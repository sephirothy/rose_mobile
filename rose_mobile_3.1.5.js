// ==UserScript==
// @name         assistant 3.1.5
// @namespace    https://pocketrose.itsns.net.cn/
// @description  Intercepts and modifies pocketrose CGI requests
// @icon         data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==
// @license      mit
// @author       xiaohaiz,fugue
// @version      3.1.15
// @grant        unsafeWindow
// @match        *://pocketrose.itsns.net.cn/*
// @require      https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js
// @run-at       document-start
// @unwrap
// ==/UserScript==

/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ([
/* 0 */
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", ({ value: true }));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageInterceptorManager_1 = __importDefault(__webpack_require__(2));
const pageInterceptorManager = new PageInterceptorManager_1.default();
$(function () {
    var _a;
    const href = location.href;
    if (href.includes("pocketrose")) {
        let cgi = href;
        if (cgi.includes("/")) {
            cgi = StringUtils_1.default.substringAfterLast(location.href, "/");
        }
        if (cgi.includes("?")) {
            cgi = StringUtils_1.default.substringBefore(cgi, "?");
        }
        (_a = pageInterceptorManager.lookupInterceptor(cgi)) === null || _a === void 0 ? void 0 : _a.intercept();
    }
});


/***/ }),
/* 1 */
/***/ ((module) => {


class StringUtils {
    static substringBefore(text, searchString) {
        const idx = text.indexOf(searchString);
        if (idx === -1) {
            return text;
        }
        return text.substring(0, idx);
    }
    static substringAfter(text, searchString) {
        const idx = text.indexOf(searchString);
        if (idx === -1) {
            return text;
        }
        return text.substring(idx + searchString.length);
    }
    static substringAfterLast(text, searchString) {
        const idx = text.lastIndexOf(searchString);
        if (idx === -1) {
            return text;
        }
        return text.substring(idx + searchString.length);
    }
    static substringBetween(text, leftString, rightString) {
        return StringUtils.substringBefore(StringUtils.substringAfter(text, leftString), rightString);
    }
    static substringBeforeSlash(text) {
        if (text.includes(" /")) {
            return StringUtils.substringBefore(text, " /");
        }
        if (text.includes("/")) {
            return StringUtils.substringBefore(text, "/");
        }
        return text;
    }
    static substringAfterSlash(text) {
        if (text.includes("/ ")) {
            return StringUtils.substringAfter(text, "/ ");
        }
        if (text.includes("/")) {
            return StringUtils.substringAfter(text, "/");
        }
        return text;
    }
    static toTitleString(s) {
        let title = "";
        for (let i = 0; i < s.length; i++) {
            title += s.charAt(i);
            if (i !== s.length - 1) {
                title += " ";
            }
        }
        return title;
    }
}
module.exports = StringUtils;


/***/ }),
/* 2 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PageInterceptorManager_interceptors;
const BattlePageInterceptor_1 = __importDefault(__webpack_require__(3));
const CastleBankPageInterceptor_1 = __importDefault(__webpack_require__(24));
const CastleDashboardPageInterceptor_1 = __importDefault(__webpack_require__(31));
const CastlePostHousePageInterceptor_1 = __importDefault(__webpack_require__(36));
const LoginDashboardPageInterceptor_1 = __importDefault(__webpack_require__(53));
const MapDashboardPageInterceptor_1 = __importDefault(__webpack_require__(57));
const MapPostHousePageInterceptor_1 = __importDefault(__webpack_require__(59));
const NationInformationPageInterceptor_1 = __importDefault(__webpack_require__(65));
const PersonalCareerManagementPageInterceptor_1 = __importDefault(__webpack_require__(67));
const PersonalEquipmentManagementPageInterceptor_1 = __importDefault(__webpack_require__(76));
const PersonalFastLoginPageInterceptor_1 = __importDefault(__webpack_require__(99));
const PersonalPetManagementPageInterceptor_1 = __importDefault(__webpack_require__(101));
const PersonalSalaryPageInterceptor_1 = __importDefault(__webpack_require__(116));
const PersonalSetupPageInterceptor_1 = __importDefault(__webpack_require__(120));
const PersonalStatusPageInterceptor_1 = __importDefault(__webpack_require__(165));
const TownAccessoryHousePageInterceptor_1 = __importDefault(__webpack_require__(169));
const TownAdventureGuildPageInterceptor_1 = __importDefault(__webpack_require__(174));
const TownArmorHousePageInterceptor_1 = __importDefault(__webpack_require__(179));
const TownBankPageInterceptor_1 = __importDefault(__webpack_require__(183));
const TownDashboardPageInterceptor_1 = __importDefault(__webpack_require__(185));
const TownGemHousePageInterceptor_1 = __importDefault(__webpack_require__(187));
const TownInformationPageInterceptor_1 = __importDefault(__webpack_require__(193));
const TownItemHousePageInterceptor_1 = __importDefault(__webpack_require__(195));
const TownPetMapHousePageInterceptor_1 = __importDefault(__webpack_require__(199));
const TownPetRankHousePageInterceptor_1 = __importDefault(__webpack_require__(201));
const TownPostHousePageInterceptor_1 = __importDefault(__webpack_require__(203));
const TownWeaponHousePageInterceptor_1 = __importDefault(__webpack_require__(205));
class PageInterceptorManager {
    constructor() {
        _PageInterceptorManager_interceptors.set(this, void 0);
        __classPrivateFieldSet(this, _PageInterceptorManager_interceptors, [
            new BattlePageInterceptor_1.default(),
            new CastleBankPageInterceptor_1.default(),
            new CastleDashboardPageInterceptor_1.default(),
            new CastlePostHousePageInterceptor_1.default(),
            new LoginDashboardPageInterceptor_1.default(),
            new MapDashboardPageInterceptor_1.default(),
            new MapPostHousePageInterceptor_1.default(),
            new NationInformationPageInterceptor_1.default(),
            new PersonalCareerManagementPageInterceptor_1.default(),
            new PersonalEquipmentManagementPageInterceptor_1.default(),
            new PersonalFastLoginPageInterceptor_1.default(),
            new PersonalPetManagementPageInterceptor_1.default(),
            new PersonalSalaryPageInterceptor_1.default(),
            new PersonalSetupPageInterceptor_1.default(),
            new PersonalStatusPageInterceptor_1.default(),
            new TownAccessoryHousePageInterceptor_1.default(),
            new TownAdventureGuildPageInterceptor_1.default(),
            new TownArmorHousePageInterceptor_1.default(),
            new TownBankPageInterceptor_1.default(),
            new TownDashboardPageInterceptor_1.default(),
            new TownGemHousePageInterceptor_1.default(),
            new TownInformationPageInterceptor_1.default(),
            new TownItemHousePageInterceptor_1.default(),
            new TownPetMapHousePageInterceptor_1.default(),
            new TownPetRankHousePageInterceptor_1.default(),
            new TownPostHousePageInterceptor_1.default(),
            new TownWeaponHousePageInterceptor_1.default(),
        ], "f");
    }
    lookupInterceptor(cgi) {
        const pageText = $("body:first").text();
        for (const interceptor of __classPrivateFieldGet(this, _PageInterceptorManager_interceptors, "f")) {
            if (interceptor.accept(cgi, pageText)) {
                return interceptor;
            }
        }
        return null;
    }
}
_PageInterceptorManager_interceptors = new WeakMap();
module.exports = PageInterceptorManager;


/***/ }),
/* 3 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _BattlePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const BattlePageProcessor_1 = __importDefault(__webpack_require__(8));
class BattlePageInterceptor {
    constructor() {
        _BattlePageInterceptor_processor.set(this, new BattlePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "battle.cgi") {
            return pageText.includes("＜＜ - 秘宝之岛 - ＞＞") ||
                pageText.includes("＜＜ - 初级之森 - ＞＞") ||
                pageText.includes("＜＜ - 中级之塔 - ＞＞") ||
                pageText.includes("＜＜ - 上级之洞窟 - ＞＞") ||
                pageText.includes("＜＜ - 十二神殿 - ＞＞");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _BattlePageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_BattlePageInterceptor_processor = new WeakMap();
module.exports = BattlePageInterceptor;


/***/ }),
/* 4 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _LocationStateMachine_storageKey;
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const LocationState_1 = __importDefault(__webpack_require__(6));
const StringUtils_1 = __importDefault(__webpack_require__(1));
/**
 * Location state machine, local storage is required.
 */
class LocationStateMachine {
    constructor(id) {
        _LocationStateMachine_storageKey.set(this, void 0);
        __classPrivateFieldSet(this, _LocationStateMachine_storageKey, "_lc_" + id, "f");
    }
    static create() {
        const id = $("input:hidden[name='id']:last").val();
        return new LocationStateMachine(id);
    }
    inTown() {
        const townId = $("input:hidden[name='townid']:last").val();
        StorageUtils_1.default.set(__classPrivateFieldGet(this, _LocationStateMachine_storageKey, "f"), "TOWN/" + townId);
    }
    inCastle() {
        const castleName = $("table:first")
            .find("tr:first")
            .next()
            .find("td:first")
            .find("table:first")
            .find("tr:eq(2)")
            .find("td:first")
            .find("table:first")
            .find("th:first")
            .text().trim();
        StorageUtils_1.default.set(__classPrivateFieldGet(this, _LocationStateMachine_storageKey, "f"), "CASTLE/" + castleName);
    }
    inMap() {
        let s = $("td:contains('现在位置')")
            .filter(function () {
            return $(this).text().startsWith("\n      现在位置");
        })
            .text();
        s = StringUtils_1.default.substringBetween(s, "现在位置(", ")");
        StorageUtils_1.default.set(__classPrivateFieldGet(this, _LocationStateMachine_storageKey, "f"), "WILD/" + s);
    }
    load() {
        const location = StorageUtils_1.default.get(__classPrivateFieldGet(this, _LocationStateMachine_storageKey, "f"));
        return new LocationState_1.default(location);
    }
}
_LocationStateMachine_storageKey = new WeakMap();
module.exports = LocationStateMachine;


/***/ }),
/* 5 */
/***/ ((module) => {


class StorageUtils {
    static set(key, value) {
        localStorage.setItem(key, value);
    }
    static get(key) {
        return localStorage.getItem(key);
    }
    static remove(key) {
        localStorage.removeItem(key);
    }
    static purge() {
        localStorage.clear();
    }
    static getString(key) {
        const value = StorageUtils.get(key);
        if (value === undefined ||
            value === null ||
            value === "undefined" ||
            value === "null") {
            return "";
        }
        return value;
    }
    static getBoolean(key) {
        const value = StorageUtils.getString(key);
        if (value === "") {
            return false;
        }
        return value !== "0";
    }
    static getInt(key, defaultValue) {
        const value = StorageUtils.getString(key);
        if (value === "") {
            return defaultValue;
        }
        return parseInt(value);
    }
    static getFloat(key, defaultValue) {
        const value = StorageUtils.getString(key);
        if (value === "") {
            return defaultValue;
        }
        return parseFloat(value);
    }
    static dumpLocalStorage() {
        const s = {};
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key === null || key.startsWith("_lc_")) {
                continue;
            }
            const value = localStorage.getItem(key);
            if (value === null) {
                continue;
            }
            // @ts-ignore
            s[key] = value;
        }
        return JSON.stringify(s);
    }
}
module.exports = StorageUtils;


/***/ }),
/* 6 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _LocationState_location, _LocationState_inTownHandler, _LocationState_inCastleHandler, _LocationState_inMapHandler;
const Coordinate_1 = __importDefault(__webpack_require__(7));
class LocationState {
    constructor(location) {
        _LocationState_location.set(this, void 0);
        _LocationState_inTownHandler.set(this, void 0);
        _LocationState_inCastleHandler.set(this, void 0);
        _LocationState_inMapHandler.set(this, void 0);
        __classPrivateFieldSet(this, _LocationState_location, location, "f");
    }
    whenInTown(handler) {
        __classPrivateFieldSet(this, _LocationState_inTownHandler, handler, "f");
        return this;
    }
    whenInCastle(handler) {
        __classPrivateFieldSet(this, _LocationState_inCastleHandler, handler, "f");
        return this;
    }
    whenInMap(handler) {
        __classPrivateFieldSet(this, _LocationState_inMapHandler, handler, "f");
        return this;
    }
    fork() {
        var _a, _b, _c, _d;
        const ss = (_a = __classPrivateFieldGet(this, _LocationState_location, "f")) === null || _a === void 0 ? void 0 : _a.split("/");
        if (ss === undefined || ss.length === 0) {
            // Do nothing in case of location is null.
            return;
        }
        if (ss[0] === "TOWN") {
            (_b = __classPrivateFieldGet(this, _LocationState_inTownHandler, "f")) === null || _b === void 0 ? void 0 : _b.call(this, ss[1]);
        }
        if (ss[0] === "CASTLE") {
            (_c = __classPrivateFieldGet(this, _LocationState_inCastleHandler, "f")) === null || _c === void 0 ? void 0 : _c.call(this, ss[1]);
        }
        if (ss[0] === "WILD") {
            const coordinate = Coordinate_1.default.parse(ss[1]);
            (_d = __classPrivateFieldGet(this, _LocationState_inMapHandler, "f")) === null || _d === void 0 ? void 0 : _d.call(this, coordinate);
        }
    }
}
_LocationState_location = new WeakMap(), _LocationState_inTownHandler = new WeakMap(), _LocationState_inCastleHandler = new WeakMap(), _LocationState_inMapHandler = new WeakMap();
module.exports = LocationState;


/***/ }),
/* 7 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const StringUtils_1 = __importDefault(__webpack_require__(1));
class Coordinate {
    constructor(x, y) {
        this.x = x;
        this.y = y;
    }
    get isAvailable() {
        return this.x >= 0 && this.x <= 15 &&
            this.y >= 0 && this.y <= 15;
    }
    asText() {
        return "(" + this.x + "," + this.y + ")";
    }
    equals(other) {
        return this.x === other.x && this.y === other.y;
    }
    static parse(text) {
        let s = text;
        if (s.includes("(") && s.includes(")")) {
            s = StringUtils_1.default.substringBetween(s, "(", ")");
        }
        const a = StringUtils_1.default.substringBefore(s, ",");
        const b = StringUtils_1.default.substringAfter(s, ",");
        const x = parseInt(a.trim());
        const y = parseInt(b.trim());
        return new Coordinate(x, y);
    }
}
module.exports = Coordinate;


/***/ }),
/* 8 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _BattlePageProcessor_instances, _BattlePageProcessor_doProcess;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const TownPetMapHouse_1 = __importDefault(__webpack_require__(12));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const CommentBoard_1 = __importDefault(__webpack_require__(20));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class BattlePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _BattlePageProcessor_instances.add(this);
    }
    doLoadButtonStyles() {
        return [90];
    }
    doProcess(credential) {
        __classPrivateFieldGet(this, _BattlePageProcessor_instances, "m", _BattlePageProcessor_doProcess).call(this, credential);
    }
}
_BattlePageProcessor_instances = new WeakSet(), _BattlePageProcessor_doProcess = function _BattlePageProcessor_doProcess(credential) {
    var _a;
    $('a[target="_blank"]').attr('tabIndex', -1);
    PageUtils_1.default.removeUnusedHyperLinks();
    PageUtils_1.default.removeGoogleAnalyticsScript();
    PageUtils_1.default.fixCurrentPageBrokenImages();
    const pageText = $("body:first").text();
    //任务模式 sephirothy
    if (pageText.includes("＜＜ - NPC战斗 - ＞＞")) {
        $('input[value="返回城市"]').attr('id', 'returnButton');
        if (pageText.includes("部队胜利")) {
            $("#returnButton").focus();
        } else {
            $("#returnButton").trigger('click');
        }
    }
    doRenderPrompt(pageText);
    $('input[value="返回住宿"]').attr('id', 'lodgeButton');
    $('input[value="返回修理"]').attr('id', 'repairButton');
    $('input[value="返回城市"]').attr('id', 'returnButton');
    $('input[value="返回更新"]').attr('id', 'updateButton');
    $('input[value="返回银行"]').attr('id', 'depositButton');
    if (SetupLoader_1.default.isBattleLargeButtonEnabled()) {
        $("#lodgeButton").addClass("button-90");
        $("#repairButton").addClass("button-90");
        $("#returnButton").addClass("button-90");
        $("#updateButton").addClass("button-90");
        $("#depositButton").addClass("button-90");
    }
    // 根据设置的内容修改按钮的台词
    let buttonText = SetupLoader_1.default.getBattleReturnButtonText();
    if (buttonText !== "") {
        $("#returnButton").val(buttonText);
    }
    buttonText = SetupLoader_1.default.getBattleLodgeButtonText();
    if (buttonText !== "") {
        $("#lodgeButton").val(buttonText);
    }
    buttonText = SetupLoader_1.default.getBattleRepairButtonText();
    if (buttonText !== "") {
        $("#repairButton").val(buttonText);
    }
    buttonText = SetupLoader_1.default.getBattleDepositButtonText();
    if (buttonText !== "") {
        $("#depositButton").val(buttonText);
    }
    // 修改返回修理按钮的行为，直接变成全部修理
    $('#repairButton').parent().prepend($('<input type="hidden" name="arm_mode" value="all">'));
    $('input[value="MY_ARM"]').attr('value', 'MY_ARM2');
    // 修改返回银行按钮的行为，直接变成全部存入
    $('#depositButton').parent().prepend($('<input type="hidden" name="azukeru" value="all">'));
    $('input[value="BANK"]').attr('value', 'BANK_SELL');
    doPostBattle(credential, pageText);
    // 如果强制推荐启用，则删除其余所有的按钮
    if (SetupLoader_1.default.isBattleForceRecommendationEnabled()) {
        $("input:submit").each(function (_idx, submit) {
            const tabIndex = $(submit).attr("tabIndex");
            if (tabIndex === undefined || tabIndex === "" || parseInt(tabIndex) !== 1) {
                $(submit).parent().remove();
            }
            else {
                $(submit).trigger("focus");
            }
        });
    }
    // 战斗页自动触底开启
    if (SetupLoader_1.default.isBattleResultAutoScrollEnabled()) {
        const buttonId = $("input:submit[tabindex='1']").attr("id");
        (_a = document.getElementById(buttonId)) === null || _a === void 0 ? void 0 : _a.scrollIntoView();
    }
    // 十二宫极速战斗
    if (pageText.includes("＜＜ - 十二神殿 - ＞＞")) {
        if (SetupLoader_1.default.isZodiacFlashBattleEnabled()) {
            $("input:submit[tabindex='1']").trigger("click");
        }
    }
    else {
        if (SetupLoader_1.default.isNormalFlashBattleEnabled()) {
            const petUpgrade = doCheckIfPetUpgrade();
            if (!petUpgrade && !pageText.includes("入手！")) {
                $("input:submit[tabindex='1']").trigger("click");
            }else {
                $("input:submit[tabindex='1']").trigger("focus");
            }
        }
    }
};
function doRenderPrompt(pageText) {
    if (pageText.includes("入手！")) {
        doRenderBattleHarvestPrompt();
    }
    else {
        doRenderNormalBattlePrompt();
    }
}
function doPostBattle(credential, pageText) {
    const reportText = $("#ueqtweixin").text();
    const endure = findRecoverItemEndure(reportText);
    const savePetMapBattleCount = SetupLoader_1.default.getSavePetMapBattleCount();
    if (savePetMapBattleCount > 0) {
        if (endure % savePetMapBattleCount === 0) {
            new TownPetMapHouse_1.default(credential).open().then(page => {
                StorageUtils_1.default.set("_pm_" + credential.id, page.asText());
            });
        }
    }
    if (shouldRepair(reportText, endure)) {
        // 优先修理按钮
        $("#repairButton").attr("tabIndex", 1);
        return;
    }
    const mode = determinePostBattleBehaviour(pageText, endure);
    if (mode === 1) {
        $("#lodgeButton").attr('tabIndex', 1);
    }
    if (mode === 2) {
        $("#depositButton").attr('tabIndex', 1);
    }
    if (mode === 3) {
        $("#returnButton").attr('tabIndex', 1);
    }
}
function findRecoverItemEndure(reportText) {
    // 耐久度初始值10000以下的最大的质数，表示没有发现回血道具
    let endure = 9973;
    if (reportText.includes("(自动)使用。(剩余")) {
        // 找到了回血道具
        const s = StringUtils_1.default.substringBetween(reportText, "(自动)使用。(剩余", "回)");
        endure = parseInt(s);
    }
    return endure;
}
function shouldRepair(reportText, endure) {
    if (endure % 100 === 0) {
        // 当回血道具的耐久度掉到100整倍数时触发修理装备。
        return true;
    }
    // 然后判断剩余的所有装备的耐久，只要有任意一件装备的耐久低于100，
    // 也触发修理装备。这里需要注意的是要排除掉大师球、宗师球、怪兽球
    // 和宠物蛋。。因此判断耐久在10~99区间吧，可以排除掉大师球和宗师球。
    let sourceText = reportText;
    const lowEndures = [];
    for (let i = 0; i < 4; i++) {
        // 最多查四次耐久度剩余
        let startIndex = sourceText.indexOf("剩余");
        if (startIndex != -1) {
            sourceText = sourceText.substring(startIndex + 2);
            let numbers = [];
            for (let j = 0; j < sourceText.length; j++) {
                if (sourceText[j] >= '0' && sourceText[j] <= '9') {
                    numbers.push(sourceText[j]);
                }
                else {
                    let number = "";
                    for (let k = 0; k < numbers.length; k++) {
                        number += numbers[k];
                    }
                    numbers = [];
                    if (parseInt(number) < SetupLoader_1.default.getRepairMinLimitation()) {
                        lowEndures.push(parseInt(number));
                    }
                    break;
                }
            }
        }
    }
    if (lowEndures.length === 0) {
        // 没有装备耐久掉到阈值之下，忽略
        return false;
    }
    for (let idx = 0; idx < lowEndures.length; idx++) {
        const currentEndure = lowEndures[idx];
        if (reportText.indexOf("大师球剩余" + currentEndure + "耐久度") === -1 &&
            reportText.indexOf("宗师球球剩余" + currentEndure + "耐久度") === -1 &&
            reportText.indexOf("超力怪兽球剩余" + currentEndure + "耐久度") === -1 &&
            reportText.indexOf("宠物蛋剩余" + currentEndure + "耐久度") === -1) {
            // 这个低耐久的装备不是上述需要排除的，说明真的有装备耐久低了，需要修理
            return true;
        }
    }
    return false;
}
/**
 * 1. 战败需要住宿
 * 2. 十二宫战斗胜利不需要住宿，直接存钱更好
 * 3. 战胜/平手情况下，检查生命力是否低于某个阈值
 * 返回值：
 * 1 - 表示住宿
 * 2 - 表示存钱
 * 3 - 表示返回
 * @param pageText
 * @param endure
 */
function determinePostBattleBehaviour(pageText, endure) {
    if (!pageText.includes("将 怪物 全灭！")) {
        // 没有战胜，直接去住宿吧
        return 1;
    }
    if (pageText.includes("＜＜ - 十二神殿 - ＞＞") || pageText.includes("＜＜ - 秘宝之岛 - ＞＞")) {
        // 十二宫和秘宝之岛战斗胜利不需要住宿，直接存钱更好
        return 2;
    }
    let depositBattleCount = SetupLoader_1.default.getDepositBattleCount();
    if (depositBattleCount > 0 && endure % depositBattleCount === 0) {
        // 存钱战数到了
        return 2;
    }
    // 通过第一个头像找到玩家的名字
    const player = $("img:first").attr("alt");
    // 获取玩家最后剩余的HP和MP
    let health = 0;
    let maxHealth = 0;
    let mana = 0;
    let maxMana = 0;
    $("td:parent").each(function (_idx, td) {
        if (player === $(td).text()) {
            let healthText = $(td).next().text();
            health = parseInt(StringUtils_1.default.substringBeforeSlash(healthText));
            maxHealth = parseInt(StringUtils_1.default.substringAfterSlash(healthText));
            let manaText = $(td).next().next().text();
            mana = parseInt(StringUtils_1.default.substringBeforeSlash(manaText));
            maxMana = parseInt(StringUtils_1.default.substringAfterSlash(manaText));
        }
    });
    // 生命力低于最大值的配置比例，住宿推荐
    if (SetupLoader_1.default.getLodgeHealthLostRatio() > 0 && (health <= maxHealth * SetupLoader_1.default.getLodgeHealthLostRatio())) {
        return 1;
    }
    // 如果MANA小于50%并且小于配置点数，住宿推荐
    if (SetupLoader_1.default.getLodgeManaLostPoint() > 0 && (mana <= maxMana * 0.5 && mana <= SetupLoader_1.default.getLodgeManaLostPoint())) {
        return 1;
    }
    if (SetupLoader_1.default.getDepositBattleCount() > 0) {
        // 设置了定期存钱，但是没有到战数，那么就直接返回吧
        return 3;
    }
    else {
        // 没有设置定期存钱，那就表示每战都存钱
        return 2;
    }
}
function doRenderBattleHarvestPrompt() {
    const prompt = SetupLoader_1.default.getBattleHarvestPrompt();
    if (prompt["person"] !== undefined && prompt["person"] !== "NONE") {
        const candidates = [];
        $("p").each(function (_idx, p) {
            if ($(p).text().includes("入手！")) {
                const html = $(p).html();
                html.split("<br>").forEach(it => {
                    if (it.endsWith("入手！")) {
                        candidates.push(it);
                    }
                });
            }
        });
        if (candidates.length > 0) {
            // @ts-ignore
            let person = prompt["person"];
            let imageHTML;
            if (person === "SELF") {
                imageHTML = PageUtils_1.default.findFirstRoleImageHtml();
            }
            else if (person === "RANDOM") {
                imageHTML = NpcLoader_1.default.randomPlayerImageHtml();
            }
            else {
                imageHTML = NpcLoader_1.default.getNpcImageHtml(person);
            }
            CommentBoard_1.default.createCommentBoard(imageHTML);
            $("#commentBoard").css("text-align", "center");
            for (const it of candidates) {
                CommentBoard_1.default.writeMessage("<b style='font-size:150%'>" + it + "</b><br>");
            }
            // @ts-ignore
            CommentBoard_1.default.writeMessage(PageUtils_1.default.convertHtmlToText(prompt["text"]));
        }
    }
}
function doRenderNormalBattlePrompt() {
    const prompt = SetupLoader_1.default.getNormalBattlePrompt();
    if (prompt["person"] !== undefined && prompt["person"] !== "NONE") {
        let person = prompt["person"];
        let imageHTML;
        if (person === "SELF") {
            imageHTML = PageUtils_1.default.findFirstRoleImageHtml();
        }
        else if (person === "RANDOM") {
            imageHTML = NpcLoader_1.default.randomPlayerImageHtml();
        }
        else {
            imageHTML = NpcLoader_1.default.getNpcImageHtml(person);
        }
        CommentBoard_1.default.createCommentBoard(imageHTML);
        $("#commentBoard")
            .css("text-align", "center")
            .css("background-color", "black")
            .css("color", "greenyellow");
        CommentBoard_1.default.writeMessage(PageUtils_1.default.convertHtmlToText(prompt["text"]));
    }
}
function doCheckIfPetUpgrade() {
    const reportText = $("#ueqtweixin").text();
    let petName = "";
    let petUpgrade = false;
    for (const s of reportText.split("\n")) {
        if (s.includes(" 获得 ") && s.includes(" 经验值.")) {
            // 这一行是宠物获得经验值的那一行
            // 记录下宠物名
            petName = StringUtils_1.default.substringBefore(s, " 获得 ");
        }
        if (petName !== "") {
            //宠物升级 sephirothy
            const searchString = petName + "学会了新技能";
            if (s.includes(searchString)) {
                petUpgrade = true;
                break;
            }
        }
    }
    return petUpgrade;
}
module.exports = BattlePageProcessor;


/***/ }),
/* 9 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Constants_1 = __importDefault(__webpack_require__(10));
const RandomUtils_1 = __importDefault(__webpack_require__(11));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class NpcLoader {
    static getNpcImageHtml(name) {
        // @ts-ignore
        const image = POCKET_NPC_IMAGES[name];
        if (image === undefined) {
            return null;
        }
        let id;
        if (name.startsWith("M_") || name.startsWith("F_") || name.startsWith("U_")) {
            id = name;
        }
        else {
            let s = StringUtils_1.default.substringAfterLast(image, "/");
            id = StringUtils_1.default.substringBefore(s, ".gif");
            id = "p_" + id;
        }
        return "<img src='" + image + "' width='64' height='64' alt='" + name + "' id='" + id + "'>";
    }
    static randomMaleNpcImageHtml() {
        const names = [];
        Object.keys(POCKET_NPC_IMAGES)
            .filter(value => value.startsWith("M_"))
            .forEach(value => names.push(value));
        const name = RandomUtils_1.default.randomElement(names);
        return NpcLoader.getNpcImageHtml(name);
    }
    static randomFemaleNpcImageHtml() {
        const names = [];
        Object.keys(POCKET_NPC_IMAGES)
            .filter(value => value.startsWith("F_"))
            .forEach(value => names.push(value));
        const name = RandomUtils_1.default.randomElement(names);
        return NpcLoader.getNpcImageHtml(name);
    }
    static randomNpcImageHtml() {
        const names = [];
        Object.keys(POCKET_NPC_IMAGES)
            .filter(value => value.startsWith("M_") || value.startsWith("F_") || value.startsWith("U_"))
            .forEach(value => names.push(value));
        const name = RandomUtils_1.default.randomElement(names);
        return NpcLoader.getNpcImageHtml(name);
    }
    static randomPlayerImageHtml() {
        const names = [];
        Object.keys(POCKET_NPC_IMAGES)
            .filter(value => !value.startsWith("M_") && !value.startsWith("F_") && !value.startsWith("U_"))
            .forEach(value => names.push(value));
        const name = RandomUtils_1.default.randomElement(names);
        return NpcLoader.getNpcImageHtml(name);
    }
    static playerNpcNames() {
        const names = [];
        Object.keys(POCKET_NPC_IMAGES)
            .filter(value => !value.startsWith("M_") && !value.startsWith("F_") && !value.startsWith("U_"))
            .forEach(value => names.push(value));
        return names;
    }
}
const POCKET_NPC_IMAGES = {
    "M_000": Constants_1.default.POCKET_DOMAIN + "/image/etc/0.gif",
    "M_001": Constants_1.default.POCKET_DOMAIN + "/image/etc/1.gif",
    "M_002": Constants_1.default.POCKET_DOMAIN + "/image/etc/2.gif",
    "M_003": Constants_1.default.POCKET_DOMAIN + "/image/etc/3.gif",
    "M_004": Constants_1.default.POCKET_DOMAIN + "/image/etc/4.gif",
    "M_005": Constants_1.default.POCKET_DOMAIN + "/image/etc/5.gif",
    "M_006": Constants_1.default.POCKET_DOMAIN + "/image/etc/6.gif",
    "M_007": Constants_1.default.POCKET_DOMAIN + "/image/etc/7.gif",
    "M_008": Constants_1.default.POCKET_DOMAIN + "/image/etc/8.gif",
    "M_009": Constants_1.default.POCKET_DOMAIN + "/image/etc/9.gif",
    "M_011": Constants_1.default.POCKET_DOMAIN + "/image/etc/11.gif",
    "M_012": Constants_1.default.POCKET_DOMAIN + "/image/etc/12.gif",
    "M_013": Constants_1.default.POCKET_DOMAIN + "/image/etc/13.gif",
    "M_014": Constants_1.default.POCKET_DOMAIN + "/image/etc/14.gif",
    "M_015": Constants_1.default.POCKET_DOMAIN + "/image/etc/15.gif",
    "M_016": Constants_1.default.POCKET_DOMAIN + "/image/etc/16.gif",
    "M_017": Constants_1.default.POCKET_DOMAIN + "/image/etc/17.gif",
    "M_018": Constants_1.default.POCKET_DOMAIN + "/image/etc/18.gif",
    "M_019": Constants_1.default.POCKET_DOMAIN + "/image/etc/19.gif",
    "M_020": Constants_1.default.POCKET_DOMAIN + "/image/etc/20.gif",
    "M_021": Constants_1.default.POCKET_DOMAIN + "/image/etc/21.gif",
    "M_022": Constants_1.default.POCKET_DOMAIN + "/image/etc/22.gif",
    "M_023": Constants_1.default.POCKET_DOMAIN + "/image/etc/23.gif",
    "F_026": Constants_1.default.POCKET_DOMAIN + "/image/etc/26.gif",
    "F_027": Constants_1.default.POCKET_DOMAIN + "/image/etc/27.gif",
    "F_028": Constants_1.default.POCKET_DOMAIN + "/image/etc/28.gif",
    "F_030": Constants_1.default.POCKET_DOMAIN + "/image/etc/30.gif",
    "F_031": Constants_1.default.POCKET_DOMAIN + "/image/etc/31.gif",
    "F_032": Constants_1.default.POCKET_DOMAIN + "/image/etc/32.gif",
    "F_037": Constants_1.default.POCKET_DOMAIN + "/image/etc/37.gif",
    "F_039": Constants_1.default.POCKET_DOMAIN + "/image/etc/39.gif",
    "F_040": Constants_1.default.POCKET_DOMAIN + "/image/etc/40.gif",
    "U_041": Constants_1.default.POCKET_DOMAIN + "/image/etc/41.gif",
    "夜三": Constants_1.default.POCKET_DOMAIN + "/image/head/1117.gif",
    "花子": Constants_1.default.POCKET_DOMAIN + "/image/head/1126.gif",
    "骨头": Constants_1.default.POCKET_DOMAIN + "/image/head/1160.gif",
    "狐狸": Constants_1.default.POCKET_DOMAIN + "/image/head/1196.gif",
    "七七": Constants_1.default.POCKET_DOMAIN + "/image/head/1368.gif",
    "豚豚": Constants_1.default.POCKET_DOMAIN + "/image/head/1389.gif",
    "夜九": Constants_1.default.POCKET_DOMAIN + "/image/head/1561.gif",
    "剑心": Constants_1.default.POCKET_DOMAIN + "/image/head/2184.gif",
    "路路": Constants_1.default.POCKET_DOMAIN + "/image/head/2201.gif",
    "饭饭": Constants_1.default.POCKET_DOMAIN + "/image/head/3139.gif",
    "亲戚": Constants_1.default.POCKET_DOMAIN + "/image/head/3188.gif",
    "马可": Constants_1.default.POCKET_DOMAIN + "/image/head/6169.gif",
    "青鸟": Constants_1.default.POCKET_DOMAIN + "/image/head/7184.gif",
    "小明": Constants_1.default.POCKET_DOMAIN + "/image/head/8166.gif",
    "末末": Constants_1.default.POCKET_DOMAIN + "/image/head/8173.gif",
    "白皇": Constants_1.default.POCKET_DOMAIN + "/image/head/11134.gif",
    "莫莫": Constants_1.default.POCKET_DOMAIN + "/image/head/13165.gif",
    "天翔": Constants_1.default.POCKET_DOMAIN + "/image/head/14129.gif",
};
module.exports = NpcLoader;


/***/ }),
/* 10 */
/***/ ((module) => {


class Constants {
}
Constants.POCKET_DOMAIN = "https://pocketrose.itsns.net.cn/pocketrose";
module.exports = Constants;


/***/ }),
/* 11 */
/***/ ((module) => {


class RandomUtils {
    static randomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    static randomElement(list) {
        if (list.length === 0) {
            return null;
        }
        if (list.length === 1) {
            return list[0];
        }
        const idx = RandomUtils.randomInt(0, list.length - 1);
        return list[idx];
    }
}
module.exports = RandomUtils;


/***/ }),
/* 12 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownPetMapHouse_credential, _TownPetMapHouse_townId;
const PetMap_1 = __importDefault(__webpack_require__(13));
const Role_1 = __importDefault(__webpack_require__(14));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownPetMapHousePage_1 = __importDefault(__webpack_require__(18));
class TownPetMapHouse {
    constructor(credential, townId) {
        _TownPetMapHouse_credential.set(this, void 0);
        _TownPetMapHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownPetMapHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownPetMapHouse_townId, townId, "f");
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownPetMapHouse_credential, "f").asRequestMap();
                    if (__classPrivateFieldGet(this, _TownPetMapHouse_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _TownPetMapHouse_townId, "f"));
                    }
                    request.set("con_str", "50");
                    request.set("mode", "PETMAP");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const page = TownPetMapHouse.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const role = new Role_1.default();
        $(html).find("td:contains('ＬＶ')")
            .filter((idx, td) => $(td).text() === "ＬＶ")
            .parent()
            .next()
            .find("td:first")
            .each((idx, td) => {
            role.name = $(td).text();
        })
            .next()
            .each((idx, td) => {
            role.level = parseInt($(td).text());
        })
            .next()
            .each((idx, td) => {
            let s = $(td).text();
            role.attribute = StringUtils_1.default.substringBefore(s, "属");
        })
            .next()
            .each((idx, td) => {
            role.career = $(td).text();
        })
            .parent()
            .next()
            .find("td:first")
            .next()
            .each((idx, td) => {
            let s = $(td).text();
            s = StringUtils_1.default.substringBefore(s, " GOLD");
            role.cash = parseInt(s);
        });
        const petMapList = [];
        $(html).find("td")
            .each(function (idx, td) {
            const img = $(td).find("img:first");
            if (img.length > 0) {
                const src = img.attr("src");
                if (src.includes("/386/")) {
                    const code = img.attr("alt");
                    const picture = StringUtils_1.default.substringAfterLast(src, "/");
                    const count = parseInt($(td).next().text());
                    const pm = new PetMap_1.default();
                    pm.code = code;
                    pm.picture = picture;
                    pm.count = count;
                    petMapList.push(pm);
                }
            }
        });
        const page = new TownPetMapHousePage_1.default();
        page.role = role;
        page.petMapList = petMapList;
        return page;
    }
}
_TownPetMapHouse_credential = new WeakMap(), _TownPetMapHouse_townId = new WeakMap();
module.exports = TownPetMapHouse;


/***/ }),
/* 13 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Constants_1 = __importDefault(__webpack_require__(10));
class PetMap {
    get imageHtml() {
        const src = Constants_1.default.POCKET_DOMAIN + "/image/386/" + this.picture;
        return "<img src='" + src + "' alt='" + this.code + "'>";
    }
}
module.exports = PetMap;


/***/ }),
/* 14 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Constants_1 = __importDefault(__webpack_require__(10));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class Role {
    get imageHtml() {
        const src = Constants_1.default.POCKET_DOMAIN + "/image/head/" + this.image;
        return "<img src='" + src + "' alt='" + this.name + "' width='64' height='64' id='roleImage'>";
    }
    parseHealth(s) {
        if (s.includes("/")) {
            this.health = parseInt(StringUtils_1.default.substringBeforeSlash(s));
            this.maxHealth = parseInt(StringUtils_1.default.substringAfterSlash(s));
        }
        else {
            this.health = parseInt(s);
        }
    }
    parseMana(s) {
        if (s.includes("/")) {
            this.mana = parseInt(StringUtils_1.default.substringBeforeSlash(s));
            this.maxMana = parseInt(StringUtils_1.default.substringAfterSlash(s));
        }
        else {
            this.mana = parseInt(s);
        }
    }
    asShortText() {
        return this.name + " " + this.level +
            " " + this.health + "/" + this.maxHealth +
            " " + this.mana + "/" + this.maxMana +
            " " + this.attack +
            " " + this.defense +
            " " + this.specialAttack +
            " " + this.specialDefense +
            " " + this.speed;
    }
}
module.exports = Role;


/***/ }),
/* 15 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const ObjectUtils_1 = __importDefault(__webpack_require__(17));
class NetworkUtils {
    static sendGetRequest(cgi, handler) {
        __internalSendGetRequest(0, cgi, handler);
    }
    static sendPostRequest(cgi, request, handler) {
        __internalSendPostRequest(0, cgi, request, handler);
    }
    static get(cgi) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    NetworkUtils.sendGetRequest(cgi, function (html) {
                        resolve(html);
                    });
                });
            })();
        });
    }
    static post(cgi, request) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (cgi, request) => {
                return new Promise(resolve => {
                    const body = ObjectUtils_1.default.convertMapToObject(request);
                    NetworkUtils.sendPostRequest(cgi, body, function (html) {
                        resolve(html);
                    });
                });
            };
            return yield action(cgi, request);
        });
    }
}
function __internalSendGetRequest(count, cgi, handler) {
    if (count === 3) {
        MessageBoard_1.default.publishWarning("请求" + cgi + "达到最大重试次数，依然失败，看起来口袋出问题了，请联系GM！");
        return;
    }
    fetch(cgi, { method: "GET" })
        .then((response) => {
        if (!response.ok) {
            MessageBoard_1.default.publishWarning("请求" + cgi + "时返回错误[status=" + response.status + "]，尝试重试！");
            throw new Error("RESPONSE was not ok");
        }
        if (count !== 0) {
            MessageBoard_1.default.publishMessage("第" + count + "次重试请求" + cgi + "成功。");
        }
        return response.arrayBuffer();
    })
        .then((arrayBuffer) => {
        const decoder = new TextDecoder("gb2312");
        const html = decoder.decode(new Uint8Array(arrayBuffer));
        if (handler !== undefined) {
            handler(html);
        }
    })
        .catch(() => {
        __internalSendGetRequest(count + 1, cgi, handler);
    });
}
function __internalSendPostRequest(count, cgi, request, handler) {
    if (count === 3) {
        MessageBoard_1.default.publishWarning("请求" + cgi + "达到最大重试次数，依然失败，看起来口袋出问题了，请联系GM！");
        return;
    }
    fetch(cgi, {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
        },
        body: new URLSearchParams(request),
    })
        .then((response) => {
        if (!response.ok) {
            MessageBoard_1.default.publishWarning("请求" + cgi + "时返回错误[status=" + response.status + "]，尝试重试！");
            throw new Error("RESPONSE was not ok");
        }
        if (count !== 0) {
            MessageBoard_1.default.publishMessage("第" + count + "次重试请求" + cgi + "成功。");
        }
        return response.arrayBuffer();
    })
        .then((arrayBuffer) => {
        const decoder = new TextDecoder("gb2312");
        const html = decoder.decode(new Uint8Array(arrayBuffer));
        if (handler !== undefined) {
            handler(html);
        }
    })
        .catch(() => {
        __internalSendPostRequest(count + 1, cgi, request, handler);
    });
}
module.exports = NetworkUtils;


/***/ }),
/* 16 */
/***/ ((module) => {


class MessageBoard {
    static createMessageBoard(containerId, imageHtml) {
        let html = "";
        html += "<table style='background-color:#888888;border-width:0;width:100%'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0' id='messageBoardManager'>" + imageHtml + "</td>";
        html += "<td style='background-color:#F8F0E0;width:100%' id='messageBoard'></td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#" + containerId).html(html);
    }
    static createMessageBoardStyleB(containerId, imageHtml) {
        let html = "";
        html += "<table style='background-color:#888888;border-width:0;width:100%'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0;width:100%' id='messageBoard'></td>";
        html += "<td style='background-color:#F8F0E0' id='messageBoardManager'>" + imageHtml + "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#" + containerId).html(html);
    }
    static resetMessageBoard(message) {
        if ($("#messageBoard").length === 0) {
            return;
        }
        $("#messageBoard").html(message);
    }
    static publishMessage(message) {
        if ($("#messageBoard").length > 0) {
            let html = $("#messageBoard").html();
            const now = new Date();
            const timeHtml = "<span style='color:forestgreen'>(" + now.toLocaleString() + ")</span>";
            html = html + "<li>" + timeHtml + " " + message + "</li>";
            $("#messageBoard").html(html);
        }
    }
    static publishWarning(message) {
        if ($("#messageBoard").length > 0) {
            let html = $("#messageBoard").html();
            const now = new Date();
            const timeHtml = "<span style='color:forestgreen'>(" + now.toLocaleString() + ")</span>";
            const messageHtml = "<span style='color:red'>" + message + "</span>";
            html = html + "<li>" + timeHtml + " " + messageHtml + "</li>";
            $("#messageBoard").html(html);
        }
    }
    static processResponseMessage(html) {
        if ($(html).text().includes("ERROR !")) {
            const errorMessage = $(html).find("font b").text();
            MessageBoard.publishMessage("<b style='color:red'>" + errorMessage + "</b>");
        }
        else {
            $(html).find("h2").each(function (_idx, h2) {
                let successMessage = $(h2).html();
                successMessage = successMessage.replace("<br>", "");
                successMessage = "<td>" + successMessage + "</td>";
                MessageBoard.publishMessage($(successMessage).text());
            });
        }
    }
}
module.exports = MessageBoard;


/***/ }),
/* 17 */
/***/ ((module) => {


class ObjectUtils {
    static convertMapToObject(map) {
        const result = {};
        map.forEach(function (value, key) {
            // @ts-ignore
            result[key] = value;
        });
        return result;
    }
}
module.exports = ObjectUtils;


/***/ }),
/* 18 */
/***/ ((module) => {


class TownPetMapHousePage {
    asText() {
        let s = "";
        for (const pm of this.petMapList) {
            s += pm.code;
            s += "/";
            s += pm.count;
            s += "  ";
        }
        return s;
    }
}
module.exports = TownPetMapHousePage;


/***/ }),
/* 19 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const StorageUtils_1 = __importDefault(__webpack_require__(5));
class SetupLoader {
    static isPokemonWikiEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_001");
    }
    static getLodgeHealthLostRatio() {
        return StorageUtils_1.default.getFloat("_pa_002", 1.1);
    }
    static getLodgeManaLostPoint() {
        return StorageUtils_1.default.getInt("_pa_003", 100);
    }
    static getRepairMinLimitation() {
        return StorageUtils_1.default.getInt("_pa_004", 100);
    }
    static getDepositBattleCount() {
        return StorageUtils_1.default.getInt("_pa_005", 10);
    }
    static isBattleResultAutoScrollEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_006");
    }
    static isBattleForceRecommendationEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_007");
    }
    static isZodiacFlashBattleEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_008");
    }
    static isNormalFlashBattleEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_029");
    }
    static isPetManagementUIEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_009");
    }
    static isEquipmentManagementUIEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_010");
    }
    static isCareerManagementUIEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_011");
    }
    static getBattlePlacePreference(id) {
        let value;
        const s = StorageUtils_1.default.getString("_pa_012_" + id);
        if (s === "") {
            value = {};
            // @ts-ignore
            value["primary"] = false;
            // @ts-ignore
            value["junior"] = false;
            // @ts-ignore 默认上洞 sephirothy
            value["senior"] = true;
            // @ts-ignore
            value["zodiac"] = false;
        }
        else {
            value = JSON.parse(s);
        }
        return value;
    }
    static isPocketSuperMarketEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_013");
    }
    static isCareerTransferEntranceDisabled(id) {
        return StorageUtils_1.default.getBoolean("_pa_014_" + id);
    }
    static getBattleReturnButtonText() {
        return StorageUtils_1.default.getString("_pa_015");
    }
    static getBattleLodgeButtonText() {
        return StorageUtils_1.default.getString("_pa_016");
    }
    static getBattleRepairButtonText() {
        return StorageUtils_1.default.getString("_pa_017");
    }
    static getBattleDepositButtonText() {
        return StorageUtils_1.default.getString("_pa_018");
    }
    static loadEquipmentSet_A(id) {
        const s = StorageUtils_1.default.getString("_pa_019_" + id);
        if (s === "") {
            const value = {};
            // @ts-ignore
            value["weaponName"] = "NONE";
            // @ts-ignore
            value["armorName"] = "NONE";
            // @ts-ignore
            value["accessoryName"] = "NONE";
            return value;
        }
        else {
            return JSON.parse(s);
        }
    }
    static loadEquipmentSet_B(id) {
        const s = StorageUtils_1.default.getString("_pa_020_" + id);
        if (s === "") {
            const value = {};
            // @ts-ignore
            value["weaponName"] = "NONE";
            // @ts-ignore
            value["armorName"] = "NONE";
            // @ts-ignore
            value["accessoryName"] = "NONE";
            return value;
        }
        else {
            return JSON.parse(s);
        }
    }
    static loadEquipmentSet_C(id) {
        const s = StorageUtils_1.default.getString("_pa_021_" + id);
        if (s === "") {
            const value = {};
            // @ts-ignore
            value["weaponName"] = "NONE";
            // @ts-ignore
            value["armorName"] = "NONE";
            // @ts-ignore
            value["accessoryName"] = "NONE";
            return value;
        }
        else {
            return JSON.parse(s);
        }
    }
    static loadEquipmentSet_D(id) {
        const s = StorageUtils_1.default.getString("_pa_022_" + id);
        if (s === "") {
            const value = {};
            // @ts-ignore
            value["weaponName"] = "NONE";
            // @ts-ignore
            value["armorName"] = "NONE";
            // @ts-ignore
            value["accessoryName"] = "NONE";
            return value;
        }
        else {
            return JSON.parse(s);
        }
    }
    static loadEquipmentSet_E(id) {
        const s = StorageUtils_1.default.getString("_pa_023_" + id);
        if (s === "") {
            const value = {};
            // @ts-ignore
            value["weaponName"] = "NONE";
            // @ts-ignore
            value["armorName"] = "NONE";
            // @ts-ignore
            value["accessoryName"] = "NONE";
            return value;
        }
        else {
            return JSON.parse(s);
        }
    }
    static getBattleHarvestPrompt() {
        const s = StorageUtils_1.default.getString("_pa_024");
        if (s === "") {
            const value = {};
            // @ts-ignore
            value["person"] = "NONE";
            // @ts-ignore
            value["text"] = "";
            return value;
        }
        else {
            return JSON.parse(s);
        }
    }
    static getNormalBattlePrompt() {
        const s = StorageUtils_1.default.getString("_pa_025");
        if (s === "") {
            const value = {};
            // @ts-ignore
            value["person"] = "NONE";
            // @ts-ignore
            value["text"] = "";
            return value;
        }
        else {
            return JSON.parse(s);
        }
    }
    static isExperienceProgressBarEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_026");
    }
    static isFastLoginEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_027");
    }
    static isHiddenLeaveAndExitEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_028");
    }
    static isCollectTownTaxDisabled() {
        return StorageUtils_1.default.getBoolean("_pa_030");
    }
    static isGemHouseUIEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_031");
    }
    static isCastleKeeperEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_032");
    }
    static isPocketBankEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_033");
    }
    static isBattleLargeButtonEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_034");
    }
    static isTownDashboardShortcutButtonEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_035");
    }
    static getEnlargeBattleRatio() {
        return StorageUtils_1.default.getFloat("_pa_036", -1);
    }
    static isConsecrateStateRecognizeEnabled(id) {
        return StorageUtils_1.default.getBoolean("_pa_037_" + id);
    }
    static isEquipmentPetSortEnabled() {
        return StorageUtils_1.default.getBoolean("_pa_038");
    }
    static getSavePetMapBattleCount() {
        return StorageUtils_1.default.getInt("_pa_039", 20);
    }
}
module.exports = SetupLoader;


/***/ }),
/* 20 */
/***/ ((module) => {


class CommentBoard {
    static createCommentBoard(imageHtml) {
        if ($("#commentBoard").length > 0) {
            return;
        }
        let html = "";
        html += "<table style='background-color:#888888;border-width:0;width:100%'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0' id='commentBoardManager'>" + imageHtml + "</td>";
        html += "<td style='background-color:#F8F0E0;width:100%' id='commentBoard'></td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("body:first").find("div:last").before($("<div id='commentBoardContainer'></div>"));
        $("#commentBoardContainer").html(html);
    }
    static writeMessage(message) {
        if ($("#commentBoard").length > 0) {
            let html = $("#commentBoard").html();
            html += message;
            $("#commentBoard").html(html);
        }
    }
}
module.exports = CommentBoard;


/***/ }),
/* 21 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Constants_1 = __importDefault(__webpack_require__(10));
const Credential_1 = __importDefault(__webpack_require__(22));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class PageUtils {
    static currentPageHtml() {
        return document.documentElement.outerHTML;
    }
    /**
     * Remove unused hyper links from last div element.
     */
    static removeUnusedHyperLinks() {
        const div = $("div:last");
        div.find("a").attr("href", "javascript:void(0)");
        div.find("a").attr("tabIndex", "-1");
    }
    /**
     * Remove last google-analytics script
     */
    static removeGoogleAnalyticsScript() {
        $("script:last").remove();
        $("script")
            .filter(function () {
            const src = $(this).attr("src");
            return src !== undefined && src.includes("google-analytics");
        })
            .each(function (_idx, script) {
            script.remove();
        });
    }
    static currentCredential() {
        const id = $("input:hidden[name='id']:last").val();
        const pass = $("input:hidden[name='pass']:last").val();
        return new Credential_1.default(id.toString(), pass.toString());
    }
    static parseCredential(pageHtml) {
        const id = $(pageHtml).find("input:hidden[name='id']:last").val();
        const pass = $(pageHtml).find("input:hidden[name='pass']:last").val();
        return new Credential_1.default(id, pass);
    }
    static generateProgressBarHTML(ratio) {
        if (ratio === 0) {
            return "<img src='" + Constants_1.default.POCKET_DOMAIN + "/image/bg/bar2.gif'  height='7' width='50' alt=''>";
        }
        if (ratio === 1) {
            return "<img src='" + Constants_1.default.POCKET_DOMAIN + "/image/bg/bar1.gif'  height='7' width='50' alt=''>";
        }
        const w1 = Math.min(49, Math.ceil(50 * ratio));
        const w2 = 50 - w1;
        return "<img src='" + Constants_1.default.POCKET_DOMAIN + "/image/bg/bar1.gif'  height='7' width='" + w1 + "' alt=''>" +
            "<img src='" + Constants_1.default.POCKET_DOMAIN + "/image/bg/bar2.gif'  height='7' width='" + w2 + "' alt=''>";
    }
    static findFirstRoleImageHtml() {
        let roleImage = "";
        $("img").each(function (_idx, img) {
            if (roleImage === "") {
                const src = $(img).attr("src");
                if (src !== undefined && src.startsWith(Constants_1.default.POCKET_DOMAIN + "/image/head/")) {
                    // 发现了用户头像
                    roleImage = src;
                }
            }
        });
        if (roleImage === "") {
            return null;
        }
        else {
            return "<img src='" + roleImage + "' width='64' height='64' id='roleImage' alt=''>";
        }
    }
    static isColorBlue(id) {
        const color = $("#" + id).css("color");
        return color.toString() === "rgb(0, 0, 255)";
    }
    static isColorGrey(id) {
        const color = $("#" + id).css("color");
        return color.toString() === "rgb(128, 128, 128)";
    }
    static generateInvisibleButton(backgroundColor) {
        return "<input type='button' " +
            "value='　　' " +
            "style='background-color:" + backgroundColor + ";border-width:0' " +
            "tabindex='-1'>";
    }
    static fixCurrentPageBrokenImages() {
        if ($("img").length === 0) {
            return;
        }
        $("img")
            .filter(function () {
            const src = $(this).attr("src");
            return src.startsWith("http://pocketrose.21sun.net:81/pocketrose") ||
                src.startsWith("http://pocketrose.21sun.net/pocketrose");
        })
            .each(function (_idx, img) {
            const src = $(img).attr("src");
            let s = src;
            if (src.includes("http://pocketrose.21sun.net:81/pocketrose")) {
                s = StringUtils_1.default.substringAfter(s, "http://pocketrose.21sun.net:81/pocketrose");
            }
            else if (src.includes("http://pocketrose.21sun.net/pocketrose")) {
                s = StringUtils_1.default.substringAfter(s, "http://pocketrose.21sun.net/pocketrose");
            }
            s = Constants_1.default.POCKET_DOMAIN + s;
            $(img).attr("src", s);
        });
    }
    static fixBrokenImageIfNecessary(s) {
        let t = s;
        if (t.includes("http://pocketrose.21sun.net:81/pocketrose")) {
            t = t.replace("http://pocketrose.21sun.net:81/pocketrose", Constants_1.default.POCKET_DOMAIN);
        }
        if (t.includes("http://pocketrose.21sun.net/pocketrose")) {
            t = t.replace("http://pocketrose.21sun.net/pocketrose", Constants_1.default.POCKET_DOMAIN);
        }
        return t;
    }
    static convertHtmlToText(html) {
        const s = "<td>" + html + "</td>";
        return $(s).text();
    }
    static scrollIntoView(elementId) {
        var _a;
        (_a = document.getElementById(elementId)) === null || _a === void 0 ? void 0 : _a.scrollIntoView();
    }
    static generateReturnTownForm(credential) {
        let html = "";
        // noinspection HtmlUnknownTarget
        html += "<form action='status.cgi' method='post'>";
        html += "<input type='hidden' name='id' value='" + credential.id + "'>";
        html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
        html += "<input type='hidden' name='mode' value='STATUS'>";
        html += "<input type='submit' id='returnTown'>";
        html += "</form>";
        return html;
    }
    static generateReturnMapForm(credential) {
        let html = "";
        // noinspection HtmlUnknownTarget
        html += "<form action='status.cgi' method='post'>";
        html += "<input type='hidden' name='id' value='" + credential.id + "'>";
        html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
        html += "<input type='hidden' name='mode' value='STATUS'>";
        html += "<input type='submit' id='returnMap'>";
        html += "</form>";
        return html;
    }
    static generateReturnCastleForm(credential) {
        let html = "";
        // noinspection HtmlUnknownTarget
        html += "<form action='castlestatus.cgi' method='post'>";
        html += "<input type='hidden' name='id' value='" + credential.id + "'>";
        html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
        html += "<input type='hidden' name='mode' value='CASTLESTATUS'>";
        html += "<input type='submit' id='returnCastle'>";
        html += "</form>";
        return html;
    }
    static loadButtonStyle(code) {
        const key = code.toString();
        // @ts-ignore
        if (BUTTON_STYLES[key] !== undefined) {
            let s = $("style[type='text/css']").html();
            s = s.replace("-->", "\n");
            // @ts-ignore
            s += BUTTON_STYLES[key];
            s += "-->";
            $("style[type='text/css']").html(s);
        }
    }
    static unbindEventBySpecifiedClass(className) {
        if ($("." + className).length > 0) {
            $("." + className)
                .off("click")
                .off("mouseenter")
                .off("mouseleave");
        }
    }
}
const BUTTON_STYLES = {
    "5": ".button-5 {\n" +
        "  align-items: center;\n" +
        "  background-clip: padding-box;\n" +
        "  background-color: #fa6400;\n" +
        "  border: 1px solid transparent;\n" +
        "  border-radius: .25rem;\n" +
        "  box-shadow: rgba(0, 0, 0, 0.02) 0 1px 3px 0;\n" +
        "  box-sizing: border-box;\n" +
        "  color: #fff;\n" +
        "  cursor: pointer;\n" +
        "  display: inline-flex;\n" +
        "  font-size: 100%;\n" +
        "  font-weight: 600;\n" +
        "  justify-content: center;\n" +
        "  line-height: 1.25;\n" +
        "  margin: 0;\n" +
        "  min-height: 3rem;\n" +
        "  padding: calc(.875rem - 1px) calc(1.5rem - 1px);\n" +
        "  position: relative;\n" +
        "  text-decoration: none;\n" +
        "  transition: all 250ms;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "  vertical-align: baseline;\n" +
        "  width: auto;\n" +
        "}\n" +
        "\n" +
        ".button-5:hover,\n" +
        ".button-5:focus {\n" +
        "  background-color: #fb8332;\n" +
        "  box-shadow: rgba(0, 0, 0, 0.1) 0 4px 12px;\n" +
        "}\n" +
        "\n" +
        ".button-5:hover {\n" +
        "  transform: translateY(-1px);\n" +
        "}\n" +
        "\n" +
        ".button-5:active {\n" +
        "  background-color: #c85000;\n" +
        "  box-shadow: rgba(0, 0, 0, .06) 0 2px 4px;\n" +
        "  transform: translateY(0);\n" +
        "}\n",
    "7": ".button-7 {\n" +
        "  background-color: #0095ff;\n" +
        "  border: 1px solid transparent;\n" +
        "  border-radius: 3px;\n" +
        "  box-shadow: rgba(255, 255, 255, .4) 0 1px 0 0 inset;\n" +
        "  box-sizing: border-box;\n" +
        "  color: #fff;\n" +
        "  cursor: pointer;\n" +
        "  display: inline-block;\n" +
        "  font-size: 100%;\n" +
        "  font-weight: 400;\n" +
        "  line-height: 1.15385;\n" +
        "  margin: 0;\n" +
        "  outline: none;\n" +
        "  padding: 8px .8em;\n" +
        "  position: relative;\n" +
        "  text-align: center;\n" +
        "  text-decoration: none;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "  vertical-align: baseline;\n" +
        "  white-space: nowrap;\n" +
        "}\n" +
        "\n" +
        ".button-7:hover,\n" +
        ".button-7:focus {\n" +
        "  background-color: #07c;\n" +
        "}\n" +
        "\n" +
        ".button-7:focus {\n" +
        "  box-shadow: 0 0 0 4px rgba(0, 149, 255, .15);\n" +
        "}\n" +
        "\n" +
        ".button-7:active {\n" +
        "  background-color: #0064bd;\n" +
        "  box-shadow: none;\n" +
        "}\n",
    "8": ".button-8 {\n" +
        "  background-color: #e1ecf4;\n" +
        "  border-radius: 3px;\n" +
        "  border: 1px solid #7aa7c7;\n" +
        "  box-shadow: rgba(255, 255, 255, .7) 0 1px 0 0 inset;\n" +
        "  box-sizing: border-box;\n" +
        "  color: #39739d;\n" +
        "  cursor: pointer;\n" +
        "  display: inline-block;\n" +
        "  font-size: 100%;\n" +
        "  font-weight: 400;\n" +
        "  line-height: 1.15385;\n" +
        "  margin: 0;\n" +
        "  outline: none;\n" +
        "  padding: 8px .8em;\n" +
        "  position: relative;\n" +
        "  text-align: center;\n" +
        "  text-decoration: none;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "  vertical-align: baseline;\n" +
        "  white-space: nowrap;\n" +
        "}\n" +
        "\n" +
        ".button-8:hover,\n" +
        ".button-8:focus {\n" +
        "  background-color: #b3d3ea;\n" +
        "  color: #2c5777;\n" +
        "}\n" +
        "\n" +
        ".button-8:focus {\n" +
        "  box-shadow: 0 0 0 4px rgba(0, 149, 255, .15);\n" +
        "}\n" +
        "\n" +
        ".button-8:active {\n" +
        "  background-color: #a0c7e4;\n" +
        "  box-shadow: none;\n" +
        "  color: #2c5777;\n" +
        "}\n",
    "16": ".button-16 {\n" +
        "  background-color: #f8f9fa;\n" +
        "  border: 1px solid #f8f9fa;\n" +
        "  border-radius: 4px;\n" +
        "  color: #3c4043;\n" +
        "  cursor: pointer;\n" +
        "  font-size: 100%;\n" +
        "  height: 36px;\n" +
        "  line-height: 27px;\n" +
        "  /* min-width: 54px;\n */" +
        "  /* padding: 0 16px;\n */" +
        "  min-width: 36px;\n" +
        "  padding: 0 8px;\n" +
        "  text-align: center;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "  white-space: pre;\n" +
        "}\n" +
        "\n" +
        ".button-16:hover {\n" +
        "  border-color: #dadce0;\n" +
        "  box-shadow: rgba(0, 0, 0, .1) 0 1px 1px;\n" +
        "  color: #202124;\n" +
        "}\n" +
        "\n" +
        ".button-16:focus {\n" +
        "  border-color: #4285f4;\n" +
        "  outline: none;\n" +
        "}\n",
    "24": ".button-24 {\n" +
        "  background: #FF4742;\n" +
        "  border: 1px solid #FF4742;\n" +
        "  border-radius: 6px;\n" +
        "  box-shadow: rgba(0, 0, 0, 0.1) 1px 2px 4px;\n" +
        "  box-sizing: border-box;\n" +
        "  color: #FFFFFF;\n" +
        "  cursor: pointer;\n" +
        "  display: inline-block;\n" +
        "  font-size: 100%;\n" +
        "  font-weight: 800;\n" +
        "  line-height: 16px;\n" +
        "  /* min-height: 40px;\n */" +
        "  outline: 0;\n" +
        "  /* padding: 12px 14px;\n */" +
        "  text-align: center;\n" +
        "  text-rendering: geometricprecision;\n" +
        "  text-transform: none;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "  vertical-align: middle;\n" +
        "}\n" +
        "\n" +
        ".button-24:hover,\n" +
        ".button-24:active {\n" +
        "  background-color: initial;\n" +
        "  background-position: 0 0;\n" +
        "  color: #FF4742;\n" +
        "}\n" +
        "\n" +
        ".button-24:active {\n" +
        "  opacity: .5;\n" +
        "}\n",
    "28": ".button-28 {\n" +
        "  appearance: none;\n" +
        "  background-color: transparent;\n" +
        "  border: 2px solid #1A1A1A;\n" +
        "  border-radius: 15px;\n" +
        "  box-sizing: border-box;\n" +
        "  color: #3B3B3B;\n" +
        "  cursor: pointer;\n" +
        "  display: inline-block;\n" +
        "  font-size: 100%;\n" +
        "  font-weight: 600;\n" +
        "  line-height: normal;\n" +
        "  margin: 0;\n" +
        "  min-height: 30px;\n" +
        "  min-width: 0;\n" +
        "  outline: none;\n" +
        "  padding: 8px 12px;\n" +
        "  text-align: center;\n" +
        "  text-decoration: none;\n" +
        "  transition: all 300ms cubic-bezier(.23, 1, 0.32, 1);\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "  width: 100%;\n" +
        "  will-change: transform;\n" +
        "}\n" +
        "\n" +
        ".button-28:disabled {\n" +
        "  pointer-events: none;\n" +
        "}\n" +
        "\n" +
        ".button-28:hover {\n" +
        "  color: #fff;\n" +
        "  background-color: #1A1A1A;\n" +
        "  box-shadow: rgba(0, 0, 0, 0.25) 0 8px 15px;\n" +
        "  transform: translateY(-2px);\n" +
        "}\n" +
        "\n" +
        ".button-28:active {\n" +
        "  box-shadow: none;\n" +
        "  transform: translateY(0);\n" +
        "}\n",
    "32": ".button-32 {\n" +
        "  background-color: #fff000;\n" +
        "  border-radius: 12px;\n" +
        "  color: #000;\n" +
        "  cursor: pointer;\n" +
        "  font-weight: bold;\n" +
        "  padding: 10px 15px;\n" +
        "  text-align: center;\n" +
        "  transition: 200ms;\n" +
        "  width: 100%;\n" +
        "  box-sizing: border-box;\n" +
        "  border: 0;\n" +
        "  font-size: 16px;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "}\n" +
        "\n" +
        ".button-32:not(:disabled):hover,\n" +
        ".button-32:not(:disabled):focus {\n" +
        "  outline: 0;\n" +
        "  background: #f4e603;\n" +
        "  box-shadow: 0 0 0 2px rgba(0,0,0,.2), 0 3px 8px 0 rgba(0,0,0,.15);\n" +
        "}\n" +
        "\n" +
        ".button-32:disabled {\n" +
        "  filter: saturate(0.2) opacity(0.5);\n" +
        "  -webkit-filter: saturate(0.2) opacity(0.5);\n" +
        "  cursor: not-allowed;\n" +
        "}\n",
    "33": ".button-33 {\n" +
        "  background-color: #c2fbd7;\n" +
        "  border-radius: 100px;\n" +
        "  box-shadow: rgba(44, 187, 99, .2) 0 -25px 18px -14px inset,rgba(44, 187, 99, .15) 0 1px 2px,rgba(44, 187, 99, .15) 0 2px 4px,rgba(44, 187, 99, .15) 0 4px 8px,rgba(44, 187, 99, .15) 0 8px 16px,rgba(44, 187, 99, .15) 0 16px 32px;\n" +
        "  color: green;\n" +
        "  cursor: pointer;\n" +
        "  display: inline-block;\n" +
        "  padding: 7px 20px;\n" +
        "  text-align: center;\n" +
        "  text-decoration: none;\n" +
        "  transition: all 250ms;\n" +
        "  border: 0;\n" +
        "  font-size: 16px;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "}\n" +
        "\n" +
        ".button-33:hover {\n" +
        "  box-shadow: rgba(44,187,99,.35) 0 -25px 18px -14px inset,rgba(44,187,99,.25) 0 1px 2px,rgba(44,187,99,.25) 0 2px 4px,rgba(44,187,99,.25) 0 4px 8px,rgba(44,187,99,.25) 0 8px 16px,rgba(44,187,99,.25) 0 16px 32px;\n" +
        "  transform: scale(1.05) rotate(-1deg);\n" +
        "}\n",
    "35": ".button-35 {\n" +
        "  align-items: center;\n" +
        "  background-color: #fff;\n" +
        "  border-radius: 12px;\n" +
        "  box-shadow: transparent 0 0 0 3px,rgba(18, 18, 18, .1) 0 6px 20px;\n" +
        "  box-sizing: border-box;\n" +
        "  color: #121212;\n" +
        "  cursor: pointer;\n" +
        "  display: inline-flex;\n" +
        "  flex: 1 1 auto;\n" +
        "  font-size: 100%;\n" +
        "  font-weight: 700;\n" +
        "  justify-content: center;\n" +
        "  line-height: 1;\n" +
        "  margin: 0;\n" +
        "  outline: none;\n" +
        "  padding: 1rem 1.2rem;\n" +
        "  text-align: center;\n" +
        "  text-decoration: none;\n" +
        "  transition: box-shadow .2s,-webkit-box-shadow .2s;\n" +
        "  white-space: nowrap;\n" +
        "  border: 0;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "}\n" +
        "\n" +
        ".button-35:hover {\n" +
        "  box-shadow: #121212 0 0 0 3px, transparent 0 0 0 0;\n" +
        "}\n",
    "62": ".button-62 {\n" +
        "  background: linear-gradient(to bottom right, #EF4765, #FF9A5A);\n" +
        "  border: 0;\n" +
        "  border-radius: 12px;\n" +
        "  color: #FFFFFF;\n" +
        "  cursor: pointer;\n" +
        "  display: inline-block;\n" +
        "  font-size: 16px;\n" +
        "  font-weight: 500;\n" +
        "  line-height: 2.5;\n" +
        "  outline: transparent;\n" +
        "  padding: 0 1rem;\n" +
        "  text-align: center;\n" +
        "  text-decoration: none;\n" +
        "  transition: box-shadow .2s ease-in-out;\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "  white-space: nowrap;\n" +
        "}\n" +
        "\n" +
        ".button-62:not([disabled]):focus {\n" +
        "  box-shadow: 0 0 .25rem rgba(0, 0, 0, 0.5), -.125rem -.125rem 1rem rgba(239, 71, 101, 0.5), .125rem .125rem 1rem rgba(255, 154, 90, 0.5);\n" +
        "}\n" +
        "\n" +
        ".button-62:not([disabled]):hover {\n" +
        "  box-shadow: 0 0 .25rem rgba(0, 0, 0, 0.5), -.125rem -.125rem 1rem rgba(239, 71, 101, 0.5), .125rem .125rem 1rem rgba(255, 154, 90, 0.5);\n" +
        "}\n",
    "89": ".button-89 {\n" +
        "  --b: 3px;   /* border thickness */\n" +
        "  --s: .45em; /* size of the corner */\n" +
        "  --color: #373B44;\n" +
        "  \n" +
        "  padding: calc(.5em + var(--s)) calc(.9em + var(--s));\n" +
        "  color: var(--color);\n" +
        "  --_p: var(--s);\n" +
        "  background:\n" +
        "    conic-gradient(from 90deg at var(--b) var(--b),#0000 90deg,var(--color) 0)\n" +
        "    var(--_p) var(--_p)/calc(100% - var(--b) - 2*var(--_p)) calc(100% - var(--b) - 2*var(--_p));\n" +
        "  transition: .3s linear, color 0s, background-color 0s;\n" +
        "  outline: var(--b) solid #0000;\n" +
        "  outline-offset: .6em;\n" +
        "  font-size: 50%;\n" +
        "\n" +
        "  border: 0;\n" +
        "\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "}\n" +
        "\n" +
        ".button-89:hover,\n" +
        ".button-89:focus-visible{\n" +
        "  --_p: 0px;\n" +
        "  outline-color: var(--color);\n" +
        "  outline-offset: .05em;\n" +
        "}\n" +
        "\n" +
        ".button-89:active {\n" +
        "  background: var(--color);\n" +
        "  color: #fff;\n" +
        "}\n",
    "90": ".button-90 {\n" +
        "  color: #fff;\n" +
        "  padding: 15px 25px;\n" +
        "  border-radius: 100px;\n" +
        "  background-color: #4C43CD;\n" +
        "  background-image: radial-gradient(93% 87% at 87% 89%, rgba(0, 0, 0, 0.23) 0%, transparent 86.18%), radial-gradient(66% 87% at 26% 20%, rgba(255, 255, 255, 0.41) 0%, rgba(255, 255, 255, 0) 69.79%, rgba(255, 255, 255, 0) 100%);\n" +
        "  box-shadow: 2px 19px 31px rgba(0, 0, 0, 0.2);\n" +
        "  font-weight: bold;\n" +
        "  font-size: 16px;\n" +
        "\n" +
        "  border: 0;\n" +
        "\n" +
        "  user-select: none;\n" +
        "  -webkit-user-select: none;\n" +
        "  touch-action: manipulation;\n" +
        "\n" +
        "  cursor: pointer;\n" +
        "}\n",
};
module.exports = PageUtils;


/***/ }),
/* 22 */
/***/ ((module) => {


class Credential {
    constructor(id, pass) {
        this.id = id;
        this.pass = pass;
    }
    asRequest() {
        return { "id": this.id, "pass": this.pass };
    }
    asRequestMap() {
        const request = new Map();
        request.set("id", this.id);
        request.set("pass", this.pass);
        return request;
    }
}
module.exports = Credential;


/***/ }),
/* 23 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Credential_1 = __importDefault(__webpack_require__(22));
const PageUtils_1 = __importDefault(__webpack_require__(21));
class PageProcessorCredentialSupport {
    process(context) {
        const buttons = this.doLoadButtonStyles();
        if (buttons.length > 0) {
            for (const button of buttons) {
                PageUtils_1.default.loadButtonStyle(button);
            }
        }
        PageUtils_1.default.fixCurrentPageBrokenImages();
        PageUtils_1.default.removeUnusedHyperLinks();
        PageUtils_1.default.removeGoogleAnalyticsScript();
        const id = $("input:hidden[name='id']:last").val();
        const pass = $("input:hidden[name='pass']:last").val();
        if (id === undefined || pass === undefined) {
            return;
        }
        this.doProcess(new Credential_1.default(id.toString(), pass.toString()), context);
    }
    doLoadButtonStyles() {
        return [];
    }
}
module.exports = PageProcessorCredentialSupport;


/***/ }),
/* 24 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleBankPageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const CastleBankPageProcessor_1 = __importDefault(__webpack_require__(25));
const PageProcessorContext_1 = __importDefault(__webpack_require__(30));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class CastleBankPageInterceptor {
    constructor() {
        _CastleBankPageInterceptor_processor.set(this, new CastleBankPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "castle.cgi") {
            return pageText.includes("存入或取出请输入数额后按下确认键");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isPocketBankEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInCastle(castleName => {
            const context = new PageProcessorContext_1.default();
            context.set("castleName", castleName);
            __classPrivateFieldGet(this, _CastleBankPageInterceptor_processor, "f").process(context);
        })
            .fork();
    }
}
_CastleBankPageInterceptor_processor = new WeakMap();
module.exports = CastleBankPageInterceptor;


/***/ }),
/* 25 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleBankPageProcessor_instances, _CastleBankPageProcessor_createImmutablePage, _CastleBankPageProcessor_renderMutablePage, _CastleBankPageProcessor_refresh, _CastleBankPageProcessor_bindDepositAllButton, _CastleBankPageProcessor_bindDepositButton, _CastleBankPageProcessor_bindWithdrawButton, _CastleBankPageProcessor_bindTransferButton;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const CastleBank_1 = __importDefault(__webpack_require__(26));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class CastleBankPageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _CastleBankPageProcessor_instances.add(this);
    }
    doProcess(credential, context) {
        const page = CastleBank_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        const castleName = context.get("castleName");
        __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_createImmutablePage).call(this, credential, castleName);
        __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_renderMutablePage).call(this, credential, page);
    }
}
_CastleBankPageProcessor_instances = new WeakSet(), _CastleBankPageProcessor_createImmutablePage = function _CastleBankPageProcessor_createImmutablePage(credential, castleName) {
    $("form").remove();
    $("table:eq(1)")
        .attr("id", "t1")
        .find("td:first")
        .attr("id", "pageTitle")
        .removeAttr("bgcolor")
        .removeAttr("width")
        .removeAttr("height")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  城 堡 银 行 " + StringUtils_1.default.toTitleString(castleName) + " 支 行  ＞＞");
    $("#pageTitle")
        .parent()
        .attr("id", "tr0")
        .next()
        .attr("id", "tr1")
        .find("td:first")
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .next()
        .next()
        .next()
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .find("table:first")
        .find("tr:first")
        .next()
        .next()
        .find("td:last")
        .attr("id", "roleCash");
    $("#tr1")
        .next()
        .attr("id", "tr2")
        .find("td:first")
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .removeAttr("width")
        .removeAttr("bgcolor")
        .css("width", "100%")
        .css("background-color", "black")
        .css("color", "wheat")
        .next()
        .attr("id", "messageBoardManager");
    let html = "";
    html += "<tr id='tr3' style='display:none'>";
    html += "<td id='hiddenFormContainer'></td>";
    html += "</tr>";
    html += "<tr id='tr4'>";
    html += "<td style='background-color:#F8F0E0;text-align:center;width:100%'>";
    html += "<input type='button' id='refreshButton' value='刷新" + castleName + "银行'>";
    html += "<input type='button' id='returnButton' value='离开" + castleName + "银行'>";
    html += "</td>";
    html += "</tr>";
    $("#tr2").after($(html));
    $("#hiddenFormContainer").html(PageUtils_1.default.generateReturnCastleForm(credential));
    html = "";
    html += "<p id='p1'>";
    html += "<input type='button' id='depositAllButton' value='全部存入' class='dynamicButton'>";
    html += "</p>";
    html += "<p id='p2'>";
    html += "<input type='text' id='depositAmount' value='' size='3' style='text-align:right'>0000 Gold&nbsp;&nbsp;&nbsp;";
    html += "<input type='button' id='depositButton' value='金存入' class='dynamicButton'>";
    html += "</p>";
    html += "<p id='p3'>";
    html += "<input type='text' id='withdrawAmount' value='' size='3' style='text-align:right'>0000 Gold&nbsp;&nbsp;&nbsp;";
    html += "<input type='button' id='withdrawButton' value='金取出' class='dynamicButton'>";
    html += "</p>";
    html += "<p id='p4'>";
    html += "&nbsp;&nbsp;&nbsp;";
    html += "</p>";
    $("#tr4")
        .next()
        .attr("id", "tr5")
        .find("td:first")
        .find("p:first")
        .attr("id", "p0")
        .after($(html));
    $("#p0")
        .prev()
        .find("font:first")
        .attr("id", "accountCash")
        .next()
        .attr("id", "accountSaving");
    html = "";
    html += "<tr id='tr6'>";
    html += "<td style='background-color:darkred;width:100%;text-align:center;font-weight:bold;color:aliceblue'>";
    html += "＜ 转 账 通 道 ＞";
    html += "</td>";
    html += "</tr>";
    html += "<tr id='tr7'>";
    html += "<td style='background-color:#F8F0E0;width:100%;text-align:center'>";
    html += "<input type='text' id='searchName' size='15' maxlength='20'>";
    html += "<input type='button' id='searchButton' value='找人'>";
    html += "<select id='peopleSelect'><option value=''>选择发送对象</select>";
    html += "<input type='text' id='transferAmount' value='' size='3' style='text-align:right'>0000 Gold&nbsp;&nbsp;&nbsp;";
    html += "<input type='button' id='transferButton' value='转账' class='dynamicButton'>";
    html += "</td>";
    html += "</tr>";
    $("#tr5").after($(html));
    // Bind immutable buttons
    $("#refreshButton").on("click", () => {
        MessageBoard_1.default.resetMessageBoard("请管理您的账户吧！");
        $("#messageBoardManager").html(NpcLoader_1.default.randomNpcImageHtml);
        __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_refresh).call(this, credential);
    });
    $("#returnButton").on("click", () => {
        $("#returnCastle").trigger("click");
    });
    $("#searchButton").on("click", () => {
        const s = $("#searchName").val();
        if (s === undefined || s.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("请正确输入人名！");
            return;
        }
        const searchName = s.trim();
        const request = credential.asRequestMap();
        request.set("mode", "CASTLE_SENDMONEY");
        // noinspection JSDeprecatedSymbols
        request.set("serch", escape(searchName));
        NetworkUtils_1.default.post("castle.cgi", request).then(html => {
            const options = $(html).find("select[name='eid']").html();
            $("#peopleSelect").html(options);
        });
    });
}, _CastleBankPageProcessor_renderMutablePage = function _CastleBankPageProcessor_renderMutablePage(credential, page) {
    __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_bindDepositAllButton).call(this, credential, page.account);
    __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_bindDepositButton).call(this, credential, page.account);
    __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_bindWithdrawButton).call(this, credential, page.account);
    __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_bindTransferButton).call(this, credential, page.account);
}, _CastleBankPageProcessor_refresh = function _CastleBankPageProcessor_refresh(credential) {
    PageUtils_1.default.scrollIntoView("pageTitle");
    new CastleBank_1.default(credential).open().then(page => {
        $("#roleCash").text(page.role.cash + " GOLD");
        $("#accountCash").text(page.account.cash.toString());
        $("#accountSaving").text(page.account.saving.toString());
        $("#depositAmount").val("");
        $("#withdrawAmount").val("");
        $("#transferAmount").val("");
        $(".dynamicButton").off("click");
        __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_renderMutablePage).call(this, credential, page);
    });
}, _CastleBankPageProcessor_bindDepositAllButton = function _CastleBankPageProcessor_bindDepositAllButton(credential, account) {
    $("#depositAllButton").on("click", () => {
        if (account.cash < 10000) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没觉得你身上有啥值得存入的现金！");
            return;
        }
        new CastleBank_1.default(credential).deposit().then(() => {
            __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_refresh).call(this, credential);
        });
    });
}, _CastleBankPageProcessor_bindDepositButton = function _CastleBankPageProcessor_bindDepositButton(credential, account) {
    $("#depositButton").on("click", () => {
        const text = $("#depositAmount").val();
        if (text === undefined || text.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有输入存入的金额！");
            return;
        }
        const amount = parseInt(text.trim());
        if (isNaN(amount) || !Number.isInteger(amount) || amount <= 0) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("非法输入金额！");
            return;
        }
        if (amount * 10000 > account.cash) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning(amount + "万！真逗，搞得你好像有这么多现金似得！");
            return;
        }
        new CastleBank_1.default(credential).deposit(amount).then(() => {
            __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_refresh).call(this, credential);
        });
    });
}, _CastleBankPageProcessor_bindWithdrawButton = function _CastleBankPageProcessor_bindWithdrawButton(credential, account) {
    $("#withdrawButton").on("click", () => {
        const text = $("#withdrawAmount").val();
        if (text === undefined || text.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有输入取出的金额！");
            return;
        }
        const amount = parseInt(text.trim());
        if (isNaN(amount) || !Number.isInteger(amount) || amount <= 0) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("非法输入金额！");
            return;
        }
        if (amount * 10000 > account.saving) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning(amount + "万！真逗，搞得你好像有这么多存款似得！");
            return;
        }
        new CastleBank_1.default(credential).withdraw(amount).then(() => {
            __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_refresh).call(this, credential);
        });
    });
}, _CastleBankPageProcessor_bindTransferButton = function _CastleBankPageProcessor_bindTransferButton(credential, account) {
    $("#transferButton").on("click", () => {
        const s = $("#peopleSelect").val();
        if (s === undefined || s.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有选择转账对象！");
            return;
        }
        const text = $("#transferAmount").val();
        if (text === undefined || text.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有输入取出的金额！");
            return;
        }
        const amount = parseInt(text.trim());
        if (isNaN(amount) || !Number.isInteger(amount) || amount <= 0) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("非法输入金额！");
            return;
        }
        if ((amount + 10) * 10000 > account.total) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("很遗憾，你压根就没有这么多钱！");
            return;
        }
        const target = $("#peopleSelect").find("option:selected").text();
        if (!confirm("请您确认向" + target + "转账" + amount + "万GOLD？")) {
            return;
        }
        const delta = BankUtils_1.default.calculateCashDifferenceAmount(account.cash, (amount + 10) * 10000);
        const bank = new CastleBank_1.default(credential);
        bank.withdraw(delta).then(() => {
            const request = credential.asRequestMap();
            request.set("gold", (amount * 10).toString()); // 送钱的接口单位是K
            request.set("eid", s.trim());
            request.set("mode", "CASTLE_SENDMONEY2");
            NetworkUtils_1.default.post("castle.cgi", request).then(html => {
                MessageBoard_1.default.processResponseMessage(html);
                bank.deposit().then(() => {
                    __classPrivateFieldGet(this, _CastleBankPageProcessor_instances, "m", _CastleBankPageProcessor_refresh).call(this, credential);
                });
            });
        });
    });
};
module.exports = CastleBankPageProcessor;


/***/ }),
/* 26 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleBank_credential;
const BankAccount_1 = __importDefault(__webpack_require__(27));
const Role_1 = __importDefault(__webpack_require__(14));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const CastleBankPage_1 = __importDefault(__webpack_require__(29));
class CastleBank {
    constructor(credential) {
        _CastleBank_credential.set(this, void 0);
        __classPrivateFieldSet(this, _CastleBank_credential, credential, "f");
    }
    static parsePage(html) {
        return doParsePage(html);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _CastleBank_credential, "f").asRequestMap();
                    request.set("mode", "CASTLE_BANK");
                    NetworkUtils_1.default.post("castle.cgi", request)
                        .then(html => {
                        const page = CastleBank.parsePage(html);
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    load() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    this.open().then(page => {
                        resolve(page.account);
                    });
                });
            };
            return yield action();
        });
    }
    deposit(amount) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    const request = __classPrivateFieldGet(this, _CastleBank_credential, "f").asRequestMap();
                    if (amount === undefined) {
                        // deposit all
                        request.set("azukeru", "all");
                        request.set("mode", "CASTLEBANK_SELL");
                        NetworkUtils_1.default.post("castle.cgi", request)
                            .then(() => {
                            MessageBoard_1.default.publishMessage("在城堡支行存入全部现金。");
                            resolve();
                        });
                    }
                    else {
                        // deposit specified amount
                        if (!BankUtils_1.default.checkAmountAvailability(amount)) {
                            MessageBoard_1.default.publishWarning("非法的金额" + amount + "！");
                            reject();
                        }
                        else if (amount === 0) {
                            // 真逗，没钱凑什么热闹。
                            resolve();
                        }
                        else {
                            request.set("azukeru", amount.toString());
                            request.set("mode", "CASTLEBANK_SELL");
                            NetworkUtils_1.default.post("castle.cgi", request)
                                .then(() => {
                                MessageBoard_1.default.publishMessage("在城堡支行存入了" + amount + "万现金。");
                                resolve();
                            });
                        }
                    }
                });
            })();
        });
    }
    withdraw(amount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    if (isNaN(amount) || !Number.isInteger(amount) || amount < 0) {
                        reject();
                        return;
                    }
                    if (amount === 0) {
                        resolve();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _CastleBank_credential, "f").asRequestMap();
                    request.set("dasu", amount.toString());
                    request.set("mode", "CASTLEBANK_BUY");
                    NetworkUtils_1.default.post("castle.cgi", request)
                        .then(html => {
                        if ($(html).text().includes("您在钱庄里没那么多存款")) {
                            MessageBoard_1.default.publishWarning("真可怜，银行里面连" + amount + "万存款都没有！");
                            reject();
                        }
                        else {
                            MessageBoard_1.default.publishMessage("从城堡支行里提取了" + amount + "万现金。");
                            resolve();
                        }
                    });
                });
            };
            return yield action();
        });
    }
}
_CastleBank_credential = new WeakMap();
function doParsePage(html) {
    const table = $(html).find("td:contains('姓名')")
        .filter((_idx, td) => {
        return $(td).text() === "姓名";
    })
        .closest("table");
    const role = new Role_1.default();
    table.find("tr:first")
        .next()
        .find("td:first")
        .filter((_idx, td) => {
        role.name = $(td).text();
        return true;
    })
        .next()
        .filter((_idx, td) => {
        role.level = parseInt($(td).text());
        return true;
    })
        .next()
        .filter((_idx, td) => {
        role.attribute = StringUtils_1.default.substringBefore($(td).text(), "属");
        return true;
    })
        .next()
        .filter((_idx, td) => {
        role.career = $(td).text();
        return true;
    })
        .parent()
        .next()
        .find("td:first")
        .next()
        .filter((_idx, td) => {
        role.cash = parseInt(StringUtils_1.default.substringBefore($(td).text(), " GOLD"));
        return true;
    });
    const font = $(html).find("font:contains('现在的所持金')")
        .filter((_idx, font) => {
        const s = $(font).text();
        return s.startsWith(" ") && s.includes("现在的所持金");
    });
    let s = font.text();
    s = StringUtils_1.default.substringBefore(s, "现在的所持金");
    const account = new BankAccount_1.default();
    account.name = s.substring(1);
    account.cash = parseInt($(font).find("font:first").text());
    account.saving = parseInt($(font).find("font:last").text());
    const page = new CastleBankPage_1.default();
    page.role = role;
    page.account = account;
    return page;
}
module.exports = CastleBank;


/***/ }),
/* 27 */
/***/ ((module) => {


class BankAccount {
    get total() {
        return this.cash + this.saving;
    }
}
module.exports = BankAccount;


/***/ }),
/* 28 */
/***/ ((module) => {


class BankUtils {
    static checkAmountAvailability(amount) {
        if (isNaN(amount)) {
            return false;
        }
        if (!Number.isInteger(amount)) {
            return false;
        }
        return amount >= 0;
    }
    static calculateCashDifferenceAmount(cash, expect) {
        if (cash >= expect) {
            return 0;
        }
        return Math.ceil((expect - cash) / 10000);
    }
}
module.exports = BankUtils;


/***/ }),
/* 29 */
/***/ ((module) => {


class CastleBankPage {
}
module.exports = CastleBankPage;


/***/ }),
/* 30 */
/***/ (function(module) {


var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var _PageProcessorContext_context;
class PageProcessorContext {
    constructor() {
        _PageProcessorContext_context.set(this, void 0);
        __classPrivateFieldSet(this, _PageProcessorContext_context, new Map(), "f");
    }
    set(key, value) {
        __classPrivateFieldGet(this, _PageProcessorContext_context, "f").set(key, value);
        return this;
    }
    get(key) {
        return __classPrivateFieldGet(this, _PageProcessorContext_context, "f").get(key);
    }
}
_PageProcessorContext_context = new WeakMap();
module.exports = PageProcessorContext;


/***/ }),
/* 31 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleDashboardPageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const CastleDashboardPageProcessor_1 = __importDefault(__webpack_require__(32));
class CastleDashboardPageInterceptor {
    constructor() {
        _CastleDashboardPageInterceptor_processor.set(this, new CastleDashboardPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "castle.cgi" || cgi === "castlestatus.cgi") {
            return pageText.includes("城堡的情報");
        }
        return false;
    }
    intercept() {
        // Set current location state to CASTLE.
        LocationStateMachine_1.default.create().inCastle();
        __classPrivateFieldGet(this, _CastleDashboardPageInterceptor_processor, "f").process();
    }
}
_CastleDashboardPageInterceptor_processor = new WeakMap();
module.exports = CastleDashboardPageInterceptor;


/***/ }),
/* 32 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleDashboardPageProcessor_instances, _CastleDashboardPageProcessor_renderMenu, _CastleDashboardPageProcessor_renderExperience, _CastleDashboardPageProcessor_renderEventBoard;
const EventHandler_1 = __importDefault(__webpack_require__(33));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class CastleDashboardPageProcessor {
    constructor() {
        _CastleDashboardPageProcessor_instances.add(this);
    }
    process() {
        PageUtils_1.default.fixCurrentPageBrokenImages();
        PageUtils_1.default.removeUnusedHyperLinks();
        PageUtils_1.default.removeGoogleAnalyticsScript();
        __classPrivateFieldGet(this, _CastleDashboardPageProcessor_instances, "m", _CastleDashboardPageProcessor_renderMenu).call(this);
        __classPrivateFieldGet(this, _CastleDashboardPageProcessor_instances, "m", _CastleDashboardPageProcessor_renderExperience).call(this);
        __classPrivateFieldGet(this, _CastleDashboardPageProcessor_instances, "m", _CastleDashboardPageProcessor_renderEventBoard).call(this);
    }
}
_CastleDashboardPageProcessor_instances = new WeakSet(), _CastleDashboardPageProcessor_renderMenu = function _CastleDashboardPageProcessor_renderMenu() {
    if (SetupLoader_1.default.isPocketBankEnabled()) {
        $("option[value='CASTLE_BANK']")
            .css("background-color", "yellow")
            .text("口袋银行城堡支行");
        $("option[value='CASTLE_SENDMONEY']").remove();
    }
    $("option[value='CASTLE_BUILDMACHINE']")
        .css("background-color", "yellow")
        .text("城堡驿站");
    $("option[value='LETTER']")
        .css("background-color", "yellow")
        .text("口袋助手设置");
    if (SetupLoader_1.default.isEquipmentManagementUIEnabled()) {
        $("option[value='USE_ITEM']")
            .css("background-color", "yellow")
            .text("装备管理");
        $("option[value='CASTLE_ITEM']").remove();
        $("option[value='CASTLE_SENDITEM']").remove();
    }
    if (SetupLoader_1.default.isPetManagementUIEnabled()) {
        $("option[value='PETSTATUS']")
            .css("background-color", "yellow")
            .text("宠物管理");
        $("option[value='CASTLE_PET']").remove();
        $("option[value='CASTLE_SENDPET']").remove();
    }
    if (SetupLoader_1.default.isCareerManagementUIEnabled()) {
        $("option[value='CHANGE_OCCUPATION']")
            .css("background-color", "yellow")
            .text("职业管理");
        $("option[value='MAGIC']").remove();
    }
}, _CastleDashboardPageProcessor_renderExperience = function _CastleDashboardPageProcessor_renderExperience() {
    if (SetupLoader_1.default.isExperienceProgressBarEnabled()) {
        $("td:contains('经验值')")
            .filter(function () {
            return $(this).text() === "经验值";
        })
            .next()
            .each(function (_idx, th) {
            const expText = $(th).text();
            const experience = parseInt(StringUtils_1.default.substringBefore(expText, " EX"));
            if (experience >= 14900) {
                $(th).css("color", "blue").text("MAX");
            }
            else {
                const level = Math.ceil(experience / 100) + 1;
                const ratio = level / 150;
                const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
                $(th).html("<span title='" + expText + "'>" + progressBar + "</span>");
            }
        });
    }
}, _CastleDashboardPageProcessor_renderEventBoard = function _CastleDashboardPageProcessor_renderEventBoard() {
    $("td:contains('最近发生的事件')")
        .filter(function () {
        return $(this).text() === "最近发生的事件";
    })
        .parent()
        .next()
        .find("td:first")
        .attr("id", "eventBoard");
    const eventHtmlList = [];
    $("#eventBoard").html()
        .split("<br>")
        .filter(it => it.endsWith(")"))
        .map(function (it) {
        // noinspection HtmlDeprecatedTag,XmlDeprecatedElement,HtmlDeprecatedAttribute
        const header = "<font color=\"navy\">●</font>";
        return StringUtils_1.default.substringAfter(it, header);
    })
        .map(function (it) {
        return EventHandler_1.default.handleWithEventHtml(it);
    })
        .forEach(it => eventHtmlList.push(it));
    let html = "";
    html += "<table style='border-width:0;width:100%;height:100%;margin:auto'>";
    html += "<tbody>";
    eventHtmlList.forEach(it => {
        html += "<tr>";
        html += "<th style='color:navy;vertical-align:top'>●</th>";
        html += "<td style='width:100%'>";
        html += it;
        html += "</td>";
        html += "</tr>";
    });
    html += "</tbody>";
    html += "</table>";
    $("#eventBoard").html(html);
};
module.exports = CastleDashboardPageProcessor;


/***/ }),
/* 33 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class EventHandler {
    static handleWithEventHtml(eventHtml) {
        if (eventHtml.includes("[萝莉失踪]")) {
            const eventText = PageUtils_1.default.convertHtmlToText(eventHtml);
            const secret = StringUtils_1.default.substringBetween(eventText, "[萝莉失踪]据说在印有", "描述的城市附近有萝莉失踪！");
            return doProcessRescueHostage(eventHtml, eventText, secret);
        }
        if (eventHtml.includes("[正太失踪]")) {
            const eventText = PageUtils_1.default.convertHtmlToText(eventHtml);
            const secret = StringUtils_1.default.substringBetween(eventText, "[正太失踪]据说在印有", "描述的城市附近有正太失踪！");
            return doProcessRescueHostage(eventHtml, eventText, secret);
        }
        return eventHtml;
    }
}
function doProcessRescueHostage(eventHtml, eventText, secret) {
    const candidates = doFindTownBySecret(secret);
    let recommendation = "";
    if (candidates.length === 0) {
        recommendation = "没有发现推荐的城市？检查一下城市字典吧，密字[" + secret + "]。";
    }
    else {
        recommendation = "可能失踪的城市是：";
        for (let i = 0; i < candidates.length; i++) {
            const town = candidates[i];
            recommendation += "<b style='color:red'>" + town.name + "</b>";
            recommendation += doGenerateSuspectCoordinate(town);
            if (i !== candidates.length - 1) {
                recommendation += "，";
            }
            else {
                recommendation += "。";
            }
        }
    }
    let p1 = StringUtils_1.default.substringBefore(eventHtml, "失踪！");
    let p2 = "失踪！";
    let p3 = StringUtils_1.default.substringAfter(eventHtml, "失踪！");
    return p1 + p2 + recommendation + p3;
}
function doFindTownBySecret(secret) {
    const candidates = [];
    for (const town of TownLoader_1.default.getTownList()) {
        if (town.description.includes(secret)) {
            candidates.push(town);
        }
    }
    return candidates;
}
function doGenerateSuspectCoordinate(town) {
    const locations = [];
    locations.push(new Coordinate_1.default(town.coordinate.x, town.coordinate.y + 1));
    locations.push(new Coordinate_1.default(town.coordinate.x, town.coordinate.y - 1));
    locations.push(new Coordinate_1.default(town.coordinate.x - 1, town.coordinate.y));
    locations.push(new Coordinate_1.default(town.coordinate.x + 1, town.coordinate.y));
    let s = "";
    for (const location of locations) {
        if (location.isAvailable) {
            s += location.asText();
        }
    }
    return "<span style='color:blue'>" + s + "</span>";
}
module.exports = EventHandler;


/***/ }),
/* 34 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Coordinate_1 = __importDefault(__webpack_require__(7));
const Town_1 = __importDefault(__webpack_require__(35));
class TownLoader {
    static getTownById(id) {
        // @ts-ignore
        const town = TOWN_DEFINITION[id];
        if (town === undefined) {
            return null;
        }
        return town;
    }
    static getTownByName(name) {
        for (const town of TownLoader.getTownList()) {
            if (name.startsWith(town.name)) {
                return town;
            }
        }
        return null;
    }
    static getTownByCoordinate(coordinate) {
        for (const town of TownLoader.getTownList()) {
            if (town.coordinate.equals(coordinate)) {
                return town;
            }
        }
        return null;
    }
    static getTownList() {
        return Object.values(TOWN_DEFINITION);
    }
}
const TOWN_DEFINITION = {
    "1": new Town_1.default("1", "贤者之城", "精灵族的王都，在精灵语中意为山谷中的隐居之城，因数位异族出身的贤者都选择在此谢世而得名。种植着珍贵草药的山谷另一端有巨大的水坝，传说曾三次以毁灭性方式成功驱赶妄图入侵的军队。", new Coordinate_1.default(14, 0)),
    "2": new Town_1.default("2", "翡冷翠", "大陆西海岸城市，著名的纺织业都市，也有可耕作的土地以及贸易的港口，农业和商业都比较发达，故而坎德人的事业长存。", new Coordinate_1.default(1, 11)),
    "3": new Town_1.default("3", "诺曼", "滨海城市，曾是大陆最大的造船业基地，后因战火而数度覆没，现在虽然仍建造船只，但规模远逊昔日。", new Coordinate_1.default(2, 12)),
    "4": new Town_1.default("4", "潘帕斯", "肥沃的土地，丰富的水源，传统型农业都市也一直是粮棉产地和经济发达地区。素有“大陆粮仓”及“天府之国”之称。自古有在二月举行祭拜农神五旬节庆典。而九月举行的大型农牧业交易会也是整个大陆最繁盛的聚会之一。", new Coordinate_1.default(3, 8)),
    "5": new Town_1.default("5", "卡鲁", "山顶矮人的重要居城要塞，依山而筑坚固无比，在这里曾掀起过高山矮人和丘陵矮人手足阋墙的矮人门战役。", new Coordinate_1.default(1, 6)),
    "6": new Town_1.default("6", "格林尼治", "自称是人类最古老的村落，因临近矮人王国而时常成为斗争的前源，传统上从事护送商队穿越沙漠的工作，但信誉始终是最大问题。", new Coordinate_1.default(1, 3)),
    "7": new Town_1.default("7", "萨拉镇", "多种族混居的城市，各种珍稀物品的输入输出地，唯一即使在战争中也会全年都对其他种族开放的城市，尽管如此，仍然能感到某种难以言明的不调合感。", new Coordinate_1.default(3, 5)),
    "8": new Town_1.default("8", "海文", "矮人族连接山区和草原的重要中转站，春季会在附近原野举行大型交易会，是无论什么种族也会受到平等接待的地方。", new Coordinate_1.default(4, 11)),
    "9": new Town_1.default("9", "黄昏之都", "精灵们称呼此地为“艾本德”精灵语意为“神圣的黄昏”。据说环绕城市的一草一木都是古代精灵的化身，在此地时常可见到上年纪的精灵，足以证明精灵并非不老不死，在精灵族的传说中，此地将是本族最终安睡之地。", new Coordinate_1.default(5, 14)),
    "10": new Town_1.default("10", "圣克鲁斯堡", "旧神殿所在之地，新旧城都充满魅力，既是著名观光都市，也是重要的宗教圣地，这里有着全大陆信仰的中心“光之神殿”。", new Coordinate_1.default(5, 6)),
    "11": new Town_1.default("11", "泰法城", "精灵所修建的完整灌溉系统的农业城市，重要的粮食蔬果生产地，此地出产的各种水果酒都享有盛名，每年夏末举行的祭典会有限制的邀请其他种族成员参加，这对向来以自傲排他的精灵传统而言已经是相当开放的行为了。", new Coordinate_1.default(5, 8)),
    "12": new Town_1.default("12", "枫丹", "原帝国冬都，又名白露城，号称四百年无战之都。大陆联合商会所在地，无数传说的源头，号称大冒险大恋爱的起点。", new Coordinate_1.default(6, 10)),
    "13": new Town_1.default("13", "自由港_赞特", "大陆南岸著名的自由城市，也是全大陆最大的贸易港。不属于大陆任何势力，由当地人组成的三级议会管理着城市，拥有绝对的自治。自古就流传着在此能通过各种渠道买到各种你所能想象以及想象不到的东西。", new Coordinate_1.default(5, 0)),
    "14": new Town_1.default("14", "火之都", "军事化气氛浓厚的矮人都市，热火朝天的锻造之城，因为临近火山口，故得此名，囤积的兵器充斥山腹改造的仓库。", new Coordinate_1.default(5, 2)),
    "15": new Town_1.default("15", "土之域", "山中小都市,露出地面的矮人都市，传说为人类遗留，但地点却远离人类文明影响的范围，接近地精族，故而专攻兵器装饰用宝石的研磨。", new Coordinate_1.default(10, 2)),
    "16": new Town_1.default("16", "瓦伦要塞", "边境要塞, 因邻接半兽人土地，军事化气氛浓厚，几乎是全男子编制的要塞都市，但重要的食粮输入也是通 过此地进行，所以时常充满着怪异的紧张气氛。", new Coordinate_1.default(11, 11)),
    "17": new Town_1.default("17", "梵", "居住着人马族重要长老的小城，洋溢着仿佛时光停滞般悠闲气氛的山中秘境，人马族的贤者之塔也建造在此，因为其中藏着重要的预言书，故而对其他种族严格戒备。", new Coordinate_1.default(7, 3)),
    "18": new Town_1.default("18", "日尔曼尼亚", "野蛮人重要的据点，虽然生活着半数以上的平民，同时也是半军事化的壁垒，秋季有长达半个月的狩猎大会。", new Coordinate_1.default(7, 8)),
    "19": new Town_1.default("19", "水之城", "又称“废弃的水之城壁”，在与大湖连接的村子里，有着明显是人类遗迹的建筑，被当作是便利的集会场所使用着，传说这里有半兽人唯一的藏书室。", new Coordinate_1.default(9, 5)),
    "20": new Town_1.default("20", "埃达", "防备着矮人城市圈的小型要塞，地震曾多次摧毁整个城市，目前的城市建造在矮人族废弃的矿洞之中，大概会因为维持费过高被放弃吧。", new Coordinate_1.default(11, 5)),
    "21": new Town_1.default("21", "柯利亚", "和矮人都市圈连接的小城市，农耕传统悠久，盛产香菜之类的烹饪用料，饮食业发达，目前正致力推广清淡素食。", new Coordinate_1.default(12, 4)),
    "22": new Town_1.default("22", "格兰特", "人马族密语中伟大的意思，是极为独特的人马族栖息之地，宁静的学问之都，有整个大陆最大的图书馆和第 一代大魔法师爱德华的陵墓，发现温泉后，也逐渐发展起疗养旅游业。", new Coordinate_1.default(11, 7)),
    "23": new Town_1.default("23", "斯坎", "最靠近食人魔所在的城市，由纯法师血统者构成的研究者群体建造，为的是就近监视、研究最古老的食人魔 种族，又称\"性格扭曲者之城\"。", new Coordinate_1.default(10, 8)),
    "24": new Town_1.default("24", "龙牙堡", "又名龙之牙，野蛮人，人类和其他种族战争中建立的要塞，城市盘踞建造在山岩上，因地势险要，历来在此发生的战斗不计其数。死伤者鲜血早已渗透了要塞附近的土壤，远远望去，裸露的岩石形貌狰狞，周围隐透血色，宛如泣血龙牙。", new Coordinate_1.default(8, 9)),
    "25": new Town_1.default("25", "海布里", "半兽人 贝里萨利乌斯族生活的集落，是半兽人中最为勇猛、尚武的一支，如今正遭遇百年不遇的人口锐减，百年前曾和人类共同作战，据信村中仍有混血的后代，出产美酒，被誉为大陆第一的珍酿。", new Coordinate_1.default(7, 11)),
    "26": new Town_1.default("26", "风之谷", "又一邻接人马族据点的村落，非常偏僻隐蔽，传说中三族勇者用来存放光明神器的地点，唯有神器仍在，才能镇丄压黑暗势力卷土重来，奇妙的是矮人族却将此地视为不祥之地。", new Coordinate_1.default(8, 12)),
    "27": new Town_1.default("27", "不归森林", "传说最初是吞噬无数人性命的黑色森林，又传是埋葬着化身为魔的战败神的坟墓，但是真相已经湮没在历史和频繁发生的地震中，因为设有保护性禁制结界，所以体力系和黑暗系在此地进行战斗会很吃亏。", new Coordinate_1.default(9, 13)),
    "28": new Town_1.default("28", "特罗尔", "以神话中的食人巨妖命名的城市，地处沙漠区内最外侧绿州边缘，是唯一非人类占多数的人类都市，又称暗 之都，在食人魔的势力圈里奇妙地存在着，流行着既非人类又非食人魔共存不可思议的生活方式。", new Coordinate_1.default(13, 14))
};
module.exports = TownLoader;


/***/ }),
/* 35 */
/***/ ((module) => {


class Town {
    constructor(id, name, description, coordinate) {
        this.id = id;
        this.name = name;
        this.description = description;
        this.coordinate = coordinate;
    }
    asText() {
        return "(" + this.id + ") " + this.name + " " + this.coordinate.asText();
    }
    get nameTitle() {
        let title = "";
        for (let i = 0; i < this.name.length; i++) {
            title += this.name.charAt(i);
            if (i !== this.name.length - 1) {
                title += " ";
            }
        }
        return title;
    }
}
module.exports = Town;


/***/ }),
/* 36 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastlePostHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const CastlePostHousePageProcessor_1 = __importDefault(__webpack_require__(37));
class CastlePostHousePageInterceptor {
    constructor() {
        _CastlePostHousePageInterceptor_processor.set(this, new CastlePostHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "castle.cgi") {
            return pageText.includes("＜＜ * 机车建造厂 *＞＞");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInCastle(() => {
            __classPrivateFieldGet(this, _CastlePostHousePageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_CastlePostHousePageInterceptor_processor = new WeakMap();
module.exports = CastlePostHousePageInterceptor;


/***/ }),
/* 37 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
const CastleEntrance_1 = __importDefault(__webpack_require__(38));
const MapBuilder_1 = __importDefault(__webpack_require__(41));
const TownEntrance_1 = __importDefault(__webpack_require__(45));
const TravelPlanExecutor_1 = __importDefault(__webpack_require__(47));
const CastleBank_1 = __importDefault(__webpack_require__(26));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const TownBank_1 = __importDefault(__webpack_require__(51));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class CastlePostHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super();
    }
    doProcess(credential, context) {
        doProcess(credential);
    }
}
function doProcess(credential) {
    const t0 = $("table:first");
    const t2 = $("table:eq(2)");
    const t3 = $("table:eq(3)");
    $(t0).removeAttr("height");
    // 修改标题
    let td = $(t0).find("tr:first td:first");
    $(td).removeAttr("bgcolor");
    $(td).removeAttr("width");
    $(td).removeAttr("height");
    $(td).css("text-align", "center");
    $(td).css("font-size", "150%");
    $(td).css("font-weight", "bold");
    $(td).css("background-color", "navy");
    $(td).css("color", "yellowgreen");
    $(td).attr("id", "title");
    $(td).text("＜＜  城 堡 驿 站  ＞＞");
    // 现金栏、坐标点、计时器
    td = $(t2).find("tr:eq(2) td:last");
    $(td).attr("id", "roleCash");
    let tr = $(t2).find("tr:eq(3)");
    td = $(tr).find("td:first");
    $(td).text("坐标点");
    td = $(tr).find("td:last");
    $(td).attr("id", "roleLocation");
    $(td).text("-");
    $(tr).after($("<tr>" +
        "<td style='background-color:#E0D0B0'>计时器</td>" +
        "<td style='background-color:#E8E8D0;color:red;font-weight:bold;text-align:right' id='countDownTimer' colspan='2'>-</td>" +
        "</tr>"));
    // 消息面板
    td = $(t3).find("td:first");
    $(td).attr("id", "messageBoard");
    $(td).css("color", "white");
    MessageBoard_1.default.resetMessageBoard("如您所愿，我们已经降废弃的机车建造厂改造成了城堡驿站。");
    // 删除不需要的页面内容
    tr = $(t3).parent().parent();
    $(tr).next().remove();
    // 绘制驿站的新页面
    $(tr).after($("" +
        "<tr style='display:none'>" +
        "<td id='eden'></td>" +
        "</tr>" +
        "<tr>" +
        "<td id='menu' style='background-color:#F8F0E0;text-align:center'></td>" +
        "</tr>" +
        "<tr style='display:none'>" +
        "<td id='map' style='background-color:#F8F0E0;text-align:center'></td>" +
        "</tr>" +
        ""));
    doRenderEden(credential);
    doRenderMenu();
    doRenderMap(credential);
}
function doRenderEden(credential) {
    let html = "";
    // noinspection HtmlUnknownTarget
    html += "<form action='castlestatus.cgi' method='post' id='returnForm'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='mode' value='CASTLESTATUS'>";
    html += "<input type='submit' id='returnSubmit'>";
    $("#eden").html(html);
}
function doRenderMenu() {
    $("#menu").html("" +
        "<input type='button' id='returnButton' value='返回城堡'>");
    $("#returnButton").on("click", function () {
        $("#returnSubmit").trigger("click");
    });
}
function doRenderMap(credential) {
    const html = MapBuilder_1.default.buildMapTable();
    $("#map").html(html);
    MapBuilder_1.default.updateTownBackgroundColor();
    new PersonalStatus_1.default(credential).load()
        .then(role => {
        const castle = role.castle;
        const buttonId = "location_" + castle.coordinate.x + "_" + castle.coordinate.y;
        $("#" + buttonId)
            .closest("td")
            .css("background-color", "black")
            .css("color", "yellow")
            .css("text-align", "center")
            .html("堡");
        $(".location_button_class")
            .on("mouseenter", function () {
            $(this).css("background-color", "red");
        })
            .on("mouseleave", function () {
            const s = $(this).parent().attr("class");
            const c = StringUtils_1.default.substringAfter(s, "_");
            if (c !== "none") {
                $(this).css("background-color", c);
            }
            else {
                $(this).removeAttr("style");
            }
        });
        $("#map").parent().show();
        doBindMapButton(credential);
    });
}
function doBindMapButton(credential) {
    $(".location_button_class").on("click", function () {
        var _a;
        const title = $(this).parent().attr("title");
        const ss = $(this).attr("id").split("_");
        const x = parseInt(ss[1]);
        const y = parseInt(ss[2]);
        const coordinate = new Coordinate_1.default(x, y);
        let townName = "";
        let confirmation = false;
        if (title.startsWith("城市")) {
            townName = StringUtils_1.default.substringAfterLast(title, " ");
            confirmation = confirm("确认移动到" + townName + "？");
        }
        else if (title.startsWith("坐标")) {
            confirmation = confirm("确认移动到坐标" + coordinate.asText() + "？");
        }
        if (!confirmation) {
            return;
        }
        // 准备切换到移动模式
        (_a = document.getElementById("title")) === null || _a === void 0 ? void 0 : _a.scrollIntoView();
        MessageBoard_1.default.resetMessageBoard("我们将实时为你播报旅途的动态：<br>");
        $("#returnButton")
            .prop("disabled", true)
            .val("旅途中请耐心等候......");
        $(".location_button_class")
            .prop("disabled", true)
            .off("mouseenter")
            .off("mouseleave");
        if (townName !== "") {
            const town = TownLoader_1.default.getTownByCoordinate(coordinate);
            doTravelToTown(credential, town);
        }
        else {
            doTravelToLocation(credential, coordinate);
        }
    });
}
function doTravelToTown(credential, town) {
    MessageBoard_1.default.publishMessage("目的地城市：<span style='color:greenyellow'>" + town.name + "</span>");
    MessageBoard_1.default.publishMessage("目的地坐标：<span style='color:greenyellow'>" + town.coordinate.asText() + "</span>");
    const castleBank = new CastleBank_1.default(credential);
    castleBank.withdraw(10)
        .then(() => {
        castleBank.load()
            .then(account => {
            $("#roleCash").text(account.cash + " GOLD");
        });
        new CastleEntrance_1.default(credential).leave()
            .then(plan => {
            plan.destination = town.coordinate;
            new TravelPlanExecutor_1.default(plan).execute()
                .then(() => {
                new TownEntrance_1.default(credential).enter(town.id)
                    .then(() => {
                    const bank = new TownBank_1.default(credential);
                    bank.deposit().then(() => {
                        bank.load().then(account => {
                            $("#roleCash").text(account.cash + " GOLD");
                        });
                        MessageBoard_1.default.publishMessage("旅途愉快，下次再见。");
                        $("#returnForm")
                            .attr("action", "status.cgi")
                            .find("input:hidden[name='mode']")
                            .val("STATUS");
                        $("#returnButton")
                            .prop("disabled", false)
                            .val(town.name + "欢迎您");
                    });
                });
            });
        });
    })
        .catch(() => {
        MessageBoard_1.default.publishWarning("因为没有足够的保证金，旅途被中断！");
        MessageBoard_1.default.publishMessage("回去吧，没钱就别来了。");
        $("#returnButton")
            .prop("disabled", false)
            .val("真可怜钱不够");
    });
}
function doTravelToLocation(credential, location) {
    MessageBoard_1.default.publishMessage("目的地坐标：<span style='color:greenyellow'>" + location.asText() + "</span>");
    new CastleEntrance_1.default(credential).leave()
        .then(plan => {
        plan.destination = location;
        const executor = new TravelPlanExecutor_1.default(plan);
        executor.execute()
            .then(() => {
            MessageBoard_1.default.publishMessage("旅途愉快，下次再见。");
            $("#returnForm")
                .attr("action", "status.cgi")
                .find("input:hidden[name='mode']")
                .val("STATUS");
            $("#returnButton")
                .prop("disabled", false)
                .val("到达了目的地" + location.asText());
        });
    });
}
module.exports = CastlePostHousePageProcessor;


/***/ }),
/* 38 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleEntrance_credential;
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const TravelPlanBuilder_1 = __importDefault(__webpack_require__(39));
class CastleEntrance {
    constructor(credential) {
        _CastleEntrance_credential.set(this, void 0);
        __classPrivateFieldSet(this, _CastleEntrance_credential, credential, "f");
    }
    enter() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request["mode"] = "CASTLE_ENTRY";
                    NetworkUtils_1.default.sendPostRequest("map.cgi", request, function () {
                        MessageBoard_1.default.publishMessage("进入了城堡。");
                        resolve();
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _CastleEntrance_credential, "f"));
        });
    }
    leave() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request["navi"] = "on";
                    // @ts-ignore
                    request["out"] = "1";
                    // @ts-ignore
                    request["mode"] = "MAP_MOVE";
                    NetworkUtils_1.default.sendPostRequest("map.cgi", request, function (html) {
                        MessageBoard_1.default.publishMessage("已经离开了城堡。");
                        const plan = TravelPlanBuilder_1.default.initializeTravelPlan(html);
                        plan.credential = credential;
                        resolve(plan);
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _CastleEntrance_credential, "f"));
        });
    }
}
_CastleEntrance_credential = new WeakMap();
module.exports = CastleEntrance;


/***/ }),
/* 39 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TravelPlan_1 = __importDefault(__webpack_require__(40));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class TravelPlanBuilder {
    static initializeTravelPlan(pageHtml) {
        let s = $(pageHtml)
            .find("select[name='chara_m']")
            .find("option:last")
            .val();
        const scope = parseInt(s);
        let mode = "ROOK";
        $(pageHtml).find("input:submit").each(function (_idx, input) {
            const v = $(input).val();
            const d = $(input).attr("disabled");
            if (v === "↖" && d === undefined) {
                mode = "QUEEN";
            }
        });
        let source = new Coordinate_1.default(-1, -1);
        $(pageHtml)
            .find("td")
            .each(function (_idx, td) {
            const text = $(td).text();
            if (text.includes("现在位置(") && text.endsWith(")")) {
                const s = StringUtils_1.default.substringBetween(text, "(", ")");
                const x = StringUtils_1.default.substringBefore(s, ",");
                const y = StringUtils_1.default.substringAfter(s, ",");
                source = new Coordinate_1.default(parseInt(x), parseInt(y));
            }
        });
        MessageBoard_1.default.publishMessage("移动范围：<span style='color:greenyellow'>" + scope + "</span>");
        MessageBoard_1.default.publishMessage("移动模式：<span style='color:greenyellow'>" + mode + "</span>");
        MessageBoard_1.default.publishMessage("当前坐标：<span style='color:greenyellow'>" + source.asText() + "</span>");
        if ($("#roleLocation").length > 0) {
            let roleLocation = source.asText();
            const town = TownLoader_1.default.getTownByCoordinate(source);
            if (town !== null) {
                roleLocation = town.name + " " + roleLocation;
            }
            $("#roleLocation").text(roleLocation);
        }
        const mapId = "location_" + source.x + "_" + source.y;
        if ($("#" + mapId).length > 0) {
            $("#" + mapId).css("background-color", "red");
        }
        const plan = new TravelPlan_1.default();
        plan.scope = scope;
        plan.mode = mode;
        plan.source = source;
        return plan;
    }
}
module.exports = TravelPlanBuilder;


/***/ }),
/* 40 */
/***/ ((module) => {


class TravelPlan {
}
module.exports = TravelPlan;


/***/ }),
/* 41 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
const TownInformation_1 = __importDefault(__webpack_require__(42));
const Coordinate_1 = __importDefault(__webpack_require__(7));
class MapBuilder {
    static buildMapTable() {
        let html = "";
        html += "<table style='background-color:#888888;margin:auto;border-width:0'>";
        html += "<tbody style='background-color:#F8F0E0'>";
        html += "<tr>";
        html += "<td></td>";
        html += "<td>0</td>";
        html += "<td>1</td>";
        html += "<td>2</td>";
        html += "<td>3</td>";
        html += "<td>4</td>";
        html += "<td>5</td>";
        html += "<td>6</td>";
        html += "<td>7</td>";
        html += "<td>8</td>";
        html += "<td>9</td>";
        html += "<td>10</td>";
        html += "<td>11</td>";
        html += "<td>12</td>";
        html += "<td>13</td>";
        html += "<td>14</td>";
        html += "<td>15</td>";
        html += "</tr>";
        for (let y = 15; y >= 0; y--) {
            html += "<tr>";
            html += "<td>" + y + "</td>";
            for (let x = 0; x <= 15; x++) {
                const coordinate = new Coordinate_1.default(x, y);
                let buttonValue = "　";
                let buttonTitle = "坐标" + coordinate.asText();
                const town = TownLoader_1.default.getTownByCoordinate(coordinate);
                if (town !== null) {
                    buttonValue = town.name.substring(0, 1);
                    buttonTitle = "城市" + coordinate.asText() + " " + town.name;
                }
                html += "<td>";
                if (buttonValue === "　") {
                    html += "<span title='" + buttonTitle + "' class='color_none'>";
                    html += "<input type='button' value='" + buttonValue + "' " +
                        "class='location_button_class' " +
                        "id='location_" + x + "_" + y + "'>";
                    html += "</span>";
                }
                else {
                    html += "<span title='" + buttonTitle + "' class='color_yellow'>";
                    html += "<input type='button' value='" + buttonValue + "' " +
                        "class='location_button_class' " +
                        "id='location_" + x + "_" + y + "' " +
                        "style='background-color:yellow'>";
                    html += "</span>";
                }
                html += "</td>";
            }
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        return html;
    }
    static updateTownBackgroundColor() {
        new TownInformation_1.default().open().then(page => {
            for (const status of page.statusList) {
                const town = TownLoader_1.default.getTownByName(status.name);
                const x = town.coordinate.x;
                const y = town.coordinate.y;
                const buttonId = "location_" + x + "_" + y;
                $("#" + buttonId)
                    .css("background-color", status.color)
                    .css("color", "white")
                    .parent()
                    .attr("class", "color_" + status.color);
            }
        });
    }
}
module.exports = MapBuilder;


/***/ }),
/* 42 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownStatus_1 = __importDefault(__webpack_require__(43));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownInformationPage_1 = __importDefault(__webpack_require__(44));
class TownInformation {
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    NetworkUtils_1.default.get("town_print.cgi").then(html => {
                        const page = TownInformation.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const statusList = [];
        $(html).find("tr")
            .filter(function (_idx) {
            return _idx > 0;
        })
            .each(function (_idx, tr) {
            const c0 = $(tr).find("td:first");
            const c1 = c0.next();
            const c2 = c1.next();
            const c3 = c2.next();
            const status = new TownStatus_1.default();
            let s = c0.text();
            if (s.endsWith(" 首都")) {
                status.name = StringUtils_1.default.substringBefore(s, " 首都");
            }
            else {
                status.name = s;
            }
            status.color = c0.find("font:first").attr("color");
            status.country = c1.text();
            s = c2.text();
            status.tax = parseInt(StringUtils_1.default.substringBefore(s, " GOLD"));
            status.attribute = c3.text();
            statusList.push(status);
        });
        const page = new TownInformationPage_1.default();
        page.statusList = statusList;
        return page;
    }
}
module.exports = TownInformation;


/***/ }),
/* 43 */
/***/ ((module) => {


class TownStatus {
}
module.exports = TownStatus;


/***/ }),
/* 44 */
/***/ ((module) => {


class TownInformationPage {
}
module.exports = TownInformationPage;


/***/ }),
/* 45 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownEntrance_credential;
const TownLoader_1 = __importDefault(__webpack_require__(34));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const TimeoutUtils_1 = __importDefault(__webpack_require__(46));
const TravelPlanBuilder_1 = __importDefault(__webpack_require__(39));
class TownEntrance {
    constructor(credential) {
        _TownEntrance_credential.set(this, void 0);
        __classPrivateFieldSet(this, _TownEntrance_credential, credential, "f");
    }
    enter(townId) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential, townId) => {
                return new Promise(resolve => {
                    MessageBoard_1.default.publishMessage("等待进城冷却中......(约55秒)");
                    TimeoutUtils_1.default.execute(55000, function () {
                        const request = credential.asRequest();
                        // @ts-ignore
                        request["townid"] = townId;
                        // @ts-ignore
                        request["mode"] = "MOVE";
                        NetworkUtils_1.default.sendPostRequest("status.cgi", request, function (html) {
                            if ($(html).text().includes("进入方法选择")) {
                                MessageBoard_1.default.publishMessage("与门卫交涉中......");
                                const request = credential.asRequest();
                                // @ts-ignore
                                request["townid"] = townId;
                                // @ts-ignore
                                request["givemoney"] = "1";
                                // @ts-ignore
                                request["mode"] = "MOVE";
                                NetworkUtils_1.default.sendPostRequest("status.cgi", request, function () {
                                    MessageBoard_1.default.publishMessage("门卫通情达理的收取了入城费用放你入城。");
                                    const town = TownLoader_1.default.getTownById(townId);
                                    MessageBoard_1.default.publishMessage("进入了<span style='color:greenyellow'>" + town.name + "</span>。");
                                    resolve();
                                });
                            }
                            else {
                                const town = TownLoader_1.default.getTownById(townId);
                                MessageBoard_1.default.publishMessage("进入了<span style='color:greenyellow'>" + town.name + "</span>。");
                                resolve();
                            }
                        });
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _TownEntrance_credential, "f"), townId);
        });
    }
    leave() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request["navi"] = "on";
                    // @ts-ignore
                    request["out"] = "1";
                    // @ts-ignore
                    request["mode"] = "MAP_MOVE";
                    NetworkUtils_1.default.sendPostRequest("map.cgi", request, function (html) {
                        MessageBoard_1.default.publishMessage("离开了当前所在城市。");
                        const plan = TravelPlanBuilder_1.default.initializeTravelPlan(html);
                        plan.credential = credential;
                        resolve(plan);
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _TownEntrance_credential, "f"));
        });
    }
}
_TownEntrance_credential = new WeakMap();
module.exports = TownEntrance;


/***/ }),
/* 46 */
/***/ ((module) => {


class TimeoutUtils {
    static execute(timeoutInMillis, handler) {
        if ($("#countDownTimer").length > 0) {
            let count = timeoutInMillis / 1000;
            const timer = setInterval(function () {
                $("#countDownTimer").text(Math.max(count--, 0));
            }, 1000);
            setTimeout(function () {
                clearInterval(timer);
                $("#countDownTimer").text("-");
                handler();
            }, timeoutInMillis);
        }
        else {
            setTimeout(handler, timeoutInMillis);
        }
    }
}
module.exports = TimeoutUtils;


/***/ }),
/* 47 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TravelPlanExecutor_plan;
const TownLoader_1 = __importDefault(__webpack_require__(34));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TimeoutUtils_1 = __importDefault(__webpack_require__(46));
class TravelPlanExecutor {
    constructor(plan) {
        _TravelPlanExecutor_plan.set(this, void 0);
        __classPrivateFieldSet(this, _TravelPlanExecutor_plan, plan, "f");
    }
    execute() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (plan) => {
                return new Promise(resolve => {
                    const pathList = calculatePath(plan.source, plan.destination, plan.scope, plan.mode);
                    if (pathList.length > 1) {
                        MessageBoard_1.default.publishMessage("旅途路径已经计算完毕，总共需要次移动" + (pathList.length - 1) + "步。");
                        let msg = "旅途路径规划：";
                        for (let i = 0; i < pathList.length; i++) {
                            let node = pathList[i];
                            msg += node.asText();
                            if (i !== pathList.length - 1) {
                                msg += "=>";
                            }
                        }
                        MessageBoard_1.default.publishMessage(msg);
                    }
                    doMoveOnPath(plan.credential, pathList, 0, function () {
                        resolve();
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _TravelPlanExecutor_plan, "f"));
        });
    }
}
_TravelPlanExecutor_plan = new WeakMap();
function doMoveOnPath(credential, pathList, index, callback) {
    if (pathList.length === 1 || index === pathList.length - 1) {
        // 路径中只有一个点，表示起点和终点是一个点，直接结束
        // 已经移动到最后一个点
        callback();
    }
    else {
        MessageBoard_1.default.publishMessage("等待移动冷却中......(约55秒)");
        TimeoutUtils_1.default.execute(55000, function () {
            const from = pathList[index];
            const to = pathList[index + 1];
            const direction = calculateDirection(from, to);
            const distance = calculateDistance(from, to);
            const request = credential.asRequest();
            // @ts-ignore
            request["con"] = "2";
            // @ts-ignore
            request["navi"] = "on";
            // @ts-ignore
            request["mode"] = "CHARA_MOVE";
            // @ts-ignore
            request["direct"] = escape(direction);
            // @ts-ignore
            request["chara_m"] = distance;
            NetworkUtils_1.default.sendPostRequest("map.cgi", request, function () {
                MessageBoard_1.default.publishMessage("<span style='color:greenyellow'>" + direction + "</span>移动" + distance + "格，到达" + to.asText() + "。");
                if ($("#roleLocation").length > 0) {
                    let roleLocation = to.asText();
                    const town = TownLoader_1.default.getTownByCoordinate(to);
                    if (town !== null) {
                        roleLocation = town.name + " " + roleLocation;
                    }
                    $("#roleLocation").text(roleLocation);
                }
                let mapId = "location_" + from.x + "_" + from.y;
                if ($("#" + mapId).length > 0) {
                    const s = $("#" + mapId).parent().attr("class");
                    const c = StringUtils_1.default.substringAfter(s, "_");
                    if (c !== "none") {
                        $("#" + mapId).css("background-color", c);
                    }
                    else {
                        $("#" + mapId).removeAttr("style");
                    }
                }
                mapId = "location_" + to.x + "_" + to.y;
                if ($("#" + mapId).length > 0) {
                    $("#" + mapId).css("background-color", "red");
                }
                doMoveOnPath(credential, pathList, index + 1, callback);
            });
        });
    }
}
function calculatePath(source, destination, scope, mode) {
    const pathList = [];
    if (source.equals(destination)) {
        pathList.push(source);
        return pathList;
    }
    const milestone = calculateMilestone(source, destination, mode);
    if (milestone !== undefined) {
        const p1 = calculateMilestonePath(source, milestone, scope);
        const p2 = calculateMilestonePath(milestone, destination, scope);
        pathList.push(...p1);
        pathList.push(...p2);
        pathList.push(destination);
    }
    else {
        const p = calculateMilestonePath(source, destination, scope);
        pathList.push(...p);
        pathList.push(destination);
    }
    return pathList;
}
function calculateMilestone(from, to, mode) {
    if (mode === "ROOK") {
        if (from.x === to.x || from.y === to.y) {
            return undefined;
        }
        return new Coordinate_1.default(from.x, to.y);
    }
    if (mode === "QUEEN") {
        if (from.x === to.x || from.y === to.y) {
            return undefined;
        }
        const xDelta = Math.abs(from.x - to.x);
        const yDelta = Math.abs(from.y - to.y);
        if (xDelta === yDelta) {
            return undefined;
        }
        const delta = Math.min(xDelta, yDelta);
        let x = from.x;
        let y = from.y;
        if (to.x > from.x) {
            x = x + delta;
        }
        else {
            x = x - delta;
        }
        if (to.y > from.y) {
            y = y + delta;
        }
        else {
            y = y - delta;
        }
        return new Coordinate_1.default(x, y);
    }
    return undefined;
}
function calculateMilestonePath(from, to, scope) {
    const nodeList = [];
    nodeList.push(from);
    if (from.x === to.x) {
        // 一条竖线上
        const step = Math.ceil(Math.abs(from.y - to.y) / scope);
        for (let i = 1; i <= step - 1; i++) {
            if (to.y > from.y) {
                nodeList.push(new Coordinate_1.default(from.x, from.y + (i * scope)));
            }
            else {
                nodeList.push(new Coordinate_1.default(from.x, from.y - (i * scope)));
            }
        }
    }
    else if (from.y === to.y) {
        // 一条横线上
        const step = Math.ceil(Math.abs(from.x - to.x) / scope);
        for (let i = 1; i <= step - 1; i++) {
            if (to.x > from.x) {
                nodeList.push(new Coordinate_1.default(from.x + (i * scope), from.y));
            }
            else {
                nodeList.push(new Coordinate_1.default(from.x - (i * scope), from.y));
            }
        }
    }
    else {
        // 一条斜线上
        const step = Math.ceil(Math.abs(from.x - to.x) / scope);
        for (let i = 1; i <= step - 1; i++) {
            let x = from.x;
            if (to.x > from.x) {
                x = x + (i * scope);
            }
            else {
                x = x - (i * scope);
            }
            let y = from.y;
            if (to.y > from.y) {
                y = y + (i * scope);
            }
            else {
                y = y - (i * scope);
            }
            nodeList.push(new Coordinate_1.default(x, y));
        }
    }
    return nodeList;
}
function calculateDirection(from, to) {
    const x1 = from.x;
    const y1 = from.y;
    const x2 = to.x;
    const y2 = to.y;
    let direction = "";
    if (x1 === x2) {
        // 上或者下
        if (y2 > y1) {
            direction = "↑";
        }
        else {
            direction = "↓";
        }
    }
    else if (y1 === y2) {
        // 左或者右
        if (x2 > x1) {
            direction = "→";
        }
        else {
            direction = "←";
        }
    }
    else {
        // 4种斜向移动
        if (x2 > x1 && y2 > y1) {
            direction = "↗";
        }
        if (x2 > x1 && y2 < y1) {
            direction = "↘";
        }
        if (x2 < x1 && y2 > y1) {
            direction = "↖";
        }
        if (x2 < x1 && y2 < y1) {
            direction = "↙";
        }
    }
    return direction;
}
function calculateDistance(from, to) {
    const x1 = from.x;
    const y1 = from.y;
    const x2 = to.x;
    const y2 = to.y;
    return Math.max(Math.abs(x1 - x2), Math.abs(y1 - y2));
}
module.exports = TravelPlanExecutor;


/***/ }),
/* 48 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalStatus_credential, _PersonalStatus_townId;
const Castle_1 = __importDefault(__webpack_require__(49));
const Role_1 = __importDefault(__webpack_require__(14));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PersonalStatusPage_1 = __importDefault(__webpack_require__(50));
class PersonalStatus {
    constructor(credential, townId) {
        _PersonalStatus_credential.set(this, void 0);
        _PersonalStatus_townId.set(this, void 0);
        __classPrivateFieldSet(this, _PersonalStatus_credential, credential, "f");
        __classPrivateFieldSet(this, _PersonalStatus_townId, townId, "f");
    }
    static parsePage(pageHtml) {
        return doParsePage(pageHtml);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise(resolve => {
                    const request = credential.asRequestMap();
                    if (__classPrivateFieldGet(this, _PersonalStatus_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _PersonalStatus_townId, "f"));
                    }
                    request.set("mode", "STATUS_PRINT");
                    NetworkUtils_1.default.post("mydata.cgi", request)
                        .then(pageHtml => {
                        const page = PersonalStatus.parsePage(pageHtml);
                        resolve(page);
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _PersonalStatus_credential, "f"));
        });
    }
    load() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    this.open().then(page => {
                        resolve(page.role);
                    });
                });
            };
            return yield action();
        });
    }
}
_PersonalStatus_credential = new WeakMap(), _PersonalStatus_townId = new WeakMap();
function doParsePage(pageHtml) {
    const role = new Role_1.default();
    const table = $(pageHtml).find("table:eq(1)");
    let s = $(table).find("tr:first td:first").text();
    role.name = StringUtils_1.default.substringBetween(s, "姓名 ： ", " (");
    let t = StringUtils_1.default.substringBetween(s, "(", ")");
    role.race = StringUtils_1.default.substringBefore(t, " ");
    role.gender = StringUtils_1.default.substringAfter(t, " ");
    let tr = $(table).find("tr:eq(1)");
    let td = $(tr).find("td:first");
    s = $(td).text();
    role.level = parseInt(StringUtils_1.default.substringAfter(s, "Ｌｖ"));
    td = $(tr).find("td:eq(1)");
    s = $(td).text();
    role.country = StringUtils_1.default.substringBetween(s, "所属：", "(");
    role.unit = StringUtils_1.default.substringBetween(s, "(", " 部队)");
    tr = $(table).find("tr:eq(2)");
    td = $(tr).find("td:first");
    s = $(td).find("img:first").attr("src");
    role.image = StringUtils_1.default.substringAfterLast(s, "/");
    td = $(tr).find("td:eq(2)");
    s = $(td).text();
    role.health = parseInt(StringUtils_1.default.substringBeforeSlash(s));
    role.maxHealth = parseInt(StringUtils_1.default.substringAfterSlash(s));
    td = $(tr).find("td:eq(4)");
    s = $(td).text();
    role.mana = parseInt(StringUtils_1.default.substringBeforeSlash(s));
    role.maxMana = parseInt(StringUtils_1.default.substringAfterSlash(s));
    tr = $(table).find("tr:eq(3)");
    td = $(tr).find("td:eq(1)");
    s = $(td).text();
    role.spell = StringUtils_1.default.substringBefore(s, "(");
    tr = $(table).find("tr:eq(5)");
    td = $(tr).find("td:eq(1)");
    s = $(td).text();
    role.attack = parseInt(s);
    td = $(tr).find("td:eq(3)");
    s = $(td).text();
    role.defense = parseInt(s);
    tr = $(table).find("tr:eq(6)");
    td = $(tr).find("td:eq(1)");
    s = $(td).text();
    role.specialAttack = parseInt(s);
    td = $(tr).find("td:eq(3)");
    s = $(td).text();
    role.specialDefense = parseInt(s);
    tr = $(table).find("tr:eq(7)");
    td = $(tr).find("td:eq(1)");
    s = $(td).text();
    role.speed = parseInt(s);
    td = $(tr).find("td:eq(3)");
    role.pet = $(td).text();
    tr = $(table).find("tr:eq(9)");
    td = $(tr).find("td:eq(1)");
    role.attribute = $(td).text();
    td = $(tr).find("td:eq(3)");
    s = $(td).text();
    if (s === "野外") {
        role.location = "WILD";
    }
    else if (s.includes("(") && s.includes(")")) {
        role.location = "CASTLE";
        const castle = new Castle_1.default();
        castle.name = StringUtils_1.default.substringBefore(s, " (");
        castle.owner = role.name;
        s = StringUtils_1.default.substringBetween(s, "(", ")");
        const x = parseInt(StringUtils_1.default.substringBefore(s, ","));
        const y = parseInt(StringUtils_1.default.substringAfter(s, ","));
        castle.coordinate = new Coordinate_1.default(x, y);
        role.castle = castle;
    }
    else {
        const town = TownLoader_1.default.getTownByName(s);
        if (town !== null) {
            role.location = "TOWN";
            role.town = town;
        }
    }
    tr = $(table).find("tr:eq(11)");
    td = $(tr).find("td:eq(1)");
    role.task = $(td).text();
    tr = $(table).find("tr:eq(16)");
    td = $(tr).find("td:eq(2)");
    role.experience = parseInt($(td).text());
    td = $(tr).find("td:eq(4)");
    s = $(td).text();
    role.cash = parseInt(StringUtils_1.default.substringBefore(s, " G"));
    tr = $(table).find("tr:eq(21)");
    td = $(tr).find("td:first");
    s = $(td).text();
    role.career = StringUtils_1.default.substringAfter(s, "职业：");
    role.masterCareerList = [];
    tr = $(table).find("tr:eq(22)");
    td = $(tr).find("td:first");
    s = $(td).text();
    s = StringUtils_1.default.substringAfter(s, "掌握职业：");
    for (const it of s.split("】【")) {
        const career = StringUtils_1.default.substringBetween(it, "【", "】");
        role.masterCareerList.push(career);
    }
    role.treasureList = [];
    tr = $(table).find("tr:eq(23)");
    td = $(tr).find("td:first");
    s = $(td).text();
    s = StringUtils_1.default.substringAfter(s, "仙人的宝物：");
    for (const it of s.split(" ")) {
        if (it !== "") {
            role.treasureList.push(it);
        }
    }
    role.hasMirror = pageHtml.includes("所有其他分身");
    const page = new PersonalStatusPage_1.default();
    page.role = role;
    return page;
}
module.exports = PersonalStatus;


/***/ }),
/* 49 */
/***/ ((module) => {


class Castle {
}
module.exports = Castle;


/***/ }),
/* 50 */
/***/ ((module) => {


class PersonalStatusPage {
}
module.exports = PersonalStatusPage;


/***/ }),
/* 51 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownBank_credential, _TownBank_townId;
const BankAccount_1 = __importDefault(__webpack_require__(27));
const Role_1 = __importDefault(__webpack_require__(14));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownBankPage_1 = __importDefault(__webpack_require__(52));
class TownBank {
    constructor(credential, townId) {
        _TownBank_credential.set(this, void 0);
        _TownBank_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownBank_credential, credential, "f");
        __classPrivateFieldSet(this, _TownBank_townId, townId, "f");
    }
    get bankTitle() {
        if (__classPrivateFieldGet(this, _TownBank_townId, "f") === undefined) {
            return "口袋银行";
        }
        else {
            const town = TownLoader_1.default.getTownById(__classPrivateFieldGet(this, _TownBank_townId, "f"));
            return town.name + "分行";
        }
    }
    static parsePage(html) {
        return doParsePage(html);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownBank_credential, "f").asRequestMap();
                    request.set("con_str", "50");
                    request.set("mode", "BANK");
                    if (__classPrivateFieldGet(this, _TownBank_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _TownBank_townId, "f"));
                    }
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const page = TownBank.parsePage(html);
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    load() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    this.open().then(page => {
                        resolve(page.account);
                    });
                });
            };
            return yield action();
        });
    }
    withdraw(amount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    if (!BankUtils_1.default.checkAmountAvailability(amount)) {
                        MessageBoard_1.default.publishWarning("无效的金额，必须是零或者正整数！");
                        reject();
                    }
                    else {
                        if (amount === 0) {
                            resolve();
                        }
                        else {
                            const request = __classPrivateFieldGet(this, _TownBank_credential, "f").asRequestMap();
                            request.set("dasu", amount.toString());
                            request.set("mode", "BANK_BUY");
                            NetworkUtils_1.default.post("town.cgi", request).then(html => {
                                if (html.includes("您在钱庄里没那么多存款")) {
                                    MessageBoard_1.default.publishWarning("并没有那么多存款！");
                                    reject();
                                }
                                else {
                                    MessageBoard_1.default.publishMessage("从" + this.bankTitle + "取现了" + amount + "万现金。");
                                    resolve();
                                }
                            });
                        }
                    }
                });
            };
            return yield action();
        });
    }
    deposit(amount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    const request = __classPrivateFieldGet(this, _TownBank_credential, "f").asRequestMap();
                    if (amount === undefined) {
                        request.set("azukeru", "all");
                        request.set("mode", "BANK_SELL");
                        NetworkUtils_1.default.post("town.cgi", request).then(() => {
                            MessageBoard_1.default.publishMessage("在" + this.bankTitle + "存入了所有现金。");
                            resolve();
                        });
                    }
                    else {
                        if (!BankUtils_1.default.checkAmountAvailability(amount)) {
                            MessageBoard_1.default.publishWarning("无效的金额，必须是零或者正整数！");
                            reject();
                        }
                        else {
                            if (amount === 0) {
                                resolve();
                            }
                            else {
                                request.set("azukeru", amount.toString());
                                request.set("mode", "BANK_SELL");
                                NetworkUtils_1.default.post("town.cgi", request).then(html => {
                                    if (html.includes("所持金不足")) {
                                        MessageBoard_1.default.publishWarning("并没有那么多现金！");
                                        reject();
                                    }
                                    else {
                                        MessageBoard_1.default.publishMessage("在" + this.bankTitle + "存入了" + amount + "万现金。");
                                        resolve();
                                    }
                                });
                            }
                        }
                    }
                });
            };
            return yield action();
        });
    }
}
_TownBank_credential = new WeakMap(), _TownBank_townId = new WeakMap();
function doParsePage(html) {
    const table = $(html).find("td:contains('姓名')")
        .filter((_idx, td) => {
        return $(td).text() === "姓名";
    })
        .closest("table");
    const role = new Role_1.default();
    table.find("tr:first")
        .next()
        .find("td:first")
        .filter((_idx, td) => {
        role.name = $(td).text();
        return true;
    })
        .next()
        .filter((_idx, td) => {
        role.level = parseInt($(td).text());
        return true;
    })
        .next()
        .filter((_idx, td) => {
        role.attribute = StringUtils_1.default.substringBefore($(td).text(), "属");
        return true;
    })
        .next()
        .filter((_idx, td) => {
        role.career = $(td).text();
        return true;
    })
        .parent()
        .next()
        .find("td:first")
        .next()
        .filter((_idx, td) => {
        role.cash = parseInt(StringUtils_1.default.substringBefore($(td).text(), " GOLD"));
        return true;
    });
    const font = $(html).find("font:contains('现在的所持金')")
        .filter((_idx, font) => {
        const s = $(font).text();
        return s.startsWith(" ") && s.includes("现在的所持金");
    });
    let s = font.text();
    s = StringUtils_1.default.substringBefore(s, "现在的所持金");
    const account = new BankAccount_1.default();
    account.name = s.substring(1);
    account.cash = parseInt($(font).find("font:first").text());
    account.saving = parseInt($(font).find("font:last").text());
    const page = new TownBankPage_1.default();
    page.role = role;
    page.account = account;
    return page;
}
module.exports = TownBank;


/***/ }),
/* 52 */
/***/ ((module) => {


class TownBankPage {
}
module.exports = TownBankPage;


/***/ }),
/* 53 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _LoginDashboardPageInterceptor_processor;
const LoginDashboardPageProcessor_1 = __importDefault(__webpack_require__(54));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class LoginDashboardPageInterceptor {
    constructor() {
        _LoginDashboardPageInterceptor_processor.set(this, new LoginDashboardPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "contnue.cgi") {
            return pageText.includes("继续游戏");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isFastLoginEnabled()) {
            return;
        }
        __classPrivateFieldGet(this, _LoginDashboardPageInterceptor_processor, "f").process();
    }
}
_LoginDashboardPageInterceptor_processor = new WeakMap();
module.exports = LoginDashboardPageInterceptor;


/***/ }),
/* 54 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const FastLoginLoader_1 = __importDefault(__webpack_require__(55));
const PageUtils_1 = __importDefault(__webpack_require__(21));
class LoginDashboardPageProcessor {
    process() {
        PageUtils_1.default.loadButtonStyle(28);
        PageUtils_1.default.fixCurrentPageBrokenImages();
        PageUtils_1.default.removeUnusedHyperLinks();
        PageUtils_1.default.removeGoogleAnalyticsScript();
        $("img:first")
            .attr("width", "64")
            .attr("height", "48");
        doProcess();
    }
}
function doProcess() {
    const configs = new Map();
    for (let i = 0; i < 50; i++) {
        const config = FastLoginLoader_1.default.loadFastLoginConfig(i);
        if (doCheckConfigAvailability(config)) {
            configs.set(i, config);
        }
    }
    if (configs.size === 0) {
        return;
    }
    $("input:text[name='id']").attr("id", "loginId");
    $("input:password[name='pass']").attr("id", "loginPass");
    $("input:submit[value='登陆']").attr("id", "loginButton");
    $("form").attr("id", "loginForm");
    let html = "";
    html += "<tr>";
    html += "<td id='fastLogin' style='background-color:#E8E8D0;text-align:center' colspan='2'></td>";
    html += "</tr>";
    $("#loginButton")
        .closest("tr")
        .after($(html));
    doRender(configs);
}
function doCheckConfigAvailability(config) {
    // @ts-ignore
    return config.name !== undefined && config.id !== undefined && config.pass !== undefined;
}
function doRender(configs) {
    const fastLoginCounts = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    let html = "";
    html += "<table style='border-width:0;margin:auto;text-align:center;width:100%'>";
    html += "<tbody>";
    html += "</tbody>";
    html += "<tr>";
    html += "<td colspan='5' style='color:navy;font-weight:bold'>快速登陆时请自行输入图形验证码</td>";
    html += "</tr>";
    html += "<tr id='tr1'>";
    for (let i = 0; i < 5; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[0]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr2'>";
    for (let i = 5; i < 10; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[1]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr3'>";
    for (let i = 10; i < 15; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[2]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr4'>";
    for (let i = 15; i < 20; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[3]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr5'>";
    for (let i = 20; i < 25; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[4]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr6'>";
    for (let i = 25; i < 30; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[5]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr7'>";
    for (let i = 30; i < 35; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[6]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr8'>";
    for (let i = 35; i < 40; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[7]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr9'>";
    for (let i = 40; i < 45; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[8]++;
        });
    }
    html += "</tr>";
    html += "<tr id='tr10'>";
    for (let i = 45; i < 50; i++) {
        html += doGenerateCell(configs, i, () => {
            fastLoginCounts[9]++;
        });
    }
    html += "</tr>";
    html += "</table>";
    $("#fastLogin").html(html);
    console.log(fastLoginCounts);
    for (let i = 0; i < fastLoginCounts.length; i++) {
        const fastLoginCount = fastLoginCounts[i];
        if (fastLoginCount === 0) {
            $("#tr" + (i + 1)).hide();
        }
    }
    doBindFastLoginButton();
}
function doGenerateCell(configs, code, handler) {
    let count = 0;
    let html = "";
    html += "<td style='background-color:#E8E8D0;width:20%;height:32px'>";
    let config = configs.get(code);
    if (config !== undefined) {
        count++;
        // @ts-ignore
        const name = config.name;
        html += "<input type='button' class='fastLoginButton button-28' " +
            "id='fastLogin_" + code + "' value='" + name + "'>";
    }
    html += "</td>";
    if (count > 0 && handler !== undefined) {
        handler();
    }
    return html;
}
function doBindFastLoginButton() {
    for (let i = 0; i < 50; i++) {
        const buttonId = "fastLogin_" + i;
        if ($("#" + buttonId).length === 0) {
            continue;
        }
        $("#" + buttonId).on("click", function () {
            const code = parseInt($(this).attr("id").split("_")[1]);
            const config = FastLoginLoader_1.default.loadFastLoginConfig(code);
            if (!doCheckConfigAvailability(config)) {
                return;
            }
            // @ts-ignore
            $("#loginId").val(config.id);
            // @ts-ignore
            $("#loginPass").val(config.pass);
            $("#loginForm").removeAttr("onsubmit");
            $("#loginButton").trigger("click");
        });
    }
}
module.exports = LoginDashboardPageProcessor;


/***/ }),
/* 55 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const FastLogin_1 = __importDefault(__webpack_require__(56));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
class FastLoginLoader {
    static loadFastLoginConfig(code) {
        if (code < 0 || code > 49) {
            return {};
        }
        const key = "_fl_" + code;
        const s = StorageUtils_1.default.getString(key);
        if (s === "") {
            return {};
        }
        else {
            return JSON.parse(s);
        }
    }
    static loadFastLogin(code) {
        const config = FastLoginLoader.loadFastLoginConfig(code);
        if (!doCheckConfigAvailability(config)) {
            return null;
        }
        const fastLogin = new FastLogin_1.default();
        // @ts-ignore
        fastLogin.name = config.name;
        // @ts-ignore
        fastLogin.id = config.id;
        // @ts-ignore
        fastLogin.pass = config.pass;
        return fastLogin;
    }
}
function doCheckConfigAvailability(config) {
    // @ts-ignore
    return config.name !== undefined && config.id !== undefined && config.pass !== undefined;
}
module.exports = FastLoginLoader;


/***/ }),
/* 56 */
/***/ ((module) => {


class FastLogin {
}
module.exports = FastLogin;


/***/ }),
/* 57 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _MapDashboardPageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const MapDashboardPageProcessor_1 = __importDefault(__webpack_require__(58));
class MapDashboardPageInterceptor {
    constructor() {
        _MapDashboardPageInterceptor_processor.set(this, new MapDashboardPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "map.cgi" || cgi === "status.cgi") {
            return pageText.includes("请选择移动的格数");
        }
        return false;
    }
    intercept() {
        // Set current location state to MAP.
        LocationStateMachine_1.default.create().inMap();
        __classPrivateFieldGet(this, _MapDashboardPageInterceptor_processor, "f").process();
    }
}
_MapDashboardPageInterceptor_processor = new WeakMap();
module.exports = MapDashboardPageInterceptor;


/***/ }),
/* 58 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _MapDashboardPageProcessor_instances, _MapDashboardPageProcessor_renderMenu, _MapDashboardPageProcessor_renderExperience, _MapDashboardPageProcessor_renderEventBoard;
const EventHandler_1 = __importDefault(__webpack_require__(33));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class MapDashboardPageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super();
        _MapDashboardPageProcessor_instances.add(this);
    }
    doProcess(credential) {
        __classPrivateFieldGet(this, _MapDashboardPageProcessor_instances, "m", _MapDashboardPageProcessor_renderMenu).call(this);
        __classPrivateFieldGet(this, _MapDashboardPageProcessor_instances, "m", _MapDashboardPageProcessor_renderExperience).call(this);
        __classPrivateFieldGet(this, _MapDashboardPageProcessor_instances, "m", _MapDashboardPageProcessor_renderEventBoard).call(this);
    }
}
_MapDashboardPageProcessor_instances = new WeakSet(), _MapDashboardPageProcessor_renderMenu = function _MapDashboardPageProcessor_renderMenu() {
    $("option[value='MAP_VISIT']")
        .css("background-color", "yellow")
        .text("拜访·驿站");
}, _MapDashboardPageProcessor_renderExperience = function _MapDashboardPageProcessor_renderExperience() {
    if (!SetupLoader_1.default.isExperienceProgressBarEnabled()) {
        return;
    }
    $("td:contains('经验值')")
        .filter(function () {
        return $(this).text() === "经验值";
    })
        .next()
        .each(function (_idx, th) {
        const expText = $(th).text();
        const experience = parseInt(StringUtils_1.default.substringBefore(expText, " EX"));
        if (experience >= 14900) {
            $(th).css("color", "blue").text("MAX");
        }
        else {
            const level = Math.ceil(experience / 100) + 1;
            const ratio = level / 150;
            const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
            $(th).html("<span title='" + expText + "'>" + progressBar + "</span>");
        }
    });
}, _MapDashboardPageProcessor_renderEventBoard = function _MapDashboardPageProcessor_renderEventBoard() {
    $("td:contains('最近发生的事件')")
        .filter(function () {
        return $(this).text() === "最近发生的事件";
    })
        .parent()
        .next()
        .find("td:first")
        .attr("id", "eventBoard");
    const eventHtmlList = [];
    $("#eventBoard").html()
        .split("<br>")
        .filter(it => it.endsWith(")"))
        .map(function (it) {
        // noinspection HtmlDeprecatedTag,XmlDeprecatedElement,HtmlDeprecatedAttribute
        const header = "<font color=\"navy\">●</font>";
        return StringUtils_1.default.substringAfter(it, header);
    })
        .map(function (it) {
        return EventHandler_1.default.handleWithEventHtml(it);
    })
        .forEach(it => eventHtmlList.push(it));
    let html = "";
    html += "<table style='border-width:0;width:100%;height:100%;margin:auto'>";
    html += "<tbody>";
    eventHtmlList.forEach(it => {
        html += "<tr>";
        html += "<th style='color:navy;vertical-align:top'>●</th>";
        html += "<td style='width:100%'>";
        html += it;
        html += "</td>";
        html += "</tr>";
    });
    html += "</tbody>";
    html += "</table>";
    $("#eventBoard").html(html);
};
module.exports = MapDashboardPageProcessor;


/***/ }),
/* 59 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _MapPostHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const MapPostHousePageProcessor_1 = __importDefault(__webpack_require__(60));
class MapPostHousePageInterceptor {
    constructor() {
        _MapPostHousePageInterceptor_processor.set(this, new MapPostHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "map.cgi") {
            return pageText.includes("＜＜住所＞＞");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInMap(() => {
            __classPrivateFieldGet(this, _MapPostHousePageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_MapPostHousePageInterceptor_processor = new WeakMap();
module.exports = MapPostHousePageInterceptor;


/***/ }),
/* 60 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const MapBuilder_1 = __importDefault(__webpack_require__(41));
const RoleLocationLoader_1 = __importDefault(__webpack_require__(61));
const TravelPlanBuilder_1 = __importDefault(__webpack_require__(39));
const TravelPlanExecutor_1 = __importDefault(__webpack_require__(47));
const CastleInformation_1 = __importDefault(__webpack_require__(63));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class MapPostHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super();
    }
    doProcess(credential) {
        doProcess(credential);
    }
}
function doProcess(credential) {
    $("input:submit[value='返回上个画面']").attr("id", "returnButton");
    $("table[height='100%']").removeAttr("height");
    $("table:eq(1)")
        .find("td:first")
        .removeAttr("bgcolor")
        .removeAttr("width")
        .removeAttr("height")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "greenyellow")
        .attr("id", "title")
        .text("＜＜　 住 所 & 简 易 驿 站 　＞＞");
    const player = $("table:eq(4)")
        .find("tr:first")
        .next()
        .find("td:first")
        .text();
    $("table:eq(4)")
        .find("tr:last")
        .after($("" +
        "<tr>" +
        "<td style='background-color:#E0D0B0'>坐标点</td>" +
        "<td id='roleLocation' style='background-color:#E8E8D0;text-align:right;color:red;font-weight:bold' colspan='3'>-</td>" +
        "</tr>" +
        "<tr>" +
        "<td style='background-color:#E0D0B0'>计时器</td>" +
        "<td id='countDownTimer' style='background-color:#E8E8D0;text-align:right;color:red;font-weight:bold' colspan='3'>-</td>" +
        "</tr>" +
        "<tr style='display:none'><td id='eden' colspan='4'></td></tr>"));
    $("table:eq(5)")
        .find("td:first")
        .removeAttr("width")
        .removeAttr("bgcolor")
        .css("width", "100%")
        .css("background-color", "black")
        .css("color", "white")
        .attr("id", "messageBoard")
        .html("简易驿站能带您去地图上任意的一个坐标点，也仅此而已。")
        .next()
        .html(NpcLoader_1.default.randomNpcImageHtml());
    let html = "";
    html += "<tr style='display:none'>";
    html += "<td id='menu' style='background-color:#F8F0E0;text-align:center'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='postHouse' style='background-color:#F8F0E0;text-align:center'>";
    html += "</td>";
    html += "</tr>";
    $("#returnButton")
        .closest("tr")
        .attr("id", "visitRow")
        .after($(html));
    doGenerateEdenForm(credential);
    doGenerateMenu();
    doRender(credential, player);
}
function doGenerateEdenForm(credential) {
    let html = "";
    // noinspection HtmlUnknownTarget
    html += "<form action='status.cgi' method='post' id='returnForm'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='mode' value='STATUS'>";
    html += "<input type='submit' id='returnSubmit'>";
    html += "</form>";
    $("#eden").html(html);
}
function doGenerateMenu() {
    $("#menu").html("<input type='button' id='travelButton' " +
        "disabled value='旅途中请耐心等候......'>");
    $("#travelButton").on("click", function () {
        $("#returnSubmit").trigger("click");
    });
}
function doRender(credential, player) {
    $("#postHouse").html(MapBuilder_1.default.buildMapTable());
    MapBuilder_1.default.updateTownBackgroundColor();
    new RoleLocationLoader_1.default(credential).load()
        .then(location => {
        const x = location.coordinate.x;
        const y = location.coordinate.y;
        const buttonId = "location_" + x + "_" + y;
        $("#" + buttonId)
            .closest("td")
            .css("background-color", "black")
            .css("color", "yellow")
            .css("text-align", "center")
            .html("我");
        $(".location_button_class")
            .on("mouseenter", function () {
            $(this).css("background-color", "red");
        })
            .on("mouseleave", function () {
            const s = $(this).parent().attr("class");
            const c = StringUtils_1.default.substringAfter(s, "_");
            if (c !== "none") {
                $(this).css("background-color", c);
            }
            else {
                $(this).removeAttr("style");
            }
        });
        $("#postHouse").parent().show();
        new CastleInformation_1.default().load(player).then(castle => {
            const coordinate = castle.coordinate;
            if (location.coordinate.equals(coordinate)) {
                return;
            }
            const buttonId = "location_" + coordinate.x + "_" + coordinate.y;
            $("#" + buttonId)
                .attr("value", "堡")
                .css("background-color", "fuchsia")
                .parent()
                .attr("title", "城堡" + coordinate.asText() + " " + castle.name)
                .attr("class", "color_fuchsia");
        });
        doBind(credential);
    });
}
function doBind(credential) {
    $(".location_button_class").on("click", function () {
        var _a;
        const ss = $(this).attr("id").split("_");
        const x = parseInt(ss[1]);
        const y = parseInt(ss[2]);
        const coordinate = new Coordinate_1.default(x, y);
        const confirmation = confirm("确认移动到坐标" + coordinate.asText() + "？");
        if (!confirmation) {
            return;
        }
        (_a = document.getElementById("title")) === null || _a === void 0 ? void 0 : _a.scrollIntoView();
        MessageBoard_1.default.resetMessageBoard("虽然我们的驿站很简陋，但是也有实时旅途动态播报：<br>");
        $("#visitRow").hide();
        $(".location_button_class")
            .prop("disabled", true)
            .off("mouseenter")
            .off("mouseleave");
        $("#menu").parent().show();
        doTravelToLocation(credential, coordinate);
    });
}
function doTravelToLocation(credential, location) {
    MessageBoard_1.default.publishMessage("目的地坐标：<span style='color:greenyellow'>" + location.asText() + "</span>");
    const request = credential.asRequest();
    // @ts-ignore
    request.mode = "STATUS";
    NetworkUtils_1.default.sendPostRequest("status.cgi", request, function (pageHtml) {
        const plan = TravelPlanBuilder_1.default.initializeTravelPlan(pageHtml);
        plan.destination = location;
        plan.credential = credential;
        const executor = new TravelPlanExecutor_1.default(plan);
        executor.execute()
            .then(() => {
            MessageBoard_1.default.publishMessage("旅途愉快，下次再见。");
            $("#travelButton")
                .prop("disabled", false)
                .val("到达了目的地" + location.asText());
        });
    });
}
module.exports = MapPostHousePageProcessor;


/***/ }),
/* 61 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _RoleLocationLoader_credential;
const RoleLocation_1 = __importDefault(__webpack_require__(62));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class RoleLocationLoader {
    constructor(credential) {
        _RoleLocationLoader_credential.set(this, void 0);
        __classPrivateFieldSet(this, _RoleLocationLoader_credential, credential, "f");
    }
    load() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request.mode = "STATUS";
                    NetworkUtils_1.default.sendPostRequest("status.cgi", request, function (pageHtml) {
                        let source = new Coordinate_1.default(-1, -1);
                        $(pageHtml)
                            .find("td")
                            .each(function (_idx, td) {
                            const text = $(td).text();
                            if (text.includes("现在位置(") && text.endsWith(")")) {
                                const s = StringUtils_1.default.substringBetween(text, "(", ")");
                                const x = StringUtils_1.default.substringBefore(s, ",");
                                const y = StringUtils_1.default.substringAfter(s, ",");
                                source = new Coordinate_1.default(parseInt(x), parseInt(y));
                            }
                        });
                        const location = new RoleLocation_1.default();
                        location.coordinate = source;
                        resolve(location);
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _RoleLocationLoader_credential, "f"));
        });
    }
}
_RoleLocationLoader_credential = new WeakMap();
module.exports = RoleLocationLoader;


/***/ }),
/* 62 */
/***/ ((module) => {


class RoleLocation {
}
module.exports = RoleLocation;


/***/ }),
/* 63 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Castle_1 = __importDefault(__webpack_require__(49));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const CastleInformationPage_1 = __importDefault(__webpack_require__(64));
class CastleInformation {
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    NetworkUtils_1.default.get("castle_print.cgi").then(html => {
                        const page = CastleInformation.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    load(roleName) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    this.open().then(page => {
                        const castle = page.findByRoleName(roleName);
                        if (castle === null) {
                            reject();
                        }
                        else {
                            resolve(castle);
                        }
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const castleList = [];
        $(html).find("td").each(function (_idx, td) {
            const text = $(td).text();
            if (text.endsWith(" (自购)")) {
                const name = $(td).prev().text();
                const owner = text.substring(0, text.indexOf(" (自购)"));
                let location = $(td).next().text();
                location = StringUtils_1.default.substringBetween(location, "(", ")");
                let x = StringUtils_1.default.substringBefore(location, ",");
                let y = StringUtils_1.default.substringAfter(location, ",");
                const coordinate = new Coordinate_1.default(parseInt(x), parseInt(y));
                const castle = new Castle_1.default();
                castle.name = name;
                castle.owner = owner;
                castle.coordinate = coordinate;
                castleList.push(castle);
            }
        });
        const page = new CastleInformationPage_1.default();
        page.castleList = castleList;
        return page;
    }
}
module.exports = CastleInformation;


/***/ }),
/* 64 */
/***/ ((module) => {


class CastleInformationPage {
    findByRoleName(roleName) {
        for (const castle of this.castleList) {
            if (castle.owner === roleName) {
                return castle;
            }
        }
        return null;
    }
}
module.exports = CastleInformationPage;


/***/ }),
/* 65 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _NationInformationPageInterceptor_processor;
const NationalInformationPageProcessor_1 = __importDefault(__webpack_require__(66));
class NationInformationPageInterceptor {
    constructor() {
        _NationInformationPageInterceptor_processor.set(this, new NationalInformationPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "map.cgi") {
            return pageText.includes("各国资料");
        }
        return false;
    }
    intercept() {
        __classPrivateFieldGet(this, _NationInformationPageInterceptor_processor, "f").process();
    }
}
_NationInformationPageInterceptor_processor = new WeakMap();
module.exports = NationInformationPageInterceptor;


/***/ }),
/* 66 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _NationalInformationPageProcessor_instances, _NationalInformationPageProcessor_renderEventBoard;
const StringUtils_1 = __importDefault(__webpack_require__(1));
const EventHandler_1 = __importDefault(__webpack_require__(33));
const PageUtils_1 = __importDefault(__webpack_require__(21));
class NationalInformationPageProcessor {
    constructor() {
        _NationalInformationPageProcessor_instances.add(this);
    }
    process() {
        PageUtils_1.default.fixCurrentPageBrokenImages();
        PageUtils_1.default.removeUnusedHyperLinks();
        PageUtils_1.default.removeGoogleAnalyticsScript();
        __classPrivateFieldGet(this, _NationalInformationPageProcessor_instances, "m", _NationalInformationPageProcessor_renderEventBoard).call(this);
    }
}
_NationalInformationPageProcessor_instances = new WeakSet(), _NationalInformationPageProcessor_renderEventBoard = function _NationalInformationPageProcessor_renderEventBoard() {
    $("table:eq(3) tr:eq(1) td:first")
        .attr("id", "eventBoard");
    const eventHtmlList = [];
    $("#eventBoard").html()
        .split("<br>")
        .filter(it => it.endsWith(")"))
        .map(function (it) {
        // noinspection HtmlDeprecatedTag,XmlDeprecatedElement,HtmlDeprecatedAttribute
        const header = "<font color=\"green\">●</font>";
        return StringUtils_1.default.substringAfter(it, header);
    })
        .map(function (it) {
        return EventHandler_1.default.handleWithEventHtml(it);
    })
        .forEach(it => eventHtmlList.push(it));
    let html = "";
    html += "<table style='border-width:0;width:100%;height:100%;margin:auto'>";
    html += "<tbody>";
    eventHtmlList.forEach(it => {
        html += "<tr>";
        html += "<th style='color:green;vertical-align:top'>●</th>";
        html += "<td style='width:100%'>";
        html += it;
        html += "</td>";
        html += "</tr>";
    });
    html += "</tbody>";
    html += "</table>";
    $("#eventBoard").html(html);
};
module.exports = NationalInformationPageProcessor;


/***/ }),
/* 67 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalCareerManagementPageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const PersonalCareerManagementPageProcessor_1 = __importDefault(__webpack_require__(68));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class PersonalCareerManagementPageInterceptor {
    constructor() {
        _PersonalCareerManagementPageInterceptor_processor.set(this, new PersonalCareerManagementPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "mydata.cgi") {
            return pageText.includes("* 转职神殿 *");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isCareerManagementUIEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _PersonalCareerManagementPageInterceptor_processor, "f").process();
        })
            .whenInCastle(() => {
            __classPrivateFieldGet(this, _PersonalCareerManagementPageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_PersonalCareerManagementPageInterceptor_processor = new WeakMap();
module.exports = PersonalCareerManagementPageInterceptor;


/***/ }),
/* 68 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const CareerLoader_1 = __importDefault(__webpack_require__(69));
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const PersonalCareerManagement_1 = __importDefault(__webpack_require__(70));
const PersonalSpell_1 = __importDefault(__webpack_require__(72));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const CommentBoard_1 = __importDefault(__webpack_require__(20));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const AbstractPersonalCareerManagementPageProcessor_1 = __importDefault(__webpack_require__(75));
class PersonalCareerManagementPageProcessor extends AbstractPersonalCareerManagementPageProcessor_1.default {
    doProcessPageParsed(credential, page, context) {
        const candidateList = page.careerList;
        doProcess(credential, candidateList);
    }
}
function doProcess(credential, candidateList) {
    $("table:first td:first").removeAttr("bgcolor");
    $("table:first td:first").removeAttr("height");
    $("table:first td:first").css("text-align", "center");
    $("table:first td:first").css("font-size", "150%");
    $("table:first td:first").css("font-weight", "bold");
    $("table:first td:first").css("background-color", "navy");
    $("table:first td:first").css("color", "greenyellow");
    $("table:first td:first").text("＜＜　 职 业 管 理 　＞＞");
    $("table:first tr:first").next().find("table:first td:first")
        .next().next().next().attr("id", "roleStatus");
    $("img[alt='神官']").parent().prev().attr("id", "messageBoard");
    $("img[alt='神官']").parent().prev().css("color", "white");
    $("table:first").removeAttr("height");
    $("table:first tr:first")
        .next().next().next()
        .html("<td style='background-color:#F8F0E0'>" +
        "<div id='CareerUI'></div><div id='Eden' style='display:none'></div>" +
        "</td>");
    $("#Eden").html("" +
        "<form action='' method='post' id='edenForm'>" +
        "        <input type='hidden' name='id' value='" + credential.id + "'>" +
        "        <input type='hidden' name='pass' value='" + credential.pass + "'>" +
        "        <div id='edenFormPayload' style='display:none'></div>" +
        "        <input type='submit' id='edenSubmit'>" +
        "</form>");
    $("table:first tr:first")
        .next().next().next()
        .after($("<tr><td style='background-color:#F8F0E0;text-align:center'>" +
        "<input type='button' value='返回城市' id='returnButton'>" +
        "<input type='button' value='装备管理' id='itemManagementButton'>" +
        "</td></tr>"));
    $("#returnButton").on("click", function () {
        $("#edenForm").attr("action", "status.cgi");
        $("#edenFormPayload").html("<input type='hidden' name='mode' value='STATUS'>");
        $("#edenSubmit").trigger("click");
    });
    $("#itemManagementButton").on("click", function () {
        $("#edenForm").attr("action", "mydata.cgi");
        $("#edenFormPayload").html("<input type='hidden' name='mode' value='USE_ITEM'>");
        $("#edenSubmit").trigger("click");
    });
    const imageHtml = NpcLoader_1.default.getNpcImageHtml("白皇");
    CommentBoard_1.default.createCommentBoard(imageHtml);
    CommentBoard_1.default.writeMessage("是的，你没有看错，换人了，某幕后黑手不愿意出镜。不过请放心，转职方面我是专业的，毕竟我一直制霸钉耙榜。<br>");
    CommentBoard_1.default.writeMessage("蓝色的职业代表你已经掌握了。我会把为你推荐的职业红色加深标识出来，当然，前提是如果有能推荐的。<br>");
    doRender(credential, candidateList);
}
function doRender(credential, candidateList) {
    let html = "";
    html += "<table style='background-color:#888888;width:100%;text-align:center'>";
    html += "<tbody style='background-color:#F8F0E0'>";
    html += "<tr>";
    html += "<td id='spellCell'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td id='careerCell'>";
    html += "</td>";
    html += "</tr>";
    html += "</toby>";
    html += "</table>";
    $("#CareerUI").html(html);
    new PersonalStatus_1.default(credential).load().then(role => {
        doRenderRoleStatus(role);
        if (role.level > 50) {
            doRenderCareer(credential, role, candidateList);
            doBindCareerButton(credential);
        }
        new PersonalSpell_1.default(credential).open().then(spellPage => {
            const spellList = spellPage.spellList;
            doRenderSpell(credential, role, spellList);
            doBindSpellButton(credential, spellList);
        });
    });
}
function doRenderRoleStatus(role) {
    let html = "";
    html += "<table style='background-color:#888888;border-width:0'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>姓名</th>";
    html += "<th style='background-color:#E0D0B0'>ＬＶ</th>";
    html += "<th style='background-color:#EFE0C0'>ＨＰ</th>";
    html += "<th style='background-color:#E8E8D0'>ＭＰ</th>";
    html += "<th style='background-color:#EFE0C0'>攻击</th>";
    html += "<th style='background-color:#EFE0C0'>防御</th>";
    html += "<th style='background-color:#EFE0C0'>智力</th>";
    html += "<th style='background-color:#EFE0C0'>精神</th>";
    html += "<th style='background-color:#EFE0C0'>速度</th>";
    html += "<th style='background-color:#E0D0B0'>属性</th>";
    html += "<th style='background-color:#E8E8D0'>职业</th>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='background-color:#E8E8D0'>" + role.name + "</td>";
    html += "<td style='background-color:#E0D0B0'>" + role.level + "</td>";
    html += "<td style='background-color:#EFE0C0'>" + role.health + "/" + role.maxHealth + "</td>";
    html += "<td style='background-color:#E8E8D0'>" + role.mana + "/" + role.maxMana + "</td>";
    html += "<td style='background-color:#EFE0C0'>" + role.attack + "</td>";
    html += "<td style='background-color:#EFE0C0'>" + role.defense + "</td>";
    html += "<td style='background-color:#EFE0C0'>" + role.specialAttack + "</td>";
    html += "<td style='background-color:#EFE0C0'>" + role.specialDefense + "</td>";
    html += "<td style='background-color:#EFE0C0'>" + role.speed + "</td>";
    html += "<td style='background-color:#E0D0B0'>" + role.attribute + "</td>";
    html += "<td style='background-color:#E8E8D0'>" + role.career + "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#roleStatus").html(html);
}
function doRenderCareer(credential, role, careerCandidateList) {
    let html = "";
    html += "<table style='background-color:#888888;width:100%;text-align:center'>";
    html += "<tbody style='background-color:#F8F0E0'>";
    html += "<tr>";
    html += "<th colspan='7' style='background-color:#E8E8D0;color:navy;text-align:center;font-weight:bold;font-size:120%'>＜＜ 选 择 新 的 职 业 ＞＞</th>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>战士系</th>";
    html += "<td style='background-color:#EFE0C0;text-align:left'>" +
        "<input type='button' class='CareerUIButton' id='career_0' value='兵士'>" +
        "<input type='button' class='CareerUIButton' id='career_1' value='武士'>" +
        "<input type='button' class='CareerUIButton' id='career_2' value='剑客'>" +
        "<input type='button' class='CareerUIButton' id='career_3' value='剑侠'>" +
        "<input type='button' class='CareerUIButton' id='career_4' value='魔法剑士'>" +
        "<input type='button' class='CareerUIButton' id='career_5' value='暗黑剑士'>" +
        "<input type='button' class='CareerUIButton' id='career_6' value='奥法剑士'>" +
        "<input type='button' class='CareerUIButton' id='career_7' value='魔导剑士'>" +
        "<input type='button' class='CareerUIButton' id='career_8' value='神圣剑士'>" +
        "<input type='button' class='CareerUIButton' id='career_9' value='圣殿武士'>" +
        "<input type='button' class='CareerUIButton' id='career_10' value='剑圣'>" +
        "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>枪系</th>";
    html += "<td style='background-color:#EFE0C0;text-align:left'>" +
        "<input type='button' class='CareerUIButton' id='career_11' value='枪战士'>" +
        "<input type='button' class='CareerUIButton' id='career_12' value='重战士'>" +
        "<input type='button' class='CareerUIButton' id='career_13' value='狂战士'>" +
        "<input type='button' class='CareerUIButton' id='career_14' value='龙战士'>" +
        "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>格斗系</th>";
    html += "<td style='background-color:#EFE0C0;text-align:left'>" +
        "<input type='button' class='CareerUIButton' id='career_15' value='武僧'>" +
        "<input type='button' class='CareerUIButton' id='career_16' value='决斗家'>" +
        "<input type='button' class='CareerUIButton' id='career_17' value='拳王'>" +
        "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>魔术系</th>";
    html += "<td style='background-color:#EFE0C0;text-align:left'>" +
        "<input type='button' class='CareerUIButton' id='career_18' value='术士'>" +
        "<input type='button' class='CareerUIButton' id='career_19' value='魔法师'>" +
        "<input type='button' class='CareerUIButton' id='career_20' value='咒灵师'>" +
        "<input type='button' class='CareerUIButton' id='career_21' value='大魔导士'>" +
        "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>祭司系</th>";
    html += "<td style='background-color:#EFE0C0;text-align:left'>" +
        "<input type='button' class='CareerUIButton' id='career_22' value='牧师'>" +
        "<input type='button' class='CareerUIButton' id='career_23' value='德鲁伊'>" +
        "<input type='button' class='CareerUIButton' id='career_24' value='贤者'>" +
        "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>弓矢系</th>";
    html += "<td style='background-color:#EFE0C0;text-align:left'>" +
        "<input type='button' class='CareerUIButton' id='career_25' value='弓箭士'>" +
        "<input type='button' class='CareerUIButton' id='career_26' value='魔弓手'>" +
        "<input type='button' class='CareerUIButton' id='career_27' value='狙击手'>" +
        "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>游侠系</th>";
    html += "<td style='background-color:#EFE0C0;text-align:left'>" +
        "<input type='button' class='CareerUIButton' id='career_28' value='游侠'>" +
        "<input type='button' class='CareerUIButton' id='career_29' value='巡林客'>" +
        "<input type='button' class='CareerUIButton' id='career_30' value='吟游诗人'>" +
        "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>天位系</th>";
    html += "<td style='background-color:#EFE0C0;text-align:left'>" +
        "<input type='button' class='CareerUIButton' id='career_31' value='小天位'>" +
        "<input type='button' class='CareerUIButton' id='career_32' value='强天位'>" +
        "<input type='button' class='CareerUIButton' id='career_33' value='斋天位'>" +
        "<input type='button' class='CareerUIButton' id='career_34' value='太天位'>" +
        "<input type='button' class='CareerUIButton' id='career_35' value='终极'>" +
        "</td>";
    html += "</tr>";
    html += "</toby>";
    html += "</table>";
    $("#careerCell").html(html);
    // 已经掌握的职业用蓝色标记
    // 没有掌握的职业用红色标记（满级的情况下）
    // 不在转职列表中的按钮删除
    // 当前职业绿色显示
    if (role.masterCareerList.includes("小天位")) {
        $("#career_32").css("color", "blue");
        $("#career_33").css("color", "blue");
        $("#career_34").css("color", "blue");
        $("#career_35").css("color", "blue");
    }
    const careerNames = Object.keys(CareerLoader_1.default.loadCareers());
    for (let i = 0; i < careerNames.length; i++) {
        const careerName = careerNames[i];
        // @ts-ignore
        const careerId = CareerLoader_1.default.loadCareers()[careerName]["id"];
        const buttonId = "career_" + careerId;
        if (role.masterCareerList.includes(careerName)) {
            $("#" + buttonId).css("color", "blue");
        }
        else {
            if (role.level >= 150) {
                if (careerName === role.career) {
                    $("#" + buttonId).css("color", "green");
                    $("#" + buttonId).css("font-weight", "bold");
                }
                else {
                    $("#" + buttonId).css("color", "red");
                    $("#" + buttonId).css("font-weight", "bold");
                }
            }
        }
        if (!careerCandidateList.includes(careerName)) {
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
            $("#" + buttonId).css("font-weight", "normal");
        }
    }
    // 推荐计算
    const recommendations = doCalculateRecommendationCareers(role, careerCandidateList);
    if (recommendations.length > 0) {
        for (const recommendation of recommendations) {
            // @ts-ignore
            const careerId = CareerLoader_1.default.loadCareers()[recommendation]["id"];
            const buttonId = "career_" + careerId;
            if (recommendation === role.career) {
                $("#" + buttonId).css("color", "green");
                $("#" + buttonId).css("font-weight", "bold");
            }
            else {
                $("#" + buttonId).css("color", "red");
                $("#" + buttonId).css("font-weight", "bold");
            }
        }
    }
    if (SetupLoader_1.default.isCareerTransferEntranceDisabled(credential.id)) {
        // 转职入口被关闭了，那就禁止所有的转职按钮。
        for (let i = 0; i < careerNames.length; i++) {
            const careerName = careerNames[i];
            // @ts-ignore
            const careerId = CareerLoader_1.default.loadCareers()[careerName]["id"];
            const buttonId = "career_" + careerId;
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
            $("#" + buttonId).css("font-weight", "normal");
        }
    }
}
function doRenderSpell(credential, role, spellList) {
    let html = "";
    html += "<table style='background-color:#888888;width:100%;text-align:center'>";
    html += "<tbody style='background-color:#F8F0E0'>";
    html += "<tr>";
    html += "<th colspan='7' style='background-color:#E8E8D0;color:navy;text-align:center;font-weight:bold;font-size:120%'>＜＜ 设 置 技 能 ＞＞</th>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>使用</th>";
    html += "<th style='background-color:#EFE0C0'>技能</th>";
    html += "<th style='background-color:#E0D0B0'>威力</th>";
    html += "<th style='background-color:#EFE0C0'>确率</th>";
    html += "<th style='background-color:#E0D0B0'>ＰＰ</th>";
    html += "<th style='background-color:#EFE0C0'>评分</th>";
    html += "<th style='background-color:#E0D0B0'>设置</th>";
    html += "</tr>";
    for (const spell of spellList) {
        const using = spell.name === role.spell;
        html += "<tr>";
        html += "<td style='background-color:#E8E8D0'>" + (using ? "★" : "") + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + spell.name + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + spell.power + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + spell.accuracy + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + spell.pp + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + spell.score + "</td>";
        html += "<td style='background-color:#E0D0B0'>" +
            "<input type='button' class='CareerUIButton' id='set_spell_" + spell.id + "' value='选择'>" +
            "</td>";
        html += "</tr>";
    }
    html += "</toby>";
    html += "</table>";
    $("#spellCell").html(html);
    for (const spell of spellList) {
        const using = spell.name === role.spell;
        if (using) {
            const buttonId = "set_spell_" + spell.id;
            $("#" + buttonId).prop("disabled", true);
        }
    }
}
function doRefresh(credential) {
    new PersonalCareerManagement_1.default(credential).open().then(page => {
        const careerCandidateList = page.careerList;
        $(".CareerUIButton").off("click");
        $("#CareerUI").html("");
        doRender(credential, careerCandidateList);
    });
}
function doBindCareerButton(credential) {
    const careerNames = Object.keys(CareerLoader_1.default.loadCareers());
    for (let i = 0; i < careerNames.length; i++) {
        const careerName = careerNames[i];
        // @ts-ignore
        const careerId = CareerLoader_1.default.loadCareers()[careerName]["id"];
        const buttonId = "career_" + careerId;
        if ($("#" + buttonId).length > 0 && !$("#" + buttonId).prop("disabled")) {
            $("#" + buttonId).on("click", function () {
                const careerId = parseInt($(this).attr("id").split("_")[1]);
                const careerName = CareerLoader_1.default.findCareerById(careerId);
                if (!confirm("请确认要转职到" + careerName + "？")) {
                    return;
                }
                const request = credential.asRequest();
                // @ts-ignore
                request["chara"] = "1";
                // @ts-ignore
                request["mode"] = "JOB_CHANGE";
                // @ts-ignore
                request["syoku_no"] = careerId;
                NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                    MessageBoard_1.default.processResponseMessage(html);
                    doRefresh(credential);
                });
            });
        }
    }
}
function doBindSpellButton(credential, spellList) {
    for (const spell of spellList) {
        const buttonId = "set_spell_" + spell.id;
        if ($("#" + buttonId).length > 0 && !$("#" + buttonId).prop("disabled")) {
            $("#" + buttonId).on("click", function () {
                const spellId = $(this).attr("id").split("_")[2];
                const request = credential.asRequest();
                // @ts-ignore
                request["mode"] = "MAGIC_SET";
                // @ts-ignore
                request["ktec_no"] = spellId;
                NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                    MessageBoard_1.default.processResponseMessage(html);
                    doRefresh(credential);
                });
            });
        }
    }
}
function doCalculateRecommendationCareers(role, careerCandidateList) {
    // 没有满级，不推荐
    if (role.level < 150) {
        return [];
    }
    // 没有掌握全部职业，不推荐
    if (role.masterCareerList.length !== 32) {
        return [];
    }
    const recommendations = [];
    const targetCareerNames = Object.keys(CareerLoader_1.default.loadCareerTransferRequirements());
    for (let i = 0; i < targetCareerNames.length; i++) {
        const name = targetCareerNames[i];
        // @ts-ignore
        const requirement = CareerLoader_1.default.loadCareerTransferRequirements()[name];
        if (role.maxMana >= requirement[0] &&
            role.attack >= requirement[1] &&
            role.defense >= requirement[2] &&
            role.specialAttack >= requirement[3] &&
            role.specialDefense >= requirement[4] &&
            role.speed >= requirement[5]) {
            // 发现了可以推荐的职业
            recommendations.push(name);
        }
    }
    if (recommendations.length === 0) {
        // 没有推荐出来，那么就推荐转职列表中的最后一个吧
        recommendations.push(careerCandidateList[careerCandidateList.length - 1]);
    }
    return recommendations;
}
module.exports = PersonalCareerManagementPageProcessor;


/***/ }),
/* 69 */
/***/ ((module) => {


class CareerLoader {
    static findCareerById(id) {
        const careerNames = Object.keys(CAREERS);
        for (let i = 0; i < careerNames.length; i++) {
            const careerName = careerNames[i];
            // @ts-ignore
            if (CAREERS[careerName]["id"] === id) {
                return careerName;
            }
        }
        return null;
    }
    static loadCareers() {
        return CAREERS;
    }
    static loadCareerTransferRequirements() {
        return CAREER_TRANSFER_REQUIREMENTS;
    }
}
const CAREERS = {
    "兵士": { "id": 0 },
    "武士": { "id": 1 },
    "剑客": { "id": 2 },
    "剑侠": { "id": 3 },
    "魔法剑士": { "id": 4 },
    "暗黑剑士": { "id": 5 },
    "奥法剑士": { "id": 6 },
    "魔导剑士": { "id": 7 },
    "神圣剑士": { "id": 8 },
    "圣殿武士": { "id": 9 },
    "剑圣": { "id": 10 },
    "枪战士": { "id": 11 },
    "重战士": { "id": 12 },
    "狂战士": { "id": 13 },
    "龙战士": { "id": 14 },
    "武僧": { "id": 15 },
    "决斗家": { "id": 16 },
    "拳王": { "id": 17 },
    "术士": { "id": 18 },
    "魔法师": { "id": 19 },
    "咒灵师": { "id": 20 },
    "大魔导士": { "id": 21 },
    "牧师": { "id": 22 },
    "德鲁伊": { "id": 23 },
    "贤者": { "id": 24 },
    "弓箭士": { "id": 25 },
    "魔弓手": { "id": 26 },
    "狙击手": { "id": 27 },
    "游侠": { "id": 28 },
    "巡林客": { "id": 29 },
    "吟游诗人": { "id": 30 },
    "小天位": { "id": 31 },
    "强天位": { "id": 32 },
    "斋天位": { "id": 33 },
    "太天位": { "id": 34 },
    "终极": { "id": 35 }
};
const CAREER_TRANSFER_REQUIREMENTS = {
    '圣殿武士': [900, 225, 225, 325, 225, 275],
    '剑圣': [900, 225, 275, 225, 275, 225],
    '龙战士': [900, 225, 225, 325, 325, 225],
    '拳王': [900, 225, 225, 325, 225, 275],
    '咒灵师': [900, 325, 275, 225, 225, 325],
    '大魔导士': [900, 275, 275, 225, 225, 275],
    '贤者': [900, 275, 225, 225, 275, 325],
    '狙击手': [900, 225, 325, 325, 225, 225],
    '吟游诗人': [900, 225, 325, 225, 325, 225]
};
module.exports = CareerLoader;


/***/ }),
/* 70 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalCareerManagement_credential, _PersonalCareerManagement_townId;
const Role_1 = __importDefault(__webpack_require__(14));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PersonalCareerManagementPage_1 = __importDefault(__webpack_require__(71));
class PersonalCareerManagement {
    constructor(credential, townId) {
        _PersonalCareerManagement_credential.set(this, void 0);
        _PersonalCareerManagement_townId.set(this, void 0);
        __classPrivateFieldSet(this, _PersonalCareerManagement_credential, credential, "f");
        __classPrivateFieldSet(this, _PersonalCareerManagement_townId, townId, "f");
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _PersonalCareerManagement_credential, "f").asRequestMap();
                    if (__classPrivateFieldGet(this, _PersonalCareerManagement_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _PersonalCareerManagement_townId, "f"));
                    }
                    request.set("mode", "CHANGE_OCCUPATION");
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        const page = PersonalCareerManagement.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const role = new Role_1.default();
        $(html).find("input:radio:first")
            .parent()
            .next() // name
            .each((idx, td) => {
            role.name = $(td).text();
        })
            .next() // level
            .each((idx, td) => {
            role.level = parseInt($(td).text());
        })
            .next() // health
            .each((idx, td) => {
            role.parseHealth($(td).text());
        })
            .next() // mana
            .each((idx, td) => {
            role.parseMana($(td).text());
        })
            .next() // attribute
            .each((idx, td) => {
            role.attribute = $(td).text();
        })
            .next() // career
            .each((idx, td) => {
            role.career = $(td).text();
        })
            .parent()
            .find("td:first")
            .next() // cash
            .each((idx, td) => {
            let s = $(td).text();
            s = StringUtils_1.default.substringBefore(s, " GOLD");
            role.cash = parseInt(s);
        });
        const careerCandidateList = [];
        $(html)
            .find("select[name='syoku_no']")
            .find("option")
            .each(function (_idx, option) {
            const value = $(option).val();
            if (value !== "") {
                const career = $(option).text().trim();
                careerCandidateList.push(career);
            }
        });
        const page = new PersonalCareerManagementPage_1.default();
        page.role = role;
        page.careerList = careerCandidateList;
        return page;
    }
}
_PersonalCareerManagement_credential = new WeakMap(), _PersonalCareerManagement_townId = new WeakMap();
module.exports = PersonalCareerManagement;


/***/ }),
/* 71 */
/***/ ((module) => {


class PersonalCareerManagementPage {
}
module.exports = PersonalCareerManagementPage;


/***/ }),
/* 72 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalSpell_credential, _PersonalSpell_townId;
const Spell_1 = __importDefault(__webpack_require__(73));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PersonalSpellPage_1 = __importDefault(__webpack_require__(74));
class PersonalSpell {
    constructor(credential, townId) {
        _PersonalSpell_credential.set(this, void 0);
        _PersonalSpell_townId.set(this, void 0);
        __classPrivateFieldSet(this, _PersonalSpell_credential, credential, "f");
        __classPrivateFieldSet(this, _PersonalSpell_townId, townId, "f");
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _PersonalSpell_credential, "f").asRequestMap();
                    if (__classPrivateFieldGet(this, _PersonalSpell_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _PersonalSpell_townId, "f"));
                    }
                    request.set("mode", "MAGIC");
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        const page = PersonalSpell.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const spellList = [];
        const select = $(html).find("select[name='ktec_no']");
        $(select).find("option").each(function (_idx, option) {
            const spell = new Spell_1.default();
            const id = $(option).val();
            if (id !== "") {
                spell.id = id;
                let s = $(option).text().trim();
                spell.name = StringUtils_1.default.substringBefore(s, "(");
                s = StringUtils_1.default.substringBetween(s, "(", ")");
                const ss = s.split(" | ");
                spell.power = parseInt(StringUtils_1.default.substringAfter(ss[0], "威力:"));
                spell.accuracy = parseInt(StringUtils_1.default.substringAfter(ss[1], "确率:"));
                spell.pp = parseInt(StringUtils_1.default.substringAfter(ss[2], "消费MP:"));
                spellList.push(spell);
            }
        });
        const page = new PersonalSpellPage_1.default();
        page.spellList = spellList;
        return page;
    }
}
_PersonalSpell_credential = new WeakMap(), _PersonalSpell_townId = new WeakMap();
module.exports = PersonalSpell;


/***/ }),
/* 73 */
/***/ ((module) => {


class Spell {
    get score() {
        return this.power * this.accuracy;
    }
}
module.exports = Spell;


/***/ }),
/* 74 */
/***/ ((module) => {


class PersonalSpellPage {
}
module.exports = PersonalSpellPage;


/***/ }),
/* 75 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const PersonalCareerManagement_1 = __importDefault(__webpack_require__(70));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class AbstractPersonalCareerManagementPageProcessor extends PageProcessorCredentialSupport_1.default {
    doProcess(credential, context) {
        const page = PersonalCareerManagement_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        this.doProcessPageParsed(credential, page, context);
    }
}
module.exports = AbstractPersonalCareerManagementPageProcessor;


/***/ }),
/* 76 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalEquipmentManagementPageInterceptor_inTownProcessor, _PersonalEquipmentManagementPageInterceptor_inCastleProcessor, _PersonalEquipmentManagementPageInterceptor_inMapProcessor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const PersonalEquipmentManagementPageProcessor_Castle_1 = __importDefault(__webpack_require__(77));
const PersonalEquipmentManagementPageProcessor_Map_1 = __importDefault(__webpack_require__(88));
const PersonalEquipmentManagementPageProcessor_Town_1 = __importDefault(__webpack_require__(89));
const PageProcessorContext_1 = __importDefault(__webpack_require__(30));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class PersonalEquipmentManagementPageInterceptor {
    constructor() {
        _PersonalEquipmentManagementPageInterceptor_inTownProcessor.set(this, new PersonalEquipmentManagementPageProcessor_Town_1.default());
        _PersonalEquipmentManagementPageInterceptor_inCastleProcessor.set(this, new PersonalEquipmentManagementPageProcessor_Castle_1.default());
        _PersonalEquipmentManagementPageInterceptor_inMapProcessor.set(this, new PersonalEquipmentManagementPageProcessor_Map_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "mydata.cgi") {
            return pageText.includes("＜＜　|||　物品使用．装备　|||　＞＞");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isEquipmentManagementUIEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(townId => {
            const context = new PageProcessorContext_1.default();
            context.set("townId", townId);
            __classPrivateFieldGet(this, _PersonalEquipmentManagementPageInterceptor_inTownProcessor, "f").process(context);
        })
            .whenInCastle(castleName => {
            const context = new PageProcessorContext_1.default();
            context.set("castleName", castleName);
            __classPrivateFieldGet(this, _PersonalEquipmentManagementPageInterceptor_inCastleProcessor, "f").process(context);
        })
            .whenInMap(coordinate => {
            const context = new PageProcessorContext_1.default();
            context.set("coordinate", coordinate.asText());
            __classPrivateFieldGet(this, _PersonalEquipmentManagementPageInterceptor_inMapProcessor, "f").process(context);
        })
            .fork();
    }
}
_PersonalEquipmentManagementPageInterceptor_inTownProcessor = new WeakMap(), _PersonalEquipmentManagementPageInterceptor_inCastleProcessor = new WeakMap(), _PersonalEquipmentManagementPageInterceptor_inMapProcessor = new WeakMap();
module.exports = PersonalEquipmentManagementPageInterceptor;


/***/ }),
/* 77 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalEquipmentManagementPageProcessor_Castle_instances, _PersonalEquipmentManagementPageProcessor_Castle_renderPersonalUI, _PersonalEquipmentManagementPageProcessor_Castle_renderBagUI, _PersonalEquipmentManagementPageProcessor_Castle_renderWarehouseUI;
const Equipment_1 = __importDefault(__webpack_require__(78));
const CastleBank_1 = __importDefault(__webpack_require__(26));
const CastleEquipmentExpressHouse_1 = __importDefault(__webpack_require__(79));
const CastleWarehouse_1 = __importDefault(__webpack_require__(81));
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const TreasureBag_1 = __importDefault(__webpack_require__(85));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const AbstractPersonalEquipmentManagementPageProcessor_1 = __importDefault(__webpack_require__(87));
class PersonalEquipmentManagementPageProcessor_Castle extends AbstractPersonalEquipmentManagementPageProcessor_1.default {
    constructor() {
        super(...arguments);
        _PersonalEquipmentManagementPageProcessor_Castle_instances.add(this);
    }
    doGeneratePageTitleHtml(context) {
        if (context === undefined) {
            return "＜＜  装 备 管 理 （ 城 堡 模 式 ）  ＞＞";
        }
        else {
            const castleName = context.get("castleName");
            return "＜＜  装 备 管 理 （ " + StringUtils_1.default.toTitleString(castleName) + " 城 堡 ）  ＞＞";
        }
    }
    doGenerateRoleLocationHtml(context) {
        if (context === undefined) {
            return "城堡";
        }
        else {
            return context.get("castleName");
        }
    }
    doGenerateWelcomeMessageHtml() {
        return "<b style='font-size:120%;color:wheat'>又来管理您的装备来啦？真是一刻不得闲啊。</b>";
    }
    doBindReturnButton(credential) {
        const html = PageUtils_1.default.generateReturnCastleForm(credential);
        $("#hiddenFormContainer").html(html);
        $("#returnButton").on("click", () => {
            $("#returnCastle").trigger("click");
        });
    }
    doRenderMutablePage(credential, page, context) {
        const bag = page.findTreasureBag();
        if (bag !== null) {
            __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Castle_instances, "m", _PersonalEquipmentManagementPageProcessor_Castle_renderPersonalUI).call(this, credential, page, bag.index, context);
        }
        else {
            // 已经掌握了剑圣职业，说明应该有百宝袋，但是因为某些bug导致百宝袋不可见了，
            // 还是提供有限的百宝袋功能吧，能够放入、取出，但是不能浏览了。
            // 如果有分身了，那也说明曾经掌握过剑圣职业，就算有百宝袋了
            new PersonalStatus_1.default(credential).load().then(role => {
                if (role.masterCareerList.includes("剑圣") || role.hasMirror) {
                    // 真的曾经拥有百宝袋，但是又因为某些bug失去了
                    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Castle_instances, "m", _PersonalEquipmentManagementPageProcessor_Castle_renderPersonalUI).call(this, credential, page, -1, context);
                }
                else {
                    // 是真的没有百宝袋
                    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Castle_instances, "m", _PersonalEquipmentManagementPageProcessor_Castle_renderPersonalUI).call(this, credential, page, -99, context);
                }
            });
        }
    }
}
_PersonalEquipmentManagementPageProcessor_Castle_instances = new WeakSet(), _PersonalEquipmentManagementPageProcessor_Castle_renderPersonalUI = function _PersonalEquipmentManagementPageProcessor_Castle_renderPersonalUI(credential, page, bagIndex, context) {
    $("#bagIndex").text(bagIndex);
    let html = "";
    html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%;margin:auto'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<td style='background-color:darkred;color:wheat;font-weight:bold;font-size:120%;text-align:center' " +
        "colspan='22'>＜ 随 身 装 备 ＞</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>选择</th>";
    html += "<th style='background-color:#EFE0C0'>装备</th>";
    html += "<th style='background-color:#E0D0B0'>名字</th>";
    html += "<th style='background-color:#EFE0C0'>种类</th>";
    html += "<th style='background-color:#E0D0B0'>效果</th>";
    html += "<th style='background-color:#EFE0C0'>重量</th>";
    html += "<th style='background-color:#EFE0C0'>耐久</th>";
    html += "<th style='background-color:#E0D0B0'>职需</th>";
    html += "<th style='background-color:#E0D0B0'>攻需</th>";
    html += "<th style='background-color:#E0D0B0'>防需</th>";
    html += "<th style='background-color:#E0D0B0'>智需</th>";
    html += "<th style='background-color:#E0D0B0'>精需</th>";
    html += "<th style='background-color:#E0D0B0'>速需</th>";
    html += "<th style='background-color:#EFE0C0'>威＋</th>";
    html += "<th style='background-color:#EFE0C0'>重＋</th>";
    html += "<th style='background-color:#EFE0C0'>幸＋</th>";
    html += "<th style='background-color:#E0D0B0'>经验</th>";
    html += "<th style='background-color:#EFE0C0'>属性</th>";
    html += "<th style='background-color:#E8E8D0'>使用</th>";
    html += "<th style='background-color:#E8E8D0'>入袋</th>";
    html += "<th style='background-color:#E8E8D0'>入库</th>";
    html += "<th style='background-color:#E8E8D0'>发送</th>";
    html += "</tr>";
    for (const equipment of page.equipmentList) {
        if (equipment.isGoldenCage || equipment.isTreasureBag) {
            continue;
        }
        html += "<tr>";
        html += "<td style='background-color:#E8E8D0'>";
        if (equipment.selectable) {
            html += "<input type='button' value='选择' " +
                "style='color:grey' " +
                "class='mutableButton-1 select-1' " +
                "id='select1_" + equipment.index + "'>";
        }
        html += "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.usingHTML + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredCareerHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredAttackHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredDefenseHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialAttackHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialDefenseHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpeedHtml + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.additionalPowerHtml + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.additionalWeightHtml + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.additionalLuckHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.experienceHTML + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.attributeHtml + "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        if (equipment.selectable) {
            html += "<input type='button' value='" + equipment.buttonTitle + "' " +
                "class='mutableButton-1 use-1' " +
                "id='use1_" + equipment.index + "'>";
        }
        html += "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        if (equipment.selectable && !equipment.using && bagIndex >= -1) {
            html += "<input type='button' value='入袋' " +
                "class='mutableButton-1 putIntoBag-1' " +
                "id='putIntoBag1_" + equipment.index + "'>";
        }
        html += "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        if (!equipment.using) {
            html += "<input type='button' value='入库' " +
                "class='mutableButton-1 putIntoWarehouse-1' " +
                "id='putIntoWarehouse1_" + equipment.index + "'>";
        }
        html += "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        html += "<input type='button' value='发送' " +
            "class='mutableButton-1 send-1' " +
            "id='send1_" + equipment.index + "' disabled style='display:none'>";
        html += "</td>";
        html += "</tr>";
    }
    // ------------------------------------------------------------------------
    // 装备菜单栏
    // ------------------------------------------------------------------------
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center' colspan='22'>";
    html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<td style='text-align:center;font-weight:bold' colspan='2'>";
    html += "<span style='color:navy'>目前剩余空位数：</span><span style='color:red'>" + page.spaceCount + "</span>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='text-align:left'>";
    html += "<input type='button' id='use1' class='mutableButton-1' value='使用装备'>";
    html += "<input type='button' id='putIntoBag1' class='mutableButton-1' value='放入百宝袋' disabled style='display:none'>";
    html += "<input type='button' id='putIntoWarehouse1' class='mutableButton-1' value='放入仓库'>";
    html += "</td>";
    html += "<td style='text-align:right'>";
    html += "<input type='button' id='openBag' class='mutableButton-1' value='打开百宝袋' disabled style='display:none'>";
    html += "<input type='button' id='closeBag' class='mutableButton-1' value='关闭百宝袋' disabled style='display:none'>";
    html += "<input type='button' id='openWarehouse' class='mutableButton-1' value='打开仓库'>";
    html += "<input type='button' id='closeWarehouse' class='mutableButton-1' value='关闭仓库'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='text-align:left' colspan='2'>";
    html += "<input type='text' id='searchName' size='15' maxlength='20'>";
    html += "<input type='button' id='searchButton' class='mutableButton-1' value='找人'>";
    html += "<select id='peopleSelect'><option value=''>选择发送对象</select>";
    html += "<input type='button' id='sendButton' class='mutableButton-1' value='发送'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='text-align:right' colspan='2'>";
    if (bagIndex >= 0) {
        html += "<input type='button' id='takeGemsOutFromBag' class='mutableButton-1' value='取出袋中全部宝石'>";
    }
    html += "<input type='button' id='putGemsIntoWarehouse' class='mutableButton-1' value='随身宝石全部入库'>";
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#equipmentList").html(html).parent().show();
    new CastleEquipmentExpressHouse_1.default(credential).open().then(expressPage => {
        for (const equipment of expressPage.equipmentList) {
            const index = equipment.index;
            if (equipment.selectable) {
                $("#send1_" + index).prop("disabled", false).show();
            }
            else {
                $("#send1_" + index).remove();
            }
        }
        $(".send-1").on("click", event => {
            const buttonId = $(event.target).attr("id");
            const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
            const s = $("#peopleSelect").val();
            if (s === undefined || s.trim() === "") {
                this.doScrollToPageTitle();
                MessageBoard_1.default.publishWarning("没有选择发送对象！");
                return;
            }
            const bank = new CastleBank_1.default(credential);
            bank.withdraw(10).then(() => {
                new CastleEquipmentExpressHouse_1.default(credential).send(s, [index]).then(() => {
                    bank.deposit().then(() => {
                        this.doRefreshMutablePage(credential, context);
                    });
                });
            });
        });
    });
    // Bind select buttons
    $(".select-1").on("click", event => {
        const buttonId = $(event.target).attr("id");
        if (PageUtils_1.default.isColorGrey(buttonId)) {
            $(event.target).css("color", "blue");
        }
        else if (PageUtils_1.default.isColorBlue(buttonId)) {
            $(event.target).css("color", "grey");
        }
    });
    // Bind use buttons
    $(".use-1").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
        new PersonalEquipmentManagement_1.default(credential).use([index]).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    // Bind put into bag buttons
    $(".putIntoBag-1").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
        new TreasureBag_1.default(credential).putInto([index]).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    // Bind put into warehouse buttons
    $(".putIntoWarehouse-1").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
        new CastleWarehouse_1.default(credential).putInto([index]).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    // Bind use button
    $("#use1").on("click", () => {
        const indexList = [];
        $(".select-1").each((idx, button) => {
            const buttonId = $(button).attr("id");
            if (PageUtils_1.default.isColorBlue(buttonId)) {
                const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                indexList.push(index);
            }
        });
        if (indexList.length === 0) {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有选择物品或装备！");
            return;
        }
        new PersonalEquipmentManagement_1.default(credential).use(indexList).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    // Put into bag
    if (bagIndex >= -1) {
        $("#putIntoBag1").prop("disabled", false).show();
        $("#putIntoBag1").on("click", () => {
            const indexList = [];
            $(".select-1").each((idx, button) => {
                const buttonId = $(button).attr("id");
                if (PageUtils_1.default.isColorBlue(buttonId)) {
                    const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                    indexList.push(index);
                }
            });
            if (indexList.length === 0) {
                this.doScrollToPageTitle();
                MessageBoard_1.default.publishWarning("没有选择物品或装备！");
                return;
            }
            new TreasureBag_1.default(credential).putInto(indexList).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
    }
    // Put into warehouse
    $("#putIntoWarehouse1").on("click", () => {
        const indexList = [];
        $(".select-1").each((idx, button) => {
            const buttonId = $(button).attr("id");
            if (PageUtils_1.default.isColorBlue(buttonId)) {
                const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                indexList.push(index);
            }
        });
        if (indexList.length === 0) {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有选择物品或装备！");
            return;
        }
        new CastleWarehouse_1.default(credential).putInto(indexList).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    // Bind open/close bag buttons
    if (bagIndex >= -1) {
        $("#openBag").prop("disabled", false).show();
        $("#closeBag").prop("disabled", false).show();
        $("#openBag").on("click", () => {
            if ($("#bagState").text() === "on") {
                return;
            }
            $("#bagState").text("on");
            __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Castle_instances, "m", _PersonalEquipmentManagementPageProcessor_Castle_renderBagUI).call(this, credential, page, bagIndex, context);
        });
        $("#closeBag").on("click", () => {
            if ($("#bagState").text() === "off") {
                return;
            }
            $("#bagState").text("off");
            PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-2");
            $("#bagList").html("").parent().hide();
        });
    }
    // Bind open/close warehouse buttons
    $("#openWarehouse").on("click", () => {
        if ($("#warehouseState").text() === "on") {
            return;
        }
        $("#warehouseState").text("on");
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Castle_instances, "m", _PersonalEquipmentManagementPageProcessor_Castle_renderWarehouseUI).call(this, credential, page, context);
    });
    $("#closeWarehouse").on("click", () => {
        if ($("#warehouseState").text() === "off") {
            return;
        }
        $("#warehouseState").text("off");
        PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-3");
        $("#warehouseList").html("").parent().hide();
    });
    $("#searchButton").on("click", () => {
        const s = $("#searchName").val();
        if (s === undefined || s.trim() === "") {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有正确输入人名！");
            return;
        }
        new CastleEquipmentExpressHouse_1.default(credential).search(s).then(optionListHtml => {
            $("#peopleSelect").html(optionListHtml);
        });
    });
    $("#sendButton").on("click", () => {
        const indexList = [];
        $(".select-1").each((idx, button) => {
            const buttonId = $(button).attr("id");
            if (PageUtils_1.default.isColorBlue(buttonId)) {
                const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                indexList.push(index);
            }
        });
        if (indexList.length === 0) {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有选择物品或装备！");
            return;
        }
        const s = $("#peopleSelect").val();
        if (s === undefined || s.trim() === "") {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有选择发送对象！");
            return;
        }
        const bank = new CastleBank_1.default(credential);
        bank.withdraw(10).then(() => {
            new CastleEquipmentExpressHouse_1.default(credential).send(s, indexList).then(() => {
                bank.deposit().then(() => {
                    this.doRefreshMutablePage(credential, context);
                });
            });
        });
    });
    $("#takeGemsOutFromBag").on("click", () => {
        const bag = new TreasureBag_1.default(credential);
        bag.open(bagIndex).then(bagPage => {
            let count = 0;
            const indexList = [];
            for (const equipment of bagPage.equipmentList) {
                if (equipment.name.endsWith("宝石")) {
                    count++;
                    if (count <= page.spaceCount) {
                        indexList.push(equipment.index);
                    }
                }
            }
            if (indexList.length === 0) {
                // Nothing found, ignore
                return;
            }
            bag.takeOut(indexList).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
    });
    $("#putGemsIntoWarehouse").on("click", () => {
        $(".select-1").each((idx, button) => {
            const buttonId = $(button).attr("id");
            const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
            const equipment = page.findEquipment(index);
            if (equipment !== null && equipment.name.endsWith("宝石")) {
                $("#" + buttonId).css("color", "blue");
            }
            else {
                $("#" + buttonId).css("color", "grey");
            }
        });
        $("#putIntoWarehouse1").trigger("click");
    });
    // Render bag or warehouse if necessary
    if ($("#bagState").text() === "on") {
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Castle_instances, "m", _PersonalEquipmentManagementPageProcessor_Castle_renderBagUI).call(this, credential, page, bagIndex, context);
    }
    if ($("#warehouseState").text() === "on") {
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Castle_instances, "m", _PersonalEquipmentManagementPageProcessor_Castle_renderWarehouseUI).call(this, credential, page, context);
    }
}, _PersonalEquipmentManagementPageProcessor_Castle_renderBagUI = function _PersonalEquipmentManagementPageProcessor_Castle_renderBagUI(credential, page, bagIndex, context) {
    if (bagIndex < 0) {
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold;font-size:120%;text-align:center'>＜ 百 宝 袋 ＞</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0;text-align:center;color:navy;font-weight:bold'>百宝袋丢失了呀？那只能为您提供受限的功能了。</th>";
        html += "</tr>";
        // ----------------------------------------------------------------
        // 百宝袋菜单栏
        // ----------------------------------------------------------------
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0;text-align:center'>";
        html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='text-align:left'>";
        if (page.spaceCount > 0) {
            html += "<input type='button' class='mutableButton-2' " +
                "id='tryTakeOutFromBag2' " +
                "value='从百宝袋中盲取'>";
        }
        html += "</td>";
        html += "<td style='text-align:right'>";
        html += "<input type='button' id='closeBag2' class='mutableButton-2' value='关闭百宝袋'>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#bagList").html(html).parent().show();
        $("#tryTakeOutFromBag2").on("click", () => {
            new TreasureBag_1.default(credential).tryTakeOut(page.spaceCount).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
        $("#closeBag2").on("click", () => {
            if ($("#bagState").text() === "off") {
                return;
            }
            $("#bagState").text("off");
            PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-2");
            $("#bagList").html("").parent().hide();
        });
        return;
    }
    new TreasureBag_1.default(credential).open(bagIndex).then(bagPage => {
        const equipmentList = bagPage.sortedEquipmentList;
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold;font-size:120%;text-align:center' colspan='11'>＜ 百 宝 袋 ＞</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>选择</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#EFE0C0'>威＋</th>";
        html += "<th style='background-color:#EFE0C0'>重＋</th>";
        html += "<th style='background-color:#EFE0C0'>幸＋</th>";
        html += "<th style='background-color:#E0D0B0'>经验</th>";
        html += "<th style='background-color:#E8E8D0'>取出</th>";
        html += "</tr>";
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (page.spaceCount > 0) {
                html += "<input type='button' value='选择' " +
                    "style='color:grey' " +
                    "class='mutableButton-2 select-2' " +
                    "id='select2_" + equipment.index + "'>";
            }
            html += "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalPowerHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalWeightHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalLuckHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.experienceHTML + "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (page.spaceCount > 0) {
                html += "<input type='button' value='出袋' " +
                    "class='mutableButton-2 takeOutBag-2' " +
                    "id='takeOutBag1_" + equipment.index + "'>";
            }
            html += "</td>";
            html += "</tr>";
        }
        // ----------------------------------------------------------------
        // 百宝袋菜单栏
        // ----------------------------------------------------------------
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0;text-align:center' colspan='11'>";
        html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='text-align:left'>";
        if (page.spaceCount > 0) {
            html += "<input type='button' class='mutableButton-2' " +
                "id='takeOutFromBag2' " +
                "value='从百宝袋中取出'>";
        }
        html += "</td>";
        html += "<td style='text-align:right'>";
        html += "<input type='button' id='closeBag2' class='mutableButton-2' value='关闭百宝袋'>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#bagList").html(html).parent().show();
        // Bind select buttons
        $(".select-2").on("click", event => {
            const buttonId = $(event.target).attr("id");
            if (PageUtils_1.default.isColorGrey(buttonId)) {
                $(event.target).css("color", "blue");
            }
            else if (PageUtils_1.default.isColorBlue(buttonId)) {
                $(event.target).css("color", "grey");
            }
        });
        // Bind take out buttons
        $(".takeOutBag-2").on("click", event => {
            const buttonId = $(event.target).attr("id");
            const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
            new TreasureBag_1.default(credential).takeOut([index]).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
        $("#takeOutFromBag2").on("click", () => {
            const indexList = [];
            $(".select-2").each((idx, button) => {
                const buttonId = $(button).attr("id");
                if (PageUtils_1.default.isColorBlue(buttonId)) {
                    const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                    indexList.push(index);
                }
            });
            if (indexList.length === 0) {
                this.doScrollToPageTitle();
                MessageBoard_1.default.publishWarning("没有选择百宝袋中的物品或装备！");
                return;
            }
            new TreasureBag_1.default(credential).takeOut(indexList).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
        $("#closeBag2").on("click", () => {
            if ($("#bagState").text() === "off") {
                return;
            }
            $("#bagState").text("off");
            PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-2");
            $("#bagList").html("").parent().hide();
        });
    });
}, _PersonalEquipmentManagementPageProcessor_Castle_renderWarehouseUI = function _PersonalEquipmentManagementPageProcessor_Castle_renderWarehouseUI(credential, page, context) {
    new CastleWarehouse_1.default(credential).open().then(warehousePage => {
        const equipmentList = Equipment_1.default.sortEquipmentList(warehousePage.storageEquipmentList);
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkred;color:wheat;font-weight:bold' " +
            "colspan='18'>";
        html += "＜ 城 堡 仓 库 ＞";
        html += "</td>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>选择</th>";
        html += "<th style='background-color:#E8E8D0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#E0D0B0'>耐久</th>";
        html += "<th style='background-color:#EFE0C0'>职业</th>";
        html += "<th style='background-color:#E0D0B0'>攻击</th>";
        html += "<th style='background-color:#E0D0B0'>防御</th>";
        html += "<th style='background-color:#E0D0B0'>智力</th>";
        html += "<th style='background-color:#E0D0B0'>精神</th>";
        html += "<th style='background-color:#E0D0B0'>速度</th>";
        html += "<th style='background-color:#EFE0C0'>威力</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>幸运</th>";
        html += "<th style='background-color:#E0D0B0'>经验</th>";
        html += "<th style='background-color:#E0D0B0'>属性</th>";
        html += "<th style='background-color:#E8E8D0'>取出</th>";
        html += "</tr>";
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (page.spaceCount > 0) {
                if (page.spaceCount > 0) {
                    html += "<input type='button' value='选择' " +
                        "style='color:grey' " +
                        "class='mutableButton-3 select-3' " +
                        "id='select3_" + equipment.index + "'>";
                }
            }
            html += "</td>";
            html += "<td style='background-color:#E8E8D0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.requiredCareerHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpeedHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalPowerHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalWeightHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalLuckHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.experienceHTML + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.attributeHtml + "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (page.spaceCount > 0) {
                html += "<input type='button' class='mutableButton-3 takeOutFromWarehouse-3' " +
                    "id='takeOutFromWarehouse3_" + equipment.index + "' value='出库'>";
            }
            html += "</td>";
            html += "</tr>";
        }
        // ----------------------------------------------------------------
        // 城堡仓库菜单栏
        // ----------------------------------------------------------------
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0;text-align:center' colspan='18'>";
        html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='text-align:left'>";
        if (page.spaceCount > 0) {
            html += "<input type='button' class='mutableButton-3' " +
                "id='takeOutFromWarehouse3' " +
                "value='从仓库中取出'>";
        }
        html += "</td>";
        html += "<td style='text-align:right'>";
        html += "<input type='button' id='closeWarehouse3' class='mutableButton-3' value='关闭仓库'>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#warehouseList").html(html).parent().show();
        // Bind select buttons
        $(".select-3").on("click", event => {
            const buttonId = $(event.target).attr("id");
            if (PageUtils_1.default.isColorGrey(buttonId)) {
                $(event.target).css("color", "blue");
            }
            else if (PageUtils_1.default.isColorBlue(buttonId)) {
                $(event.target).css("color", "grey");
            }
        });
        // Bind take out buttons
        $(".takeOutFromWarehouse-3").on("click", event => {
            const buttonId = $(event.target).attr("id");
            const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
            new CastleWarehouse_1.default(credential).takeOut([index]).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
        $("#takeOutFromWarehouse3").on("click", () => {
            const indexList = [];
            $(".select-3").each((idx, button) => {
                const buttonId = $(button).attr("id");
                if (PageUtils_1.default.isColorBlue(buttonId)) {
                    const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                    indexList.push(index);
                }
            });
            if (indexList.length === 0) {
                this.doScrollToPageTitle();
                MessageBoard_1.default.publishWarning("没有选择仓库中的物品或装备！");
                return;
            }
            new CastleWarehouse_1.default(credential).takeOut(indexList).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
        $("#closeWarehouse3").on("click", () => {
            if ($("#warehouseState").text() === "off") {
                return;
            }
            $("#warehouseState").text("off");
            PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-3");
            $("#warehouseList").html("").parent().hide();
        });
    });
};
module.exports = PersonalEquipmentManagementPageProcessor_Castle;


/***/ }),
/* 78 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PROHIBIT_SELLING_ITEM_LIST = [
    "千与千寻",
    "勿忘我",
    "神枪 永恒",
    "霸邪斧 天煌",
    "魔刀 哭杀",
    "神器 苍穹",
    "魔神器 幻空",
    "真·圣剑 苍白的正义",
    "双经斩",
    "千幻碧水猿洛克奇斯",
    "地纹玄甲龟斯特奥特斯",
    "幽冥黑鳞蟒罗尼科斯",
    "火睛混沌兽哈贝达",
    "羽翅圣光虎阿基勒斯",
    "金翅追日鹰庞塔雷斯",
    "风翼三足凤纳托利斯",
    "圣皇铠甲 天威",
    "薄翼甲",
    "魔盔 虚无",
    "神冠 灵通",
    "龙",
    "玉佩",
    "宠物蛋"
];
const NO_EXPERIENCE_ITEM_LIST = [
    "大师球",
    "宗师球",
    "超力怪兽球",
    "宠物蛋"
];
const NONE_REPAIRABLE_ITEM_LIST = [
    "大师球",
    "宗师球",
    "超力怪兽球",
    "宠物蛋"
];
const ATTRIBUTE_HEAVY_ARMOR_ITEM_LIST = [
    "千幻碧水猿洛克奇斯",
    "地纹玄甲龟斯特奥特斯",
    "幽冥黑鳞蟒罗尼科斯",
    "火睛混沌兽哈贝达",
    "羽翅圣光虎阿基勒斯",
    "金翅追日鹰庞塔雷斯",
    "风翼三足凤纳托利斯"
];
class Equipment {
    parseName(nameHtml) {
        this.nameHTML = PageUtils_1.default.fixBrokenImageIfNecessary(nameHtml);
        const s = PageUtils_1.default.convertHtmlToText(this.nameHTML);
        if (s.startsWith("齐心★")) {
            this.star = true;
            this.name = StringUtils_1.default.substringAfter(s, "齐心★");
        }
        else {
            this.star = false;
            this.name = s;
        }
    }
    parseEndure(endureText) {
        if (endureText.includes("/")) {
            const a = StringUtils_1.default.substringBeforeSlash(endureText);
            const b = StringUtils_1.default.substringAfterSlash(endureText);
            this.endure = parseInt(a);
            this.maxEndure = parseInt(b);
        }
        else {
            this.endure = parseInt(endureText);
        }
    }
    parseGemCount(gemCountText) {
        if (gemCountText.includes("/")) {
            const a = StringUtils_1.default.substringBeforeSlash(gemCountText);
            const b = StringUtils_1.default.substringAfterSlash(gemCountText);
            this.gemCount = parseInt(a);
            this.maxGemCount = parseInt(b);
        }
        else {
            this.endure = parseInt(gemCountText);
        }
    }
    parsePrice(priceHtml) {
        this.priceHTML = priceHtml;
        let s = PageUtils_1.default.convertHtmlToText(priceHtml);
        if (s.includes(" ")) {
            s = StringUtils_1.default.substringBefore(s, " ");
        }
        this.price = parseInt(s);
    }
    get categoryOrder() {
        if (this.isWeapon) {
            return 1;
        }
        if (this.isArmor) {
            return 2;
        }
        if (this.isAccessory) {
            return 3;
        }
        if (this.isItem) {
            return 4;
        }
        return 0;
    }
    get isWeapon() {
        return this.category === "武器";
    }
    get isArmor() {
        return this.category === "防具";
    }
    get isAccessory() {
        return this.category === "饰品";
    }
    get isItem() {
        return this.category === "物品";
    }
    get isTreasureBag() {
        return this.isItem && this.name === "百宝袋";
    }
    get isGoldenCage() {
        return this.isItem && this.name === "黄金笼子";
    }
    get isSellable() {
        if (this.selectable !== undefined && !this.selectable) {
            return false;
        }
        if (this.using !== undefined && this.using) {
            return false;
        }
        for (const it of PROHIBIT_SELLING_ITEM_LIST) {
            if (this.name.endsWith(it)) {
                return false;
            }
        }
        return true;
    }
    get isRepairable() {
        if (this.isItem) {
            return this.name.includes("(自动)");
        }
        else {
            return !NONE_REPAIRABLE_ITEM_LIST.includes(this.name);
        }
    }
    get isStorable() {
        if (this.using) {
            return false;
        }
        if (this.isItem) {
            return false;
        }
        return !NONE_REPAIRABLE_ITEM_LIST.includes(this.name);
    }
    get fullExperienceRatio() {
        if (this.isItem) {
            return -1;
        }
        if (NO_EXPERIENCE_ITEM_LIST.includes(this.name)) {
            return -1;
        }
        let maxExperience = 0;
        if (isAttributeHeavyArmor(this.name)) {
            // 属性重铠满级经验为76000
            maxExperience = 76000;
        }
        else if (this.power !== 0) {
            const powerForUse = Math.abs(this.power);
            maxExperience = Math.floor(powerForUse * 0.2) * 1000;
        }
        if (maxExperience === 0) {
            return -1;
        }
        if (this.experience >= maxExperience) {
            return 1;
        }
        if (this.experience === 0) {
            return 0;
        }
        return this.experience / maxExperience;
    }
    get checkboxHTML() {
        if (this.selectable) {
            return "<input type='checkbox' name='item" + this.index + "' value='" + this.index + "' class='personal_checkbox'>";
        }
        else {
            return "";
        }
    }
    get usingHTML() {
        if (!this.using) {
            return "";
        }
        if (this.experience === undefined) {
            return "★";
        }
        const ratio = this.fullExperienceRatio;
        if (ratio === 1 || ratio < 0) {
            return "<span title='装备中' style='color:red'>★</span>";
        }
        else {
            return "<span title='装备中'>★</span>";
        }
    }
    get experienceHTML() {
        if (this.isItem) {
            if (this.name === "藏宝图") {
                const coordinate = new Coordinate_1.default(this.power, this.weight);
                if (!coordinate.isAvailable) {
                    return "<b style='color:red'>活动图</b>";
                }
                const town = TownLoader_1.default.getTownByCoordinate(coordinate);
                if (town !== null) {
                    return "<b style='color:red'>" + town.name + "</b>";
                }
                else {
                    return "-";
                }
            }
            else {
                return "-";
            }
        }
        const ratio = this.fullExperienceRatio;
        if (ratio < 0) {
            return "-";
        }
        if (ratio === 1) {
            return "<span style='color:red' title='" + this.experience + "'>MAX</span>";
        }
        const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
        return "<span title='" + this.experience + " (" + (ratio * 100).toFixed(2) + "%)'>" + progressBar + "</span>";
    }
    get fullName() {
        if (this.star) {
            return "齐心★" + this.name;
        }
        else {
            return this.name;
        }
    }
    get endureHtml() {
        if (this.isItem && !this.name.includes("自动")) {
            return "-";
        }
        if (this.maxEndure === undefined) {
            return this.endure.toString();
        }
        else {
            return this.endure + "/" + this.maxEndure;
        }
    }
    get gemCountHtml() {
        if (this.maxGemCount === undefined) {
            if (this.gemCount === undefined || this.gemCount === 0) {
                return "-";
            }
            else {
                return this.gemCount.toString();
            }
        }
        else {
            return "<span style='color:red'>" + this.gemCount + "</span> / <span style='color:red'>" + this.maxGemCount + "</span>";
        }
    }
    get requiredCareerHtml() {
        if (this.requiredCareer === undefined || this.requiredCareer === "所有职业") {
            return "-";
        }
        return this.requiredCareer;
    }
    get requiredAttackHtml() {
        if (this.requiredAttack === undefined || this.requiredAttack === 0) {
            return "-";
        }
        return this.requiredAttack.toString();
    }
    get requiredDefenseHtml() {
        if (this.requiredDefense === undefined || this.requiredDefense === 0) {
            return "-";
        }
        return this.requiredDefense.toString();
    }
    get requiredSpecialAttackHtml() {
        if (this.requiredSpecialAttack === undefined || this.requiredSpecialAttack === 0) {
            return "-";
        }
        return this.requiredSpecialAttack.toString();
    }
    get requiredSpecialDefenseHtml() {
        if (this.requiredSpecialDefense === undefined || this.requiredSpecialDefense === 0) {
            return "-";
        }
        return this.requiredSpecialDefense.toString();
    }
    get requiredSpeedHtml() {
        if (this.requiredSpeed === undefined || this.requiredSpeed === 0) {
            return "-";
        }
        return this.requiredSpeed.toString();
    }
    get additionalPowerHtml() {
        if (this.additionalPower === undefined || this.additionalPower === 0) {
            return "-";
        }
        return this.additionalPower.toString();
    }
    get additionalWeightHtml() {
        if (this.additionalWeight === undefined || this.additionalWeight === 0) {
            return "-";
        }
        return this.additionalWeight.toString();
    }
    get additionalLuckHtml() {
        if (this.additionalLuck === undefined || this.additionalLuck === 0) {
            return "-";
        }
        return this.additionalLuck.toString();
    }
    get attributeHtml() {
        if (this.attribute === undefined || this.attribute === "无") {
            return "-";
        }
        return this.attribute;
    }
    get buttonTitle() {
        if (this.isItem) {
            return "使用";
        }
        let title = "装备";
        if (this.using) {
            title = "卸下";
        }
        return title;
    }
    static sortEquipmentList(source) {
        const target = [];
        target.push(...source);
        if (!SetupLoader_1.default.isEquipmentPetSortEnabled()) {
            return target;
        }
        target.sort((a, b) => {
            let ret = a.categoryOrder - b.categoryOrder;
            if (ret !== 0) {
                return ret;
            }
            let a1 = a.star ? 1 : 0;
            let b1 = b.star ? 1 : 0;
            ret = a1 - b1;
            if (ret !== 0) {
                return ret;
            }
            ret = b.power - a.power;
            if (ret !== 0) {
                return ret;
            }
            ret = a.fullName.localeCompare(b.fullName);
            if (ret !== 0) {
                return ret;
            }
            return b.additionalPower - a.additionalPower;
        });
        return target;
    }
}
function isAttributeHeavyArmor(name) {
    for (const it of ATTRIBUTE_HEAVY_ARMOR_ITEM_LIST) {
        if (name.endsWith(it)) {
            return true;
        }
    }
    return false;
}
module.exports = Equipment;


/***/ }),
/* 79 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleEquipmentExpressHouse_credential;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Role_1 = __importDefault(__webpack_require__(14));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const CastleEquipmentExpressHousePage_1 = __importDefault(__webpack_require__(80));
class CastleEquipmentExpressHouse {
    constructor(credential) {
        _CastleEquipmentExpressHouse_credential.set(this, void 0);
        __classPrivateFieldSet(this, _CastleEquipmentExpressHouse_credential, credential, "f");
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _CastleEquipmentExpressHouse_credential, "f").asRequestMap();
                    request.set("mode", "CASTLE_SENDITEM");
                    NetworkUtils_1.default.post("castle.cgi", request).then(html => {
                        const page = CastleEquipmentExpressHouse.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    search(name) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (name.trim() === "") {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _CastleEquipmentExpressHouse_credential, "f").asRequestMap();
                    request.set("mode", "CASTLE_SENDITEM");
                    // noinspection JSDeprecatedSymbols
                    request.set("serch", escape(name.trim()));
                    NetworkUtils_1.default.post("castle.cgi", request).then(html => {
                        const optionListHtml = $(html).find("select:first").html();
                        resolve(optionListHtml);
                    });
                });
            })();
        });
    }
    send(target, indexList) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (target.trim() === "" || indexList.length === 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _CastleEquipmentExpressHouse_credential, "f").asRequestMap();
                    request.set("mode", "CASTLE_SENDITEM2");
                    request.set("eid", target.trim());
                    for (const index of indexList) {
                        request.set("item" + index, index.toString());
                    }
                    NetworkUtils_1.default.post("castle.cgi", request).then(html => {
                        if (html.includes("所持金不足")) {
                            reject();
                        }
                        else {
                            MessageBoard_1.default.processResponseMessage(html);
                            resolve();
                        }
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const role = new Role_1.default();
        $(html).find("td:contains('ＬＶ')")
            .filter((idx, td) => $(td).text() === "ＬＶ")
            .closest("tr")
            .next()
            .find("td:first")
            .each((idx, td) => {
            role.name = $(td).text();
        })
            .next()
            .each((idx, td) => {
            role.level = parseInt($(td).text());
        })
            .next()
            .each((idx, td) => {
            let s = $(td).text();
            role.attribute = StringUtils_1.default.substringBefore(s, "属");
        })
            .next()
            .each((idx, td) => {
            role.career = $(td).text();
        })
            .parent()
            .next()
            .find("td:first")
            .next()
            .each((idx, td) => {
            let s = $(td).text();
            s = StringUtils_1.default.substringBefore(s, " GOLD");
            role.cash = parseInt(s);
        });
        const equipmentList = [];
        $(html).find("input:checkbox")
            .each((idx, checkbox) => {
            const equipment = new Equipment_1.default();
            let s = $(checkbox).val();
            equipment.index = parseInt(s);
            equipment.selectable = !$(checkbox).prop("disabled");
            const c1 = $(checkbox).parent();
            const c2 = c1.next();
            const c3 = c2.next();
            const c4 = c3.next();
            const c5 = c4.next();
            const c6 = c5.next();
            equipment.using = c2.text() === "★";
            equipment.parseName(c3.html());
            equipment.category = c4.text();
            equipment.power = parseInt(c5.text());
            equipment.weight = parseInt(c6.text());
            equipmentList.push(equipment);
        });
        const page = new CastleEquipmentExpressHousePage_1.default();
        page.role = role;
        page.equipmentList = equipmentList;
        return page;
    }
}
_CastleEquipmentExpressHouse_credential = new WeakMap();
module.exports = CastleEquipmentExpressHouse;


/***/ }),
/* 80 */
/***/ ((module) => {


class CastleEquipmentExpressHousePage {
    canSend(index) {
        for (const equipment of this.equipmentList) {
            if (equipment.index === index) {
                return equipment.selectable;
            }
        }
        return false;
    }
}
module.exports = CastleEquipmentExpressHousePage;


/***/ }),
/* 81 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleWarehouse_credential;
const Equipment_1 = __importDefault(__webpack_require__(78));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const CastleWarehousePage_1 = __importDefault(__webpack_require__(82));
class CastleWarehouse {
    constructor(credential) {
        _CastleWarehouse_credential.set(this, void 0);
        __classPrivateFieldSet(this, _CastleWarehouse_credential, credential, "f");
    }
    static parsePage(pageHtml) {
        return doParsePage(pageHtml);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise(resolve => {
                    const request = credential.asRequestMap();
                    request.set("mode", "CASTLE_ITEM");
                    NetworkUtils_1.default.post("castle.cgi", request)
                        .then(pageHtml => {
                        const page = CastleWarehouse.parsePage(pageHtml);
                        resolve(page);
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _CastleWarehouse_credential, "f"));
        });
    }
    putInto(indexList) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    if (indexList.length === 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _CastleWarehouse_credential, "f").asRequestMap();
                    for (const index of indexList) {
                        request.set("item" + index, index.toString());
                    }
                    request.set("chara", "1");
                    request.set("mode", "CASTLE_ITEMSTORE");
                    NetworkUtils_1.default.post("castle.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
    takeOut(indexList) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    if (indexList.length === 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _CastleWarehouse_credential, "f").asRequestMap();
                    for (const index of indexList) {
                        request.set("item" + index, index.toString());
                    }
                    request.set("chara", "1");
                    request.set("mode", "CASTLE_ITEMWITHDRAW");
                    NetworkUtils_1.default.post("castle.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
}
_CastleWarehouse_credential = new WeakMap();
function doParsePage(pageHtml) {
    const page = new CastleWarehousePage_1.default();
    const s = $(pageHtml).find("td:contains('所持金')")
        .filter(function () {
        return $(this).text() === "所持金";
    })
        .next()
        .text();
    page.roleCash = parseInt(StringUtils_1.default.substringBefore(s, " GOLD"));
    page.personalEquipmentList = __parseCastleWareHousePersonalEquipmentList(pageHtml);
    page.storageEquipmentList = __parseCastleWareHouseStorageEquipmentList(pageHtml);
    return page;
}
function __parseCastleWareHousePersonalEquipmentList(pageHtml) {
    const equipmentList = [];
    $(pageHtml).find("table")
        .filter(function (_idx) {
        return _idx == 2;
    })
        .each(function (_idx, element) {
        $(element).find("input:checkbox")
            .each(function (_idx, checkbox) {
            const c0 = $(checkbox).parent();
            const c1 = c0.next();
            const c2 = c1.next();
            const c3 = c2.next();
            const c4 = c3.next();
            const c5 = c4.next();
            const c6 = c5.next();
            const c7 = c6.next();
            const c8 = c7.next();
            const c9 = c8.next();
            const c10 = c9.next();
            const c11 = c10.next();
            const c12 = c11.next();
            const c13 = c12.next();
            const c14 = c13.next();
            const c15 = c14.next();
            const c16 = c15.next();
            const c17 = c16.next();
            const equipment = new Equipment_1.default();
            equipment.index = parseInt($(checkbox).val());
            equipment.selectable = !$(checkbox).prop("disabled");
            equipment.using = c1.text() === "★";
            equipment.parseName(c2.html());
            equipment.category = c3.text();
            equipment.power = parseInt(c4.text());
            equipment.weight = parseInt(c5.text());
            equipment.parseEndure(c6.text());
            equipment.requiredCareer = c7.text();
            equipment.requiredAttack = parseInt(c8.text());
            equipment.requiredDefense = parseInt(c9.text());
            equipment.requiredSpecialAttack = parseInt(c10.text());
            equipment.requiredSpecialDefense = parseInt(c11.text());
            equipment.requiredSpeed = parseInt(c12.text());
            equipment.additionalPower = parseInt(c13.text());
            equipment.additionalWeight = parseInt(c14.text());
            equipment.additionalLuck = parseInt(c15.text());
            equipment.experience = parseInt(c16.text());
            equipment.attribute = c17.text();
            equipmentList.push(equipment);
        });
    });
    return equipmentList;
}
function __parseCastleWareHouseStorageEquipmentList(pageHtml) {
    const equipmentList = [];
    $(pageHtml).find("table")
        .filter(function (_idx) {
        return _idx == 3;
    })
        .each(function (_idx, element) {
        $(element).find("input:checkbox")
            .each(function (_idx, checkbox) {
            const c1 = $(checkbox).parent();
            const c2 = $(c1).next();
            const c3 = $(c2).next();
            const c4 = $(c3).next();
            const c5 = $(c4).next();
            const c6 = $(c5).next();
            const c7 = $(c6).next();
            const c8 = $(c7).next();
            const c9 = $(c8).next();
            const c10 = $(c9).next();
            const c11 = $(c10).next();
            const c12 = $(c11).next();
            const c13 = $(c12).next();
            const c14 = $(c13).next();
            const c15 = $(c14).next();
            const c16 = $(c15).next();
            const c17 = $(c16).next();
            const c18 = $(c17).next();
            const equipment = new Equipment_1.default();
            equipment.index = parseInt($(checkbox).val());
            equipment.selectable = true;
            equipment.using = false;
            equipment.parseName($(c3).html());
            equipment.category = $(c4).text();
            equipment.power = parseInt($(c5).text());
            equipment.weight = parseInt($(c6).text());
            equipment.parseEndure($(c7).text());
            equipment.requiredCareer = $(c8).text();
            equipment.requiredAttack = parseInt($(c9).text());
            equipment.requiredDefense = parseInt($(c10).text());
            equipment.requiredSpecialAttack = parseInt($(c11).text());
            equipment.requiredSpecialDefense = parseInt($(c12).text());
            equipment.requiredSpeed = parseInt($(c13).text());
            equipment.additionalPower = parseInt($(c14).text());
            equipment.additionalWeight = parseInt($(c15).text());
            equipment.additionalLuck = parseInt($(c16).text());
            equipment.experience = parseInt($(c17).text());
            equipment.attribute = $(c18).text();
            equipmentList.push(equipment);
        });
    });
    return equipmentList;
}
module.exports = CastleWarehouse;


/***/ }),
/* 82 */
/***/ ((module) => {


class CastleWarehousePage {
}
module.exports = CastleWarehousePage;


/***/ }),
/* 83 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalEquipmentManagement_credential, _PersonalEquipmentManagement_townId;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Role_1 = __importDefault(__webpack_require__(14));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PersonalEquipmentManagementPage_1 = __importDefault(__webpack_require__(84));
class PersonalEquipmentManagement {
    constructor(credential, townId) {
        _PersonalEquipmentManagement_credential.set(this, void 0);
        _PersonalEquipmentManagement_townId.set(this, void 0);
        __classPrivateFieldSet(this, _PersonalEquipmentManagement_credential, credential, "f");
        __classPrivateFieldSet(this, _PersonalEquipmentManagement_townId, townId, "f");
    }
    static parsePage(html) {
        return __parsePage(html);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _PersonalEquipmentManagement_credential, "f").asRequestMap();
                    request.set("mode", "USE_ITEM");
                    if (__classPrivateFieldGet(this, _PersonalEquipmentManagement_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _PersonalEquipmentManagement_townId, "f"));
                    }
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        const page = PersonalEquipmentManagement.parsePage(html);
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    use(indexList) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (indexList.length === 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _PersonalEquipmentManagement_credential, "f").asRequestMap();
                    request.set("chara", "1");
                    for (const index of indexList) {
                        request.set("item" + index, index.toString());
                    }
                    request.set("word", "");
                    request.set("mode", "USE");
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            })();
        });
    }
}
_PersonalEquipmentManagement_credential = new WeakMap(), _PersonalEquipmentManagement_townId = new WeakMap();
function __parsePage(html) {
    const role = new Role_1.default();
    $(html).find("td:contains('ＬＶ')")
        .filter((idx, td) => $(td).text() === "ＬＶ")
        .closest("tr")
        .next()
        .find("td:first")
        .each((idx, td) => {
        role.name = $(td).text();
    })
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        role.level = parseInt(s);
    })
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        role.parseHealth(s);
    })
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        role.parseMana(s);
    })
        .next()
        .each((idx, td) => {
        role.attribute = $(td).text();
    })
        .next()
        .each((idx, td) => {
        role.career = $(td).text();
    })
        .parent()
        .next()
        .find("td:first")
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        s = StringUtils_1.default.substringBefore(s, " GOLD");
        role.cash = parseInt(s);
    });
    const page = new PersonalEquipmentManagementPage_1.default();
    page.role = role;
    page.equipmentList = __parseEquipmentList(html);
    return page;
}
function __parseEquipmentList(html) {
    const equipmentList = [];
    $(html).find("input:checkbox").each(function (_idx, checkbox) {
        const equipment = new Equipment_1.default();
        const tr = $(checkbox).parent().parent();
        // index & selectable
        equipment.index = parseInt($(checkbox).val());
        equipment.selectable = !$(checkbox).prop("disabled");
        // using
        let s = $(tr).find("th:first").text();
        equipment.using = (s === "★");
        // name & star
        equipment.parseName($(tr).find("td:eq(1)").html());
        // category
        s = $(tr).find("td:eq(2)").text();
        equipment.category = s;
        // power & weight & endure
        s = $(tr).find("td:eq(3)").text();
        equipment.power = parseInt(s);
        s = $(tr).find("td:eq(4)").text();
        equipment.weight = parseInt(s);
        s = $(tr).find("td:eq(5)").text();
        equipment.endure = parseInt(s);
        // required career
        s = $(tr).find("td:eq(6)").text();
        equipment.requiredCareer = s;
        // required stats
        s = $(tr).find("td:eq(7)").text();
        equipment.requiredAttack = parseInt(s);
        s = $(tr).find("td:eq(8)").text();
        equipment.requiredDefense = parseInt(s);
        s = $(tr).find("td:eq(9)").text();
        equipment.requiredSpecialAttack = parseInt(s);
        s = $(tr).find("td:eq(10)").text();
        equipment.requiredSpecialDefense = parseInt(s);
        s = $(tr).find("td:eq(11)").text();
        equipment.requiredSpeed = parseInt(s);
        // additional
        s = $(tr).find("td:eq(12)").text();
        equipment.additionalPower = parseInt(s);
        s = $(tr).find("td:eq(13)").text();
        equipment.additionalWeight = parseInt(s);
        s = $(tr).find("td:eq(14)").text();
        equipment.additionalLuck = parseInt(s);
        // experience
        s = $(tr).find("td:eq(15)").text();
        equipment.experience = parseInt(s);
        // attribute
        s = $(tr).find("td:eq(16)").text();
        equipment.attribute = s;
        equipmentList.push(equipment);
    });
    return equipmentList;
}
module.exports = PersonalEquipmentManagement;


/***/ }),
/* 84 */
/***/ ((module) => {


class PersonalEquipmentManagementPage {
    get spaceCount() {
        return 20 - this.equipmentList.length;
    }
    findEquipment(index) {
        for (const equipment of this.equipmentList) {
            if (equipment.index === index) {
                return equipment;
            }
        }
        return null;
    }
    findTreasureBag() {
        for (const equipment of this.equipmentList) {
            if (equipment.isTreasureBag) {
                return equipment;
            }
        }
        return null;
    }
    findGoldenCage() {
        for (const equipment of this.equipmentList) {
            if (equipment.isGoldenCage) {
                return equipment;
            }
        }
        return null;
    }
}
module.exports = PersonalEquipmentManagementPage;


/***/ }),
/* 85 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TreasureBag_credential;
const Equipment_1 = __importDefault(__webpack_require__(78));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const TreasureBagPage_1 = __importDefault(__webpack_require__(86));
class TreasureBag {
    constructor(credential) {
        _TreasureBag_credential.set(this, void 0);
        __classPrivateFieldSet(this, _TreasureBag_credential, credential, "f");
    }
    static parsePage(html) {
        const equipmentList = [];
        $(html).find("input:checkbox").each(function (_idx, checkbox) {
            const equipment = new Equipment_1.default();
            const tr = $(checkbox).parent().parent();
            // index & selectable
            equipment.index = parseInt($(checkbox).val());
            equipment.selectable = true;
            // name & star
            equipment.parseName($(tr).find("td:eq(1)").html());
            // category
            let s = $(tr).find("td:eq(2)").text();
            equipment.category = s;
            // power & weight & endure
            s = $(tr).find("td:eq(3)").text();
            equipment.power = parseInt(s);
            s = $(tr).find("td:eq(4)").text();
            equipment.weight = parseInt(s);
            s = $(tr).find("td:eq(5)").text();
            equipment.endure = parseInt(s);
            // additional
            s = $(tr).find("td:eq(6)").text();
            equipment.additionalPower = parseInt(s);
            s = $(tr).find("td:eq(7)").text();
            equipment.additionalWeight = parseInt(s);
            s = $(tr).find("td:eq(8)").text();
            equipment.additionalLuck = parseInt(s);
            // experience
            s = $(tr).find("td:eq(9)").text();
            equipment.experience = parseInt(s);
            equipmentList.push(equipment);
        });
        const page = new TreasureBagPage_1.default();
        page.equipmentList = equipmentList;
        return page;
    }
    open(bagIndex) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    if (bagIndex < 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _TreasureBag_credential, "f").asRequestMap();
                    request.set("chara", "1");
                    request.set("item" + bagIndex, bagIndex.toString());
                    request.set("mode", "USE");
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        const page = TreasureBag.parsePage(html);
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    putInto(indexList) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    if (indexList.length === 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _TreasureBag_credential, "f").asRequestMap();
                    request.set("chara", "1");
                    request.set("mode", "PUTINBAG");
                    for (const index of indexList) {
                        request.set("item" + index, index.toString());
                    }
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
    takeOut(indexList) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    if (indexList.length === 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _TreasureBag_credential, "f").asRequestMap();
                    request.set("mode", "GETOUTBAG");
                    for (const index of indexList) {
                        request.set("item" + index, index.toString());
                    }
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
    tryTakeOut(count) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (count <= 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _TreasureBag_credential, "f").asRequestMap();
                    request.set("mode", "GETOUTBAG");
                    for (let i = 0; i < count; i++) {
                        request.set("item" + i, i.toString());
                    }
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            })();
        });
    }
}
_TreasureBag_credential = new WeakMap();
module.exports = TreasureBag;


/***/ }),
/* 86 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Equipment_1 = __importDefault(__webpack_require__(78));
class TreasureBagPage {
    get sortedEquipmentList() {
        return Equipment_1.default.sortEquipmentList(this.equipmentList);
    }
}
module.exports = TreasureBagPage;


/***/ }),
/* 87 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _AbstractPersonalEquipmentManagementPageProcessor_instances, _AbstractPersonalEquipmentManagementPageProcessor_renderImmutablePage, _AbstractPersonalEquipmentManagementPageProcessor_bindImmutableButtons;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class AbstractPersonalEquipmentManagementPageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _AbstractPersonalEquipmentManagementPageProcessor_instances.add(this);
    }
    doLoadButtonStyles() {
        return [35];
    }
    doProcess(credential, context) {
        const page = PersonalEquipmentManagement_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        __classPrivateFieldGet(this, _AbstractPersonalEquipmentManagementPageProcessor_instances, "m", _AbstractPersonalEquipmentManagementPageProcessor_renderImmutablePage).call(this, credential, page, context);
    }
    doRefreshMutablePage(credential, context) {
        PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-1");
        PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-2");
        PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-3");
        $("#equipmentList").html("").parent().hide();
        $("#bagList").html("").parent().hide();
        $("#warehouseList").html("").parent().hide();
        let townId = undefined;
        if (context !== undefined) {
            townId = context.get("townId");
        }
        new PersonalEquipmentManagement_1.default(credential, townId).open().then(page => {
            this.doRenderRole(page.role);
            this.doRenderMutablePage(credential, page, context);
        });
    }
    doScrollToPageTitle() {
        PageUtils_1.default.scrollIntoView("pageTitle");
    }
    doRenderRole(role) {
        if (role !== undefined) {
            $("#roleHealth").text(role.health + "/" + role.maxHealth);
            $("#roleMana").text(role.mana + "/" + role.maxMana);
            $("#roleCash").text(role.cash + " GOLD");
        }
    }
    doBindSelectButtons(className) {
        $("." + className).on("click", event => {
            const buttonId = $(event.target).attr("id");
            if (PageUtils_1.default.isColorGrey(buttonId)) {
                $(event.target).css("color", "blue");
            }
            else if (PageUtils_1.default.isColorBlue(buttonId)) {
                $(event.target).css("color", "grey");
            }
        });
    }
    doCheckSetConfiguration(config) {
        if (config === null) {
            return false;
        }
        // @ts-ignore
        const a = config["weaponName"];
        // @ts-ignore
        const b = config["armorName"];
        // @ts-ignore
        const c = config["accessoryName"];
        return (a !== undefined && a !== "NONE") || (b !== undefined && b !== "NONE") || (c !== undefined && c !== "NONE");
    }
    doBeforeRenderMutablePage(credential, context) {
    }
}
_AbstractPersonalEquipmentManagementPageProcessor_instances = new WeakSet(), _AbstractPersonalEquipmentManagementPageProcessor_renderImmutablePage = function _AbstractPersonalEquipmentManagementPageProcessor_renderImmutablePage(credential, page, context) {
    // 删除不必要的属性，可能会造成显示格式混乱。
    $("table[height='100%']").removeAttr("height");
    // 定位第一个表格
    const t0 = $("table:first")
        .attr("id", "t0");
    // 标题栏 : pageTitle
    t0.find("tr:first")
        .attr("id", "tr0")
        .find("td:first")
        .attr("id", "pageTitle")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("bgcolor")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .html(this.doGeneratePageTitleHtml(context));
    $("#tr0")
        .next()
        .attr("id", "tr1")
        .find("td:first")
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .attr("id", "roleImage")
        .next()
        .removeAttr("width")
        .css("width", "100%")
        .next().remove();
    $("#roleImage")
        .next()
        .find("table:first")
        .find("tr:first")
        .next()
        .find("td:eq(2)")
        .attr("id", "roleHealth")
        .next()
        .attr("id", "roleMana")
        .parent()
        .next()
        .find("td:last")
        .attr("id", "roleCash")
        .parent()
        .after($("" +
        "<tr>" +
        "<td style='background-color:#E0D0B0'>坐标点</td>" +
        "<td style='background-color:#E8E8D0;text-align:right;font-weight:bold;color:red' " +
        "colspan='5' id='roleLocation'>" + this.doGenerateRoleLocationHtml(context) + "</td>" +
        "</tr>" +
        ""));
    // ------------------------------------------------------------------------
    // 消息面板栏
    // ------------------------------------------------------------------------
    $("#tr1")
        .next()
        .attr("id", "tr2")
        .find("td:first")
        .attr("id", "messageBoardContainer")
        .removeAttr("height");
    MessageBoard_1.default.createMessageBoardStyleB("messageBoardContainer", NpcLoader_1.default.randomNpcImageHtml());
    $("#messageBoard")
        .css("background-color", "black")
        .css("color", "wheat");
    MessageBoard_1.default.resetMessageBoard(this.doGenerateWelcomeMessageHtml());
    // ------------------------------------------------------------------------
    // 隐藏表单栏
    // ------------------------------------------------------------------------
    let html = "";
    html += "<tr id='tr3' style='display:none'>";
    html += "<td id='hiddenFormContainer'>";
    html += "</td>";
    html += "</tr>";
    $("#tr2").after($(html));
    // ------------------------------------------------------------------------
    // 主菜单栏
    // ------------------------------------------------------------------------
    html = "";
    html += "<tr id='tr4'>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' id='refreshButton' value='刷新装备管理' class='button-35'>&nbsp;&nbsp;&nbsp;";
    html += "<input type='button' id='returnButton' value='退出装备管理' class='button-35'>";
    html += "</td>";
    html += "</tr>";
    $("#tr3").after($(html));
    // ------------------------------------------------------------------------
    // 用于保存百宝袋和仓库的状态
    // ------------------------------------------------------------------------
    html = "";
    html += "<tr id='tr5' style='display:none'>";
    html += "<td>";
    html += "<div id='bagIndex'>-99</div>";
    html += "<div id='bagState'>off</div>"; // 仅限有百宝袋
    html += "<div id='warehouseState'>off</div>"; // 仅限城堡
    html += "</td>";
    html += "</tr>";
    $("#tr4").after($(html));
    // ------------------------------------------------------------------------
    // 装备栏目
    // ------------------------------------------------------------------------
    html = "";
    html += "<tr id='tr6' style='display:none'>";
    html += "<td id='equipmentList'></td>";
    html += "</tr>";
    $("#tr5").after($(html));
    // ------------------------------------------------------------------------
    // 百宝袋栏目（仅限有百宝袋）
    // ------------------------------------------------------------------------
    html = "";
    html += "<tr id='tr7' style='display:none'>";
    html += "<td id='bagList'></td>";
    html += "</tr>";
    $("#tr6").after($(html));
    // ------------------------------------------------------------------------
    // 仓库栏目（仅限城堡）
    // ------------------------------------------------------------------------
    html = "";
    html += "<tr id='tr8' style='display:none'>";
    html += "<td id='warehouseList'></td>";
    html += "</tr>";
    $("#tr7").after($(html));
    html = "";
    html += "<tr id='tr9' style='display:none'>";
    html += "<td id='consecrateFormContainer'></td>";
    html += "</tr>";
    $("#tr8").after($(html));
    __classPrivateFieldGet(this, _AbstractPersonalEquipmentManagementPageProcessor_instances, "m", _AbstractPersonalEquipmentManagementPageProcessor_bindImmutableButtons).call(this, credential, context);
    this.doBeforeRenderMutablePage(credential, context);
    this.doRenderMutablePage(credential, page, context);
}, _AbstractPersonalEquipmentManagementPageProcessor_bindImmutableButtons = function _AbstractPersonalEquipmentManagementPageProcessor_bindImmutableButtons(credential, context) {
    this.doBindReturnButton(credential);
    $("#refreshButton").on("click", () => {
        this.doScrollToPageTitle();
        $("#messageBoardManager").html(NpcLoader_1.default.randomNpcImageHtml());
        MessageBoard_1.default.resetMessageBoard(this.doGenerateWelcomeMessageHtml());
        this.doRefreshMutablePage(credential, context);
    });
};
module.exports = AbstractPersonalEquipmentManagementPageProcessor;


/***/ }),
/* 88 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalEquipmentManagementPageProcessor_Map_instances, _PersonalEquipmentManagementPageProcessor_Map_bindSelectPersonalButton, _PersonalEquipmentManagementPageProcessor_Map_bindUseButton, _PersonalEquipmentManagementPageProcessor_Map_bindStoreButton, _PersonalEquipmentManagementPageProcessor_Map_bindOpenBagButton, _PersonalEquipmentManagementPageProcessor_Map_bindCloseBagButton, _PersonalEquipmentManagementPageProcessor_Map_doRenderStorageEquipmentList, _PersonalEquipmentManagementPageProcessor_Map_bindSelectStorageButton, _PersonalEquipmentManagementPageProcessor_Map_bindTakeOutButton;
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const TreasureBag_1 = __importDefault(__webpack_require__(85));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const AbstractPersonalEquipmentManagementPageProcessor_1 = __importDefault(__webpack_require__(87));
class PersonalEquipmentManagementPageProcessor_Map extends AbstractPersonalEquipmentManagementPageProcessor_1.default {
    constructor() {
        super(...arguments);
        _PersonalEquipmentManagementPageProcessor_Map_instances.add(this);
    }
    doGeneratePageTitleHtml(context) {
        return "＜＜  装 备 管 理 （ 地 图 模 式 ）  ＞＞";
    }
    doGenerateRoleLocationHtml(context) {
        if (context === undefined) {
            return "野外";
        }
        else {
            return context.get("coordinate");
        }
    }
    doGenerateWelcomeMessageHtml() {
        return "<b style='font-size:120%;color:wheat'>真是难为您了，在野外还不忘捯饬您这些破烂。</b>";
    }
    doBindReturnButton(credential) {
        const html = PageUtils_1.default.generateReturnMapForm(credential);
        $("#hiddenFormContainer").html(html);
        $("#returnButton").on("click", () => {
            $("#returnMap").trigger("click");
        });
    }
    doRenderMutablePage(credential, page, context) {
        const treasureBag = page.findTreasureBag();
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='background-color:darkred;color:wheat;font-weight:bold;font-size:120%;text-align:center' colspan='20'>＜ 随 身 装 备 ＞</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>选择</th>";
        html += "<th style='background-color:#EFE0C0'>装备</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>职需</th>";
        html += "<th style='background-color:#E0D0B0'>攻需</th>";
        html += "<th style='background-color:#E0D0B0'>防需</th>";
        html += "<th style='background-color:#E0D0B0'>智需</th>";
        html += "<th style='background-color:#E0D0B0'>精需</th>";
        html += "<th style='background-color:#E0D0B0'>速需</th>";
        html += "<th style='background-color:#EFE0C0'>威＋</th>";
        html += "<th style='background-color:#EFE0C0'>重＋</th>";
        html += "<th style='background-color:#EFE0C0'>幸＋</th>";
        html += "<th style='background-color:#E0D0B0'>经验</th>";
        html += "<th style='background-color:#EFE0C0'>属性</th>";
        html += "<th style='background-color:#E8E8D0'>使用</th>";
        html += "<th style='background-color:#E8E8D0'>入袋</th>";
        html += "</tr>";
        for (const equipment of page.equipmentList) {
            if (equipment.isGoldenCage || equipment.isTreasureBag) {
                continue;
            }
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (equipment.selectable) {
                html += "<input type='button' " +
                    "value='选择' " +
                    "style='color:grey' " +
                    "id='selectPersonal_" + equipment.index + "' " +
                    "class='mutableButton-1'>";
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.usingHTML + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredCareerHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpeedHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalPowerHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalWeightHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalLuckHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.experienceHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.attributeHtml + "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (equipment.selectable) {
                html += "<input type='button' " +
                    "value='" + equipment.buttonTitle + "' " +
                    "id='use_" + equipment.index + "' " +
                    "class='mutableButton-1'>";
            }
            html += "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (treasureBag !== null && equipment.selectable && !equipment.using) {
                html += "<input type='button' " +
                    "value='入袋' " +
                    "id='store_" + equipment.index + "' " +
                    "class='mutableButton-1'>";
            }
            html += "</td>";
            html += "</tr>";
        }
        // ------------------------------------------------------------------------
        // 装备菜单栏
        // ------------------------------------------------------------------------
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0;text-align:center' colspan='20'>";
        html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='text-align:left'>";
        html += "<input type='button' id='use' class='mutableButton-1' value='使用装备'>";
        html += "<input type='button' id='bag' class='mutableButton-1' value='放入百宝袋'>";
        html += "</td>";
        html += "<td style='text-align:right'>";
        html += "<input type='button' id='openBag' class='mutableButton-1' value='打开百宝袋'>";
        html += "<input type='button' id='closeBag' class='mutableButton-1' value='关闭百宝袋'>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#equipmentList").html(html).parent().show();
        if (treasureBag === null) {
            $("#bag").prop("disabled", true).hide();
            $("#openBag").prop("disabled", true).hide();
            $("#closeBag").prop("disabled", true).hide();
        }
        else {
            if ($("#bagState").text() === "on") {
                $("#openBag").prop("disabled", true);
            }
            else {
                $("#closeBag").prop("disabled", true);
            }
        }
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Map_instances, "m", _PersonalEquipmentManagementPageProcessor_Map_bindSelectPersonalButton).call(this);
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Map_instances, "m", _PersonalEquipmentManagementPageProcessor_Map_bindUseButton).call(this, credential, context);
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Map_instances, "m", _PersonalEquipmentManagementPageProcessor_Map_bindStoreButton).call(this, credential, treasureBag, context);
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Map_instances, "m", _PersonalEquipmentManagementPageProcessor_Map_bindOpenBagButton).call(this, credential, context);
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Map_instances, "m", _PersonalEquipmentManagementPageProcessor_Map_bindCloseBagButton).call(this, credential, context);
        if (treasureBag !== null && $("#bagState").text() === "on") {
            __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Map_instances, "m", _PersonalEquipmentManagementPageProcessor_Map_doRenderStorageEquipmentList).call(this, credential, treasureBag, context);
        }
    }
}
_PersonalEquipmentManagementPageProcessor_Map_instances = new WeakSet(), _PersonalEquipmentManagementPageProcessor_Map_bindSelectPersonalButton = function _PersonalEquipmentManagementPageProcessor_Map_bindSelectPersonalButton() {
    $("input:button[value='选择']")
        .filter(function () {
        const buttonId = $(this).attr("id");
        return buttonId.startsWith("selectPersonal_");
    })
        .on("click", function () {
        const buttonId = $(this).attr("id");
        if (PageUtils_1.default.isColorGrey(buttonId)) {
            $(this).css("color", "blue");
        }
        else if (PageUtils_1.default.isColorBlue(buttonId)) {
            $(this).css("color", "grey");
        }
    });
}, _PersonalEquipmentManagementPageProcessor_Map_bindUseButton = function _PersonalEquipmentManagementPageProcessor_Map_bindUseButton(credential, context) {
    const instance = this;
    for (let i = 0; i < 20; i++) {
        const buttonId = "use_" + i;
        if ($("#" + buttonId).length === 0) {
            continue;
        }
        $("#" + buttonId).on("click", function () {
            new PersonalEquipmentManagement_1.default(credential)
                .use([i])
                .then(() => {
                instance.doRefreshMutablePage(credential, context);
            });
        });
    }
    $("#use").on("click", function () {
        const indexList = [];
        $("input:button[value='选择']")
            .filter(function () {
            const buttonId = $(this).attr("id");
            return buttonId.startsWith("selectPersonal_");
        })
            .each(function (_idx, input) {
            const buttonId = $(input).attr("id");
            if (PageUtils_1.default.isColorBlue(buttonId)) {
                const index = parseInt(StringUtils_1.default.substringAfter(buttonId, "_"));
                indexList.push(index);
            }
        });
        if (indexList.length === 0) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有选择装备或者物品！");
            return;
        }
        new PersonalEquipmentManagement_1.default(credential)
            .use(indexList)
            .then(() => {
            instance.doRefreshMutablePage(credential, context);
        });
    });
}, _PersonalEquipmentManagementPageProcessor_Map_bindStoreButton = function _PersonalEquipmentManagementPageProcessor_Map_bindStoreButton(credential, treasureBag, context) {
    if (treasureBag === null) {
        return;
    }
    const instance = this;
    $("input:button[value='入袋']").on("click", function () {
        const buttonId = $(this).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfter(buttonId, "_"));
        new TreasureBag_1.default(credential)
            .putInto([index])
            .then(() => {
            instance.doRefreshMutablePage(credential, context);
        });
    });
    $("#bag").on("click", function () {
        const indexList = [];
        $("input:button[value='选择']")
            .filter(function () {
            const buttonId = $(this).attr("id");
            return buttonId.startsWith("selectPersonal_");
        })
            .each(function (_idx, input) {
            const buttonId = $(input).attr("id");
            if (PageUtils_1.default.isColorBlue(buttonId)) {
                const index = parseInt(StringUtils_1.default.substringAfter(buttonId, "_"));
                indexList.push(index);
            }
        });
        if (indexList.length === 0) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有选择装备或者物品！");
            return;
        }
        new TreasureBag_1.default(credential)
            .putInto(indexList)
            .then(() => {
            instance.doRefreshMutablePage(credential, context);
        });
    });
}, _PersonalEquipmentManagementPageProcessor_Map_bindOpenBagButton = function _PersonalEquipmentManagementPageProcessor_Map_bindOpenBagButton(credential, context) {
    if ($("#openBag").prop("disabled")) {
        return;
    }
    const instance = this;
    $("#openBag").on("click", function () {
        $("#bagState").text("on");
        instance.doRefreshMutablePage(credential, context);
    });
}, _PersonalEquipmentManagementPageProcessor_Map_bindCloseBagButton = function _PersonalEquipmentManagementPageProcessor_Map_bindCloseBagButton(credential, context) {
    if ($("#closeBag").prop("disabled")) {
        return;
    }
    const instance = this;
    $("#closeBag").on("click", function () {
        $("#bagState").text("off");
        instance.doRefreshMutablePage(credential, context);
    });
}, _PersonalEquipmentManagementPageProcessor_Map_doRenderStorageEquipmentList = function _PersonalEquipmentManagementPageProcessor_Map_doRenderStorageEquipmentList(credential, treasureBag, context) {
    new TreasureBag_1.default(credential)
        .open(treasureBag.index)
        .then(bagPage => {
        const equipmentList = bagPage.sortedEquipmentList;
        if (equipmentList.length === 0) {
            // Nothing found in bag.
            return;
        }
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold;font-size:120%;text-align:center' colspan='11'>＜ 百 宝 袋 ＞</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>选择</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#EFE0C0'>威＋</th>";
        html += "<th style='background-color:#EFE0C0'>重＋</th>";
        html += "<th style='background-color:#EFE0C0'>幸＋</th>";
        html += "<th style='background-color:#E0D0B0'>经验</th>";
        html += "<th style='background-color:#E8E8D0'>取出</th>";
        html += "</tr>";
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            html += "<input type='button' " +
                "value='选择' " +
                "style='color:grey' " +
                "id='selectStorage_" + equipment.index + "' " +
                "class='mutableElement'>";
            html += "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalPowerHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalWeightHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalLuckHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.experienceHTML + "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            html += "<input type='button' " +
                "value='取出' " +
                "id='takeOut_" + equipment.index + "' " +
                "class='mutableElement'>";
            html += "</td>";
            html += "</tr>";
        }
        // ----------------------------------------------------------------
        // 百宝袋菜单栏
        // ----------------------------------------------------------------
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0;text-align:center' colspan='11'>";
        html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='text-align:left'>";
        html += "<input type='button' id='takeOut' class='mutableElement' value='取出百宝袋'>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#bagList").html(html).parent().show();
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Map_instances, "m", _PersonalEquipmentManagementPageProcessor_Map_bindSelectStorageButton).call(this);
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Map_instances, "m", _PersonalEquipmentManagementPageProcessor_Map_bindTakeOutButton).call(this, credential, treasureBag, context);
    });
}, _PersonalEquipmentManagementPageProcessor_Map_bindSelectStorageButton = function _PersonalEquipmentManagementPageProcessor_Map_bindSelectStorageButton() {
    $("input:button[value='选择']")
        .filter(function () {
        const buttonId = $(this).attr("id");
        return buttonId.startsWith("selectStorage_");
    })
        .on("click", function () {
        const buttonId = $(this).attr("id");
        if (PageUtils_1.default.isColorGrey(buttonId)) {
            $(this).css("color", "blue");
        }
        else if (PageUtils_1.default.isColorBlue(buttonId)) {
            $(this).css("color", "grey");
        }
    });
}, _PersonalEquipmentManagementPageProcessor_Map_bindTakeOutButton = function _PersonalEquipmentManagementPageProcessor_Map_bindTakeOutButton(credential, treasureBag, context) {
    const instance = this;
    $("input:button[value='取出']").on("click", function () {
        const buttonId = $(this).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfter(buttonId, "_"));
        new TreasureBag_1.default(credential)
            .takeOut([index])
            .then(() => {
            instance.doRefreshMutablePage(credential, context);
        });
    });
    $("#takeOut").on("click", function () {
        const indexList = [];
        $("input:button[value='选择']")
            .filter(function () {
            const buttonId = $(this).attr("id");
            return buttonId.startsWith("selectStorage_");
        })
            .each(function (_idx, input) {
            const buttonId = $(input).attr("id");
            if (PageUtils_1.default.isColorBlue(buttonId)) {
                const index = parseInt(StringUtils_1.default.substringAfter(buttonId, "_"));
                indexList.push(index);
            }
        });
        if (indexList.length === 0) {
            instance.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有选择装备或者物品！");
            return;
        }
        new TreasureBag_1.default(credential)
            .takeOut(indexList)
            .then(() => {
            instance.doRefreshMutablePage(credential, context);
        });
    });
};
module.exports = PersonalEquipmentManagementPageProcessor_Map;


/***/ }),
/* 89 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalEquipmentManagementPageProcessor_Town_instances, _PersonalEquipmentManagementPageProcessor_Town_renderPersonalUI, _PersonalEquipmentManagementPageProcessor_Town_renderBagUI, _PersonalEquipmentManagementPageProcessor_Town_renderLostBagUI, _PersonalEquipmentManagementPageProcessor_Town_renderNormalBagUI, _PersonalEquipmentManagementPageProcessor_Town_bindSetButton, _PersonalEquipmentManagementPageProcessor_Town_renderWarehouseUI;
const Equipment_1 = __importDefault(__webpack_require__(78));
const EquipmentSet_1 = __importDefault(__webpack_require__(90));
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const EquipmentSetLoader_1 = __importDefault(__webpack_require__(91));
const RoleStatusLoader_1 = __importDefault(__webpack_require__(92));
const CastleEquipmentExpressHouse_1 = __importDefault(__webpack_require__(79));
const CastleInformation_1 = __importDefault(__webpack_require__(63));
const CastleWarehouse_1 = __importDefault(__webpack_require__(81));
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const TownBank_1 = __importDefault(__webpack_require__(51));
const TownEquipmentExpressHouse_1 = __importDefault(__webpack_require__(95));
const TownForgeHouse_1 = __importDefault(__webpack_require__(97));
const TreasureBag_1 = __importDefault(__webpack_require__(85));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const CommentBoard_1 = __importDefault(__webpack_require__(20));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const AbstractPersonalEquipmentManagementPageProcessor_1 = __importDefault(__webpack_require__(87));
class PersonalEquipmentManagementPageProcessor_Town extends AbstractPersonalEquipmentManagementPageProcessor_1.default {
    constructor() {
        super(...arguments);
        _PersonalEquipmentManagementPageProcessor_Town_instances.add(this);
    }
    doGeneratePageTitleHtml(context) {
        if (context === undefined) {
            return "＜＜  装 备 管 理 （ 城 市 模 式 ）  ＞＞";
        }
        else {
            const townId = context.get("townId");
            const town = TownLoader_1.default.getTownById(townId);
            return "＜＜  装 备 管 理 （ " + town.nameTitle + " ）  ＞＞";
        }
    }
    doGenerateRoleLocationHtml(context) {
        if (context === undefined) {
            return "城市";
        }
        else {
            const townId = context.get("townId");
            const town = TownLoader_1.default.getTownById(townId);
            return town.name;
        }
    }
    doGenerateWelcomeMessageHtml() {
        return "<b style='font-size:120%;color:wheat'>又来管理您的装备来啦？就这点破烂折腾来折腾去的，您累不累啊。</b>";
    }
    doBindReturnButton(credential) {
        const html = PageUtils_1.default.generateReturnTownForm(credential);
        $("#hiddenFormContainer").html(html);
        $("#returnButton").on("click", () => {
            $("#returnTown").trigger("click");
        });
    }
    doBeforeRenderMutablePage(credential, context) {
        let html = "";
        // noinspection HtmlUnknownTarget
        html += "<form action='mydata.cgi' method='post'>";
        html += "<input type='hidden' name='id' value='" + credential.id + "'>";
        html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
        html += "<input type='hidden' name='chara' value='1'>";
        html += "<input type='hidden' name='mode' value='CONSECRATE'>";
        html += "<div id='consecrateItems'></div>";
        html += "<input type='submit' id='consecrateSubmit'>";
        html += "</form>";
        $("#consecrateFormContainer").html(html);
        CommentBoard_1.default.createCommentBoard(NpcLoader_1.default.getNpcImageHtml("饭饭"));
        CommentBoard_1.default.writeMessage("我就要一键祭奠，就要，就要！");
        CommentBoard_1.default.writeMessage("<input type='button' id='consecrateButton' value='祭奠选择的装备'>");
        $("#consecrateButton").hide();
        $("#consecrateButton").on("click", function () {
            const consecrateCandidates = [];
            const consecrateCandidateNames = [];
            $(".selectButton-1")
                .each(function (_idx, button) {
                const buttonId = $(button).attr("id");
                const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                if (PageUtils_1.default.isColorBlue(buttonId)) {
                    const c0 = $(button).parent();
                    const c1 = c0.next();
                    const c2 = c1.next();
                    const c3 = c2.next();
                    let s = c3.text().trim();
                    if (s === "武器" || s === "防具" || s === "饰品") {
                        s = c1.text().trim();
                        if (s !== "★") {
                            s = c2.text().trim();
                            consecrateCandidates.push(index);
                            consecrateCandidateNames.push(s);
                        }
                    }
                }
            });
            if (consecrateCandidates.length === 0) {
                MessageBoard_1.default.publishWarning("没有选择能够祭奠的装备！");
                return;
            }
            if (!confirm("请务必确认你将要祭奠的这些装备：" + consecrateCandidateNames.join())) {
                return;
            }
            new TownBank_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId")).withdraw(100).then(() => {
                let html = "";
                consecrateCandidates.forEach(it => {
                    html += "<input type='hidden' name='item" + it + "' value='" + it + "'>";
                });
                $("#consecrateItems").html(html);
                $("#consecrateSubmit").trigger("click");
            });
        });
        $("#p_3139").on("click", function () {
            $("#p_3139").off("click");
            new RoleStatusLoader_1.default(credential).loadRoleStatus()
                .then(status => {
                if (status.canConsecrate) {
                    $("#consecrateButton").show();
                }
                else {
                    MessageBoard_1.default.publishWarning("祭奠还在冷却中！");
                }
            });
        });
    }
    doRenderMutablePage(credential, page, context) {
        const bag = page.findTreasureBag();
        if (bag !== null) {
            __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderPersonalUI).call(this, credential, page, bag.index, context);
        }
        else {
            // 已经掌握了剑圣职业，说明应该有百宝袋，但是因为某些bug导致百宝袋不可见了，
            // 还是提供有限的百宝袋功能吧，能够放入、取出，但是不能浏览了。
            // 如果有分身了，那也说明曾经掌握过剑圣职业，就算有百宝袋了
            new PersonalStatus_1.default(credential).load().then(role => {
                if (role.masterCareerList.includes("剑圣") || role.hasMirror) {
                    // 真的曾经拥有百宝袋，但是又因为某些bug失去了
                    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderPersonalUI).call(this, credential, page, -1, context);
                }
                else {
                    // 是真的没有百宝袋
                    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderPersonalUI).call(this, credential, page, -99, context);
                }
            });
        }
    }
}
_PersonalEquipmentManagementPageProcessor_Town_instances = new WeakSet(), _PersonalEquipmentManagementPageProcessor_Town_renderPersonalUI = function _PersonalEquipmentManagementPageProcessor_Town_renderPersonalUI(credential, page, bagIndex, context) {
    $("#bagIndex").text(bagIndex);
    let html = "";
    html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%;margin:auto'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<td style='background-color:darkred;color:wheat;font-weight:bold;font-size:120%;text-align:center' " +
        "colspan='22'>＜ 随 身 装 备 ＞</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>选择</th>";
    html += "<th style='background-color:#EFE0C0'>装备</th>";
    html += "<th style='background-color:#E0D0B0'>名字</th>";
    html += "<th style='background-color:#EFE0C0'>种类</th>";
    html += "<th style='background-color:#E0D0B0'>效果</th>";
    html += "<th style='background-color:#EFE0C0'>重量</th>";
    html += "<th style='background-color:#EFE0C0'>耐久</th>";
    html += "<th style='background-color:#E0D0B0'>职需</th>";
    html += "<th style='background-color:#E0D0B0'>攻需</th>";
    html += "<th style='background-color:#E0D0B0'>防需</th>";
    html += "<th style='background-color:#E0D0B0'>智需</th>";
    html += "<th style='background-color:#E0D0B0'>精需</th>";
    html += "<th style='background-color:#E0D0B0'>速需</th>";
    html += "<th style='background-color:#EFE0C0'>威＋</th>";
    html += "<th style='background-color:#EFE0C0'>重＋</th>";
    html += "<th style='background-color:#EFE0C0'>幸＋</th>";
    html += "<th style='background-color:#E0D0B0'>经验</th>";
    html += "<th style='background-color:#EFE0C0'>属性</th>";
    html += "<th style='background-color:#E8E8D0'>使用</th>";
    html += "<th style='background-color:#E8E8D0'>修理</th>";
    html += "<th style='background-color:#E8E8D0'>入袋</th>";
    html += "<th style='background-color:#E8E8D0'>发送</th>";
    html += "</tr>";
    for (const equipment of page.equipmentList) {
        if (equipment.isGoldenCage || equipment.isTreasureBag) {
            continue;
        }
        html += "<tr>";
        html += "<td style='background-color:#E8E8D0'>";
        if (equipment.selectable) {
            html += "<input type='button' value='选择' " +
                "style='color:grey' " +
                "class='mutableButton-1 selectButton-1' " +
                "id='selectButton_1_" + equipment.index + "'>";
        }
        html += "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.usingHTML + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredCareerHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredAttackHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredDefenseHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialAttackHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialDefenseHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpeedHtml + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.additionalPowerHtml + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.additionalWeightHtml + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.additionalLuckHtml + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + equipment.experienceHTML + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + equipment.attributeHtml + "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        if (equipment.selectable) {
            html += "<input type='button' value='" + equipment.buttonTitle + "' " +
                "class='mutableButton-1 useButton-1' " +
                "id='useButton_1_" + equipment.index + "'>";
        }
        html += "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        if (equipment.isRepairable) {
            html += "<input type='button' value='修理' " +
                "class='mutableButton-1 repairButton-1' " +
                "id='repairButton_1_" + equipment.index + "'>";
        }
        html += "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        if (equipment.selectable && !equipment.using && bagIndex >= -1) {
            html += "<input type='button' value='入袋' " +
                "class='mutableButton-1 storeButton-1' " +
                "id='storeButton_1_" + equipment.index + "'>";
        }
        html += "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        html += "<input type='button' value='发送' " +
            "class='mutableButton-1 sendButton-1' " +
            "id='sendButton_1_" + equipment.index + "' disabled style='display:none'>";
        html += "</td>";
        html += "</tr>";
    }
    // ------------------------------------------------------------------------
    // 装备菜单栏
    // ------------------------------------------------------------------------
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center' colspan='22'>";
    html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<td style='text-align:center;font-weight:bold' colspan='2'>";
    html += "<span style='color:navy'>目前剩余空位数：</span><span style='color:red'>" + page.spaceCount + "</span>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='text-align:left'>";
    html += "<input type='button' id='useButton' class='mutableButton-1' value='使用装备'>";
    html += "<input type='button' id='storeButton' class='mutableButton-1' value='放入百宝袋' disabled style='display:none'>";
    html += "</td>";
    html += "<td style='text-align:right'>";
    html += "<input type='button' id='openBagButton' class='mutableButton-1' value='打开百宝袋' disabled style='display:none'>";
    html += "<input type='button' id='closeBagButton' class='mutableButton-1' value='关闭百宝袋' disabled style='display:none'>";
    html += "<input type='button' id='openWarehouse' class='mutableButton-1' value='打开仓库' disabled style='display:none'>";
    html += "<input type='button' id='closeWarehouse' class='mutableButton-1' value='关闭仓库' disabled style='display:none'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='text-align:right' colspan='2'>";
    html += "<input type='text' id='searchName' size='15' maxlength='20'>";
    html += "<input type='button' id='searchButton' class='mutableButton-1' value='找人'>";
    html += "<select id='peopleSelect'><option value=''>选择发送对象</select>";
    html += "<input type='button' id='sendButton' class='mutableButton-1' value='发送'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='text-align:right' colspan='2'>";
    html += "<input type='button' class='mutableButton-1' id='luckCharmButton' value='千与千寻' style='color:blue'>";
    html += "<input type='button' class='mutableButton-1' id='dontForgetMeButton' value='勿忘我' style='color:red'>";
    html += "<input type='button' class='mutableButton-1' id='magicBallButton' value='魔法使的闪光弹' style='color:green'>";
    html += "<input type='button' class='mutableButton-1' id='setButton_A' value='套装Ａ' disabled>";
    html += "<input type='button' class='mutableButton-1' id='setButton_B' value='套装Ｂ' disabled>";
    html += "<input type='button' class='mutableButton-1' id='setButton_C' value='套装Ｃ' disabled>";
    html += "<input type='button' class='mutableButton-1' id='setButton_D' value='套装Ｄ' disabled>";
    html += "<input type='button' class='mutableButton-1' id='setButton_E' value='套装Ｅ' disabled>";
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#equipmentList").html(html).parent().show();
    if (SetupLoader_1.default.isCastleKeeperEnabled()) {
        new CastleInformation_1.default().load(page.role.name).then(() => {
            $("#openWarehouse").prop("disabled", false).show();
            $("#closeWarehouse").prop("disabled", false).show();
            $("#openWarehouse").on("click", () => {
                if ($("#warehouseState").text() === "on") {
                    return;
                }
                $("#warehouseState").text("on");
                __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderWarehouseUI).call(this, credential, page, context);
            });
            $("#closeWarehouse").on("click", () => {
                if ($("#warehouseState").text() === "off") {
                    return;
                }
                $("#warehouseState").text("off");
                PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-3");
                $("#warehouseList").html("").parent().hide();
            });
        });
    }
    // --------------------------------------------------------------------
    // 发送
    // --------------------------------------------------------------------
    new TownEquipmentExpressHouse_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId")).open().then(expressPage => {
        for (const equipment of expressPage.equipmentList) {
            const index = equipment.index;
            if (equipment.selectable) {
                $("#sendButton_1_" + index).prop("disabled", false).show();
            }
            else {
                $("#sendButton_1_" + index).remove();
            }
        }
        $(".sendButton-1").on("click", event => {
            const buttonId = $(event.target).attr("id");
            const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
            const s = $("#peopleSelect").val();
            if (s === undefined || s.trim() === "") {
                this.doScrollToPageTitle();
                MessageBoard_1.default.publishWarning("没有选择发送对象！");
                return;
            }
            const bank = new TownBank_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId"));
            bank.withdraw(10).then(() => {
                new TownEquipmentExpressHouse_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId")).send(s, [index]).then(() => {
                    bank.deposit().then(() => {
                        this.doRefreshMutablePage(credential, context);
                    });
                });
            });
        });
    });
    // --------------------------------------------------------------------
    // 选择
    // --------------------------------------------------------------------
    this.doBindSelectButtons("selectButton-1");
    // --------------------------------------------------------------------
    // 使用
    // --------------------------------------------------------------------
    $(".useButton-1").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
        new PersonalEquipmentManagement_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId")).use([index]).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    // --------------------------------------------------------------------
    // 修理
    // --------------------------------------------------------------------
    $(".repairButton-1").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
        new TownForgeHouse_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId")).repair(index).then(() => {
            const equipment = page.findEquipment(index);
            MessageBoard_1.default.publishMessage("修理了" + equipment.fullName + "。");
            this.doRefreshMutablePage(credential, context);
        });
    });
    // --------------------------------------------------------------------
    // 入袋
    // --------------------------------------------------------------------
    $(".storeButton-1").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
        new TreasureBag_1.default(credential).putInto([index]).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    // --------------------------------------------------------------------
    // 找人
    // --------------------------------------------------------------------
    $("#searchButton").on("click", () => {
        const s = $("#searchName").val();
        if (s === undefined || s.trim() === "") {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有正确输入人名！");
            return;
        }
        new TownEquipmentExpressHouse_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId")).search(s).then(optionListHtml => {
            $("#peopleSelect").html(optionListHtml);
        });
    });
    // --------------------------------------------------------------------
    // 打开百宝袋 / 关闭百宝袋
    // --------------------------------------------------------------------
    if (bagIndex >= -1) {
        $("#openBagButton").prop("disabled", false).show();
        $("#closeBagButton").prop("disabled", false).show();
        $("#openBagButton").on("click", () => {
            if ($("#bagState").text() === "on") {
                return;
            }
            $("#bagState").text("on");
            __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderBagUI).call(this, credential, page, bagIndex, context);
        });
        $("#closeBagButton").on("click", () => {
            if ($("#bagState").text() === "off") {
                return;
            }
            $("#bagState").text("off");
            PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-2");
            $("#bagList").html("").parent().hide();
        });
    }
    // --------------------------------------------------------------------
    // 使用
    // --------------------------------------------------------------------
    $("#useButton").on("click", () => {
        const indexList = [];
        $(".selectButton-1").each((idx, button) => {
            const buttonId = $(button).attr("id");
            if (PageUtils_1.default.isColorBlue(buttonId)) {
                const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                indexList.push(index);
            }
        });
        if (indexList.length === 0) {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有选择物品或装备！");
            return;
        }
        new PersonalEquipmentManagement_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId")).use(indexList).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    // --------------------------------------------------------------------
    // 放入百宝袋
    // --------------------------------------------------------------------
    if (bagIndex >= -1) {
        $("#storeButton").prop("disabled", false).show();
        $("#storeButton").on("click", () => {
            const indexList = [];
            $(".selectButton-1").each((idx, button) => {
                const buttonId = $(button).attr("id");
                if (PageUtils_1.default.isColorBlue(buttonId)) {
                    const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                    indexList.push(index);
                }
            });
            if (indexList.length === 0) {
                this.doScrollToPageTitle();
                MessageBoard_1.default.publishWarning("没有选择物品或装备！");
                return;
            }
            new TreasureBag_1.default(credential).putInto(indexList).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
    }
    // --------------------------------------------------------------------
    // 发送
    // --------------------------------------------------------------------
    $("#sendButton").on("click", () => {
        const indexList = [];
        $(".selectButton-1").each((idx, button) => {
            const buttonId = $(button).attr("id");
            if (PageUtils_1.default.isColorBlue(buttonId)) {
                const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                indexList.push(index);
            }
        });
        if (indexList.length === 0) {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有选择物品或装备！");
            return;
        }
        const s = $("#peopleSelect").val();
        if (s === undefined || s.trim() === "") {
            this.doScrollToPageTitle();
            MessageBoard_1.default.publishWarning("没有选择发送对象！");
            return;
        }
        const bank = new TownBank_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId"));
        bank.withdraw(10).then(() => {
            new CastleEquipmentExpressHouse_1.default(credential).send(s, indexList).then(() => {
                bank.deposit().then(() => {
                    this.doRefreshMutablePage(credential, context);
                });
            });
        });
    });
    $("#luckCharmButton").on("click", () => {
        const set = new EquipmentSet_1.default();
        set.initialize();
        set.accessoryName = "千与千寻";
        new EquipmentSetLoader_1.default(credential, page.equipmentList).load(set)
            .then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    $("#dontForgetMeButton").on("click", () => {
        const set = new EquipmentSet_1.default();
        set.initialize();
        set.accessoryName = "勿忘我";
        new EquipmentSetLoader_1.default(credential, page.equipmentList).load(set)
            .then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    $("#magicBallButton").on("click", () => {
        const set = new EquipmentSet_1.default();
        set.initialize();
        set.accessoryName = "魔法使的闪光弹";
        new EquipmentSetLoader_1.default(credential, page.equipmentList).load(set)
            .then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_bindSetButton).call(this, credential, page, "A", context);
    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_bindSetButton).call(this, credential, page, "B", context);
    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_bindSetButton).call(this, credential, page, "C", context);
    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_bindSetButton).call(this, credential, page, "D", context);
    __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_bindSetButton).call(this, credential, page, "E", context);
    if ($("#bagState").text() === "on") {
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderBagUI).call(this, credential, page, bagIndex, context);
    }
    if ($("#warehouseState").text() === "on") {
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderWarehouseUI).call(this, credential, page, context);
    }
}, _PersonalEquipmentManagementPageProcessor_Town_renderBagUI = function _PersonalEquipmentManagementPageProcessor_Town_renderBagUI(credential, page, bagIndex, context) {
    if (bagIndex < 0) {
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderLostBagUI).call(this, credential, page, context);
    }
    else {
        __classPrivateFieldGet(this, _PersonalEquipmentManagementPageProcessor_Town_instances, "m", _PersonalEquipmentManagementPageProcessor_Town_renderNormalBagUI).call(this, credential, page, bagIndex, context);
    }
}, _PersonalEquipmentManagementPageProcessor_Town_renderLostBagUI = function _PersonalEquipmentManagementPageProcessor_Town_renderLostBagUI(credential, page, context) {
    let html = "";
    html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%;margin:auto'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold;font-size:120%;text-align:center'>＜ 百 宝 袋 ＞</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0;text-align:center;color:navy;font-weight:bold'>百宝袋丢失了呀？那只能为您提供受限的功能了。</th>";
    html += "</tr>";
    // ----------------------------------------------------------------
    // 百宝袋菜单栏
    // ----------------------------------------------------------------
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<td style='text-align:left'>";
    if (page.spaceCount > 0) {
        html += "<input type='button' class='mutableButton-2' " +
            "id='takeOutButton' " +
            "value='从百宝袋中盲取'>";
    }
    html += "</td>";
    html += "<td style='text-align:right'>";
    html += "<input type='button' id='closeBagButton_2' class='mutableButton-2' value='关闭百宝袋'>";
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#bagList").html(html).parent().show();
    $("#takeOutButton").on("click", () => {
        new TreasureBag_1.default(credential).tryTakeOut(page.spaceCount).then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
    $("#closeBagButton_2").on("click", () => {
        if ($("#bagState").text() === "off") {
            return;
        }
        $("#bagState").text("off");
        PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-2");
        $("#bagList").html("").parent().hide();
    });
}, _PersonalEquipmentManagementPageProcessor_Town_renderNormalBagUI = function _PersonalEquipmentManagementPageProcessor_Town_renderNormalBagUI(credential, page, bagIndex, context) {
    new TreasureBag_1.default(credential).open(bagIndex).then(bagPage => {
        const equipmentList = bagPage.sortedEquipmentList;
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold;font-size:120%;text-align:center' colspan='11'>＜ 百 宝 袋 ＞</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>选择</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#EFE0C0'>威＋</th>";
        html += "<th style='background-color:#EFE0C0'>重＋</th>";
        html += "<th style='background-color:#EFE0C0'>幸＋</th>";
        html += "<th style='background-color:#E0D0B0'>经验</th>";
        html += "<th style='background-color:#E8E8D0'>取出</th>";
        html += "</tr>";
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (page.spaceCount > 0) {
                html += "<input type='button' value='选择' " +
                    "style='color:grey' " +
                    "class='mutableButton-2 selectButton-2' " +
                    "id='selectButton_2_" + equipment.index + "'>";
            }
            html += "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalPowerHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalWeightHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalLuckHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.experienceHTML + "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (page.spaceCount > 0) {
                html += "<input type='button' value='出袋' " +
                    "class='mutableButton-2 takeOutButton-2' " +
                    "id='takeOutButton_2_" + equipment.index + "'>";
            }
            html += "</td>";
            html += "</tr>";
        }
        // ----------------------------------------------------------------
        // 百宝袋菜单栏
        // ----------------------------------------------------------------
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0;text-align:center' colspan='11'>";
        html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='text-align:left'>";
        if (page.spaceCount > 0) {
            html += "<input type='button' class='mutableButton-2' " +
                "id='takeOutButton' " +
                "value='从百宝袋中取出'>";
        }
        html += "</td>";
        html += "<td style='text-align:right'>";
        html += "<input type='button' id='closeBagButton_2' class='mutableButton-2' value='关闭百宝袋'>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#bagList").html(html).parent().show();
        this.doBindSelectButtons("selectButton-2");
        $(".takeOutButton-2").on("click", event => {
            const buttonId = $(event.target).attr("id");
            const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
            new TreasureBag_1.default(credential).takeOut([index]).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
        $("#takeOutButton").on("click", () => {
            const indexList = [];
            $(".selectButton-2").each((idx, button) => {
                const buttonId = $(button).attr("id");
                if (PageUtils_1.default.isColorBlue(buttonId)) {
                    const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
                    indexList.push(index);
                }
            });
            if (indexList.length === 0) {
                this.doScrollToPageTitle();
                MessageBoard_1.default.publishWarning("没有选择百宝袋中的物品或装备！");
                return;
            }
            new TreasureBag_1.default(credential).takeOut(indexList).then(() => {
                this.doRefreshMutablePage(credential, context);
            });
        });
        $("#closeBagButton_2").on("click", () => {
            if ($("#bagState").text() === "off") {
                return;
            }
            $("#bagState").text("off");
            PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-2");
            $("#bagList").html("").parent().hide();
        });
    });
}, _PersonalEquipmentManagementPageProcessor_Town_bindSetButton = function _PersonalEquipmentManagementPageProcessor_Town_bindSetButton(credential, page, setId, context) {
    let setConfig = null;
    switch (setId) {
        case "A":
            setConfig = SetupLoader_1.default.loadEquipmentSet_A(credential.id);
            break;
        case "B":
            setConfig = SetupLoader_1.default.loadEquipmentSet_B(credential.id);
            break;
        case "C":
            setConfig = SetupLoader_1.default.loadEquipmentSet_C(credential.id);
            break;
        case "D":
            setConfig = SetupLoader_1.default.loadEquipmentSet_D(credential.id);
            break;
        case "E":
            setConfig = SetupLoader_1.default.loadEquipmentSet_E(credential.id);
            break;
        default:
            break;
    }
    if (!this.doCheckSetConfiguration(setConfig)) {
        return;
    }
    const buttonId = "setButton_" + setId;
    $("#" + buttonId).prop("disabled", false);
    $("#" + buttonId).on("click", () => {
        const set = new EquipmentSet_1.default();
        set.initialize();
        // @ts-ignore
        set.weaponName = setConfig["weaponName"];
        // @ts-ignore
        if (setConfig["weaponStar"] !== undefined && setConfig["weaponStar"]) {
            set.weaponName = "齐心★" + set.weaponName;
        }
        // @ts-ignore
        set.armorName = setConfig["armorName"];
        // @ts-ignore
        if (setConfig["armorStar"] !== undefined && setConfig["armorStar"]) {
            set.armorName = "齐心★" + set.armorName;
        }
        // @ts-ignore
        set.accessoryName = setConfig["accessoryName"];
        // @ts-ignore
        if (setConfig["accessoryStar"] !== undefined && setConfig["accessoryStar"]) {
            set.accessoryName = "齐心★" + set.accessoryName;
        }
        new EquipmentSetLoader_1.default(credential, page.equipmentList).load(set)
            .then(() => {
            this.doRefreshMutablePage(credential, context);
        });
    });
}, _PersonalEquipmentManagementPageProcessor_Town_renderWarehouseUI = function _PersonalEquipmentManagementPageProcessor_Town_renderWarehouseUI(credential, page, context) {
    new CastleWarehouse_1.default(credential).open().then(warehousePage => {
        const equipmentList = Equipment_1.default.sortEquipmentList(warehousePage.storageEquipmentList);
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkred;color:wheat;font-weight:bold' " +
            "colspan='16'>";
        html += "＜ 城 堡 仓 库 ＞";
        html += "</td>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#E0D0B0'>耐久</th>";
        html += "<th style='background-color:#EFE0C0'>职业</th>";
        html += "<th style='background-color:#E0D0B0'>攻击</th>";
        html += "<th style='background-color:#E0D0B0'>防御</th>";
        html += "<th style='background-color:#E0D0B0'>智力</th>";
        html += "<th style='background-color:#E0D0B0'>精神</th>";
        html += "<th style='background-color:#E0D0B0'>速度</th>";
        html += "<th style='background-color:#EFE0C0'>威力</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>幸运</th>";
        html += "<th style='background-color:#E0D0B0'>经验</th>";
        html += "<th style='background-color:#E0D0B0'>属性</th>";
        html += "</tr>";
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.requiredCareerHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpecialDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.requiredSpeedHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalPowerHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalWeightHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.additionalLuckHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.experienceHTML + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.attributeHtml + "</td>";
            html += "</tr>";
        }
        // ----------------------------------------------------------------
        // 城堡仓库菜单栏
        // ----------------------------------------------------------------
        html += "<tr>";
        html += "<td style='background-color:#F8F0E0;text-align:center' colspan='18'>";
        html += "<table style='border-width:0;background-color:#F8F0E0;width:100%;margin:auto'>";
        html += "<tbody>";
        html += "<tr>";
        html += "<td style='text-align:right'>";
        html += "<input type='button' id='closeWarehouse3' class='mutableButton-3' value='关闭仓库'>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        html += "</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#warehouseList").html(html).parent().show();
        $("#closeWarehouse3").on("click", () => {
            if ($("#warehouseState").text() === "off") {
                return;
            }
            $("#warehouseState").text("off");
            PageUtils_1.default.unbindEventBySpecifiedClass("mutableButton-3");
            $("#warehouseList").html("").parent().hide();
        });
    });
};
module.exports = PersonalEquipmentManagementPageProcessor_Town;


/***/ }),
/* 90 */
/***/ ((module) => {


class EquipmentSet {
    initialize() {
        this.weaponName = undefined;
        this.weaponIndex = undefined;
        this.weaponUsing = undefined;
        this.armorName = undefined;
        this.armorIndex = undefined;
        this.armorUsing = undefined;
        this.accessoryName = undefined;
        this.accessoryIndex = undefined;
        this.accessoryUsing = undefined;
        this.treasureBagIndex = undefined;
    }
    get isAllFound() {
        if (this.weaponName !== undefined && this.weaponIndex === undefined) {
            return false;
        }
        if (this.armorName !== undefined && this.armorIndex === undefined) {
            return false;
        }
        return !(this.accessoryName !== undefined && this.accessoryIndex === undefined);
    }
}
module.exports = EquipmentSet;


/***/ }),
/* 91 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _EquipmentSetLoader_credential, _EquipmentSetLoader_equipmentList;
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const TreasureBag_1 = __importDefault(__webpack_require__(85));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
class EquipmentSetLoader {
    constructor(credential, equipmentList) {
        _EquipmentSetLoader_credential.set(this, void 0);
        _EquipmentSetLoader_equipmentList.set(this, void 0);
        __classPrivateFieldSet(this, _EquipmentSetLoader_credential, credential, "f");
        __classPrivateFieldSet(this, _EquipmentSetLoader_equipmentList, equipmentList, "f");
    }
    load(set) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential, equipmentList, set) => {
                return new Promise(resolve => {
                    set = doScanEquipmentSet(equipmentList, set);
                    // 在自身完成了检索
                    if (!set.isAllFound && set.treasureBagIndex !== undefined) {
                        // 没有找全，有百宝袋，进继续找。
                        const treasureBag = new TreasureBag_1.default(credential);
                        treasureBag.open(set.treasureBagIndex)
                            .then(bagPage => {
                            const bagEquipmentList = bagPage.equipmentList;
                            const candidateIndexList = [];
                            if (set.weaponName !== undefined && set.weaponIndex === undefined) {
                                for (const bit of bagEquipmentList) {
                                    if (bit.isWeapon && bit.fullName === set.weaponName) {
                                        MessageBoard_1.default.publishMessage("在百宝袋中找到了武器：" + bit.nameHTML);
                                        candidateIndexList.push(bit.index);
                                        break;
                                    }
                                }
                            }
                            if (set.armorName !== undefined && set.armorIndex === undefined) {
                                for (const bit of bagEquipmentList) {
                                    if (bit.isArmor && bit.fullName === set.armorName) {
                                        MessageBoard_1.default.publishMessage("在百宝袋中找到了防具：" + bit.nameHTML);
                                        candidateIndexList.push(bit.index);
                                        break;
                                    }
                                }
                            }
                            if (set.accessoryName !== undefined && set.accessoryIndex === undefined) {
                                for (const bit of bagEquipmentList) {
                                    if (bit.isAccessory && bit.fullName === set.accessoryName) {
                                        MessageBoard_1.default.publishMessage("在百宝袋中找到了饰品：" + bit.nameHTML);
                                        candidateIndexList.push(bit.index);
                                        break;
                                    }
                                }
                            }
                            if (candidateIndexList.length > 0) {
                                // 在百宝袋中找到了需要的装备，准备拿出来
                                treasureBag.takeOut(candidateIndexList).then(() => {
                                    new PersonalEquipmentManagement_1.default(credential).open().then(newPage => {
                                        const newEquipmentList = newPage.equipmentList;
                                        set = doScanEquipmentSet(newEquipmentList, set);
                                        doLoadEquipmentSet(credential, set, resolve);
                                    });
                                });
                            }
                            else {
                                // 在百宝袋中没有找到需要的装备
                                doLoadEquipmentSet(credential, set, resolve);
                            }
                        });
                    }
                    else {
                        doLoadEquipmentSet(credential, set, resolve);
                    }
                });
            };
            return yield action(__classPrivateFieldGet(this, _EquipmentSetLoader_credential, "f"), __classPrivateFieldGet(this, _EquipmentSetLoader_equipmentList, "f"), set);
        });
    }
}
_EquipmentSetLoader_credential = new WeakMap(), _EquipmentSetLoader_equipmentList = new WeakMap();
function doScanEquipmentSet(equipmentList, set) {
    for (const it of equipmentList) {
        if (it.isTreasureBag) {
            set.treasureBagIndex = it.index;
        }
        if (set.weaponName !== undefined) {
            if (it.isWeapon && it.fullName === set.weaponName) {
                MessageBoard_1.default.publishMessage("在身上找到了武器：" + it.nameHTML);
                set.weaponIndex = it.index;
                set.weaponUsing = it.using;
            }
        }
        if (set.armorName !== undefined) {
            if (it.isArmor && it.fullName === set.armorName) {
                MessageBoard_1.default.publishMessage("在身上找到了防具：" + it.nameHTML);
                set.armorIndex = it.index;
                set.armorUsing = it.using;
            }
        }
        if (set.accessoryName !== undefined) {
            if (it.isAccessory && it.fullName === set.accessoryName) {
                MessageBoard_1.default.publishMessage("在身上找到了饰品：" + it.nameHTML);
                set.accessoryIndex = it.index;
                set.accessoryUsing = it.using;
            }
        }
    }
    return set;
}
function doLoadEquipmentSet(credential, set, resolve) {
    const request = credential.asRequest();
    // @ts-ignore
    request["chara"] = "1";
    // @ts-ignore
    request["mode"] = "USE";
    let count = 0;
    if (set.weaponIndex !== undefined && set.weaponUsing !== undefined && !set.weaponUsing) {
        count++;
        // @ts-ignore
        request["item" + set.weaponIndex] = set.weaponIndex;
    }
    if (set.armorIndex !== undefined && set.armorUsing !== undefined && !set.armorUsing) {
        count++;
        // @ts-ignore
        request["item" + set.armorIndex] = set.armorIndex;
    }
    if (set.accessoryIndex !== undefined && set.accessoryUsing !== undefined && !set.accessoryUsing) {
        count++;
        // @ts-ignore
        request["item" + set.accessoryIndex] = set.accessoryIndex;
    }
    if (count === 0) {
        MessageBoard_1.default.publishMessage("没有找到对应的装备或者正在装备中，忽略。");
        resolve();
    }
    else {
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            resolve();
        });
    }
}
module.exports = EquipmentSetLoader;


/***/ }),
/* 92 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _RoleStatusLoader_credential;
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const RoleStatusParser_1 = __importDefault(__webpack_require__(93));
class RoleStatusLoader {
    constructor(credential) {
        _RoleStatusLoader_credential.set(this, void 0);
        __classPrivateFieldSet(this, _RoleStatusLoader_credential, credential, "f");
    }
    loadRoleStatus() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request["mode"] = "STATUS";
                    NetworkUtils_1.default.sendPostRequest("status.cgi", request, function (html) {
                        const status = RoleStatusParser_1.default.parseRoleStatus(html);
                        resolve(status);
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _RoleStatusLoader_credential, "f"));
        });
    }
}
_RoleStatusLoader_credential = new WeakMap();
module.exports = RoleStatusLoader;


/***/ }),
/* 93 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const RoleStatus_1 = __importDefault(__webpack_require__(94));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class RoleStatusParser {
    static parseRoleStatus(pageHtml) {
        return doParseRoleStatus(pageHtml);
    }
}
function doParseRoleStatus(pageHtml) {
    const page = $(pageHtml);
    const status = new RoleStatus_1.default();
    status.canConsecrate = page.text().includes("可以进行下次祭奠了");
    status.battleCount = parseInt(page.find("input:hidden[name='ktotal']").val());
    status.country = StringUtils_1.default.substringBefore(page.find("option[value='LOCAL_RULE']").text(), "国法");
    status.townCountry = page.find("th:contains('支配下')")
        .filter(function () {
        return $(this).text() === "支配下";
    })
        .next()
        .text();
    status.townId = page.find("input:hidden[name='townid']").val();
    // 读取角色当前的能力值
    // 奇怪了，读不到指定id的div元素？但是可以读到里面的td子元素
    page.find("td:last")
        .each(function (_idx, td) {
        const text = $(td).text();
        let idx = text.indexOf("Lv：");
        let s = text.substring(idx);
        status.level = parseInt(s.substring(3, s.indexOf(" ")));
        idx = text.indexOf("攻击力：");
        s = text.substring(idx);
        status.attack = parseInt(s.substring(4, s.indexOf(" ")));
        idx = s.indexOf("防御力：");
        s = s.substring(idx);
        status.defense = parseInt(s.substring(4, s.indexOf(" ")));
        idx = s.indexOf("智力：");
        s = s.substring(idx);
        status.specialAttack = parseInt(s.substring(3, s.indexOf(" ")));
        idx = s.indexOf("精神力：");
        s = s.substring(idx);
        status.specialDefense = parseInt(s.substring(4, s.indexOf(" ")));
        idx = s.indexOf("速度：");
        s = s.substring(idx);
        status.speed = parseInt(s.substring(3));
    });
    return status;
}
module.exports = RoleStatusParser;


/***/ }),
/* 94 */
/***/ ((module) => {


class RoleStatus {
}
module.exports = RoleStatus;


/***/ }),
/* 95 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownEquipmentExpressHouse_credential, _TownEquipmentExpressHouse_townId;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Role_1 = __importDefault(__webpack_require__(14));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownEquipmentExpressHousePage_1 = __importDefault(__webpack_require__(96));
class TownEquipmentExpressHouse {
    constructor(credential, townId) {
        _TownEquipmentExpressHouse_credential.set(this, void 0);
        _TownEquipmentExpressHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownEquipmentExpressHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownEquipmentExpressHouse_townId, townId, "f");
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownEquipmentExpressHouse_credential, "f").asRequestMap();
                    if (__classPrivateFieldGet(this, _TownEquipmentExpressHouse_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _TownEquipmentExpressHouse_townId, "f"));
                    }
                    request.set("con_str", "50");
                    request.set("mode", "ITEM_SEND");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const page = TownEquipmentExpressHouse.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    search(name) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (name.trim() === "") {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _TownEquipmentExpressHouse_credential, "f").asRequestMap();
                    request.set("mode", "ITEM_SEND");
                    // noinspection JSDeprecatedSymbols
                    request.set("serch", escape(name.trim()));
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const optionListHtml = $(html).find("select:first").html();
                        resolve(optionListHtml);
                    });
                });
            })();
        });
    }
    send(target, indexList) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (target.trim() === "" || indexList.length === 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _TownEquipmentExpressHouse_credential, "f").asRequestMap();
                    request.set("mode", "ITEM_SEND2");
                    request.set("eid", target.trim());
                    for (const index of indexList) {
                        request.set("item" + index, index.toString());
                    }
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        if (html.includes("所持金不足")) {
                            reject();
                        }
                        else {
                            MessageBoard_1.default.processResponseMessage(html);
                            resolve();
                        }
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const role = new Role_1.default();
        $(html).find("td:contains('ＬＶ')")
            .filter((idx, td) => $(td).text() === "ＬＶ")
            .closest("tr")
            .next()
            .find("td:first")
            .each((idx, td) => {
            role.name = $(td).text();
        })
            .next()
            .each((idx, td) => {
            role.level = parseInt($(td).text());
        })
            .next()
            .each((idx, td) => {
            role.attribute = StringUtils_1.default.substringBefore($(td).text(), "属");
        })
            .next()
            .each((idx, td) => {
            role.attribute = $(td).text();
        })
            .parent()
            .next()
            .find("td:first")
            .next()
            .each((idx, td) => {
            let s = $(td).text();
            s = StringUtils_1.default.substringBefore(s, " GOLD");
            role.cash = parseInt(s);
        });
        const equipmentList = [];
        $(html).find("input:checkbox")
            .each((idx, checkbox) => {
            const equipment = new Equipment_1.default();
            let s = $(checkbox).val();
            equipment.index = parseInt(s);
            equipment.selectable = !$(checkbox).prop("disabled");
            const c1 = $(checkbox).parent();
            const c2 = c1.next();
            const c3 = c2.next();
            const c4 = c3.next();
            const c5 = c4.next();
            const c6 = c5.next();
            equipment.using = c2.text() === "★";
            equipment.parseName(c3.html());
            equipment.category = c4.text();
            equipment.power = parseInt(c5.text());
            equipment.weight = parseInt(c6.text());
            equipmentList.push(equipment);
        });
        const page = new TownEquipmentExpressHousePage_1.default();
        page.role = role;
        page.equipmentList = equipmentList;
        return page;
    }
}
_TownEquipmentExpressHouse_credential = new WeakMap(), _TownEquipmentExpressHouse_townId = new WeakMap();
module.exports = TownEquipmentExpressHouse;


/***/ }),
/* 96 */
/***/ ((module) => {


class TownEquipmentExpressHousePage {
}
module.exports = TownEquipmentExpressHousePage;


/***/ }),
/* 97 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownForgeHouse_credential, _TownForgeHouse_townId;
const Role_1 = __importDefault(__webpack_require__(14));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownForgeHousePage_1 = __importDefault(__webpack_require__(98));
class TownForgeHouse {
    constructor(credential, townId) {
        _TownForgeHouse_credential.set(this, void 0);
        _TownForgeHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownForgeHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownForgeHouse_townId, townId, "f");
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownForgeHouse_credential, "f").asRequestMap();
                    if (__classPrivateFieldGet(this, _TownForgeHouse_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _TownForgeHouse_townId, "f"));
                    }
                    request.set("con_str", "50");
                    request.set("mode", "MY_ARM");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const page = TownForgeHouse.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    repair(index) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (index < 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _TownForgeHouse_credential, "f").asRequestMap();
                    request.set("select", index.toString());
                    request.set("mode", "MY_ARM2");
                    NetworkUtils_1.default.post("town.cgi", request).then(() => {
                        resolve();
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const role = new Role_1.default();
        $(html).find("td:contains('ＬＶ')")
            .filter((idx, td) => $(td).text() === "ＬＶ")
            .closest("tr")
            .next()
            .find("td:first")
            .each((idx, td) => {
            role.name = $(td).text();
        })
            .next()
            .each((idx, td) => {
            role.level = parseInt($(td).text());
        })
            .next()
            .each((idx, td) => {
            role.attribute = StringUtils_1.default.substringBefore($(td).text(), "属");
        })
            .next()
            .each((idx, td) => {
            role.attribute = $(td).text();
        })
            .parent()
            .next()
            .find("td:first")
            .next()
            .each((idx, td) => {
            let s = $(td).text();
            s = StringUtils_1.default.substringBefore(s, " GOLD");
            role.cash = parseInt(s);
        });
        const page = new TownForgeHousePage_1.default();
        page.role = role;
        return page;
    }
}
_TownForgeHouse_credential = new WeakMap(), _TownForgeHouse_townId = new WeakMap();
module.exports = TownForgeHouse;


/***/ }),
/* 98 */
/***/ ((module) => {


class TownForgeHousePage {
}
module.exports = TownForgeHousePage;


/***/ }),
/* 99 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalFastLoginPageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const PersonalFastLoginPageProcessor_1 = __importDefault(__webpack_require__(100));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class PersonalFastLoginPageInterceptor {
    constructor() {
        _PersonalFastLoginPageInterceptor_processor.set(this, new PersonalFastLoginPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "mydata.cgi") {
            return pageText.includes("* 出家 *");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isFastLoginEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _PersonalFastLoginPageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_PersonalFastLoginPageInterceptor_processor = new WeakMap();
module.exports = PersonalFastLoginPageInterceptor;


/***/ }),
/* 100 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const FastLoginLoader_1 = __importDefault(__webpack_require__(55));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class PersonalFastLoginPageProcessor extends PageProcessorCredentialSupport_1.default {
    doProcess(credential, context) {
        doProcess(credential);
    }
}
function doProcess(credential) {
    $("td:first")
        .removeAttr("width")
        .removeAttr("bgcolor")
        .removeAttr("height")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "greenyellow")
        .attr("id", "title")
        .text("＜＜　 快 速 登 陆 设 置 　＞＞");
    $("table:eq(4)")
        .find("td:first")
        .attr("id", "messageBoard")
        .removeAttr("width")
        .removeAttr("bgcolor")
        .css("width", "100%")
        .css("background-color", "black")
        .css("color", "white")
        .html("可以在这里设置快速登陆，所有的登陆信息都只存储在你的浏览器本地，可以放心使用！");
    // 删除原有页面的所有表单
    $("form").remove();
    $("br:eq(3)").remove();
    $("br:eq(2)").remove();
    $("br:eq(1)").remove();
    $("br:eq(0)").remove();
    // 重新绘制页面内容
    let html = "";
    html += "<table style='width:100%;border-width:0;background-color:#888888'>";
    html += "<tbody>";
    html += "<tr style='display:none'>";
    html += "<td id='eden'></td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td id='fastLoginSetup'></td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' id='returnButton' value='离开快速登陆设置'>";
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("table:first").after($(html));
    doGenerateEdenForm(credential);
    doBindReturnButton();
    doRender();
}
function doGenerateEdenForm(credential) {
    let html = "";
    // noinspection HtmlUnknownTarget
    html += "<form action='status.cgi' method='post' id='returnForm'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='mode' value='STATUS'>";
    html += "<input type='submit' id='returnSubmit'>";
    html += "</form>";
    $("#eden").html(html);
}
function doBindReturnButton() {
    $("#returnButton").on("click", function () {
        $("#returnSubmit").trigger("click");
    });
}
function doRender() {
    let html = "";
    html += "<table style='border-width:0;width:100%;background-color:#888888'>";
    html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>快速登陆</th>";
    html += "<th style='background-color:#EFE0C0'>角色名字</th>";
    html += "<th style='background-color:#E0D0B0'>登陆名</th>";
    html += "<th style='background-color:#EFE0C0'>密码</th>";
    html += "<th style='background-color:#E0D0B0'>重复密码</th>";
    html += "<th style='background-color:#EFE0C0'>设置</th>";
    html += "</tr>";
    for (let i = 0; i < 50; i++) {
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>";
        html += "快速登陆 (" + (i + 1) + ")";
        html += "</th>";
        html += "<td style='background-color:#EFE0C0;text-align:left'>";
        html += "<input type='text' id='name_" + i + "' size='10' maxlength='10'>";
        html += "</td>";
        html += "<td style='background-color:#E0D0B0;text-align:left'>";
        html += "<input type='text' id='id_" + i + "' size='10' maxlength='10'>";
        html += "</td>";
        html += "<td style='background-color:#EFE0C0;text-align:left'>";
        html += "<input type='password' id='pass1_" + i + "' size='10' maxlength='10'>";
        html += "</td>";
        html += "<td style='background-color:#E0D0B0;text-align:left'>";
        html += "<input type='password' id='pass2_" + i + "' size='10' maxlength='10'>";
        html += "</td>";
        html += "<td style='background-color:#EFE0C0'>";
        html += "<input type='button' id='button_" + i + "' class='button_class' value='设置'>";
        html += "<input type='button' id='clear_" + i + "' class='clear_class' value='清除'>";
        html += "</td>";
        html += "</tr>";
    }
    html += "</tbody>";
    html += "</table>";
    $("#fastLoginSetup").html(html);
    for (let i = 0; i < 50; i++) {
        const config = FastLoginLoader_1.default.loadFastLoginConfig(i);
        // @ts-ignore
        let s = config.name;
        if (s !== undefined) {
            $("#name_" + i).val(s);
        }
        // @ts-ignore
        s = config.id;
        if (s !== undefined) {
            $("#id_" + i).val(s);
        }
        // @ts-ignore
        s = config.pass;
        if (s !== undefined) {
            $("#pass1_" + i).val(s);
            $("#pass2_" + i).val(s);
        }
    }
    doBindFastLoginButton();
    doBindClearButton();
}
function doBindFastLoginButton() {
    $(".button_class").on("click", function () {
        const code = parseInt($(this).attr("id").split("_")[1]);
        let s = $("#name_" + code).val();
        if (s === undefined || s.trim().length === 0) {
            MessageBoard_1.default.publishWarning("角色名字不能为空");
            return;
        }
        const name = s.trim();
        s = $("#id_" + code).val();
        if (s === undefined || s.trim().length === 0) {
            MessageBoard_1.default.publishWarning("登陆名不能为空");
            return;
        }
        const id = s.trim();
        s = $("#pass1_" + code).val();
        if (s === undefined || s.trim().length === 0) {
            MessageBoard_1.default.publishWarning("密码不能为空");
            return;
        }
        const pass1 = s.trim();
        s = $("#pass2_" + code).val();
        if (s === undefined || s.trim().length === 0) {
            MessageBoard_1.default.publishWarning("密码不能为空");
            return;
        }
        const pass2 = s.trim();
        if (pass1 !== pass2) {
            MessageBoard_1.default.publishWarning("两次输入的密码不匹配");
            return;
        }
        const value = {
            "name": name,
            "id": id,
            "pass": pass1
        };
        StorageUtils_1.default.set("_fl_" + code, JSON.stringify(value));
        MessageBoard_1.default.publishMessage("设置已经保存。");
        doRefresh();
    });
}
function doBindClearButton() {
    $(".clear_class").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const code = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
        StorageUtils_1.default.remove("_fl_" + code);
        doRefresh();
    });
}
function doRefresh() {
    $("#fastLoginSetup").html("");
    $(".button_class").off("click");
    $(".clear_class").off("click");
    doRender();
}
module.exports = PersonalFastLoginPageProcessor;


/***/ }),
/* 101 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalPetManagementPageInterceptor_inTownProcessor, _PersonalPetManagementPageInterceptor_inCastleProcessor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const PersonalPetManagementPageProcessor_Castle_1 = __importDefault(__webpack_require__(102));
const PersonalPetManagementPageProcessor_Town_1 = __importDefault(__webpack_require__(115));
const PageProcessorContext_1 = __importDefault(__webpack_require__(30));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class PersonalPetManagementPageInterceptor {
    constructor() {
        _PersonalPetManagementPageInterceptor_inTownProcessor.set(this, new PersonalPetManagementPageProcessor_Town_1.default());
        _PersonalPetManagementPageInterceptor_inCastleProcessor.set(this, new PersonalPetManagementPageProcessor_Castle_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "mydata.cgi") {
            return pageText.includes("宠物现在升级时学习新技能情况一览");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isPetManagementUIEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(townId => {
            const context = new PageProcessorContext_1.default();
            context.set("townId", townId);
            __classPrivateFieldGet(this, _PersonalPetManagementPageInterceptor_inTownProcessor, "f").process(context);
        })
            .whenInCastle(castleName => {
            const context = new PageProcessorContext_1.default();
            context.set("castleName", castleName);
            __classPrivateFieldGet(this, _PersonalPetManagementPageInterceptor_inCastleProcessor, "f").process(context);
        })
            .fork();
    }
}
_PersonalPetManagementPageInterceptor_inTownProcessor = new WeakMap(), _PersonalPetManagementPageInterceptor_inCastleProcessor = new WeakMap();
module.exports = PersonalPetManagementPageInterceptor;


/***/ }),
/* 102 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Pet_1 = __importDefault(__webpack_require__(103));
const PetProfileLoader_1 = __importDefault(__webpack_require__(104));
const CastleBank_1 = __importDefault(__webpack_require__(26));
const CastlePetExpressHouse_1 = __importDefault(__webpack_require__(106));
const CastleRanch_1 = __importDefault(__webpack_require__(107));
const GoldenCage_1 = __importDefault(__webpack_require__(109));
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const PersonalPetManagement_1 = __importDefault(__webpack_require__(112));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const AbstractPersonalPetManagementPageProcessor_1 = __importDefault(__webpack_require__(114));
class PersonalPetManagementPageProcessor_Castle extends AbstractPersonalPetManagementPageProcessor_1.default {
    doProcessWithPageParsed(credential, page, context) {
        // 修改返回城堡的表单
        $("#returnButton")
            .val("返回城堡")
            .parent()
            .attr("action", "castlestatus.cgi")
            .find("input:hidden[name='mode']")
            .val("CASTLESTATUS");
        doProcess(credential, page.petList, page.petStudyStatus);
    }
}
function doProcess(credential, petList, studyStatus) {
    new PersonalStatus_1.default(credential).load().then(role => {
        if (role.masterCareerList.includes("贤者") || role.hasMirror) {
            $("#hasGoldenCage").text("true");
        }
        $("#roleLocation").text(role.location);
        doRender(credential, petList, studyStatus);
        new PersonalEquipmentManagement_1.default(credential).open().then(page => {
            const cage = page.findGoldenCage();
            if (cage !== null) {
                $("#goldenCageIndex").text(cage.index);
                $("#openCageButton").show();
                $("#closeCageButton").show();
            }
        });
    });
}
function doRender(credential, petList, studyStatus) {
    let html = "";
    html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%'>";
    html += "<tbody style='background-color:#F8F0E0'>";
    html += "<tr>";
    html += "<td style='background-color:#EFE0C0'></td>";
    html += "<td style='background-color:#EFE0C0'>使用</td>";
    html += "<td style='background-color:#E8E8D0'>宠物名</td>";
    html += "<td style='background-color:#E8E8D0'>性别</td>";
    html += "<td style='background-color:#E8E8D0'>Ｌｖ</td>";
    html += "<td style='background-color:#E8E8D0'>ＨＰ</td>";
    html += "<td style='background-color:#E8E8D0'>攻击力</td>";
    html += "<td style='background-color:#E8E8D0'>防御力</td>";
    html += "<td style='background-color:#E8E8D0'>智力</td>";
    html += "<td style='background-color:#E8E8D0'>精神力</td>";
    html += "<td style='background-color:#E8E8D0'>速度</td>";
    html += "<td style='background-color:#E8E8D0'>技1</td>";
    html += "<td style='background-color:#E8E8D0'>技2</td>";
    html += "<td style='background-color:#E8E8D0'>技3</td>";
    html += "<td style='background-color:#E8E8D0'>技4</td>";
    html += "<td style='background-color:#E8E8D0'>亲密度</td>";
    html += "<td style='background-color:#E8E8D0'>种类</td>";
    html += "<td style='background-color:#E8E8D0'>属性1</td>";
    html += "<td style='background-color:#E8E8D0'>属性2</td>";
    html += "<td style='background-color:#E8E8D0'>成长</td>";
    html += "</tr>";
    for (const pet of petList) {
        html += "<tr>";
        html += "<td style='background-color:#EFE0C0' rowspan='2' id='pet_picture_" + pet.code + "' class='pet_picture_class'>" +
            pet.imageHtml +
            "</td>";
        html += "<td style='background-color:#EFE0C0' rowspan='2'>" +
            (pet.using ? "★" : "") +
            "</td>";
        html += "<td style='background-color:#E8E8D0' id='pet_name_" + pet.code + "' class='PetUIButton'>" +
            "<b>" + pet.name + "</b>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.gender +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.level +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.health + "/" + pet.maxHealth +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.attack >= 375 ? "<b style='color:red'>" + pet.attack + "</b>" : pet.attack) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.defense >= 375 ? "<b style='color:red'>" + pet.defense + "</b>" : pet.defense) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.specialAttack >= 375 ? "<b style='color:red'>" + pet.specialAttack + "</b>" : pet.specialAttack) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.specialDefense >= 375 ? "<b style='color:red'>" + pet.specialDefense + "</b>" : pet.specialDefense) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.speed >= 375 ? "<b style='color:red'>" + pet.speed + "</b>" : pet.speed) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            "<input type='button' class='PetUIButton' id='pet_" + pet.index + "_spell_1' value='" + pet.spell1 + "' title='" + pet.spell1Description + "'>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            "<input type='button' class='PetUIButton' id='pet_" + pet.index + "_spell_2' value='" + pet.spell2 + "' title='" + pet.spell2Description + "'>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            "<input type='button' class='PetUIButton' id='pet_" + pet.index + "_spell_3' value='" + pet.spell3 + "' title='" + pet.spell3Description + "'>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            "<input type='button' class='PetUIButton' id='pet_" + pet.index + "_spell_4' value='" + pet.spell4 + "' title='" + pet.spell4Description + "'>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.love >= 100 ? "<b style='color:red'>" + pet.love + "</b>" : pet.love) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.race +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.attribute1 +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.attribute2 === "无" ? "-" : pet.attribute2) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        const petFuture = PetProfileLoader_1.default.load(pet.code);
        if (petFuture !== null) {
            html += petFuture.growExperience;
        }
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<td colspan='18' style='text-align: left'>"; // 当前宠物的操作位置
        html += "<input type='button' class='PetUIButton' value='卸下' id='pet_" + pet.index + "_uninstall'>";
        html += "<input type='button' class='PetUIButton' value='使用' id='pet_" + pet.index + "_install'>";
        html += "<input type='button' class='PetUIButton' value='入笼' id='pet_" + pet.index + "_cage'>";
        html += "<input type='button' class='PetUIButton grazeButton' value='放牧' id='pet_" + pet.index + "_graze'>";
        html += "<input type='button' class='PetUIButton' value='亲密' id='pet_" + pet.index + "_love'>";
        html += "<input type='button' class='PetUIButton' value='参赛' id='pet_" + pet.index + "_league'>";
        html += "<input type='button' class='PetUIButton' value='献祭' id='pet_" + pet.index + "_consecrate'>";
        html += "<input type='button' class='PetUIButton' value='发送' id='pet_" + pet.index + "_send'>";
        html += "<input type='button' class='PetUIButton' value='改名' id='pet_" + pet.index + "_rename'>&nbsp;";
        html += "<input type='text' id='pet_" + pet.index + "_name_text' size='15' maxlength='20'>";
        html += "</td>";
        html += "</tr>";
    }
    html += "<tr><td style='background-color:#EFE0C0;text-align:right' colspan='20'>";
    html += "<input type='text' id='receiverName' size='15' maxlength='20'>";
    html += "<input type='button' class='PetUIButton' id='searchReceiverButton' value='找人'>";
    html += "<select name='eid' id='receiverCandidates'><option value=''>选择发送对象</select>";
    html += "</td></tr>";
    html += "<tr><td style='background-color:#EFE0C0;text-align:center' colspan='20'>";
    html += "<b style='color:navy'>设置宠物升级时学习技能情况</b>";
    html += "</td></tr>";
    html += "<tr><td style='background-color:#E8E8D0;text-align:center' colspan='20'>";
    html += "<input type='button' class='PetUIButton' value='第１技能位' id='pet_spell_study_1'>";
    html += "<input type='button' class='PetUIButton' value='第２技能位' id='pet_spell_study_2'>";
    html += "<input type='button' class='PetUIButton' value='第３技能位' id='pet_spell_study_3'>";
    html += "<input type='button' class='PetUIButton' value='第４技能位' id='pet_spell_study_4'>";
    html += "</td></tr>";
    html += "<tr><td style='background-color:#E8E8D0;text-align:center' colspan='20'>";
    html += "<input type='button' class='PetUIButton' value='刷新宠物管理' id='refreshButton'>";
    html += "<input type='button' class='PetUIButton' value='打开黄金笼子' id='openCageButton'>";
    html += "<input type='button' class='PetUIButton' value='关闭黄金笼子' id='closeCageButton'>";
    html += "<input type='button' class='PetUIButton' value='从黄金笼子盲取' id='takeOutFirstFromCageButton' disabled style='display:none'>";
    html += "</td></tr>";
    html += "<tr><td style='background-color:#E8E8D0;text-align:center' colspan='20'>";
    html += "<input type='button' class='PetUIButton' value='打开城堡牧场' id='openRanchButton'>";
    html += "<input type='button' class='PetUIButton' value='关闭城堡牧场' id='closeRanchButton'>";
    html += "</td></tr>";
    html += "<tr style='display:none'><td id='goldenCageContainer' style='background-color:#E8E8D0;text-align:center' colspan='20'>";
    html += "</td></tr>";
    html += "</tbody>";
    html += "</table>";
    $("#pet_management_container").html(html);
    if ($("#goldenCageIndex").text() === "none") {
        $("#openCageButton").hide();
        $("#closeCageButton").hide();
    }
    // 根据宠物状态修改按钮的样式
    for (let i = 0; i < petList.length; i++) {
        const pet = petList[i];
        // 设置卸下宠物按钮的状态
        if (!pet.using) {
            let buttonId = "pet_" + pet.index + "_uninstall";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置使用宠物按钮的状态
        if (pet.using) {
            let buttonId = "pet_" + pet.index + "_install";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
            buttonId = "pet_" + pet.index + "_cage";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
            buttonId = "pet_" + pet.index + "_graze";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        if ($("#hasGoldenCage").text() !== "true" && !pet.using) {
            // 没有黄金笼子的不应该有入笼选项
            let buttonId = "pet_" + pet.index + "_cage";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置宠物技能按钮的状态
        let spellButtonId = "pet_" + pet.index + "_spell_1";
        if (pet.usingSpell1) {
            $("#" + spellButtonId).css("color", "blue");
        }
        else {
            $("#" + spellButtonId).css("color", "grey");
        }
        spellButtonId = "pet_" + pet.index + "_spell_2";
        if (pet.usingSpell2) {
            $("#" + spellButtonId).css("color", "blue");
        }
        else {
            $("#" + spellButtonId).css("color", "grey");
        }
        spellButtonId = "pet_" + pet.index + "_spell_3";
        if (pet.usingSpell3) {
            $("#" + spellButtonId).css("color", "blue");
        }
        else {
            $("#" + spellButtonId).css("color", "grey");
        }
        spellButtonId = "pet_" + pet.index + "_spell_4";
        if (pet.usingSpell4) {
            $("#" + spellButtonId).css("color", "blue");
        }
        else {
            $("#" + spellButtonId).css("color", "grey");
        }
        // 设置宠物亲密度按钮的状态
        if (pet.love >= 100) {
            let buttonId = "pet_" + pet.index + "_love";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置宠物联赛按钮的状态
        if (pet.level < 100) {
            let buttonId = "pet_" + pet.index + "_league";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置宠物献祭按钮的状态
        if (pet.level !== 1) {
            let buttonId = "pet_" + pet.index + "_consecrate";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置宠物发送按钮的状态
        if (pet.using) {
            let buttonId = "pet_" + pet.index + "_send";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
    }
    // 设置技能学习位的按钮样式
    if (studyStatus.includes(1)) {
        $("#pet_spell_study_1").css("color", "blue");
    }
    else {
        $("#pet_spell_study_1").css("color", "grey");
    }
    if (studyStatus.includes(2)) {
        $("#pet_spell_study_2").css("color", "blue");
    }
    else {
        $("#pet_spell_study_2").css("color", "grey");
    }
    if (studyStatus.includes(3)) {
        $("#pet_spell_study_3").css("color", "blue");
    }
    else {
        $("#pet_spell_study_3").css("color", "grey");
    }
    if (studyStatus.includes(4)) {
        $("#pet_spell_study_4").css("color", "blue");
    }
    else {
        $("#pet_spell_study_4").css("color", "grey");
    }
    doBindPetFuture(petList);
    // 绑定按钮点击事件处理
    doBind(credential, petList);
    doBindGrazeButton(credential);
    if ($("#goldenCageStatus").text() === "on") {
        doRenderGoldenCage(credential);
    }
    else {
        // 由于某些bug造成某些号黄金笼子消失
        if ($("#hasGoldenCage").text() === "true") {
            // 身上没有发现黄金笼子，但是掌握了贤者或者开了分身
            // 应该有笼子的，能提供限制版笼子功能，取出第一个宠物
            $("#takeOutFirstFromCageButton")
                .prop("disabled", false)
                .show()
                .on("click", function () {
                const request = credential.asRequest();
                // @ts-ignore
                request["select"] = "0";
                // @ts-ignore
                request["mode"] = "GETOUTLONGZI";
                NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                    MessageBoard_1.default.processResponseMessage(html);
                    doRefresh(credential);
                });
            });
        }
    }
    $("#openRanchButton").on("click", () => {
        if ($("#ranchState").text() === "on") {
            return;
        }
        $("#ranchState").text("on");
        doRefresh(credential);
    });
    $("#closeRanchButton").on("click", () => {
        if ($("#ranchState").text() === "off") {
            return;
        }
        $("#ranchState").text("off");
        doRefresh(credential);
    });
    if ($("#ranchState").text() === "on") {
        doRenderRanch(credential);
    }
}
function doBindPetFuture(petList) {
    for (const pet of petList) {
        const code = pet.code;
        if ($("#pet_name_" + code).length > 0) {
            $("#pet_name_" + code)
                .on("click", function () {
                const petFuture = PetProfileLoader_1.default.load(code);
                let html = "";
                html += "<table style='width:100%;border-width:0;background-color:wheat;margin:auto'>";
                html += "<tbody>";
                html += "<tr style='background-color:black;color:wheat'>";
                html += "<th>名字</th>";
                html += "<th>总族</th>";
                html += "<th>命族</th>";
                html += "<th>攻族</th>";
                html += "<th>防族</th>";
                html += "<th>智族</th>";
                html += "<th>精族</th>";
                html += "<th>速族</th>";
                html += "<th>命努</th>";
                html += "<th>攻努</th>";
                html += "<th>防努</th>";
                html += "<th>智努</th>";
                html += "<th>精努</th>";
                html += "<th>速努</th>";
                html += "<th>捕获</th>";
                html += "<th>成长</th>";
                html += "<td rowspan='2' style='text-align:center'>" + petFuture.imageHtml + "</td>";
                html += "</tr>";
                html += "<tr style='background-color:black;color:wheat;font-weight:bold;text-align:center'>";
                html += "<td>" + petFuture.name + "</td>";
                html += "<td>" + petFuture.totalBaseStats + "</td>";
                html += "<td>" + petFuture.healthBaseStats + "</td>";
                html += "<td>" + petFuture.attackBaseStats + "</td>";
                html += "<td>" + petFuture.defenseBaseStats + "</td>";
                html += "<td>" + petFuture.specialAttackBaseStats + "</td>";
                html += "<td>" + petFuture.specialDefenseBaseStats + "</td>";
                html += "<td>" + petFuture.speedBaseStats + "</td>";
                html += "<td>" + petFuture.healthEffort + "</td>";
                html += "<td>" + petFuture.attackEffort + "</td>";
                html += "<td>" + petFuture.defenseEffort + "</td>";
                html += "<td>" + petFuture.specialAttackEffort + "</td>";
                html += "<td>" + petFuture.specialDefenseEffort + "</td>";
                html += "<td>" + petFuture.speedEffort + "</td>";
                html += "<td>" + petFuture.catchRatio + "</td>";
                html += "<td>" + petFuture.growExperience + "</td>";
                html += "</tr>";
                html += "</tbody>";
                html += "</table>";
                $("#messageBoard").html(html);
            });
        }
        if ($("#pet_picture_" + code).length > 0) {
            $("#pet_picture_" + code)
                .on("mouseenter", function () {
                const petFuture = PetProfileLoader_1.default.load(code);
                let html = "";
                html += "<table style='width:100%;border-width:0;background-color:wheat;margin:auto'>";
                html += "<tbody>";
                html += "<tr style='background-color:black;color:wheat'>";
                html += "<th>名字</th>";
                html += "<th>总族</th>";
                html += "<th>命族</th>";
                html += "<th>攻族</th>";
                html += "<th>防族</th>";
                html += "<th>智族</th>";
                html += "<th>精族</th>";
                html += "<th>速族</th>";
                html += "<th>命努</th>";
                html += "<th>攻努</th>";
                html += "<th>防努</th>";
                html += "<th>智努</th>";
                html += "<th>精努</th>";
                html += "<th>速努</th>";
                html += "<th>捕获</th>";
                html += "<th>成长</th>";
                html += "<td rowspan='3' style='text-align:center'>" + petFuture.imageHtml + "</td>";
                html += "</tr>";
                html += "<tr style='background-color:black;color:wheat;font-weight:bold;text-align:center'>";
                html += "<td rowspan='2'>" + petFuture.name + "</td>";
                html += "<td rowspan='2'>" + petFuture.totalBaseStats + "</td>";
                html += "<td>" + petFuture.healthBaseStats + "</td>";
                html += "<td>" + petFuture.attackBaseStats + "</td>";
                html += "<td>" + petFuture.defenseBaseStats + "</td>";
                html += "<td>" + petFuture.specialAttackBaseStats + "</td>";
                html += "<td>" + petFuture.specialDefenseBaseStats + "</td>";
                html += "<td>" + petFuture.speedBaseStats + "</td>";
                html += "<td rowspan='2'>" + petFuture.healthEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.attackEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.defenseEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.specialAttackEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.specialDefenseEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.speedEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.catchRatio + "</td>";
                html += "<td rowspan='2'>" + petFuture.growExperience + "</td>";
                html += "</tr>";
                html += "<tr style='background-color:black;color:wheat;font-weight:bold;text-align:center'>";
                html += "<td>" + petFuture.perfectHealth + "</td>";
                html += "<td>" + petFuture.perfectAttack + "</td>";
                html += "<td>" + petFuture.perfectDefense + "</td>";
                html += "<td>" + petFuture.perfectSpecialAttack + "</td>";
                html += "<td>" + petFuture.perfectSpecialDefense + "</td>";
                html += "<td>" + petFuture.perfectSpeed + "</td>";
                html += "</tr>";
                html += "</tbody>";
                html += "</table>";
                $("#messageBoard").html(html);
            })
                .on("mouseleave", function () {
                MessageBoard_1.default.resetMessageBoard("全新的宠物管理UI为您带来不一样的感受，试试把鼠标停留在宠物图片上有惊喜。<br>" +
                    "手机用户请试试单击宠物名字那一栏。");
            });
        }
    }
}
function doRenderGoldenCage(credential) {
    const s = $("#goldenCageIndex").text();
    if (s === "none") {
        return;
    }
    const index = parseInt(s);
    new GoldenCage_1.default(credential).open(index).then(cagePage => {
        const cagePetList = cagePage.sortedPetList;
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0'>";
        html += "<tr>";
        html += "<td style='background-color:#E8E8D0'>宠物名</td>";
        html += "<td style='background-color:#E8E8D0'>Ｌｖ</td>";
        html += "<td style='background-color:#E8E8D0'>ＨＰ</td>";
        html += "<td style='background-color:#E8E8D0'>攻击力</td>";
        html += "<td style='background-color:#E8E8D0'>防御力</td>";
        html += "<td style='background-color:#E8E8D0'>智力</td>";
        html += "<td style='background-color:#E8E8D0'>精神力</td>";
        html += "<td style='background-color:#E8E8D0'>速度</td>";
        html += "<td style='background-color:#E8E8D0'>经验</td>";
        html += "<td style='background-color:#E8E8D0'>性别</td>";
        html += "<td style='background-color:#E8E8D0'>取出</td>";
        html += "</tr>";
        for (const pet of cagePetList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>" + pet.name + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.level + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.health + "/" + pet.maxHealth + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.attack + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.defense + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.specialAttack + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.specialDefense + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.speed + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.experience + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.gender + "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            html += "<input type='button' class='PetUIButton' id='takeOutButton_" + pet.index + "' value='取出'>";
            html += "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#goldenCageContainer")
            .html(html)
            .parent()
            .show();
        $("#goldenCageStatus").text("on");
        for (const pet of cagePetList) {
            doBindTakeOutButton(credential, pet.index);
        }
    });
}
function doBind(credential, petList) {
    for (let i = 0; i < petList.length; i++) {
        const pet = petList[i];
        let buttonId = "pet_" + pet.index + "_uninstall";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetUninstallButton(credential, buttonId);
        }
        buttonId = "pet_" + pet.index + "_install";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetInstallButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_cage";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetCageButton(credential, buttonId, pet);
        }
        doBindPetSpellButton(credential, pet);
        buttonId = "pet_" + pet.index + "_love";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetLoveButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_league";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetLeagueButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_rename";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetRenameButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_consecrate";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetConsecrateButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_send";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetSendButton(credential, buttonId, pet);
        }
    }
    // 设置宠物技能学习位的按钮行为
    doBindPetStudyButton(credential);
    // 设置查找发送对象按钮行为
    doBindSearchButton(credential);
    // 设置更新按钮行为
    doBindRefreshButton(credential);
    // 设置黄金笼子按钮的行为
    doBindGoldenCageButton(credential);
}
function doRefresh(credential) {
    new PersonalPetManagement_1.default(credential).open().then(petPage => {
        // 从新的宠物界面中重新解析宠物状态
        const petList = petPage.petList;
        const petStudyStatus = petPage.petStudyStatus;
        $(".pet_picture_class").off("mouseenter").off("mouseleave");
        // 解除当前所有的按钮
        $(".PetUIButton").off("click");
        // 清除PetUI的内容
        $("#pet_management_container").html("");
        // 清除牧场
        $("#ranchList").html("").parent().hide();
        // 使用新的宠物重新渲染PetUI
        doRender(credential, petList, petStudyStatus);
    });
}
function doBindPetUninstallButton(credential, buttonId) {
    $("#" + buttonId).on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = "-1";
        // @ts-ignore
        request["mode"] = "CHOOSEPET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindPetInstallButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "CHOOSEPET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindPetCageButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PUTINLONGZI";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindPetSpellButton(credential, pet) {
    $("#" + "pet_" + pet.index + "_spell_1").on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETUSESKILL_SET";
        if (PageUtils_1.default.isColorGrey("pet_" + pet.index + "_spell_1")) {
            // 启用当前的技能
            // @ts-ignore
            request["use1"] = "1";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_2")) {
            // @ts-ignore
            request["use2"] = "2";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_3")) {
            // @ts-ignore
            request["use3"] = "3";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_4")) {
            // @ts-ignore
            request["use4"] = "4";
        }
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#" + "pet_" + pet.index + "_spell_2").on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETUSESKILL_SET";
        if (PageUtils_1.default.isColorGrey("pet_" + pet.index + "_spell_2")) {
            // 启用当前的技能
            // @ts-ignore
            request["use2"] = "2";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_1")) {
            // @ts-ignore
            request["use1"] = "1";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_3")) {
            // @ts-ignore
            request["use3"] = "3";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_4")) {
            // @ts-ignore
            request["use4"] = "4";
        }
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#" + "pet_" + pet.index + "_spell_3").on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETUSESKILL_SET";
        if (PageUtils_1.default.isColorGrey("pet_" + pet.index + "_spell_3")) {
            // 启用当前的技能
            // @ts-ignore
            request["use3"] = "3";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_1")) {
            // @ts-ignore
            request["use1"] = "1";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_2")) {
            // @ts-ignore
            request["use2"] = "2";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_4")) {
            // @ts-ignore
            request["use4"] = "4";
        }
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#" + "pet_" + pet.index + "_spell_4").on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETUSESKILL_SET";
        if (PageUtils_1.default.isColorGrey("pet_" + pet.index + "_spell_4")) {
            // 启用当前的技能
            // @ts-ignore
            request["use4"] = "4";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_1")) {
            // @ts-ignore
            request["use1"] = "1";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_2")) {
            // @ts-ignore
            request["use2"] = "2";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_3")) {
            // @ts-ignore
            request["use3"] = "3";
        }
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindPetLoveButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const amount = Math.ceil(100 - pet.love);
        const bank = new CastleBank_1.default(credential);
        bank.withdraw(amount).then(() => {
            const request = credential.asRequest();
            // @ts-ignore
            request["mode"] = "PETADDLOVE";
            // @ts-ignore
            request["select"] = pet.index;
            NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                MessageBoard_1.default.processResponseMessage(html);
                bank.deposit().then(() => {
                    doRefresh(credential);
                });
            });
        });
    });
}
function doBindPetLeagueButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETGAME";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            if (html.includes("ERROR !")) {
                const result = $(html).find("font b").text();
                MessageBoard_1.default.publishWarning(result);
                doRefresh(credential);
            }
            else {
                // 由于目前登陆宠联的操作不会触发页面刷新，因此直接返回主页面
                $("#returnButton").trigger("click");
            }
        });
    });
}
function doBindPetRenameButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const textId = "pet_" + pet.index + "_name_text";
        let newName = $("#" + textId).val();
        if (newName !== "") {
            newName = escape(newName);
            const request = credential.asRequest();
            // @ts-ignore
            request["select"] = pet.index;
            // @ts-ignore
            request["name"] = newName;
            // @ts-ignore
            request["mode"] = "PETCHANGENAME";
            NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                MessageBoard_1.default.processResponseMessage(html);
                doRefresh(credential);
            });
        }
    });
}
function doBindPetConsecrateButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        if (!confirm("你确认要献祭宠物" + pet.name + "吗？")) {
            return;
        }
        const bank = new CastleBank_1.default(credential);
        bank.withdraw(1000).then(() => {
            consecratePet(credential, pet.index).then(() => {
                bank.deposit().then(() => {
                    doRefresh(credential);
                });
            });
        });
    });
}
function doBindPetSendButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const receiver = $("#receiverCandidates").val();
        if (receiver === undefined || receiver.trim() === "") {
            MessageBoard_1.default.publishWarning("没有选择发送对象！");
            return;
        }
        const bank = new CastleBank_1.default(credential);
        bank.withdraw(10).then(() => {
            new CastlePetExpressHouse_1.default(credential).send(receiver, pet.index).then(() => {
                bank.deposit().then(() => {
                    doRefresh(credential);
                });
            });
        });
    });
}
function doBindPetStudyButton(credential) {
    $("#pet_spell_study_1").on("click", function () {
        const request = credential.asRequest();
        const color = $("#pet_spell_study_1").css("color");
        if (color.toString() === "rgb(128, 128, 128)") {
            // @ts-ignore
            request["study1"] = "1";
        }
        if (color.toString() === "rgb(0, 0, 255)") {
            // 当前是已经设置学习状态
        }
        // @ts-ignore
        request["mode"] = "STUDY_SET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#pet_spell_study_2").on("click", function () {
        const request = credential.asRequest();
        const color = $("#pet_spell_study_2").css("color");
        if (color.toString() === "rgb(128, 128, 128)") {
            // @ts-ignore
            request["study2"] = "2";
        }
        if (color.toString() === "rgb(0, 0, 255)") {
            // 当前是已经设置学习状态
        }
        // @ts-ignore
        request["mode"] = "STUDY_SET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#pet_spell_study_3").on("click", function () {
        const request = credential.asRequest();
        const color = $("#pet_spell_study_3").css("color");
        if (color.toString() === "rgb(128, 128, 128)") {
            // @ts-ignore
            request["study3"] = "3";
        }
        if (color.toString() === "rgb(0, 0, 255)") {
            // 当前是已经设置学习状态
        }
        // @ts-ignore
        request["mode"] = "STUDY_SET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#pet_spell_study_4").on("click", function () {
        const request = credential.asRequest();
        const color = $("#pet_spell_study_4").css("color");
        if (color.toString() === "rgb(128, 128, 128)") {
            // @ts-ignore
            request["study4"] = "4";
        }
        if (color.toString() === "rgb(0, 0, 255)") {
            // 当前是已经设置学习状态
        }
        // @ts-ignore
        request["mode"] = "STUDY_SET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindSearchButton(credential) {
    $("#searchReceiverButton").on("click", function () {
        const search = $("#receiverName").val();
        if (search.trim() === "") {
            MessageBoard_1.default.publishWarning("接收人没有输入！");
            return;
        }
        new CastlePetExpressHouse_1.default(credential).search(search).then(html => {
            $("#receiverCandidates").html(html);
        });
    });
}
function doBindRefreshButton(credential) {
    $("#refreshButton").on("click", function () {
        MessageBoard_1.default.resetMessageBoard("");
        doRefresh(credential);
    });
}
function consecratePet(credential, petIndex) {
    return __awaiter(this, void 0, void 0, function* () {
        const action = function (credential, petIndex) {
            return new Promise((resolve) => {
                const request = credential.asRequest();
                // @ts-ignore
                request["select"] = petIndex;
                // @ts-ignore
                request["mode"] = "PETBORN6";
                NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                    MessageBoard_1.default.processResponseMessage(html);
                    resolve();
                });
            });
        };
        return yield action(credential, petIndex);
    });
}
function doBindGoldenCageButton(credential) {
    $("#openCageButton").on("click", function () {
        if ($("#goldenCageStatus").text() === "on") {
            return;
        }
        doRenderGoldenCage(credential);
    });
    $("#closeCageButton").on("click", function () {
        if ($("#goldenCageStatus").text() === "off") {
            return;
        }
        $("#goldenCageContainer")
            .html("")
            .parent()
            .hide();
        $("#goldenCageStatus").text("off");
    });
}
function doBindTakeOutButton(credential, index) {
    $("#takeOutButton_" + index).on("click", function () {
        const select = StringUtils_1.default.substringAfter($(this).attr("id"), "_");
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = select;
        // @ts-ignore
        request["mode"] = "GETOUTLONGZI";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doRenderRanch(credential) {
    new CastleRanch_1.default(credential).enter().then(status => {
        const petList = Pet_1.default.sortPetList(status.ranchPetList);
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold' colspan='11'>";
        html += "＜ 城 堡 牧 场 ＞";
        html += "</td>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>等级</th>";
        html += "<th style='background-color:#E0D0B0'>生命</th>";
        html += "<th style='background-color:#E0D0B0'>攻击</th>";
        html += "<th style='background-color:#E0D0B0'>防御</th>";
        html += "<th style='background-color:#E0D0B0'>智力</th>";
        html += "<th style='background-color:#E0D0B0'>精神</th>";
        html += "<th style='background-color:#E0D0B0'>速度</th>";
        html += "<th style='background-color:#EFE0C0'>经验</th>";
        html += "<th style='background-color:#EFE0C0'>性别</th>";
        html += "<th style='background-color:#E8E8D0'>召唤</th>";
        html += "</tr>";
        for (const pet of petList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>" + pet.name + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + pet.levelHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.healthHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.attackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.defenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.specialAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.specialDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.speedHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + pet.experienceHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + pet.gender + "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            html += "<input type='button' class='PetUIButton summonButton' id='summon_" + pet.index + "' value='召唤'>";
            html += "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#ranchList").html(html).parent().show();
        doBindSummonButton(credential);
    });
}
function doBindGrazeButton(credential) {
    $(".grazeButton")
        .filter((idx, button) => {
        return !$(button).prop("disabled");
    })
        .on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(StringUtils_1.default.substringBetween(buttonId, "_", "_"));
        new CastleRanch_1.default(credential).graze(index).then(() => {
            doRefresh(credential);
        });
    });
}
function doBindSummonButton(credential) {
    $(".summonButton")
        .on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(StringUtils_1.default.substringAfterLast(buttonId, "_"));
        new CastleRanch_1.default(credential).summon(index).then(() => {
            doRefresh(credential);
        });
    });
}
module.exports = PersonalPetManagementPageProcessor_Castle;


/***/ }),
/* 103 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const Constants_1 = __importDefault(__webpack_require__(10));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
class Pet {
    get imageHtml() {
        const src = Constants_1.default.POCKET_DOMAIN + "/image/pet/" + this.picture;
        return "<img src='" + src + "' width='64' height='64' alt='" + this.race + "' style='border-width:0'>";
    }
    get usingHtml() {
        return this.using ? "★" : "";
    }
    get levelHtml() {
        if (!SetupLoader_1.default.isExperienceProgressBarEnabled()) {
            return this.level.toString();
        }
        if (this.level === 100) {
            return "<span title='满级' style='color:red'>MAX</span>";
        }
        const ratio = this.level / 100;
        const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
        return "<span title='" + ("LV " + this.level) + "'>" + progressBar + "</span>";
    }
    get healthHtml() {
        return this.health + "/" + this.maxHealth;
    }
    get attackHtml() {
        if (this.attack >= 375) {
            return "<span title='倚天' style='color:red;font-weight:bold'>" + this.attack + "</span>";
        }
        else {
            return this.attack.toString();
        }
    }
    get defenseHtml() {
        if (this.defense >= 375) {
            return "<span title='磐石' style='color:red;font-weight:bold'>" + this.defense + "</span>";
        }
        else {
            return this.defense.toString();
        }
    }
    get specialAttackHtml() {
        if (this.specialAttack >= 375) {
            return "<span title='仙人' style='color:red;font-weight:bold'>" + this.specialAttack + "</span>";
        }
        else {
            return this.specialAttack.toString();
        }
    }
    get specialDefenseHtml() {
        if (this.specialDefense >= 375) {
            return "<span title='军神' style='color:red;font-weight:bold'>" + this.specialDefense + "</span>";
        }
        else {
            return this.specialDefense.toString();
        }
    }
    get speedHtml() {
        if (this.speed >= 375) {
            return "<span title='疾风' style='color:red;font-weight:bold'>" + this.speed + "</span>";
        }
        else {
            return this.speed.toString();
        }
    }
    get experienceHtml() {
        if (!SetupLoader_1.default.isExperienceProgressBarEnabled()) {
            return this.experience.toString();
        }
        if (this.level === 100) {
            return "<span title='满级' style='color:red'>MAX</span>";
        }
        const nextLevel = this.level + 1;
        const maxExperience = (Math.pow(nextLevel / 100, 2) * 1000000);
        const ratio = this.experience / maxExperience;
        const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
        return "<span title='" + this.experience + "'>" + progressBar + "</span>";
    }
    static sortPetList(source) {
        const target = [];
        target.push(...source);
        if (!SetupLoader_1.default.isEquipmentPetSortEnabled()) {
            return target;
        }
        target.sort((a, b) => {
            let ret = b.level - a.level;
            if (ret !== 0) {
                return ret;
            }
            let a1 = (a.name.includes("(") && a.name.includes(")")) ? 0 : 1;
            let b1 = (b.name.includes("(") && b.name.includes(")")) ? 0 : 1;
            ret = a1 - b1;
            if (ret !== 0) {
                return ret;
            }
            let a2 = (a.name.includes("(") && a.name.includes(")")) ?
                StringUtils_1.default.substringBetween(a.name, "(", ")") : a.name;
            let b2 = (b.name.includes("(") && b.name.includes(")")) ?
                StringUtils_1.default.substringBetween(b.name, "(", ")") : b.name;
            return a2.localeCompare(b2);
        });
        return target;
    }
}
module.exports = Pet;


/***/ }),
/* 104 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const PetProfile_1 = __importDefault(__webpack_require__(105));
class PetProfileLoader {
    static load(code) {
        // @ts-ignore
        const config = PET_FUTURES[code];
        if (config === undefined) {
            return null;
        }
        return doParse(code, config);
    }
    static loadAll() {
        const futureList = [];
        const codes = Object.keys(PET_FUTURES);
        for (let i = 0; i < codes.length; i++) {
            const code = codes[i];
            // @ts-ignore
            const config = PET_FUTURES[code];
            const future = doParse(code, config);
            futureList.push(future);
        }
        return futureList;
    }
}
function doParse(code, config) {
    const future = new PetProfile_1.default();
    future.code = code;
    // @ts-ignore
    future.name = config.n;
    // @ts-ignore
    future.picture = config.p;
    // @ts-ignore
    future.healthBaseStats = config.f0;
    // @ts-ignore
    future.attackBaseStats = config.f1;
    // @ts-ignore
    future.defenseBaseStats = config.f2;
    // @ts-ignore
    future.specialAttackBaseStats = config.f3;
    // @ts-ignore
    future.specialDefenseBaseStats = config.f4;
    // @ts-ignore
    future.speedBaseStats = config.f5;
    // @ts-ignore
    future.healthEffort = config.e0;
    // @ts-ignore
    future.attackEffort = config.e1;
    // @ts-ignore
    future.defenseEffort = config.e2;
    // @ts-ignore
    future.specialAttackEffort = config.e3;
    // @ts-ignore
    future.specialDefenseEffort = config.e4;
    // @ts-ignore
    future.speedEffort = config.e5;
    // @ts-ignore
    future.catchRatio = config.cr;
    // @ts-ignore
    future.growExperience = config.ge;
    return future;
}
const PET_FUTURES = {
    "001": {
        "n": "妙蛙种子(001)",
        "p": "203.gif",
        "f0": 45,
        "f1": 49,
        "f2": 49,
        "f3": 65,
        "f4": 65,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 64
    },
    "002": {
        "n": "妙蛙草(002)",
        "p": "204.gif",
        "f0": 60,
        "f1": 62,
        "f2": 63,
        "f3": 80,
        "f4": 80,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 141
    },
    "003": {
        "n": "妙蛙花(003)",
        "p": "205.gif",
        "f0": 80,
        "f1": 82,
        "f2": 83,
        "f3": 100,
        "f4": 100,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 208
    },
    "004": {
        "n": "小火龙(004)",
        "p": "206.gif",
        "f0": 39,
        "f1": 52,
        "f2": 43,
        "f3": 60,
        "f4": 50,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 65
    },
    "005": {
        "n": "火恐龙(005)",
        "p": "207.gif",
        "f0": 58,
        "f1": 64,
        "f2": 58,
        "f3": 80,
        "f4": 65,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 142
    },
    "006": {
        "n": "喷火龙(006)",
        "p": "208.gif",
        "f0": 78,
        "f1": 84,
        "f2": 78,
        "f3": 109,
        "f4": 85,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 209
    },
    "007": {
        "n": "杰尼龟(007)",
        "p": "209.gif",
        "f0": 44,
        "f1": 48,
        "f2": 65,
        "f3": 50,
        "f4": 64,
        "f5": 43,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 66
    },
    "008": {
        "n": "卡咪龟(008)",
        "p": "210.gif",
        "f0": 59,
        "f1": 63,
        "f2": 80,
        "f3": 65,
        "f4": 80,
        "f5": 58,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 143
    },
    "009": {
        "n": "水箭龟(009)",
        "p": "211.gif",
        "f0": 79,
        "f1": 83,
        "f2": 100,
        "f3": 85,
        "f4": 105,
        "f5": 78,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 45,
        "ge": 210
    },
    "010": {
        "n": "绿毛虫(010)",
        "p": "212.gif",
        "f0": 45,
        "f1": 30,
        "f2": 35,
        "f3": 20,
        "f4": 20,
        "f5": 45,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 53
    },
    "011": {
        "n": "铁甲蛹(011)",
        "p": "213.gif",
        "f0": 50,
        "f1": 20,
        "f2": 55,
        "f3": 25,
        "f4": 25,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 72
    },
    "012": {
        "n": "巴大蝴(012)",
        "p": "214.gif",
        "f0": 60,
        "f1": 45,
        "f2": 50,
        "f3": 80,
        "f4": 80,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 160
    },
    "013": {
        "n": "独角虫(013)",
        "p": "215.gif",
        "f0": 40,
        "f1": 35,
        "f2": 30,
        "f3": 20,
        "f4": 20,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 52
    },
    "014": {
        "n": "铁壳昆(014)",
        "p": "216.gif",
        "f0": 45,
        "f1": 25,
        "f2": 50,
        "f3": 25,
        "f4": 25,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 71
    },
    "015": {
        "n": "大针蜂(015)",
        "p": "217.gif",
        "f0": 65,
        "f1": 80,
        "f2": 40,
        "f3": 45,
        "f4": 80,
        "f5": 75,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 159
    },
    "016": {
        "n": "波波(016)",
        "p": "218.gif",
        "f0": 40,
        "f1": 45,
        "f2": 40,
        "f3": 35,
        "f4": 35,
        "f5": 56,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 55
    },
    "017": {
        "n": "比比鸟(017)",
        "p": "219.gif",
        "f0": 63,
        "f1": 60,
        "f2": 55,
        "f3": 50,
        "f4": 50,
        "f5": 71,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 120,
        "ge": 113
    },
    "018": {
        "n": "比雕(018)",
        "p": "220.gif",
        "f0": 83,
        "f1": 80,
        "f2": 75,
        "f3": 70,
        "f4": 70,
        "f5": 91,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 3,
        "cr": 45,
        "ge": 172
    },
    "019": {
        "n": "小拉达(019)",
        "p": "221.gif",
        "f0": 30,
        "f1": 56,
        "f2": 35,
        "f3": 25,
        "f4": 35,
        "f5": 72,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 57
    },
    "020": {
        "n": "拉达(020)",
        "p": "222.gif",
        "f0": 55,
        "f1": 81,
        "f2": 60,
        "f3": 50,
        "f4": 70,
        "f5": 97,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 127,
        "ge": 116
    },
    "021": {
        "n": "烈雀(021)",
        "p": "223.gif",
        "f0": 40,
        "f1": 60,
        "f2": 30,
        "f3": 31,
        "f4": 31,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 58
    },
    "022": {
        "n": "尖嘴鸟(022)",
        "p": "224.gif",
        "f0": 65,
        "f1": 90,
        "f2": 65,
        "f3": 61,
        "f4": 61,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 90,
        "ge": 162
    },
    "023": {
        "n": "阿柏蛇(023)",
        "p": "225.gif",
        "f0": 35,
        "f1": 60,
        "f2": 44,
        "f3": 40,
        "f4": 54,
        "f5": 55,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 62
    },
    "024": {
        "n": "阿柏怪(024)",
        "p": "226.gif",
        "f0": 60,
        "f1": 85,
        "f2": 69,
        "f3": 65,
        "f4": 79,
        "f5": 80,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 147
    },
    "025": {
        "n": "皮卡丘(025)",
        "p": "156.gif",
        "f0": 35,
        "f1": 55,
        "f2": 30,
        "f3": 50,
        "f4": 40,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 190,
        "ge": 82
    },
    "026": {
        "n": "雷丘(026)",
        "p": "157.gif",
        "f0": 60,
        "f1": 90,
        "f2": 55,
        "f3": 90,
        "f4": 80,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 3,
        "cr": 75,
        "ge": 122
    },
    "027": {
        "n": "穿山鼠(027)",
        "p": "112.gif",
        "f0": 50,
        "f1": 75,
        "f2": 85,
        "f3": 20,
        "f4": 30,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 93
    },
    "028": {
        "n": "穿山王(028)",
        "p": "113.gif",
        "f0": 75,
        "f1": 100,
        "f2": 110,
        "f3": 45,
        "f4": 55,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 163
    },
    "029": {
        "n": "尼多兰(029)",
        "p": "227.gif",
        "f0": 55,
        "f1": 47,
        "f2": 52,
        "f3": 40,
        "f4": 40,
        "f5": 41,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 235,
        "ge": 59
    },
    "030": {
        "n": "尼多莉娜(030)",
        "p": "228.gif",
        "f0": 70,
        "f1": 62,
        "f2": 67,
        "f3": 55,
        "f4": 55,
        "f5": 56,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 117
    },
    "031": {
        "n": "尼多后(031)",
        "p": "229.gif",
        "f0": 90,
        "f1": 82,
        "f2": 87,
        "f3": 75,
        "f4": 85,
        "f5": 76,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 194
    },
    "032": {
        "n": "尼多朗(032)",
        "p": "230.gif",
        "f0": 46,
        "f1": 57,
        "f2": 40,
        "f3": 40,
        "f4": 40,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 235,
        "ge": 60
    },
    "033": {
        "n": "尼多利诺(033)",
        "p": "231.gif",
        "f0": 61,
        "f1": 72,
        "f2": 57,
        "f3": 55,
        "f4": 55,
        "f5": 65,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 118
    },
    "034": {
        "n": "尼多王(034)",
        "p": "232.gif",
        "f0": 81,
        "f1": 92,
        "f2": 77,
        "f3": 85,
        "f4": 75,
        "f5": 85,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 195
    },
    "035": {
        "n": "皮皮(035)",
        "p": "233.gif",
        "f0": 70,
        "f1": 45,
        "f2": 48,
        "f3": 60,
        "f4": 65,
        "f5": 35,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 150,
        "ge": 68
    },
    "036": {
        "n": "皮可西(036)",
        "p": "234.gif",
        "f0": 95,
        "f1": 70,
        "f2": 73,
        "f3": 85,
        "f4": 90,
        "f5": 60,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 25,
        "ge": 129
    },
    "037": {
        "n": "六尾(037)",
        "p": "153.gif",
        "f0": 38,
        "f1": 41,
        "f2": 40,
        "f3": 50,
        "f4": 65,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 63
    },
    "038": {
        "n": "九尾(038)",
        "p": "154.gif",
        "f0": 73,
        "f1": 76,
        "f2": 75,
        "f3": 81,
        "f4": 100,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 1,
        "cr": 75,
        "ge": 178
    },
    "039": {
        "n": "胖丁(039)",
        "p": "138.gif",
        "f0": 115,
        "f1": 45,
        "f2": 20,
        "f3": 45,
        "f4": 25,
        "f5": 20,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 170,
        "ge": 76
    },
    "040": {
        "n": "胖可丁(040)",
        "p": "139.gif",
        "f0": 140,
        "f1": 70,
        "f2": 45,
        "f3": 75,
        "f4": 50,
        "f5": 45,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 50,
        "ge": 109
    },
    "041": {
        "n": "超音蝠(041)",
        "p": "063.gif",
        "f0": 40,
        "f1": 45,
        "f2": 35,
        "f3": 30,
        "f4": 40,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 54
    },
    "042": {
        "n": "大嘴蝠(042)",
        "p": "064.gif",
        "f0": 75,
        "f1": 80,
        "f2": 70,
        "f3": 65,
        "f4": 75,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 90,
        "ge": 171
    },
    "043": {
        "n": "走路草(043)",
        "p": "088.gif",
        "f0": 45,
        "f1": 50,
        "f2": 55,
        "f3": 75,
        "f4": 65,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 78
    },
    "044": {
        "n": "臭臭花(044)",
        "p": "089.gif",
        "f0": 60,
        "f1": 65,
        "f2": 70,
        "f3": 85,
        "f4": 75,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 132
    },
    "045": {
        "n": "霸王花(045)",
        "p": "090.gif",
        "f0": 75,
        "f1": 80,
        "f2": 85,
        "f3": 100,
        "f4": 90,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 184
    },
    "046": {
        "n": "派拉斯(046)",
        "p": "235.gif",
        "f0": 35,
        "f1": 70,
        "f2": 55,
        "f3": 45,
        "f4": 55,
        "f5": 25,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 70
    },
    "047": {
        "n": "派拉斯特(047)",
        "p": "236.gif",
        "f0": 60,
        "f1": 95,
        "f2": 80,
        "f3": 60,
        "f4": 80,
        "f5": 30,
        "e0": 0,
        "e1": 2,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 128
    },
    "048": {
        "n": "毛球(048)",
        "p": "237.gif",
        "f0": 60,
        "f1": 55,
        "f2": 50,
        "f3": 40,
        "f4": 55,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 190,
        "ge": 75
    },
    "049": {
        "n": "末入蛾(049)",
        "p": "238.gif",
        "f0": 70,
        "f1": 65,
        "f2": 60,
        "f3": 90,
        "f4": 75,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 1,
        "cr": 75,
        "ge": 138
    },
    "050": {
        "n": "地鼠(050)",
        "p": "239.gif",
        "f0": 10,
        "f1": 55,
        "f2": 25,
        "f3": 35,
        "f4": 45,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 81
    },
    "051": {
        "n": "三地鼠(051)",
        "p": "240.gif",
        "f0": 35,
        "f1": 80,
        "f2": 50,
        "f3": 50,
        "f4": 70,
        "f5": 120,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 50,
        "ge": 153
    },
    "052": {
        "n": "喵喵(052)",
        "p": "241.gif",
        "f0": 40,
        "f1": 45,
        "f2": 35,
        "f3": 40,
        "f4": 40,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 69
    },
    "053": {
        "n": "猫老大(053)",
        "p": "242.gif",
        "f0": 65,
        "f1": 70,
        "f2": 60,
        "f3": 65,
        "f4": 65,
        "f5": 115,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 90,
        "ge": 148
    },
    "054": {
        "n": "可达鸭(054)",
        "p": "158.gif",
        "f0": 50,
        "f1": 52,
        "f2": 48,
        "f3": 65,
        "f4": 50,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 80
    },
    "055": {
        "n": "哥达鸭(055)",
        "p": "159.gif",
        "f0": 80,
        "f1": 82,
        "f2": 78,
        "f3": 95,
        "f4": 80,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 174
    },
    "056": {
        "n": "猴怪(056)",
        "p": "243.gif",
        "f0": 40,
        "f1": 80,
        "f2": 35,
        "f3": 35,
        "f4": 45,
        "f5": 70,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 74
    },
    "057": {
        "n": "火爆猴(057)",
        "p": "244.gif",
        "f0": 65,
        "f1": 105,
        "f2": 60,
        "f3": 60,
        "f4": 70,
        "f5": 95,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 149
    },
    "058": {
        "n": "卡蒂狗(058)",
        "p": "245.gif",
        "f0": 55,
        "f1": 70,
        "f2": 45,
        "f3": 70,
        "f4": 50,
        "f5": 60,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 91
    },
    "059": {
        "n": "风速狗(059)",
        "p": "246.gif",
        "f0": 90,
        "f1": 110,
        "f2": 80,
        "f3": 100,
        "f4": 80,
        "f5": 95,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 213
    },
    "060": {
        "n": "蚊香蝌蚪(060)",
        "p": "247.gif",
        "f0": 40,
        "f1": 50,
        "f2": 40,
        "f3": 40,
        "f4": 40,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 77
    },
    "061": {
        "n": "蚊香蛙(061)",
        "p": "248.gif",
        "f0": 65,
        "f1": 65,
        "f2": 65,
        "f3": 50,
        "f4": 50,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 120,
        "ge": 131
    },
    "062": {
        "n": "快泳蛙(062)",
        "p": "249.gif",
        "f0": 90,
        "f1": 85,
        "f2": 95,
        "f3": 70,
        "f4": 90,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 3,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 185
    },
    "063": {
        "n": "凯西(063)",
        "p": "039.gif",
        "f0": 25,
        "f1": 20,
        "f2": 15,
        "f3": 105,
        "f4": 55,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 200,
        "ge": 73
    },
    "064": {
        "n": "勇吉拉(064)",
        "p": "040.gif",
        "f0": 40,
        "f1": 35,
        "f2": 30,
        "f3": 120,
        "f4": 70,
        "f5": 105,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 100,
        "ge": 145
    },
    "065": {
        "n": "胡地(065)",
        "p": "041.gif",
        "f0": 55,
        "f1": 50,
        "f2": 45,
        "f3": 135,
        "f4": 85,
        "f5": 120,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 50,
        "ge": 186
    },
    "066": {
        "n": "腕力(066)",
        "p": "073.gif",
        "f0": 70,
        "f1": 80,
        "f2": 50,
        "f3": 35,
        "f4": 35,
        "f5": 35,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 180,
        "ge": 88
    },
    "067": {
        "n": "豪力(067)",
        "p": "074.gif",
        "f0": 80,
        "f1": 100,
        "f2": 70,
        "f3": 50,
        "f4": 60,
        "f5": 45,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 146
    },
    "068": {
        "n": "怪力(068)",
        "p": "075.gif",
        "f0": 90,
        "f1": 130,
        "f2": 80,
        "f3": 65,
        "f4": 85,
        "f5": 55,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 193
    },
    "069": {
        "n": "喇叭芽(069)",
        "p": "250.gif",
        "f0": 50,
        "f1": 75,
        "f2": 35,
        "f3": 70,
        "f4": 30,
        "f5": 40,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 84
    },
    "070": {
        "n": "口朵花(070)",
        "p": "251.gif",
        "f0": 65,
        "f1": 90,
        "f2": 50,
        "f3": 85,
        "f4": 45,
        "f5": 55,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 151
    },
    "071": {
        "n": "大食花(071)",
        "p": "252.gif",
        "f0": 80,
        "f1": 105,
        "f2": 65,
        "f3": 100,
        "f4": 60,
        "f5": 70,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 191
    },
    "072": {
        "n": "玛瑙水母(072)",
        "p": "066.gif",
        "f0": 40,
        "f1": 40,
        "f2": 35,
        "f3": 50,
        "f4": 100,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 190,
        "ge": 105
    },
    "073": {
        "n": "毒刺水母(073)",
        "p": "067.gif",
        "f0": 80,
        "f1": 70,
        "f2": 65,
        "f3": 80,
        "f4": 120,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 60,
        "ge": 205
    },
    "074": {
        "n": "小拳石(074)",
        "p": "057.gif",
        "f0": 40,
        "f1": 80,
        "f2": 100,
        "f3": 30,
        "f4": 30,
        "f5": 20,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 86
    },
    "075": {
        "n": "隆隆石(075)",
        "p": "058.gif",
        "f0": 55,
        "f1": 95,
        "f2": 115,
        "f3": 45,
        "f4": 45,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 134
    },
    "076": {
        "n": "隆隆岩(076)",
        "p": "059.gif",
        "f0": 80,
        "f1": 110,
        "f2": 130,
        "f3": 55,
        "f4": 65,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 3,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 177
    },
    "077": {
        "n": "小火马(077)",
        "p": "253.gif",
        "f0": 50,
        "f1": 85,
        "f2": 55,
        "f3": 65,
        "f4": 65,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 152
    },
    "078": {
        "n": "烈焰马(078)",
        "p": "254.gif",
        "f0": 65,
        "f1": 100,
        "f2": 70,
        "f3": 80,
        "f4": 80,
        "f5": 105,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 60,
        "ge": 192
    },
    "079": {
        "n": "呆呆兽(079)",
        "p": "255.gif",
        "f0": 90,
        "f1": 65,
        "f2": 65,
        "f3": 40,
        "f4": 40,
        "f5": 15,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 99
    },
    "080": {
        "n": "呆河马(080)",
        "p": "256.gif",
        "f0": 95,
        "f1": 75,
        "f2": 110,
        "f3": 100,
        "f4": 80,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 164
    },
    "081": {
        "n": "小磁怪(081)",
        "p": "082.gif",
        "f0": 25,
        "f1": 35,
        "f2": 70,
        "f3": 95,
        "f4": 55,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 89
    },
    "082": {
        "n": "三合一磁怪(082)",
        "p": "083.gif",
        "f0": 50,
        "f1": 60,
        "f2": 95,
        "f3": 120,
        "f4": 70,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 161
    },
    "083": {
        "n": "大葱鸭(083)",
        "p": "257.gif",
        "f0": 52,
        "f1": 65,
        "f2": 55,
        "f3": 58,
        "f4": 62,
        "f5": 60,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 94
    },
    "084": {
        "n": "嘟嘟(084)",
        "p": "092.gif",
        "f0": 35,
        "f1": 85,
        "f2": 45,
        "f3": 35,
        "f4": 35,
        "f5": 75,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 96
    },
    "085": {
        "n": "嘟嘟利(085)",
        "p": "093.gif",
        "f0": 60,
        "f1": 110,
        "f2": 70,
        "f3": 60,
        "f4": 60,
        "f5": 100,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 158
    },
    "086": {
        "n": "小海狮(086)",
        "p": "258.gif",
        "f0": 65,
        "f1": 45,
        "f2": 55,
        "f3": 45,
        "f4": 70,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 190,
        "ge": 100
    },
    "087": {
        "n": "白海狮(087)",
        "p": "259.gif",
        "f0": 90,
        "f1": 70,
        "f2": 80,
        "f3": 70,
        "f4": 95,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 75,
        "ge": 176
    },
    "088": {
        "n": "臭泥(088)",
        "p": "106.gif",
        "f0": 80,
        "f1": 80,
        "f2": 50,
        "f3": 40,
        "f4": 50,
        "f5": 25,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 90
    },
    "089": {
        "n": "臭臭泥(089)",
        "p": "107.gif",
        "f0": 105,
        "f1": 105,
        "f2": 75,
        "f3": 65,
        "f4": 100,
        "f5": 50,
        "e0": 1,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 157
    },
    "090": {
        "n": "大舌贝(090)",
        "p": "260.gif",
        "f0": 30,
        "f1": 65,
        "f2": 100,
        "f3": 45,
        "f4": 25,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 97
    },
    "091": {
        "n": "铁甲贝(091)",
        "p": "261.gif",
        "f0": 50,
        "f1": 95,
        "f2": 180,
        "f3": 85,
        "f4": 45,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 203
    },
    "092": {
        "n": "鬼斯(092)",
        "p": "262.gif",
        "f0": 30,
        "f1": 35,
        "f2": 30,
        "f3": 100,
        "f4": 35,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 95
    },
    "093": {
        "n": "鬼斯通(093)",
        "p": "263.gif",
        "f0": 45,
        "f1": 50,
        "f2": 45,
        "f3": 115,
        "f4": 55,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 126
    },
    "094": {
        "n": "耿鬼(094)",
        "p": "264.gif",
        "f0": 60,
        "f1": 65,
        "f2": 60,
        "f3": 130,
        "f4": 75,
        "f5": 110,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 190
    },
    "095": {
        "n": "大岩蛇(095)",
        "p": "265.gif",
        "f0": 35,
        "f1": 45,
        "f2": 160,
        "f3": 30,
        "f4": 45,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 108
    },
    "096": {
        "n": "素利普(096)",
        "p": "266.gif",
        "f0": 60,
        "f1": 48,
        "f2": 45,
        "f3": 43,
        "f4": 90,
        "f5": 42,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 190,
        "ge": 102
    },
    "097": {
        "n": "素利柏(097)",
        "p": "267.gif",
        "f0": 85,
        "f1": 73,
        "f2": 70,
        "f3": 73,
        "f4": 115,
        "f5": 67,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 75,
        "ge": 165
    },
    "098": {
        "n": "大钳蟹(098)",
        "p": "268.gif",
        "f0": 30,
        "f1": 105,
        "f2": 90,
        "f3": 25,
        "f4": 25,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 225,
        "ge": 115
    },
    "099": {
        "n": "巨钳蟹(099)",
        "p": "269.gif",
        "f0": 55,
        "f1": 130,
        "f2": 115,
        "f3": 50,
        "f4": 50,
        "f5": 75,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 206
    },
    "100": {
        "n": "雷电球(100)",
        "p": "084.gif",
        "f0": 40,
        "f1": 30,
        "f2": 50,
        "f3": 55,
        "f4": 55,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 103
    },
    "101": {
        "n": "顽皮蛋(101)",
        "p": "085.gif",
        "f0": 60,
        "f1": 50,
        "f2": 70,
        "f3": 80,
        "f4": 80,
        "f5": 140,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 60,
        "ge": 150
    },
    "102": {
        "n": "蛋蛋(102)",
        "p": "270.gif",
        "f0": 60,
        "f1": 40,
        "f2": 80,
        "f3": 60,
        "f4": 45,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 98
    },
    "103": {
        "n": "椰蛋树(103)",
        "p": "271.gif",
        "f0": 95,
        "f1": 95,
        "f2": 85,
        "f3": 125,
        "f4": 65,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 212
    },
    "104": {
        "n": "可拉可拉(104)",
        "p": "272.gif",
        "f0": 50,
        "f1": 50,
        "f2": 95,
        "f3": 40,
        "f4": 50,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 87
    },
    "105": {
        "n": "嘎拉嘎拉(105)",
        "p": "273.gif",
        "f0": 60,
        "f1": 80,
        "f2": 110,
        "f3": 50,
        "f4": 80,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 124
    },
    "106": {
        "n": "沙瓦郎(106)",
        "p": "274.gif",
        "f0": 50,
        "f1": 120,
        "f2": 53,
        "f3": 35,
        "f4": 110,
        "f5": 87,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 139
    },
    "107": {
        "n": "艾比郎(107)",
        "p": "275.gif",
        "f0": 50,
        "f1": 105,
        "f2": 79,
        "f3": 35,
        "f4": 110,
        "f5": 76,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 140
    },
    "108": {
        "n": "大舌头(108)",
        "p": "276.gif",
        "f0": 90,
        "f1": 55,
        "f2": 75,
        "f3": 60,
        "f4": 75,
        "f5": 30,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 127
    },
    "109": {
        "n": "瓦斯弹(109)",
        "p": "108.gif",
        "f0": 40,
        "f1": 65,
        "f2": 95,
        "f3": 60,
        "f4": 45,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 114
    },
    "110": {
        "n": "双弹瓦斯(110)",
        "p": "109.gif",
        "f0": 65,
        "f1": 90,
        "f2": 120,
        "f3": 85,
        "f4": 70,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 173
    },
    "111": {
        "n": "铁甲犀牛(111)",
        "p": "169.gif",
        "f0": 80,
        "f1": 85,
        "f2": 95,
        "f3": 30,
        "f4": 30,
        "f5": 25,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 135
    },
    "112": {
        "n": "铁甲暴龙(112)",
        "p": "170.gif",
        "f0": 105,
        "f1": 130,
        "f2": 120,
        "f3": 45,
        "f4": 45,
        "f5": 40,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 204
    },
    "113": {
        "n": "吉利蛋(113)",
        "p": "277.gif",
        "f0": 250,
        "f1": 5,
        "f2": 5,
        "f3": 35,
        "f4": 105,
        "f5": 50,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 255
    },
    "114": {
        "n": "蔓藤怪(114)",
        "p": "278.gif",
        "f0": 65,
        "f1": 55,
        "f2": 115,
        "f3": 100,
        "f4": 40,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 166
    },
    "115": {
        "n": "袋龙(115)",
        "p": "279.gif",
        "f0": 105,
        "f1": 95,
        "f2": 80,
        "f3": 40,
        "f4": 80,
        "f5": 90,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 175
    },
    "116": {
        "n": "墨海马(116)",
        "p": "184.gif",
        "f0": 30,
        "f1": 40,
        "f2": 70,
        "f3": 70,
        "f4": 25,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 225,
        "ge": 83
    },
    "117": {
        "n": "海刺龙(117)",
        "p": "185.gif",
        "f0": 55,
        "f1": 65,
        "f2": 95,
        "f3": 95,
        "f4": 45,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 155
    },
    "118": {
        "n": "角金鱼(118)",
        "p": "050.gif",
        "f0": 45,
        "f1": 67,
        "f2": 60,
        "f3": 35,
        "f4": 50,
        "f5": 63,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 225,
        "ge": 111
    },
    "119": {
        "n": "金鱼王(119)",
        "p": "051.gif",
        "f0": 80,
        "f1": 92,
        "f2": 65,
        "f3": 65,
        "f4": 80,
        "f5": 68,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 170
    },
    "120": {
        "n": "海星星(120)",
        "p": "143.gif",
        "f0": 30,
        "f1": 45,
        "f2": 55,
        "f3": 70,
        "f4": 55,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 225,
        "ge": 106
    },
    "121": {
        "n": "宝石海星(121)",
        "p": "144.gif",
        "f0": 60,
        "f1": 75,
        "f2": 85,
        "f3": 100,
        "f4": 85,
        "f5": 115,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 60,
        "ge": 207
    },
    "122": {
        "n": "吸盘魔偶(122)",
        "p": "280.gif",
        "f0": 40,
        "f1": 45,
        "f2": 65,
        "f3": 100,
        "f4": 120,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 136
    },
    "123": {
        "n": "飞天螳螂(123)",
        "p": "281.gif",
        "f0": 70,
        "f1": 110,
        "f2": 80,
        "f3": 55,
        "f4": 80,
        "f5": 105,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 187
    },
    "124": {
        "n": "迷唇姐(124)",
        "p": "282.gif",
        "f0": 65,
        "f1": 50,
        "f2": 35,
        "f3": 115,
        "f4": 95,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 137
    },
    "125": {
        "n": "电击兽(125)",
        "p": "283.gif",
        "f0": 65,
        "f1": 83,
        "f2": 57,
        "f3": 95,
        "f4": 85,
        "f5": 105,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 45,
        "ge": 156
    },
    "126": {
        "n": "鸭嘴火龙(126)",
        "p": "284.gif",
        "f0": 65,
        "f1": 95,
        "f2": 57,
        "f3": 100,
        "f4": 85,
        "f5": 93,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 167
    },
    "127": {
        "n": "大甲(127)",
        "p": "167.gif",
        "f0": 65,
        "f1": 125,
        "f2": 100,
        "f3": 55,
        "f4": 70,
        "f5": 85,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 200
    },
    "128": {
        "n": "肯泰罗(128)",
        "p": "285.gif",
        "f0": 75,
        "f1": 100,
        "f2": 95,
        "f3": 40,
        "f4": 70,
        "f5": 110,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 211
    },
    "129": {
        "n": "鲤鱼王(129)",
        "p": "052.gif",
        "f0": 20,
        "f1": 10,
        "f2": 55,
        "f3": 15,
        "f4": 20,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 20
    },
    "130": {
        "n": "暴鲤龙(130)",
        "p": "053.gif",
        "f0": 95,
        "f1": 125,
        "f2": 79,
        "f3": 60,
        "f4": 100,
        "f5": 81,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 214
    },
    "131": {
        "n": "拉普拉斯(131)",
        "p": "286.gif",
        "f0": 130,
        "f1": 85,
        "f2": 80,
        "f3": 85,
        "f4": 95,
        "f5": 60,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 219
    },
    "132": {
        "n": "百变怪(132)",
        "p": "287.gif",
        "f0": 48,
        "f1": 48,
        "f2": 48,
        "f3": 48,
        "f4": 48,
        "f5": 48,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 35,
        "ge": 61
    },
    "133": {
        "n": "伊布(133)",
        "p": "288.gif",
        "f0": 55,
        "f1": 55,
        "f2": 50,
        "f3": 45,
        "f4": 65,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 92
    },
    "134": {
        "n": "水精灵(134)",
        "p": "289.gif",
        "f0": 130,
        "f1": 65,
        "f2": 60,
        "f3": 110,
        "f4": 95,
        "f5": 65,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 196
    },
    "135": {
        "n": "雷精灵(135)",
        "p": "290.gif",
        "f0": 65,
        "f1": 65,
        "f2": 60,
        "f3": 110,
        "f4": 95,
        "f5": 130,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 45,
        "ge": 197
    },
    "136": {
        "n": "火精灵(136)",
        "p": "291.gif",
        "f0": 65,
        "f1": 130,
        "f2": 60,
        "f3": 95,
        "f4": 110,
        "f5": 65,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 198
    },
    "137": {
        "n": "3D龙(137)",
        "p": "292.gif",
        "f0": 65,
        "f1": 60,
        "f2": 70,
        "f3": 85,
        "f4": 75,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 130
    },
    "138": {
        "n": "菊石兽(138)",
        "p": "293.gif",
        "f0": 35,
        "f1": 40,
        "f2": 100,
        "f3": 90,
        "f4": 55,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 120
    },
    "139": {
        "n": "多刺菊石兽(139)",
        "p": "294.gif",
        "f0": 70,
        "f1": 60,
        "f2": 125,
        "f3": 115,
        "f4": 70,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 199
    },
    "140": {
        "n": "化石盔(140)",
        "p": "295.gif",
        "f0": 30,
        "f1": 80,
        "f2": 90,
        "f3": 55,
        "f4": 45,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 119
    },
    "141": {
        "n": "镰刀盔(141)",
        "p": "296.gif",
        "f0": 60,
        "f1": 115,
        "f2": 105,
        "f3": 65,
        "f4": 70,
        "f5": 80,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 201
    },
    "142": {
        "n": "化石翼龙(142)",
        "p": "297.gif",
        "f0": 80,
        "f1": 105,
        "f2": 65,
        "f3": 60,
        "f4": 75,
        "f5": 130,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 45,
        "ge": 202
    },
    "143": {
        "n": "卡比兽(143)",
        "p": "298.gif",
        "f0": 160,
        "f1": 110,
        "f2": 65,
        "f3": 65,
        "f4": 110,
        "f5": 30,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 25,
        "ge": 154
    },
    "144": {
        "n": "冷冻鸟(144)",
        "p": "299.gif",
        "f0": 90,
        "f1": 85,
        "f2": 100,
        "f3": 95,
        "f4": 125,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 3,
        "ge": 215
    },
    "145": {
        "n": "闪电鸟(145)",
        "p": "300.gif",
        "f0": 90,
        "f1": 90,
        "f2": 85,
        "f3": 125,
        "f4": 90,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 216
    },
    "146": {
        "n": "火焰鸟(146)",
        "p": "301.gif",
        "f0": 90,
        "f1": 100,
        "f2": 90,
        "f3": 125,
        "f4": 85,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 217
    },
    "147": {
        "n": "迷你龙(147)",
        "p": "302.gif",
        "f0": 41,
        "f1": 64,
        "f2": 45,
        "f3": 50,
        "f4": 50,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 67
    },
    "148": {
        "n": "哈克龙(148)",
        "p": "303.gif",
        "f0": 61,
        "f1": 84,
        "f2": 65,
        "f3": 70,
        "f4": 70,
        "f5": 70,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 144
    },
    "149": {
        "n": "快龙(149)",
        "p": "304.gif",
        "f0": 91,
        "f1": 134,
        "f2": 95,
        "f3": 100,
        "f4": 100,
        "f5": 80,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 218
    },
    "150": {
        "n": "超梦(150)",
        "p": "305.gif",
        "f0": 106,
        "f1": 110,
        "f2": 90,
        "f3": 154,
        "f4": 90,
        "f5": 130,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 220
    },
    "151": {
        "n": "梦幻(151)",
        "p": "306.gif",
        "f0": 100,
        "f1": 100,
        "f2": 100,
        "f3": 100,
        "f4": 100,
        "f5": 100,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 64
    },
    "152": {
        "n": "奇科莉塔(152)",
        "p": "307.gif",
        "f0": 45,
        "f1": 49,
        "f2": 65,
        "f3": 49,
        "f4": 65,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 64
    },
    "153": {
        "n": "小花兽(153)",
        "p": "308.gif",
        "f0": 60,
        "f1": 62,
        "f2": 80,
        "f3": 63,
        "f4": 80,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 141
    },
    "154": {
        "n": "巨花兽(154)",
        "p": "309.gif",
        "f0": 80,
        "f1": 82,
        "f2": 100,
        "f3": 83,
        "f4": 100,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 208
    },
    "155": {
        "n": "火岚兽(155)",
        "p": "310.gif",
        "f0": 39,
        "f1": 52,
        "f2": 43,
        "f3": 60,
        "f4": 50,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 65
    },
    "156": {
        "n": "熔岩兽(156)",
        "p": "311.gif",
        "f0": 58,
        "f1": 64,
        "f2": 58,
        "f3": 80,
        "f4": 65,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 142
    },
    "157": {
        "n": "爆风兽(157)",
        "p": "312.gif",
        "f0": 78,
        "f1": 84,
        "f2": 78,
        "f3": 109,
        "f4": 85,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 209
    },
    "158": {
        "n": "诺可鳄(158)",
        "p": "313.gif",
        "f0": 50,
        "f1": 65,
        "f2": 64,
        "f3": 44,
        "f4": 48,
        "f5": 43,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 66
    },
    "159": {
        "n": "艾莉鳄(159)",
        "p": "314.gif",
        "f0": 65,
        "f1": 80,
        "f2": 80,
        "f3": 59,
        "f4": 63,
        "f5": 58,
        "e0": 0,
        "e1": 1,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 143
    },
    "160": {
        "n": "大丹鳄(160)",
        "p": "315.gif",
        "f0": 85,
        "f1": 105,
        "f2": 100,
        "f3": 79,
        "f4": 83,
        "f5": 78,
        "e0": 0,
        "e1": 2,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 210
    },
    "161": {
        "n": "立尾鼠(161)",
        "p": "316.gif",
        "f0": 35,
        "f1": 46,
        "f2": 34,
        "f3": 35,
        "f4": 45,
        "f5": 20,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 57
    },
    "162": {
        "n": "大立尾鼠(162)",
        "p": "317.gif",
        "f0": 85,
        "f1": 76,
        "f2": 64,
        "f3": 45,
        "f4": 55,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 90,
        "ge": 116
    },
    "163": {
        "n": "呵呵鹰(163)",
        "p": "318.gif",
        "f0": 60,
        "f1": 30,
        "f2": 30,
        "f3": 36,
        "f4": 56,
        "f5": 50,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 58
    },
    "164": {
        "n": "夜鹰(164)",
        "p": "319.gif",
        "f0": 100,
        "f1": 50,
        "f2": 50,
        "f3": 76,
        "f4": 96,
        "f5": 70,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 162
    },
    "165": {
        "n": "金龟虫(165)",
        "p": "320.gif",
        "f0": 40,
        "f1": 20,
        "f2": 30,
        "f3": 40,
        "f4": 80,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 255,
        "ge": 54
    },
    "166": {
        "n": "金龟战士(166)",
        "p": "321.gif",
        "f0": 55,
        "f1": 35,
        "f2": 50,
        "f3": 55,
        "f4": 110,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 90,
        "ge": 134
    },
    "167": {
        "n": "独角蛛(167)",
        "p": "322.gif",
        "f0": 40,
        "f1": 60,
        "f2": 40,
        "f3": 40,
        "f4": 40,
        "f5": 30,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 54
    },
    "168": {
        "n": "大独角蛛(168)",
        "p": "323.gif",
        "f0": 70,
        "f1": 90,
        "f2": 70,
        "f3": 60,
        "f4": 60,
        "f5": 40,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 134
    },
    "169": {
        "n": "双翼蝙蝠(169)",
        "p": "065.gif",
        "f0": 85,
        "f1": 90,
        "f2": 80,
        "f3": 70,
        "f4": 80,
        "f5": 130,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 3,
        "cr": 90,
        "ge": 204
    },
    "170": {
        "n": "双灯鱼(170)",
        "p": "181.gif",
        "f0": 75,
        "f1": 38,
        "f2": 38,
        "f3": 56,
        "f4": 56,
        "f5": 67,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 90
    },
    "171": {
        "n": "大双灯鱼(171)",
        "p": "182.gif",
        "f0": 125,
        "f1": 58,
        "f2": 58,
        "f3": 76,
        "f4": 76,
        "f5": 67,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 156
    },
    "172": {
        "n": "皮丘(172)",
        "p": "155.gif",
        "f0": 20,
        "f1": 40,
        "f2": 15,
        "f3": 35,
        "f4": 35,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 42
    },
    "173": {
        "n": "皮(173)",
        "p": "324.gif",
        "f0": 50,
        "f1": 25,
        "f2": 28,
        "f3": 45,
        "f4": 55,
        "f5": 15,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 150,
        "ge": 37
    },
    "174": {
        "n": "布布林(174)",
        "p": "137.gif",
        "f0": 90,
        "f1": 30,
        "f2": 15,
        "f3": 40,
        "f4": 20,
        "f5": 15,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 170,
        "ge": 39
    },
    "175": {
        "n": "波克比(175)",
        "p": "325.gif",
        "f0": 35,
        "f1": 20,
        "f2": 65,
        "f3": 40,
        "f4": 65,
        "f5": 20,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 190,
        "ge": 74
    },
    "176": {
        "n": "飞翼兽(176)",
        "p": "326.gif",
        "f0": 55,
        "f1": 40,
        "f2": 85,
        "f3": 80,
        "f4": 105,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 75,
        "ge": 114
    },
    "177": {
        "n": "玩偶鸟(177)",
        "p": "162.gif",
        "f0": 40,
        "f1": 50,
        "f2": 45,
        "f3": 70,
        "f4": 45,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 73
    },
    "178": {
        "n": "预言鸟(178)",
        "p": "163.gif",
        "f0": 65,
        "f1": 75,
        "f2": 70,
        "f3": 95,
        "f4": 70,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 1,
        "cr": 75,
        "ge": 171
    },
    "179": {
        "n": "电电羊(179)",
        "p": "327.gif",
        "f0": 55,
        "f1": 40,
        "f2": 40,
        "f3": 65,
        "f4": 45,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 235,
        "ge": 59
    },
    "180": {
        "n": "羊咩咩(180)",
        "p": "328.gif",
        "f0": 70,
        "f1": 55,
        "f2": 55,
        "f3": 80,
        "f4": 60,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 117
    },
    "181": {
        "n": "电龙(181)",
        "p": "329.gif",
        "f0": 90,
        "f1": 75,
        "f2": 75,
        "f3": 115,
        "f4": 90,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 194
    },
    "182": {
        "n": "美丽花(182)",
        "p": "091.gif",
        "f0": 75,
        "f1": 80,
        "f2": 85,
        "f3": 90,
        "f4": 100,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 45,
        "ge": 184
    },
    "183": {
        "n": "水鼠(183)",
        "p": "055.gif",
        "f0": 70,
        "f1": 20,
        "f2": 50,
        "f3": 20,
        "f4": 50,
        "f5": 40,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 58
    },
    "184": {
        "n": "大水鼠(184)",
        "p": "056.gif",
        "f0": 100,
        "f1": 50,
        "f2": 80,
        "f3": 50,
        "f4": 80,
        "f5": 50,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 153
    },
    "185": {
        "n": "骗人树(185)",
        "p": "330.gif",
        "f0": 70,
        "f1": 100,
        "f2": 115,
        "f3": 30,
        "f4": 65,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 65,
        "ge": 135
    },
    "186": {
        "n": "蚊香蛙王(186)",
        "p": "331.gif",
        "f0": 90,
        "f1": 75,
        "f2": 75,
        "f3": 90,
        "f4": 100,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 45,
        "ge": 185
    },
    "187": {
        "n": "羽毛树(187)",
        "p": "332.gif",
        "f0": 35,
        "f1": 35,
        "f2": 40,
        "f3": 35,
        "f4": 55,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 255,
        "ge": 74
    },
    "188": {
        "n": "波波树(188)",
        "p": "333.gif",
        "f0": 55,
        "f1": 45,
        "f2": 50,
        "f3": 45,
        "f4": 65,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 120,
        "ge": 136
    },
    "189": {
        "n": "棉花树(189)",
        "p": "334.gif",
        "f0": 75,
        "f1": 55,
        "f2": 70,
        "f3": 55,
        "f4": 85,
        "f5": 110,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 3,
        "cr": 45,
        "ge": 176
    },
    "190": {
        "n": "长尾猴(190)",
        "p": "335.gif",
        "f0": 55,
        "f1": 70,
        "f2": 55,
        "f3": 40,
        "f4": 55,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 94
    },
    "191": {
        "n": "悠闲种子(191)",
        "p": "336.gif",
        "f0": 30,
        "f1": 30,
        "f2": 30,
        "f3": 30,
        "f4": 30,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 235,
        "ge": 52
    },
    "192": {
        "n": "向日葵(192)",
        "p": "337.gif",
        "f0": 75,
        "f1": 75,
        "f2": 55,
        "f3": 105,
        "f4": 85,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 146
    },
    "193": {
        "n": "花羽蜻蜓(193)",
        "p": "338.gif",
        "f0": 65,
        "f1": 65,
        "f2": 45,
        "f3": 75,
        "f4": 45,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 75,
        "ge": 147
    },
    "194": {
        "n": "小嵘(194)",
        "p": "339.gif",
        "f0": 55,
        "f1": 45,
        "f2": 45,
        "f3": 25,
        "f4": 25,
        "f5": 15,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 52
    },
    "195": {
        "n": "呆呆嵘(195)",
        "p": "340.gif",
        "f0": 95,
        "f1": 85,
        "f2": 85,
        "f3": 65,
        "f4": 65,
        "f5": 35,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 137
    },
    "196": {
        "n": "艾菲狐(196)",
        "p": "341.gif",
        "f0": 65,
        "f1": 65,
        "f2": 60,
        "f3": 130,
        "f4": 95,
        "f5": 110,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 197
    },
    "197": {
        "n": "小黑兔(197)",
        "p": "342.gif",
        "f0": 95,
        "f1": 65,
        "f2": 110,
        "f3": 60,
        "f4": 130,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 197
    },
    "198": {
        "n": "夜乌鸦(198)",
        "p": "343.gif",
        "f0": 60,
        "f1": 85,
        "f2": 42,
        "f3": 85,
        "f4": 42,
        "f5": 91,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 30,
        "ge": 107
    },
    "199": {
        "n": "河马国王(199)",
        "p": "344.gif",
        "f0": 95,
        "f1": 75,
        "f2": 80,
        "f3": 100,
        "f4": 110,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 70,
        "ge": 164
    },
    "200": {
        "n": "梦魔(200)",
        "p": "345.gif",
        "f0": 60,
        "f1": 60,
        "f2": 60,
        "f3": 85,
        "f4": 85,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 147
    },
    "201": {
        "n": "未知(201)",
        "p": "346.gif",
        "f0": 48,
        "f1": 72,
        "f2": 48,
        "f3": 72,
        "f4": 48,
        "f5": 48,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 225,
        "ge": 61
    },
    "202": {
        "n": "忍耐龙(202)",
        "p": "161.gif",
        "f0": 190,
        "f1": 33,
        "f2": 58,
        "f3": 33,
        "f4": 58,
        "f5": 33,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 177
    },
    "203": {
        "n": "麒麟奇(203)",
        "p": "164.gif",
        "f0": 70,
        "f1": 80,
        "f2": 65,
        "f3": 90,
        "f4": 65,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 149
    },
    "204": {
        "n": "松果怪(204)",
        "p": "347.gif",
        "f0": 50,
        "f1": 65,
        "f2": 90,
        "f3": 35,
        "f4": 35,
        "f5": 15,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 60
    },
    "205": {
        "n": "具壳怪(205)",
        "p": "348.gif",
        "f0": 75,
        "f1": 90,
        "f2": 140,
        "f3": 60,
        "f4": 60,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 118
    },
    "206": {
        "n": "土龙(206)",
        "p": "349.gif",
        "f0": 100,
        "f1": 70,
        "f2": 70,
        "f3": 65,
        "f4": 65,
        "f5": 45,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 75
    },
    "207": {
        "n": "大钳虫(207)",
        "p": "350.gif",
        "f0": 65,
        "f1": 75,
        "f2": 105,
        "f3": 35,
        "f4": 65,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 60,
        "ge": 108
    },
    "208": {
        "n": "钢牙龙(208)",
        "p": "351.gif",
        "f0": 75,
        "f1": 85,
        "f2": 200,
        "f3": 55,
        "f4": 65,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 25,
        "ge": 196
    },
    "209": {
        "n": "布鲁(209)",
        "p": "352.gif",
        "f0": 60,
        "f1": 80,
        "f2": 50,
        "f3": 40,
        "f4": 40,
        "f5": 30,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 63
    },
    "210": {
        "n": "大布鲁(210)",
        "p": "353.gif",
        "f0": 90,
        "f1": 120,
        "f2": 75,
        "f3": 60,
        "f4": 60,
        "f5": 45,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 178
    },
    "211": {
        "n": "千针豚(211)",
        "p": "354.gif",
        "f0": 65,
        "f1": 95,
        "f2": 75,
        "f3": 55,
        "f4": 55,
        "f5": 85,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 100
    },
    "212": {
        "n": "哈萨姆(212)",
        "p": "355.gif",
        "f0": 70,
        "f1": 130,
        "f2": 100,
        "f3": 55,
        "f4": 80,
        "f5": 65,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 25,
        "ge": 200
    },
    "213": {
        "n": "洞洞龟(213)",
        "p": "356.gif",
        "f0": 20,
        "f1": 10,
        "f2": 230,
        "f3": 10,
        "f4": 230,
        "f5": 5,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 190,
        "ge": 80
    },
    "214": {
        "n": "大力甲虫(214)",
        "p": "168.gif",
        "f0": 80,
        "f1": 125,
        "f2": 75,
        "f3": 40,
        "f4": 95,
        "f5": 85,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 200
    },
    "215": {
        "n": "梦拉(215)",
        "p": "357.gif",
        "f0": 55,
        "f1": 95,
        "f2": 55,
        "f3": 35,
        "f4": 75,
        "f5": 115,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 60,
        "ge": 132
    },
    "216": {
        "n": "公主熊(216)",
        "p": "358.gif",
        "f0": 60,
        "f1": 80,
        "f2": 50,
        "f3": 50,
        "f4": 50,
        "f5": 40,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 124
    },
    "217": {
        "n": "圈圈熊(217)",
        "p": "359.gif",
        "f0": 90,
        "f1": 130,
        "f2": 75,
        "f3": 75,
        "f4": 75,
        "f5": 55,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 189
    },
    "218": {
        "n": "无壳蜗牛(218)",
        "p": "103.gif",
        "f0": 40,
        "f1": 40,
        "f2": 40,
        "f3": 70,
        "f4": 40,
        "f5": 20,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 78
    },
    "219": {
        "n": "粘液蜗牛(219)",
        "p": "104.gif",
        "f0": 50,
        "f1": 50,
        "f2": 120,
        "f3": 80,
        "f4": 80,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 154
    },
    "220": {
        "n": "乌利猪(220)",
        "p": "360.gif",
        "f0": 50,
        "f1": 50,
        "f2": 40,
        "f3": 30,
        "f4": 30,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 225,
        "ge": 78
    },
    "221": {
        "n": "伊诺猪(221)",
        "p": "361.gif",
        "f0": 100,
        "f1": 100,
        "f2": 80,
        "f3": 60,
        "f4": 60,
        "f5": 50,
        "e0": 1,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 160
    },
    "222": {
        "n": "赛尼珊瑚(222)",
        "p": "180.gif",
        "f0": 55,
        "f1": 55,
        "f2": 85,
        "f3": 65,
        "f4": 85,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 60,
        "ge": 113
    },
    "223": {
        "n": "怪蛙鱼(223)",
        "p": "362.gif",
        "f0": 35,
        "f1": 65,
        "f2": 35,
        "f3": 65,
        "f4": 35,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 78
    },
    "224": {
        "n": "石章鱼(224)",
        "p": "363.gif",
        "f0": 75,
        "f1": 105,
        "f2": 75,
        "f3": 105,
        "f4": 75,
        "f5": 45,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 164
    },
    "225": {
        "n": "吉利鸟(225)",
        "p": "364.gif",
        "f0": 45,
        "f1": 55,
        "f2": 45,
        "f3": 65,
        "f4": 45,
        "f5": 75,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 183
    },
    "226": {
        "n": "阿扁鱼(226)",
        "p": "365.gif",
        "f0": 65,
        "f1": 40,
        "f2": 70,
        "f3": 80,
        "f4": 140,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 25,
        "ge": 168
    },
    "227": {
        "n": "巨鸟(227)",
        "p": "115.gif",
        "f0": 65,
        "f1": 80,
        "f2": 140,
        "f3": 40,
        "f4": 70,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 114
    },
    "228": {
        "n": "恶魔犬(228)",
        "p": "366.gif",
        "f0": 45,
        "f1": 60,
        "f2": 30,
        "f3": 80,
        "f4": 50,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 25,
        "ge": 168
    },
    "229": {
        "n": "地狱犬(229)",
        "p": "367.gif",
        "f0": 75,
        "f1": 90,
        "f2": 50,
        "f3": 110,
        "f4": 80,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 204
    },
    "230": {
        "n": "海马龙(230)",
        "p": "186.gif",
        "f0": 75,
        "f1": 95,
        "f2": 95,
        "f3": 95,
        "f4": 95,
        "f5": 85,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 207
    },
    "231": {
        "n": "芝麻象(231)",
        "p": "165.gif",
        "f0": 90,
        "f1": 60,
        "f2": 60,
        "f3": 40,
        "f4": 40,
        "f5": 40,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 124
    },
    "232": {
        "n": "大牙象(232)",
        "p": "166.gif",
        "f0": 90,
        "f1": 120,
        "f2": 120,
        "f3": 60,
        "f4": 60,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 189
    },
    "233": {
        "n": "3D龙2(233)",
        "p": "368.gif",
        "f0": 80,
        "f1": 85,
        "f2": 80,
        "f3": 90,
        "f4": 105,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 180
    },
    "234": {
        "n": "惊角鹿(234)",
        "p": "369.gif",
        "f0": 73,
        "f1": 95,
        "f2": 62,
        "f3": 85,
        "f4": 65,
        "f5": 85,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 165
    },
    "235": {
        "n": "画画犬(235)",
        "p": "370.gif",
        "f0": 55,
        "f1": 20,
        "f2": 35,
        "f3": 20,
        "f4": 45,
        "f5": 75,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 106
    },
    "236": {
        "n": "巴路奇(236)",
        "p": "371.gif",
        "f0": 35,
        "f1": 35,
        "f2": 35,
        "f3": 35,
        "f4": 35,
        "f5": 35,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 91
    },
    "237": {
        "n": "卡波耶拉(237)",
        "p": "372.gif",
        "f0": 50,
        "f1": 95,
        "f2": 95,
        "f3": 35,
        "f4": 110,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 138
    },
    "238": {
        "n": "大眼娃(238)",
        "p": "373.gif",
        "f0": 45,
        "f1": 30,
        "f2": 15,
        "f3": 85,
        "f4": 65,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 87
    },
    "239": {
        "n": "电力兽(239)",
        "p": "374.gif",
        "f0": 45,
        "f1": 63,
        "f2": 37,
        "f3": 65,
        "f4": 55,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 106
    },
    "240": {
        "n": "布比(240)",
        "p": "375.gif",
        "f0": 45,
        "f1": 75,
        "f2": 37,
        "f3": 70,
        "f4": 55,
        "f5": 83,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 117
    },
    "241": {
        "n": "牛奶坦克(241)",
        "p": "376.gif",
        "f0": 95,
        "f1": 80,
        "f2": 105,
        "f3": 40,
        "f4": 70,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 200
    },
    "242": {
        "n": "快乐(242)",
        "p": "377.gif",
        "f0": 255,
        "f1": 10,
        "f2": 10,
        "f3": 75,
        "f4": 135,
        "f5": 55,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 255
    },
    "243": {
        "n": "雷虎(243)",
        "p": "378.gif",
        "f0": 90,
        "f1": 85,
        "f2": 75,
        "f3": 115,
        "f4": 100,
        "f5": 115,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 2,
        "cr": 3,
        "ge": 216
    },
    "244": {
        "n": "火狮(244)",
        "p": "379.gif",
        "f0": 115,
        "f1": 115,
        "f2": 85,
        "f3": 90,
        "f4": 75,
        "f5": 100,
        "e0": 1,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 217
    },
    "245": {
        "n": "水狼(245)",
        "p": "380.gif",
        "f0": 100,
        "f1": 75,
        "f2": 115,
        "f3": 90,
        "f4": 115,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 3,
        "ge": 215
    },
    "246": {
        "n": "幼甲龙(246)",
        "p": "381.gif",
        "f0": 50,
        "f1": 64,
        "f2": 50,
        "f3": 45,
        "f4": 50,
        "f5": 41,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 67
    },
    "247": {
        "n": "小甲龙(247)",
        "p": "382.gif",
        "f0": 70,
        "f1": 84,
        "f2": 70,
        "f3": 65,
        "f4": 70,
        "f5": 51,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 144
    },
    "248": {
        "n": "巨大甲龙(248)",
        "p": "383.gif",
        "f0": 100,
        "f1": 134,
        "f2": 110,
        "f3": 95,
        "f4": 100,
        "f5": 61,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 218
    },
    "249": {
        "n": "路基亚(249)",
        "p": "384.gif",
        "f0": 106,
        "f1": 90,
        "f2": 130,
        "f3": 90,
        "f4": 154,
        "f5": 110,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 3,
        "ge": 220
    },
    "250": {
        "n": "凤凰(250)",
        "p": "385.gif",
        "f0": 106,
        "f1": 130,
        "f2": 90,
        "f3": 110,
        "f4": 154,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 3,
        "ge": 220
    },
    "251": {
        "n": "雪拉比(251)",
        "p": "386.gif",
        "f0": 100,
        "f1": 100,
        "f2": 100,
        "f3": 100,
        "f4": 100,
        "f5": 100,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 64
    },
    "252": {
        "n": "草蜥蜴(252)",
        "p": "001.gif",
        "f0": 40,
        "f1": 45,
        "f2": 35,
        "f3": 65,
        "f4": 55,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 65
    },
    "253": {
        "n": "草青蛙(253)",
        "p": "002.gif",
        "f0": 50,
        "f1": 65,
        "f2": 45,
        "f3": 85,
        "f4": 65,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 45,
        "ge": 141
    },
    "254": {
        "n": "针叶王(254)",
        "p": "003.gif",
        "f0": 70,
        "f1": 85,
        "f2": 65,
        "f3": 105,
        "f4": 85,
        "f5": 120,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 3,
        "cr": 45,
        "ge": 208
    },
    "255": {
        "n": "小火鸡(255)",
        "p": "004.gif",
        "f0": 45,
        "f1": 60,
        "f2": 40,
        "f3": 70,
        "f4": 50,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 65
    },
    "256": {
        "n": "瓦卡火鸡(256)",
        "p": "005.gif",
        "f0": 60,
        "f1": 85,
        "f2": 60,
        "f3": 85,
        "f4": 60,
        "f5": 55,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 142
    },
    "257": {
        "n": "火鸡战士(257)",
        "p": "006.gif",
        "f0": 80,
        "f1": 120,
        "f2": 70,
        "f3": 110,
        "f4": 70,
        "f5": 80,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 209
    },
    "258": {
        "n": "小水狗(258)",
        "p": "007.gif",
        "f0": 50,
        "f1": 70,
        "f2": 50,
        "f3": 50,
        "f4": 50,
        "f5": 40,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 65
    },
    "259": {
        "n": "水狗(259)",
        "p": "008.gif",
        "f0": 70,
        "f1": 85,
        "f2": 70,
        "f3": 60,
        "f4": 70,
        "f5": 50,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 143
    },
    "260": {
        "n": "水狗王(260)",
        "p": "009.gif",
        "f0": 100,
        "f1": 110,
        "f2": 90,
        "f3": 85,
        "f4": 90,
        "f5": 60,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 210
    },
    "261": {
        "n": "伯秋狗(261)",
        "p": "010.gif",
        "f0": 35,
        "f1": 55,
        "f2": 35,
        "f3": 30,
        "f4": 30,
        "f5": 35,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 55
    },
    "262": {
        "n": "恶啸狼(262)",
        "p": "011.gif",
        "f0": 70,
        "f1": 90,
        "f2": 70,
        "f3": 60,
        "f4": 60,
        "f5": 70,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 127,
        "ge": 128
    },
    "263": {
        "n": "小浣熊(263)",
        "p": "012.gif",
        "f0": 38,
        "f1": 30,
        "f2": 41,
        "f3": 30,
        "f4": 41,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 60
    },
    "264": {
        "n": "小臭釉(264)",
        "p": "013.gif",
        "f0": 78,
        "f1": 70,
        "f2": 61,
        "f3": 50,
        "f4": 61,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 90,
        "ge": 128
    },
    "265": {
        "n": "红毛虫(265)",
        "p": "014.gif",
        "f0": 45,
        "f1": 45,
        "f2": 35,
        "f3": 20,
        "f4": 30,
        "f5": 20,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 54
    },
    "266": {
        "n": "刺角蛹(266)",
        "p": "015.gif",
        "f0": 50,
        "f1": 35,
        "f2": 55,
        "f3": 25,
        "f4": 25,
        "f5": 15,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 71
    },
    "267": {
        "n": "吸管蝶(267)",
        "p": "016.gif",
        "f0": 60,
        "f1": 70,
        "f2": 50,
        "f3": 90,
        "f4": 50,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 161
    },
    "268": {
        "n": "刺角昆(268)",
        "p": "017.gif",
        "f0": 50,
        "f1": 35,
        "f2": 55,
        "f3": 25,
        "f4": 25,
        "f5": 15,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 72
    },
    "269": {
        "n": "半莲毒蛾(269)",
        "p": "018.gif",
        "f0": 60,
        "f1": 50,
        "f2": 70,
        "f3": 50,
        "f4": 90,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 45,
        "ge": 160
    },
    "270": {
        "n": "哈斯荷叶(270)",
        "p": "019.gif",
        "f0": 40,
        "f1": 30,
        "f2": 30,
        "f3": 40,
        "f4": 50,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 255,
        "ge": 74
    },
    "271": {
        "n": "哈斯荷童(271)",
        "p": "020.gif",
        "f0": 60,
        "f1": 50,
        "f2": 50,
        "f3": 60,
        "f4": 70,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 120,
        "ge": 141
    },
    "272": {
        "n": "荷叶鸭(272)",
        "p": "021.gif",
        "f0": 80,
        "f1": 70,
        "f2": 70,
        "f3": 90,
        "f4": 100,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 45,
        "ge": 181
    },
    "273": {
        "n": "坚果球(273)",
        "p": "022.gif",
        "f0": 40,
        "f1": 40,
        "f2": 50,
        "f3": 30,
        "f4": 30,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 74
    },
    "274": {
        "n": "坚果怪(274)",
        "p": "023.gif",
        "f0": 70,
        "f1": 70,
        "f2": 40,
        "f3": 60,
        "f4": 40,
        "f5": 60,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 141
    },
    "275": {
        "n": "木天狗(275)",
        "p": "024.gif",
        "f0": 90,
        "f1": 100,
        "f2": 60,
        "f3": 90,
        "f4": 60,
        "f5": 80,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 181
    },
    "276": {
        "n": "思巴燕(276)",
        "p": "025.gif",
        "f0": 40,
        "f1": 55,
        "f2": 30,
        "f3": 30,
        "f4": 30,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 200,
        "ge": 59
    },
    "277": {
        "n": "奥思巴燕(277)",
        "p": "026.gif",
        "f0": 60,
        "f1": 85,
        "f2": 60,
        "f3": 50,
        "f4": 50,
        "f5": 125,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 45,
        "ge": 162
    },
    "278": {
        "n": "小海鸥(278)",
        "p": "027.gif",
        "f0": 40,
        "f1": 30,
        "f2": 30,
        "f3": 55,
        "f4": 30,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 64
    },
    "279": {
        "n": "大嘴鹈鹕(279)",
        "p": "028.gif",
        "f0": 60,
        "f1": 50,
        "f2": 100,
        "f3": 85,
        "f4": 75,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 164
    },
    "280": {
        "n": "拉托斯(280)",
        "p": "029.gif",
        "f0": 28,
        "f1": 25,
        "f2": 25,
        "f3": 45,
        "f4": 35,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 235,
        "ge": 70
    },
    "281": {
        "n": "凯利阿(281)",
        "p": "030.gif",
        "f0": 38,
        "f1": 35,
        "f2": 35,
        "f3": 65,
        "f4": 55,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 140
    },
    "282": {
        "n": "超能女皇(282)",
        "p": "031.gif",
        "f0": 68,
        "f1": 65,
        "f2": 65,
        "f3": 125,
        "f4": 115,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 208
    },
    "283": {
        "n": "阿美蛛(283)",
        "p": "032.gif",
        "f0": 40,
        "f1": 30,
        "f2": 32,
        "f3": 50,
        "f4": 52,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 200,
        "ge": 63
    },
    "284": {
        "n": "阿美蝶(284)",
        "p": "033.gif",
        "f0": 70,
        "f1": 60,
        "f2": 62,
        "f3": 80,
        "f4": 82,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 1,
        "e5": 0,
        "cr": 75,
        "ge": 128
    },
    "285": {
        "n": "凯诺菇(285)",
        "p": "034.gif",
        "f0": 60,
        "f1": 40,
        "f2": 60,
        "f3": 40,
        "f4": 60,
        "f5": 35,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 65
    },
    "286": {
        "n": "凯诺战士(286)",
        "p": "035.gif",
        "f0": 60,
        "f1": 130,
        "f2": 80,
        "f3": 60,
        "f4": 60,
        "f5": 70,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 165
    },
    "287": {
        "n": "小懒熊(287)",
        "p": "036.gif",
        "f0": 60,
        "f1": 60,
        "f2": 60,
        "f3": 35,
        "f4": 35,
        "f5": 30,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 83
    },
    "288": {
        "n": "长臂猿(288)",
        "p": "037.gif",
        "f0": 80,
        "f1": 80,
        "f2": 80,
        "f3": 55,
        "f4": 55,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 120,
        "ge": 126
    },
    "289": {
        "n": "大猩猩(289)",
        "p": "038.gif",
        "f0": 150,
        "f1": 160,
        "f2": 100,
        "f3": 95,
        "f4": 65,
        "f5": 100,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 210
    },
    "290": {
        "n": "掘地虫(290)",
        "p": "042.gif",
        "f0": 31,
        "f1": 45,
        "f2": 90,
        "f3": 30,
        "f4": 30,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 65
    },
    "291": {
        "n": "巨翅蝉(291)",
        "p": "043.gif",
        "f0": 61,
        "f1": 90,
        "f2": 45,
        "f3": 50,
        "f4": 50,
        "f5": 160,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 120,
        "ge": 155
    },
    "292": {
        "n": "鬼蝉蛹(292)",
        "p": "044.gif",
        "f0": 1,
        "f1": 90,
        "f2": 45,
        "f3": 30,
        "f4": 30,
        "f5": 40,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 95
    },
    "293": {
        "n": "音波兔(293)",
        "p": "045.gif",
        "f0": 64,
        "f1": 51,
        "f2": 23,
        "f3": 51,
        "f4": 23,
        "f5": 28,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 68
    },
    "294": {
        "n": "圆耳兔(294)",
        "p": "046.gif",
        "f0": 84,
        "f1": 71,
        "f2": 43,
        "f3": 71,
        "f4": 43,
        "f5": 48,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 126
    },
    "295": {
        "n": "噪音王(295)",
        "p": "047.gif",
        "f0": 104,
        "f1": 91,
        "f2": 63,
        "f3": 91,
        "f4": 63,
        "f5": 68,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 184
    },
    "296": {
        "n": "拳击兔(296)",
        "p": "048.gif",
        "f0": 72,
        "f1": 60,
        "f2": 30,
        "f3": 20,
        "f4": 30,
        "f5": 25,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 180,
        "ge": 87
    },
    "297": {
        "n": "相扑兔(297)",
        "p": "049.gif",
        "f0": 144,
        "f1": 120,
        "f2": 60,
        "f3": 40,
        "f4": 60,
        "f5": 50,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 200,
        "ge": 184
    },
    "298": {
        "n": "小水鼠(298)",
        "p": "054.gif",
        "f0": 50,
        "f1": 20,
        "f2": 40,
        "f3": 20,
        "f4": 40,
        "f5": 20,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 150,
        "ge": 33
    },
    "299": {
        "n": "磁石怪(299)",
        "p": "060.gif",
        "f0": 30,
        "f1": 45,
        "f2": 135,
        "f3": 45,
        "f4": 90,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 108
    },
    "300": {
        "n": "手尾猫(300)",
        "p": "061.gif",
        "f0": 50,
        "f1": 45,
        "f2": 45,
        "f3": 35,
        "f4": 35,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 65
    },
    "301": {
        "n": "圆环猫(301)",
        "p": "062.gif",
        "f0": 70,
        "f1": 65,
        "f2": 65,
        "f3": 55,
        "f4": 55,
        "f5": 70,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 60,
        "ge": 138
    },
    "302": {
        "n": "地狱超人(302)",
        "p": "068.gif",
        "f0": 50,
        "f1": 75,
        "f2": 75,
        "f3": 65,
        "f4": 65,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 98
    },
    "303": {
        "n": "巨嘴秋(303)",
        "p": "069.gif",
        "f0": 50,
        "f1": 85,
        "f2": 85,
        "f3": 55,
        "f4": 55,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 98
    },
    "304": {
        "n": "钢甲小子(304)",
        "p": "070.gif",
        "f0": 50,
        "f1": 70,
        "f2": 100,
        "f3": 40,
        "f4": 40,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 180,
        "ge": 96
    },
    "305": {
        "n": "钢甲犀牛(305)",
        "p": "071.gif",
        "f0": 60,
        "f1": 90,
        "f2": 140,
        "f3": 50,
        "f4": 50,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 152
    },
    "306": {
        "n": "钢甲暴龙(306)",
        "p": "072.gif",
        "f0": 70,
        "f1": 110,
        "f2": 180,
        "f3": 60,
        "f4": 60,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 3,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 205
    },
    "307": {
        "n": "阿萨那恩(307)",
        "p": "076.gif",
        "f0": 30,
        "f1": 40,
        "f2": 55,
        "f3": 40,
        "f4": 55,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 180,
        "ge": 91
    },
    "308": {
        "n": "丘雷姆(308)",
        "p": "077.gif",
        "f0": 60,
        "f1": 60,
        "f2": 75,
        "f3": 60,
        "f4": 75,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 90,
        "ge": 153
    },
    "309": {
        "n": "疾电狗(309)",
        "p": "078.gif",
        "f0": 40,
        "f1": 45,
        "f2": 40,
        "f3": 65,
        "f4": 40,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 120,
        "ge": 104
    },
    "310": {
        "n": "电气狗(310)",
        "p": "079.gif",
        "f0": 70,
        "f1": 75,
        "f2": 60,
        "f3": 105,
        "f4": 60,
        "f5": 105,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 45,
        "ge": 168
    },
    "311": {
        "n": "正电兔(311)",
        "p": "080.gif",
        "f0": 60,
        "f1": 50,
        "f2": 40,
        "f3": 85,
        "f4": 75,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 200,
        "ge": 120
    },
    "312": {
        "n": "负电兔(312)",
        "p": "081.gif",
        "f0": 60,
        "f1": 40,
        "f2": 50,
        "f3": 75,
        "f4": 85,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 200,
        "ge": 120
    },
    "313": {
        "n": "巴鲁胖蜂(313)",
        "p": "086.gif",
        "f0": 65,
        "f1": 73,
        "f2": 55,
        "f3": 47,
        "f4": 75,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 150,
        "ge": 146
    },
    "314": {
        "n": "伊露胖蜂(314)",
        "p": "087.gif",
        "f0": 65,
        "f1": 47,
        "f2": 55,
        "f3": 73,
        "f4": 75,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 150,
        "ge": 146
    },
    "315": {
        "n": "芭蕾玫瑰(315)",
        "p": "094.gif",
        "f0": 50,
        "f1": 60,
        "f2": 45,
        "f3": 100,
        "f4": 80,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 150,
        "ge": 152
    },
    "316": {
        "n": "吞食兽(316)",
        "p": "095.gif",
        "f0": 70,
        "f1": 43,
        "f2": 53,
        "f3": 43,
        "f4": 53,
        "f5": 40,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 225,
        "ge": 75
    },
    "317": {
        "n": "吞食王(317)",
        "p": "096.gif",
        "f0": 100,
        "f1": 73,
        "f2": 83,
        "f3": 73,
        "f4": 83,
        "f5": 55,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 168
    },
    "318": {
        "n": "三色食人鱼(318)",
        "p": "097.gif",
        "f0": 45,
        "f1": 90,
        "f2": 20,
        "f3": 65,
        "f4": 20,
        "f5": 65,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 225,
        "ge": 88
    },
    "319": {
        "n": "大口食人鲨(319)",
        "p": "098.gif",
        "f0": 70,
        "f1": 120,
        "f2": 40,
        "f3": 95,
        "f4": 40,
        "f5": 95,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 175
    },
    "320": {
        "n": "肥波鲸(320)",
        "p": "099.gif",
        "f0": 130,
        "f1": 70,
        "f2": 35,
        "f3": 70,
        "f4": 35,
        "f5": 60,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 125,
        "ge": 137
    },
    "321": {
        "n": "鲸鱼王(321)",
        "p": "100.gif",
        "f0": 170,
        "f1": 90,
        "f2": 45,
        "f3": 90,
        "f4": 45,
        "f5": 60,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 206
    },
    "322": {
        "n": "沙漠骆驼(322)",
        "p": "101.gif",
        "f0": 60,
        "f1": 60,
        "f2": 40,
        "f3": 65,
        "f4": 45,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 88
    },
    "323": {
        "n": "火山骆驼(323)",
        "p": "102.gif",
        "f0": 70,
        "f1": 100,
        "f2": 70,
        "f3": 105,
        "f4": 75,
        "f5": 40,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 150,
        "ge": 175
    },
    "324": {
        "n": "熔岩乌龟(324)",
        "p": "105.gif",
        "f0": 70,
        "f1": 85,
        "f2": 140,
        "f3": 85,
        "f4": 70,
        "f5": 20,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 161
    },
    "325": {
        "n": "弹簧小猪(325)",
        "p": "110.gif",
        "f0": 60,
        "f1": 25,
        "f2": 35,
        "f3": 70,
        "f4": 80,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 255,
        "ge": 89
    },
    "326": {
        "n": "布比猪(326)",
        "p": "111.gif",
        "f0": 80,
        "f1": 45,
        "f2": 65,
        "f3": 90,
        "f4": 110,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 60,
        "ge": 164
    },
    "327": {
        "n": "圈圈兔(327)",
        "p": "114.gif",
        "f0": 60,
        "f1": 60,
        "f2": 60,
        "f3": 60,
        "f4": 60,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 85
    },
    "328": {
        "n": "拿古拉(328)",
        "p": "116.gif",
        "f0": 45,
        "f1": 100,
        "f2": 45,
        "f3": 45,
        "f4": 45,
        "f5": 10,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 73
    },
    "329": {
        "n": "拉巴蜻蜓(329)",
        "p": "117.gif",
        "f0": 50,
        "f1": 70,
        "f2": 50,
        "f3": 50,
        "f4": 50,
        "f5": 70,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 120,
        "ge": 126
    },
    "330": {
        "n": "拉巴飞龙(330)",
        "p": "118.gif",
        "f0": 80,
        "f1": 100,
        "f2": 80,
        "f3": 80,
        "f4": 80,
        "f5": 100,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 45,
        "ge": 197
    },
    "331": {
        "n": "南瓜仙人球(331)",
        "p": "119.gif",
        "f0": 50,
        "f1": 85,
        "f2": 40,
        "f3": 85,
        "f4": 40,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 97
    },
    "332": {
        "n": "塔斯仙人掌(332)",
        "p": "120.gif",
        "f0": 70,
        "f1": 115,
        "f2": 60,
        "f3": 115,
        "f4": 60,
        "f5": 55,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 177
    },
    "333": {
        "n": "云彩雀(333)",
        "p": "121.gif",
        "f0": 45,
        "f1": 40,
        "f2": 60,
        "f3": 40,
        "f4": 75,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 255,
        "ge": 74
    },
    "334": {
        "n": "碧云龙(334)",
        "p": "122.gif",
        "f0": 75,
        "f1": 70,
        "f2": 90,
        "f3": 70,
        "f4": 105,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 188
    },
    "335": {
        "n": "雪山狐猫(335)",
        "p": "123.gif",
        "f0": 73,
        "f1": 115,
        "f2": 60,
        "f3": 60,
        "f4": 60,
        "f5": 90,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 165
    },
    "336": {
        "n": "红牙响尾蛇(336)",
        "p": "124.gif",
        "f0": 73,
        "f1": 100,
        "f2": 60,
        "f3": 100,
        "f4": 60,
        "f5": 65,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 90,
        "ge": 165
    },
    "337": {
        "n": "月亮神石(337)",
        "p": "125.gif",
        "f0": 70,
        "f1": 55,
        "f2": 65,
        "f3": 95,
        "f4": 85,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 150
    },
    "338": {
        "n": "太阳神石(338)",
        "p": "126.gif",
        "f0": 70,
        "f1": 95,
        "f2": 85,
        "f3": 55,
        "f4": 65,
        "f5": 70,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 150
    },
    "339": {
        "n": "小鲶鱼(339)",
        "p": "127.gif",
        "f0": 50,
        "f1": 48,
        "f2": 43,
        "f3": 46,
        "f4": 41,
        "f5": 60,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 92
    },
    "340": {
        "n": "地震鲶鱼(340)",
        "p": "128.gif",
        "f0": 110,
        "f1": 78,
        "f2": 73,
        "f3": 76,
        "f4": 71,
        "f5": 60,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 158
    },
    "341": {
        "n": "双钳龙虾(341)",
        "p": "129.gif",
        "f0": 43,
        "f1": 80,
        "f2": 65,
        "f3": 50,
        "f4": 35,
        "f5": 35,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 205,
        "ge": 111
    },
    "342": {
        "n": "钢钳龙虾(342)",
        "p": "130.gif",
        "f0": 63,
        "f1": 120,
        "f2": 85,
        "f3": 90,
        "f4": 55,
        "f5": 55,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 155,
        "ge": 161
    },
    "343": {
        "n": "土偶怪(343)",
        "p": "131.gif",
        "f0": 40,
        "f1": 40,
        "f2": 55,
        "f3": 40,
        "f4": 70,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 255,
        "ge": 58
    },
    "344": {
        "n": "三合一土偶(344)",
        "p": "132.gif",
        "f0": 60,
        "f1": 70,
        "f2": 105,
        "f3": 70,
        "f4": 120,
        "f5": 75,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 90,
        "ge": 189
    },
    "345": {
        "n": "向日古花(345)",
        "p": "133.gif",
        "f0": 66,
        "f1": 41,
        "f2": 77,
        "f3": 61,
        "f4": 87,
        "f5": 23,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 121
    },
    "346": {
        "n": "噬人古花(346)",
        "p": "134.gif",
        "f0": 86,
        "f1": 81,
        "f2": 97,
        "f3": 81,
        "f4": 107,
        "f5": 43,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 201
    },
    "347": {
        "n": "硬甲古蝎(347)",
        "p": "135.gif",
        "f0": 45,
        "f1": 95,
        "f2": 50,
        "f3": 40,
        "f4": 50,
        "f5": 75,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 119
    },
    "348": {
        "n": "盔甲蝎(348)",
        "p": "136.gif",
        "f0": 75,
        "f1": 125,
        "f2": 100,
        "f3": 70,
        "f4": 80,
        "f5": 45,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 200
    },
    "349": {
        "n": "丑鲤鱼(349)",
        "p": "140.gif",
        "f0": 20,
        "f1": 15,
        "f2": 20,
        "f3": 10,
        "f4": 55,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 61
    },
    "350": {
        "n": "美丽龙(350)",
        "p": "141.gif",
        "f0": 95,
        "f1": 60,
        "f2": 79,
        "f3": 100,
        "f4": 125,
        "f5": 81,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 60,
        "ge": 213
    },
    "351": {
        "n": "天气小子(351)",
        "p": "142.gif",
        "f0": 70,
        "f1": 70,
        "f2": 70,
        "f3": 70,
        "f4": 70,
        "f5": 70,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 145
    },
    "352": {
        "n": "隐身龙(352)",
        "p": "145.gif",
        "f0": 60,
        "f1": 90,
        "f2": 70,
        "f3": 60,
        "f4": 120,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 200,
        "ge": 132
    },
    "353": {
        "n": "鬼影娃娃(353)",
        "p": "146.gif",
        "f0": 44,
        "f1": 75,
        "f2": 35,
        "f3": 63,
        "f4": 33,
        "f5": 45,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 225,
        "ge": 97
    },
    "354": {
        "n": "链嘴幽魂(354)",
        "p": "147.gif",
        "f0": 64,
        "f1": 115,
        "f2": 65,
        "f3": 83,
        "f4": 63,
        "f5": 65,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 179
    },
    "355": {
        "n": "夜游灵(355)",
        "p": "148.gif",
        "f0": 20,
        "f1": 40,
        "f2": 90,
        "f3": 30,
        "f4": 90,
        "f5": 25,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 190,
        "ge": 97
    },
    "356": {
        "n": "黑乃伊(356)",
        "p": "149.gif",
        "f0": 40,
        "f1": 70,
        "f2": 130,
        "f3": 60,
        "f4": 130,
        "f5": 25,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 90,
        "ge": 179
    },
    "357": {
        "n": "热带雷龙(357)",
        "p": "150.gif",
        "f0": 99,
        "f1": 68,
        "f2": 83,
        "f3": 72,
        "f4": 87,
        "f5": 51,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 200,
        "ge": 169
    },
    "358": {
        "n": "蓝风铃(358)",
        "p": "151.gif",
        "f0": 65,
        "f1": 50,
        "f2": 70,
        "f3": 95,
        "f4": 80,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 147
    },
    "359": {
        "n": "黑面雪狐(359)",
        "p": "152.gif",
        "f0": 65,
        "f1": 130,
        "f2": 60,
        "f3": 75,
        "f4": 60,
        "f5": 75,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 174
    },
    "360": {
        "n": "小忍耐龙(360)",
        "p": "160.gif",
        "f0": 95,
        "f1": 23,
        "f2": 48,
        "f3": 23,
        "f4": 48,
        "f5": 23,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 125,
        "ge": 44
    },
    "361": {
        "n": "由基瓦拉(361)",
        "p": "171.gif",
        "f0": 50,
        "f1": 50,
        "f2": 50,
        "f3": 50,
        "f4": 50,
        "f5": 50,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 74
    },
    "362": {
        "n": "巨头冰怪(362)",
        "p": "172.gif",
        "f0": 80,
        "f1": 80,
        "f2": 80,
        "f3": 80,
        "f4": 80,
        "f5": 80,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 187
    },
    "363": {
        "n": "波波海象(363)",
        "p": "173.gif",
        "f0": 70,
        "f1": 40,
        "f2": 50,
        "f3": 55,
        "f4": 50,
        "f5": 25,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 75
    },
    "364": {
        "n": "古拉海象(364)",
        "p": "174.gif",
        "f0": 90,
        "f1": 60,
        "f2": 70,
        "f3": 75,
        "f4": 70,
        "f5": 45,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 128
    },
    "365": {
        "n": "海象牙王(365)",
        "p": "175.gif",
        "f0": 110,
        "f1": 80,
        "f2": 90,
        "f3": 95,
        "f4": 90,
        "f5": 65,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 192
    },
    "366": {
        "n": "帕鲁蚌(366)",
        "p": "176.gif",
        "f0": 35,
        "f1": 64,
        "f2": 85,
        "f3": 74,
        "f4": 55,
        "f5": 32,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 142
    },
    "367": {
        "n": "巨嘴鳗(367)",
        "p": "177.gif",
        "f0": 55,
        "f1": 104,
        "f2": 105,
        "f3": 94,
        "f4": 75,
        "f5": 52,
        "e0": 0,
        "e1": 1,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 178
    },
    "368": {
        "n": "尖头鳗(368)",
        "p": "178.gif",
        "f0": 55,
        "f1": 84,
        "f2": 105,
        "f3": 114,
        "f4": 75,
        "f5": 52,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 178
    },
    "369": {
        "n": "地图石鱼(369)",
        "p": "179.gif",
        "f0": 100,
        "f1": 90,
        "f2": 130,
        "f3": 45,
        "f4": 65,
        "f5": 55,
        "e0": 1,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 25,
        "ge": 198
    },
    "370": {
        "n": "心形鱼(370)",
        "p": "183.gif",
        "f0": 43,
        "f1": 30,
        "f2": 55,
        "f3": 40,
        "f4": 65,
        "f5": 97,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 225,
        "ge": 110
    },
    "371": {
        "n": "塔祖贝龙(371)",
        "p": "187.gif",
        "f0": 45,
        "f1": 75,
        "f2": 60,
        "f3": 40,
        "f4": 30,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 89
    },
    "372": {
        "n": "龙龙贝(372)",
        "p": "188.gif",
        "f0": 65,
        "f1": 95,
        "f2": 100,
        "f3": 60,
        "f4": 50,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 144
    },
    "373": {
        "n": "血翼飞龙(373)",
        "p": "189.gif",
        "f0": 95,
        "f1": 135,
        "f2": 80,
        "f3": 110,
        "f4": 80,
        "f5": 100,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 218
    },
    "374": {
        "n": "独眼达恩(374)",
        "p": "190.gif",
        "f0": 40,
        "f1": 55,
        "f2": 80,
        "f3": 35,
        "f4": 60,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 103
    },
    "375": {
        "n": "双臂恩古(375)",
        "p": "191.gif",
        "f0": 60,
        "f1": 75,
        "f2": 100,
        "f3": 55,
        "f4": 80,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 153
    },
    "376": {
        "n": "钢铁螃蟹(376)",
        "p": "192.gif",
        "f0": 80,
        "f1": 135,
        "f2": 130,
        "f3": 95,
        "f4": 90,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 3,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 210
    },
    "377": {
        "n": "岩神柱(377)",
        "p": "193.gif",
        "f0": 80,
        "f1": 100,
        "f2": 200,
        "f3": 50,
        "f4": 100,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 3,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 217
    },
    "378": {
        "n": "冰神柱(378)",
        "p": "194.gif",
        "f0": 80,
        "f1": 50,
        "f2": 100,
        "f3": 100,
        "f4": 200,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 3,
        "ge": 216
    },
    "379": {
        "n": "钢神柱(379)",
        "p": "195.gif",
        "f0": 80,
        "f1": 75,
        "f2": 150,
        "f3": 75,
        "f4": 150,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 3,
        "ge": 215
    },
    "380": {
        "n": "拉迪阿斯(380)",
        "p": "196.gif",
        "f0": 80,
        "f1": 80,
        "f2": 90,
        "f3": 110,
        "f4": 130,
        "f5": 110,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 3,
        "ge": 211
    },
    "381": {
        "n": "拉迪奥斯(381)",
        "p": "197.gif",
        "f0": 80,
        "f1": 90,
        "f2": 80,
        "f3": 130,
        "f4": 110,
        "f5": 110,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 211
    },
    "382": {
        "n": "海皇牙(382)",
        "p": "198.gif",
        "f0": 100,
        "f1": 100,
        "f2": 90,
        "f3": 150,
        "f4": 140,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 5,
        "ge": 218
    },
    "383": {
        "n": "古拉顿(383)",
        "p": "199.gif",
        "f0": 100,
        "f1": 150,
        "f2": 140,
        "f3": 100,
        "f4": 90,
        "f5": 90,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 5,
        "ge": 218
    },
    "384": {
        "n": "天空之龙(384)",
        "p": "200.gif",
        "f0": 105,
        "f1": 150,
        "f2": 90,
        "f3": 150,
        "f4": 90,
        "f5": 95,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 220
    },
    "385": {
        "n": "月映兽(385)",
        "p": "201.gif",
        "f0": 100,
        "f1": 100,
        "f2": 100,
        "f3": 100,
        "f4": 100,
        "f5": 100,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 215
    },
    "386": {
        "n": "迪奥西斯(386)",
        "p": "202.gif",
        "f0": 50,
        "f1": 150,
        "f2": 50,
        "f3": 150,
        "f4": 50,
        "f5": 150,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 1,
        "cr": 3,
        "ge": 215
    },
    "387": {
        "n": "树苗龟(387)",
        "p": "387.gif",
        "f0": 55,
        "f1": 68,
        "f2": 64,
        "f3": 45,
        "f4": 55,
        "f5": 31,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 64
    },
    "388": {
        "n": "树林龟(388)",
        "p": "388.gif",
        "f0": 75,
        "f1": 89,
        "f2": 85,
        "f3": 55,
        "f4": 65,
        "f5": 36,
        "e0": 0,
        "e1": 1,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 141
    },
    "389": {
        "n": "地壳龟(389)",
        "p": "389.gif",
        "f0": 95,
        "f1": 109,
        "f2": 105,
        "f3": 75,
        "f4": 85,
        "f5": 56,
        "e0": 0,
        "e1": 2,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 208
    },
    "390": {
        "n": "火苗猴(390)",
        "p": "390.gif",
        "f0": 44,
        "f1": 58,
        "f2": 44,
        "f3": 58,
        "f4": 44,
        "f5": 61,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 65
    },
    "391": {
        "n": "猛火猴(391)",
        "p": "391.gif",
        "f0": 64,
        "f1": 78,
        "f2": 52,
        "f3": 78,
        "f4": 52,
        "f5": 81,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 142
    },
    "392": {
        "n": "豪火猴(392)",
        "p": "392.gif",
        "f0": 76,
        "f1": 104,
        "f2": 71,
        "f3": 104,
        "f4": 71,
        "f5": 108,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 209
    },
    "393": {
        "n": "侯企鹅(393)",
        "p": "393.gif",
        "f0": 53,
        "f1": 51,
        "f2": 53,
        "f3": 61,
        "f4": 56,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 66
    },
    "394": {
        "n": "王企鹅(394)",
        "p": "394.gif",
        "f0": 64,
        "f1": 66,
        "f2": 68,
        "f3": 81,
        "f4": 76,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 143
    },
    "395": {
        "n": "皇帝企鹅(395)",
        "p": "395.gif",
        "f0": 84,
        "f1": 86,
        "f2": 88,
        "f3": 111,
        "f4": 101,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 210
    },
    "396": {
        "n": "胖胖翁(396)",
        "p": "396.gif",
        "f0": 40,
        "f1": 55,
        "f2": 30,
        "f3": 30,
        "f4": 30,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 255,
        "ge": 56
    },
    "397": {
        "n": "大胖翁(397)",
        "p": "397.gif",
        "f0": 55,
        "f1": 75,
        "f2": 50,
        "f3": 40,
        "f4": 40,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 120,
        "ge": 113
    },
    "398": {
        "n": "长冠翁(398)",
        "p": "398.gif",
        "f0": 85,
        "f1": 120,
        "f2": 70,
        "f3": 50,
        "f4": 50,
        "f5": 100,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 172
    },
    "399": {
        "n": "钝河狸(399)",
        "p": "399.gif",
        "f0": 59,
        "f1": 45,
        "f2": 40,
        "f3": 35,
        "f4": 40,
        "f5": 31,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 58
    },
    "400": {
        "n": "河狸精灵(400)",
        "p": "400.gif",
        "f0": 79,
        "f1": 85,
        "f2": 60,
        "f3": 55,
        "f4": 60,
        "f5": 71,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 127,
        "ge": 116
    },
    "401": {
        "n": "胖蟋蟀(401)",
        "p": "401.gif",
        "f0": 37,
        "f1": 25,
        "f2": 41,
        "f3": 25,
        "f4": 41,
        "f5": 25,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 54
    },
    "402": {
        "n": "蟋蟀战士(402)",
        "p": "402.gif",
        "f0": 77,
        "f1": 85,
        "f2": 51,
        "f3": 66,
        "f4": 51,
        "f5": 65,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 159
    },
    "403": {
        "n": "小电狮(403)",
        "p": "403.gif",
        "f0": 45,
        "f1": 65,
        "f2": 34,
        "f3": 40,
        "f4": 34,
        "f5": 45,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 235,
        "ge": 60
    },
    "404": {
        "n": "电光狮(404)",
        "p": "404.gif",
        "f0": 60,
        "f1": 85,
        "f2": 49,
        "f3": 60,
        "f4": 49,
        "f5": 60,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 117
    },
    "405": {
        "n": "雷鸣狮(405)",
        "p": "405.gif",
        "f0": 80,
        "f1": 120,
        "f2": 79,
        "f3": 95,
        "f4": 79,
        "f5": 70,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 194
    },
    "406": {
        "n": "玫瑰花苞(406)",
        "p": "406.gif",
        "f0": 40,
        "f1": 30,
        "f2": 35,
        "f3": 50,
        "f4": 70,
        "f5": 55,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 68
    },
    "407": {
        "n": "万花蔷薇(407)",
        "p": "407.gif",
        "f0": 60,
        "f1": 70,
        "f2": 55,
        "f3": 125,
        "f4": 105,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 204
    },
    "408": {
        "n": "小骨龙(408)",
        "p": "408.gif",
        "f0": 67,
        "f1": 125,
        "f2": 40,
        "f3": 30,
        "f4": 30,
        "f5": 58,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 99
    },
    "409": {
        "n": "暴骨龙(409)",
        "p": "409.gif",
        "f0": 97,
        "f1": 165,
        "f2": 60,
        "f3": 65,
        "f4": 50,
        "f5": 58,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 199
    },
    "410": {
        "n": "甲盾兽(410)",
        "p": "410.gif",
        "f0": 30,
        "f1": 42,
        "f2": 118,
        "f3": 42,
        "f4": 88,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 99
    },
    "411": {
        "n": "钢盾兽(411)",
        "p": "411.gif",
        "f0": 60,
        "f1": 52,
        "f2": 98,
        "f3": 47,
        "f4": 78,
        "f5": 30,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 199
    },
    "412": {
        "n": "蓑衣虫(412)",
        "p": "412.gif",
        "f0": 40,
        "f1": 29,
        "f2": 45,
        "f3": 29,
        "f4": 45,
        "f5": 36,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 120,
        "ge": 61
    },
    "413": {
        "n": "叶衣虫(413)",
        "p": "413.gif",
        "f0": 60,
        "f1": 59,
        "f2": 85,
        "f3": 79,
        "f4": 105,
        "f5": 36,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 159
    },
    "414": {
        "n": "亮翅蛾(414)",
        "p": "414.gif",
        "f0": 70,
        "f1": 94,
        "f2": 50,
        "f3": 94,
        "f4": 50,
        "f5": 66,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 159
    },
    "415": {
        "n": "三合一蜂巢(415)",
        "p": "415.gif",
        "f0": 30,
        "f1": 30,
        "f2": 42,
        "f3": 30,
        "f4": 42,
        "f5": 70,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 120,
        "ge": 63
    },
    "416": {
        "n": "蜂女皇(416)",
        "p": "416.gif",
        "f0": 70,
        "f1": 80,
        "f2": 102,
        "f3": 80,
        "f4": 102,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 188
    },
    "417": {
        "n": "电松鼠(417)",
        "p": "417.gif",
        "f0": 60,
        "f1": 45,
        "f2": 70,
        "f3": 45,
        "f4": 90,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 200,
        "ge": 120
    },
    "418": {
        "n": "叉尾鼬(418)",
        "p": "418.gif",
        "f0": 55,
        "f1": 65,
        "f2": 35,
        "f3": 60,
        "f4": 30,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 75
    },
    "419": {
        "n": "海鼬王(419)",
        "p": "419.gif",
        "f0": 85,
        "f1": 105,
        "f2": 55,
        "f3": 85,
        "f4": 50,
        "f5": 115,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 75,
        "ge": 178
    },
    "420": {
        "n": "樱桃芽(420)",
        "p": "420.gif",
        "f0": 45,
        "f1": 35,
        "f2": 45,
        "f3": 62,
        "f4": 53,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 68
    },
    "421": {
        "n": "樱桃花(421)",
        "p": "421.gif",
        "f0": 70,
        "f1": 60,
        "f2": 70,
        "f3": 87,
        "f4": 78,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 133
    },
    "422": {
        "n": "无壳龙(422)",
        "p": "422.gif",
        "f0": 76,
        "f1": 48,
        "f2": 48,
        "f3": 57,
        "f4": 62,
        "f5": 34,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 190,
        "ge": 73
    },
    "423": {
        "n": "地贝龙(423)",
        "p": "423.gif",
        "f0": 111,
        "f1": 83,
        "f2": 68,
        "f3": 92,
        "f4": 82,
        "f5": 39,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 176
    },
    "424": {
        "n": "双尾猴(424)",
        "p": "424.gif",
        "f0": 75,
        "f1": 100,
        "f2": 66,
        "f3": 60,
        "f4": 66,
        "f5": 115,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 45,
        "ge": 186
    },
    "425": {
        "n": "气球仔(425)",
        "p": "425.gif",
        "f0": 90,
        "f1": 50,
        "f2": 34,
        "f3": 60,
        "f4": 44,
        "f5": 70,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 125,
        "ge": 127
    },
    "426": {
        "n": "幽灵气球(426)",
        "p": "426.gif",
        "f0": 150,
        "f1": 80,
        "f2": 44,
        "f3": 90,
        "f4": 54,
        "f5": 80,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 204
    },
    "427": {
        "n": "棉花兔(427)",
        "p": "427.gif",
        "f0": 55,
        "f1": 66,
        "f2": 44,
        "f3": 44,
        "f4": 56,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 84
    },
    "428": {
        "n": "女郎兔(428)",
        "p": "428.gif",
        "f0": 65,
        "f1": 76,
        "f2": 84,
        "f3": 54,
        "f4": 96,
        "f5": 105,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 60,
        "ge": 178
    },
    "429": {
        "n": "梦巫(429)",
        "p": "429.gif",
        "f0": 60,
        "f1": 60,
        "f2": 60,
        "f3": 105,
        "f4": 105,
        "f5": 105,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 1,
        "e5": 0,
        "cr": 45,
        "ge": 187
    },
    "430": {
        "n": "绅士鸦(430)",
        "p": "430.gif",
        "f0": 100,
        "f1": 125,
        "f2": 52,
        "f3": 105,
        "f4": 52,
        "f5": 71,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 187
    },
    "431": {
        "n": "旋尾猫(431)",
        "p": "431.gif",
        "f0": 49,
        "f1": 55,
        "f2": 42,
        "f3": 42,
        "f4": 37,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 71
    },
    "432": {
        "n": "胖胖猫(432)",
        "p": "432.gif",
        "f0": 71,
        "f1": 82,
        "f2": 64,
        "f3": 64,
        "f4": 59,
        "f5": 112,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 75,
        "ge": 183
    },
    "433": {
        "n": "金铃(433)",
        "p": "433.gif",
        "f0": 45,
        "f1": 30,
        "f2": 50,
        "f3": 65,
        "f4": 50,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 74
    },
    "434": {
        "n": "毒臭釉(434)",
        "p": "434.gif",
        "f0": 63,
        "f1": 63,
        "f2": 47,
        "f3": 41,
        "f4": 41,
        "f5": 74,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 225,
        "ge": 79
    },
    "435": {
        "n": "恶毒釉(435)",
        "p": "435.gif",
        "f0": 103,
        "f1": 93,
        "f2": 67,
        "f3": 71,
        "f4": 61,
        "f5": 84,
        "e0": 2,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 209
    },
    "436": {
        "n": "镜面偶(436)",
        "p": "436.gif",
        "f0": 57,
        "f1": 24,
        "f2": 86,
        "f3": 24,
        "f4": 86,
        "f5": 23,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 72
    },
    "437": {
        "n": "镜面图腾(437)",
        "p": "437.gif",
        "f0": 67,
        "f1": 89,
        "f2": 116,
        "f3": 79,
        "f4": 116,
        "f5": 33,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 90,
        "ge": 188
    },
    "438": {
        "n": "胡说盆栽(438)",
        "p": "438.gif",
        "f0": 50,
        "f1": 80,
        "f2": 95,
        "f3": 45,
        "f4": 10,
        "f5": 10,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 255,
        "ge": 68
    },
    "439": {
        "n": "魔尼小丑(439)",
        "p": "439.gif",
        "f0": 20,
        "f1": 25,
        "f2": 45,
        "f3": 70,
        "f4": 90,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 145,
        "ge": 78
    },
    "440": {
        "n": "兜兜蛋(440)",
        "p": "440.gif",
        "f0": 100,
        "f1": 5,
        "f2": 5,
        "f3": 15,
        "f4": 65,
        "f5": 30,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 130,
        "ge": 255
    },
    "441": {
        "n": "音符鹉(441)",
        "p": "441.gif",
        "f0": 76,
        "f1": 65,
        "f2": 45,
        "f3": 92,
        "f4": 42,
        "f5": 91,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 107
    },
    "442": {
        "n": "鬼盆栽(442)",
        "p": "442.gif",
        "f0": 50,
        "f1": 92,
        "f2": 108,
        "f3": 92,
        "f4": 108,
        "f5": 35,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 100,
        "ge": 168
    },
    "443": {
        "n": "地龙宝宝(443)",
        "p": "443.gif",
        "f0": 58,
        "f1": 70,
        "f2": 45,
        "f3": 40,
        "f4": 45,
        "f5": 42,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 67
    },
    "444": {
        "n": "利爪地龙(444)",
        "p": "444.gif",
        "f0": 68,
        "f1": 90,
        "f2": 65,
        "f3": 50,
        "f4": 55,
        "f5": 82,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 144
    },
    "445": {
        "n": "暴地龙(445)",
        "p": "445.gif",
        "f0": 108,
        "f1": 130,
        "f2": 95,
        "f3": 80,
        "f4": 85,
        "f5": 102,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 445
    },
    "446": {
        "n": "刚比兽(446)",
        "p": "446.gif",
        "f0": 135,
        "f1": 85,
        "f2": 40,
        "f3": 40,
        "f4": 85,
        "f5": 5,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 50,
        "ge": 94
    },
    "447": {
        "n": "鲁力欧(447)",
        "p": "447.gif",
        "f0": 40,
        "f1": 70,
        "f2": 40,
        "f3": 35,
        "f4": 40,
        "f5": 60,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 72
    },
    "448": {
        "n": "鲁卡力欧(448)",
        "p": "448.gif",
        "f0": 70,
        "f1": 110,
        "f2": 70,
        "f3": 115,
        "f4": 70,
        "f5": 90,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 204
    },
    "449": {
        "n": "沼泽河马(449)",
        "p": "449.gif",
        "f0": 68,
        "f1": 72,
        "f2": 78,
        "f3": 38,
        "f4": 42,
        "f5": 32,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 140,
        "ge": 95
    },
    "450": {
        "n": "沙河马(450)",
        "p": "450.gif",
        "f0": 108,
        "f1": 112,
        "f2": 118,
        "f3": 68,
        "f4": 72,
        "f5": 47,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 198
    },
    "451": {
        "n": "幼龙蝎(451)",
        "p": "451.gif",
        "f0": 40,
        "f1": 50,
        "f2": 90,
        "f3": 30,
        "f4": 55,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 114
    },
    "452": {
        "n": "毒龙蝎(452)",
        "p": "452.gif",
        "f0": 70,
        "f1": 90,
        "f2": 110,
        "f3": 60,
        "f4": 75,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 204
    },
    "453": {
        "n": "毒蟾斗士(453)",
        "p": "453.gif",
        "f0": 48,
        "f1": 61,
        "f2": 40,
        "f3": 61,
        "f4": 40,
        "f5": 50,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 140,
        "ge": 83
    },
    "454": {
        "n": "毒蟾王(454)",
        "p": "454.gif",
        "f0": 83,
        "f1": 106,
        "f2": 65,
        "f3": 86,
        "f4": 65,
        "f5": 85,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 75,
        "ge": 181
    },
    "455": {
        "n": "噬人怪草(455)",
        "p": "455.gif",
        "f0": 74,
        "f1": 100,
        "f2": 72,
        "f3": 90,
        "f4": 72,
        "f5": 46,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 200,
        "ge": 164
    },
    "456": {
        "n": "蝶尾鱼(456)",
        "p": "456.gif",
        "f0": 49,
        "f1": 49,
        "f2": 56,
        "f3": 49,
        "f4": 61,
        "f5": 66,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 190,
        "ge": 90
    },
    "457": {
        "n": "蝶翅鱼(457)",
        "p": "457.gif",
        "f0": 69,
        "f1": 69,
        "f2": 76,
        "f3": 69,
        "f4": 86,
        "f5": 91,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 75,
        "ge": 156
    },
    "458": {
        "n": "小球飞鱼(458)",
        "p": "458.gif",
        "f0": 45,
        "f1": 20,
        "f2": 50,
        "f3": 60,
        "f4": 120,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 25,
        "ge": 108
    },
    "459": {
        "n": "森林雪人(459)",
        "p": "459.gif",
        "f0": 60,
        "f1": 62,
        "f2": 50,
        "f3": 62,
        "f4": 60,
        "f5": 40,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 120,
        "ge": 131
    },
    "460": {
        "n": "巨雪人(460)",
        "p": "460.gif",
        "f0": 90,
        "f1": 92,
        "f2": 75,
        "f3": 92,
        "f4": 85,
        "f5": 60,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 60,
        "ge": 214
    },
    "461": {
        "n": "玛纽拉(461)",
        "p": "461.gif",
        "f0": 70,
        "f1": 120,
        "f2": 65,
        "f3": 45,
        "f4": 85,
        "f5": 125,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 199
    },
    "462": {
        "n": "飞碟磁怪(462)",
        "p": "462.gif",
        "f0": 70,
        "f1": 70,
        "f2": 115,
        "f3": 130,
        "f4": 90,
        "f5": 60,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 3,
        "e5": 0,
        "cr": 30,
        "ge": 211
    },
    "463": {
        "n": "长舌怪(463)",
        "p": "463.gif",
        "f0": 110,
        "f1": 85,
        "f2": 95,
        "f3": 80,
        "f4": 95,
        "f5": 50,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 193
    },
    "464": {
        "n": "钻甲暴龙(464)",
        "p": "464.gif",
        "f0": 115,
        "f1": 140,
        "f2": 130,
        "f3": 55,
        "f4": 55,
        "f5": 40,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 217
    },
    "465": {
        "n": "树藤怪(465)",
        "p": "465.gif",
        "f0": 100,
        "f1": 100,
        "f2": 125,
        "f3": 110,
        "f4": 50,
        "f5": 50,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 211
    },
    "466": {
        "n": "电击魔(466)",
        "p": "466.gif",
        "f0": 75,
        "f1": 123,
        "f2": 67,
        "f3": 95,
        "f4": 85,
        "f5": 95,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 199
    },
    "467": {
        "n": "鸭嘴炎龙(467)",
        "p": "467.gif",
        "f0": 75,
        "f1": 95,
        "f2": 67,
        "f3": 125,
        "f4": 95,
        "f5": 83,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 199
    },
    "468": {
        "n": "波克鸟(468)",
        "p": "468.gif",
        "f0": 85,
        "f1": 50,
        "f2": 95,
        "f3": 120,
        "f4": 115,
        "f5": 80,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 1,
        "e5": 0,
        "cr": 30,
        "ge": 220
    },
    "469": {
        "n": "古蜻蜓(469)",
        "p": "469.gif",
        "f0": 86,
        "f1": 76,
        "f2": 86,
        "f3": 116,
        "f4": 56,
        "f5": 95,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 198
    },
    "470": {
        "n": "叶精灵(470)",
        "p": "470.gif",
        "f0": 65,
        "f1": 110,
        "f2": 130,
        "f3": 60,
        "f4": 65,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 196
    },
    "471": {
        "n": "冰精灵(471)",
        "p": "471.gif",
        "f0": 65,
        "f1": 60,
        "f2": 110,
        "f3": 130,
        "f4": 95,
        "f5": 65,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 196
    },
    "472": {
        "n": "巨飞蝎(472)",
        "p": "472.gif",
        "f0": 75,
        "f1": 95,
        "f2": 125,
        "f3": 45,
        "f4": 75,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 192
    },
    "473": {
        "n": "獠牙猪(473)",
        "p": "473.gif",
        "f0": 110,
        "f1": 130,
        "f2": 80,
        "f3": 70,
        "f4": 60,
        "f5": 80,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 50,
        "ge": 207
    },
    "474": {
        "n": "3D龙Z(474)",
        "p": "474.gif",
        "f0": 85,
        "f1": 80,
        "f2": 70,
        "f3": 135,
        "f4": 75,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 158
    },
    "475": {
        "n": "超能战士(475)",
        "p": "475.gif",
        "f0": 68,
        "f1": 125,
        "f2": 65,
        "f3": 65,
        "f4": 115,
        "f5": 80,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 208
    },
    "476": {
        "n": "红鼻钢(476)",
        "p": "476.gif",
        "f0": 60,
        "f1": 55,
        "f2": 145,
        "f3": 75,
        "f4": 150,
        "f5": 40,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 60,
        "ge": 198
    },
    "477": {
        "n": "夜魔人(477)",
        "p": "477.gif",
        "f0": 45,
        "f1": 100,
        "f2": 135,
        "f3": 65,
        "f4": 135,
        "f5": 45,
        "e0": 0,
        "e1": 0,
        "e2": 1,
        "e3": 0,
        "e4": 2,
        "e5": 0,
        "cr": 45,
        "ge": 210
    },
    "478": {
        "n": "雪魔女(478)",
        "p": "478.gif",
        "f0": 70,
        "f1": 80,
        "f2": 70,
        "f3": 80,
        "f4": 70,
        "f5": 110,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 2,
        "cr": 75,
        "ge": 187
    },
    "479": {
        "n": "电磁鬼(479)",
        "p": "479.gif",
        "f0": 50,
        "f1": 50,
        "f2": 77,
        "f3": 95,
        "f4": 77,
        "f5": 91,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 1,
        "cr": 45,
        "ge": 132
    },
    "480": {
        "n": "黄圣菇(480)",
        "p": "480.gif",
        "f0": 75,
        "f1": 75,
        "f2": 130,
        "f3": 75,
        "f4": 130,
        "f5": 95,
        "e0": 0,
        "e1": 0,
        "e2": 2,
        "e3": 0,
        "e4": 1,
        "e5": 0,
        "cr": 3,
        "ge": 210
    },
    "481": {
        "n": "红圣菇(481)",
        "p": "481.gif",
        "f0": 80,
        "f1": 105,
        "f2": 105,
        "f3": 105,
        "f4": 105,
        "f5": 80,
        "e0": 0,
        "e1": 1,
        "e2": 0,
        "e3": 1,
        "e4": 1,
        "e5": 0,
        "cr": 3,
        "ge": 210
    },
    "482": {
        "n": "蓝圣菇(482)",
        "p": "482.gif",
        "f0": 75,
        "f1": 125,
        "f2": 70,
        "f3": 125,
        "f4": 70,
        "f5": 115,
        "e0": 0,
        "e1": 2,
        "e2": 0,
        "e3": 1,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 210
    },
    "483": {
        "n": "迪奥鲁加(483)",
        "p": "483.gif",
        "f0": 100,
        "f1": 120,
        "f2": 120,
        "f3": 150,
        "f4": 100,
        "f5": 90,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 220
    },
    "484": {
        "n": "帕鲁其亚(484)",
        "p": "484.gif",
        "f0": 90,
        "f1": 120,
        "f2": 100,
        "f3": 150,
        "f4": 120,
        "f5": 100,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 30,
        "ge": 220
    },
    "485": {
        "n": "岩浆巨兽(485)",
        "p": "485.gif",
        "f0": 91,
        "f1": 90,
        "f2": 106,
        "f3": 130,
        "f4": 106,
        "f5": 77,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 3,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 215
    },
    "486": {
        "n": "恩神柱(486)",
        "p": "486.gif",
        "f0": 110,
        "f1": 160,
        "f2": 110,
        "f3": 80,
        "f4": 110,
        "f5": 100,
        "e0": 0,
        "e1": 3,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 220
    },
    "487": {
        "n": "鬼龙(487)",
        "p": "487.gif",
        "f0": 150,
        "f1": 100,
        "f2": 120,
        "f3": 100,
        "f4": 120,
        "f5": 90,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 220
    },
    "488": {
        "n": "梦兽(488)",
        "p": "488.gif",
        "f0": 120,
        "f1": 70,
        "f2": 120,
        "f3": 75,
        "f4": 130,
        "f5": 85,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 3,
        "e5": 0,
        "cr": 3,
        "ge": 210
    },
    "489": {
        "n": "菲奥奈(489)",
        "p": "489.gif",
        "f0": 80,
        "f1": 80,
        "f2": 80,
        "f3": 80,
        "f4": 80,
        "f5": 80,
        "e0": 1,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 165
    },
    "490": {
        "n": "玛娜菲(490)",
        "p": "490.gif",
        "f0": 100,
        "f1": 100,
        "f2": 100,
        "f3": 100,
        "f4": 100,
        "f5": 100,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 215
    },
    "491": {
        "n": "暗裂魔(491)",
        "p": "491.gif",
        "f0": 70,
        "f1": 90,
        "f2": 90,
        "f3": 135,
        "f4": 90,
        "f5": 125,
        "e0": 0,
        "e1": 0,
        "e2": 0,
        "e3": 2,
        "e4": 0,
        "e5": 1,
        "cr": 3,
        "ge": 210
    },
    "492": {
        "n": "草刺猬(492)",
        "p": "492.gif",
        "f0": 100,
        "f1": 100,
        "f2": 100,
        "f3": 100,
        "f4": 100,
        "f5": 100,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 45,
        "ge": 64
    },
    "493": {
        "n": "圣灵兽(493)",
        "p": "493.gif",
        "f0": 120,
        "f1": 120,
        "f2": 120,
        "f3": 120,
        "f4": 120,
        "f5": 120,
        "e0": 3,
        "e1": 0,
        "e2": 0,
        "e3": 0,
        "e4": 0,
        "e5": 0,
        "cr": 3,
        "ge": 255
    },
};
module.exports = PetProfileLoader;


/***/ }),
/* 105 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Constants_1 = __importDefault(__webpack_require__(10));
class PetProfile {
    get imageHtml() {
        const src = Constants_1.default.POCKET_DOMAIN + "/image/pet/" + this.picture;
        return "<img src='" + src + "' width='64' height='64' alt='" + this.code + "' style='border-width:0'>";
    }
    get totalBaseStats() {
        return this.healthBaseStats +
            this.attackBaseStats +
            this.defenseBaseStats +
            this.specialAttackBaseStats +
            this.specialDefenseBaseStats +
            this.speedBaseStats;
    }
    get totalEffort() {
        return this.healthEffort +
            this.attackEffort +
            this.defenseEffort +
            this.specialAttackEffort +
            this.specialDefenseEffort +
            this.speedEffort;
    }
    get perfectHealth() {
        const max = 20 + (this.healthEffort * 10);
        const init = (this.healthBaseStats * 20) + 40;
        const incr = (max / 2) * 99;
        return Math.ceil(init + incr);
    }
    get perfectAttack() {
        const max = this.attackEffort + 1;
        const init = (this.attackBaseStats * 2) + 40;
        const incr = (max / 2) * 99;
        return Math.ceil(init + incr);
    }
    get perfectDefense() {
        const max = this.defenseEffort + 1;
        const init = (this.defenseBaseStats * 2) + 40;
        const incr = (max / 2) * 99;
        return Math.ceil(init + incr);
    }
    get perfectSpecialAttack() {
        const max = this.specialAttackEffort + 1;
        const init = (this.specialAttackBaseStats * 2) + 40;
        const incr = (max / 2) * 99;
        return Math.ceil(init + incr);
    }
    get perfectSpecialDefense() {
        const max = this.specialDefenseEffort + 1;
        const init = (this.specialDefenseBaseStats * 2) + 40;
        const incr = (max / 2) * 99;
        return Math.ceil(init + incr);
    }
    get perfectSpeed() {
        const max = this.speedEffort + 1;
        const init = (this.speedBaseStats * 2) + 40;
        const incr = (max / 2) * 99;
        return Math.ceil(init + incr);
    }
    get perfectCapacity() {
        return Math.floor(this.perfectHealth / 3) +
            this.perfectAttack +
            this.perfectDefense +
            this.perfectSpecialAttack +
            this.perfectSpecialDefense +
            this.perfectSpeed;
    }
}
module.exports = PetProfile;


/***/ }),
/* 106 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastlePetExpressHouse_credential;
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
class CastlePetExpressHouse {
    constructor(credential) {
        _CastlePetExpressHouse_credential.set(this, void 0);
        __classPrivateFieldSet(this, _CastlePetExpressHouse_credential, credential, "f");
    }
    search(searchName) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _CastlePetExpressHouse_credential, "f").asRequestMap();
                    // noinspection JSDeprecatedSymbols
                    request.set("serch", escape(searchName.trim()));
                    request.set("mode", "CASTLE_SENDPET");
                    NetworkUtils_1.default.post("castle.cgi", request).then(html => {
                        const selectHtml = $(html).find("select[name='eid']:first").html();
                        resolve(selectHtml);
                    });
                });
            })();
        });
    }
    send(receiver, index) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (receiver.trim() === "" || index < 0) {
                        reject();
                        return;
                    }
                    const request = __classPrivateFieldGet(this, _CastlePetExpressHouse_credential, "f").asRequestMap();
                    request.set("select", index.toString());
                    request.set("eid", receiver.trim());
                    request.set("mode", "CASTLE_SENDPET2");
                    NetworkUtils_1.default.post("castle.cgi", request).then(html => {
                        if (html.includes("所持金不足")) {
                            reject();
                        }
                        else {
                            MessageBoard_1.default.processResponseMessage(html);
                            resolve();
                        }
                    });
                });
            })();
        });
    }
}
_CastlePetExpressHouse_credential = new WeakMap();
module.exports = CastlePetExpressHouse;


/***/ }),
/* 107 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _CastleRanch_credential;
const Pet_1 = __importDefault(__webpack_require__(103));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const CastleRanchPage_1 = __importDefault(__webpack_require__(108));
class CastleRanch {
    constructor(credential) {
        _CastleRanch_credential.set(this, void 0);
        __classPrivateFieldSet(this, _CastleRanch_credential, credential, "f");
    }
    static parseCastleRanchStatus(pageHtml) {
        const personalPetList = doParsePersonalPetList(pageHtml);
        const ranchPetList = doParseRanchPetList(pageHtml);
        const page = new CastleRanchPage_1.default();
        page.personalPetList = personalPetList;
        page.ranchPetList = ranchPetList;
        return page;
    }
    enter() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request.mode = "CASTLE_PET";
                    NetworkUtils_1.default.sendPostRequest("castle.cgi", request, function (pageHtml) {
                        const ranchStatus = CastleRanch.parseCastleRanchStatus(pageHtml);
                        resolve(ranchStatus);
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _CastleRanch_credential, "f"));
        });
    }
    graze(index) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential, index) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request.select = index;
                    // @ts-ignore
                    request.mode = "CASTLE_PETSTORE";
                    NetworkUtils_1.default.sendPostRequest("castle.cgi", request, function (pageHtml) {
                        MessageBoard_1.default.processResponseMessage(pageHtml);
                        resolve();
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _CastleRanch_credential, "f"), index);
        });
    }
    summon(index) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential, index) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request.select = index;
                    // @ts-ignore
                    request.mode = "CASTLE_PETWITHDRAW";
                    NetworkUtils_1.default.sendPostRequest("castle.cgi", request, function (pageHtml) {
                        MessageBoard_1.default.processResponseMessage(pageHtml);
                        resolve();
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _CastleRanch_credential, "f"), index);
        });
    }
}
_CastleRanch_credential = new WeakMap();
function doParsePersonalPetList(pageHtml) {
    const petList = [];
    $(pageHtml).find("td:contains('放入城堡牧场')")
        .filter(function () {
        return $(this).text() === "放入城堡牧场";
    })
        .closest("table")
        .find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const c2 = c1.next();
        const c3 = c2.next();
        const c4 = c3.next();
        const c5 = c4.next();
        const c6 = c5.next();
        const c7 = c6.next();
        const c8 = c7.next();
        const c9 = c8.next();
        const c10 = c9.next();
        const c11 = c10.next();
        const pet = new Pet_1.default();
        pet.index = parseInt($(radio).val());
        pet.selectable = !$(radio).prop("disabled");
        pet.using = c1.text() === "★使用";
        pet.name = c2.text();
        pet.level = parseInt(c3.text());
        let s = c4.text();
        pet.health = parseInt(StringUtils_1.default.substringBeforeSlash(s));
        pet.maxHealth = parseInt(StringUtils_1.default.substringAfterSlash(s));
        pet.attack = parseInt(c5.text());
        pet.defense = parseInt(c6.text());
        pet.specialAttack = parseInt(c7.text());
        pet.specialDefense = parseInt(c8.text());
        pet.speed = parseInt(c9.text());
        pet.experience = parseInt(c10.text());
        pet.gender = c11.text();
        petList.push(pet);
    });
    return petList;
}
function doParseRanchPetList(pageHtml) {
    const petList = [];
    $(pageHtml).find("td:contains('从城堡仓库取出')")
        .filter(function () {
        return $(this).text() === "从城堡仓库取出";
    })
        .closest("table")
        .find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const c2 = c1.next();
        const c3 = c2.next();
        const c4 = c3.next();
        const c5 = c4.next();
        const c6 = c5.next();
        const c7 = c6.next();
        const c8 = c7.next();
        const c9 = c8.next();
        const c10 = c9.next();
        const pet = new Pet_1.default();
        pet.index = parseInt($(radio).val());
        pet.selectable = true;
        pet.name = c1.text();
        pet.level = parseInt(c2.text());
        let s = c3.text();
        pet.health = parseInt(StringUtils_1.default.substringBeforeSlash(s));
        pet.maxHealth = parseInt(StringUtils_1.default.substringAfterSlash(s));
        pet.attack = parseInt(c4.text());
        pet.defense = parseInt(c5.text());
        pet.specialAttack = parseInt(c6.text());
        pet.specialDefense = parseInt(c7.text());
        pet.speed = parseInt(c8.text());
        pet.experience = parseInt(c9.text());
        pet.gender = c10.text();
        petList.push(pet);
    });
    return petList;
}
module.exports = CastleRanch;


/***/ }),
/* 108 */
/***/ ((module) => {


class CastleRanchPage {
}
module.exports = CastleRanchPage;


/***/ }),
/* 109 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _GoldenCage_credential;
const Pet_1 = __importDefault(__webpack_require__(103));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const NumberUtils_1 = __importDefault(__webpack_require__(110));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const GoldenCagePage_1 = __importDefault(__webpack_require__(111));
class GoldenCage {
    constructor(credential) {
        _GoldenCage_credential.set(this, void 0);
        __classPrivateFieldSet(this, _GoldenCage_credential, credential, "f");
    }
    open(cageIndex) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise((resolve, reject) => {
                    if (!NumberUtils_1.default.isIndexNumber(cageIndex)) {
                        reject();
                    }
                    else {
                        const request = __classPrivateFieldGet(this, _GoldenCage_credential, "f").asRequestMap();
                        request.set("chara", "1");
                        request.set("item" + cageIndex, cageIndex.toString());
                        request.set("mode", "USE");
                        NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                            const page = GoldenCage.parsePage(html);
                            resolve(page);
                        });
                    }
                });
            })();
        });
    }
    static parsePage(pageHtml) {
        const petList = [];
        $(pageHtml)
            .find("input:radio")
            .each(function (_idx, radio) {
            const c0 = $(radio).parent();
            const c1 = $(c0).next();
            const c2 = $(c1).next();
            const c3 = $(c2).next();
            const c4 = $(c3).next();
            const c5 = $(c4).next();
            const c6 = $(c5).next();
            const c7 = $(c6).next();
            const c8 = $(c7).next();
            const c9 = $(c8).next();
            const c10 = $(c9).next();
            const pet = new Pet_1.default();
            pet.index = parseInt($(radio).val());
            pet.name = $(c1).text();
            pet.level = parseInt($(c2).text());
            let s = $(c3).text();
            pet.health = parseInt(StringUtils_1.default.substringBeforeSlash(s));
            pet.maxHealth = parseInt(StringUtils_1.default.substringAfterSlash(s));
            pet.attack = parseInt($(c4).text());
            pet.defense = parseInt($(c5).text());
            pet.specialAttack = parseInt($(c6).text());
            pet.specialDefense = parseInt($(c7).text());
            pet.speed = parseInt($(c8).text());
            pet.experience = parseInt($(c9).text());
            pet.gender = $(c10).text();
            petList.push(pet);
        });
        const page = new GoldenCagePage_1.default();
        page.petList = petList;
        return page;
    }
}
_GoldenCage_credential = new WeakMap();
module.exports = GoldenCage;


/***/ }),
/* 110 */
/***/ ((module) => {


class NumberUtils {
    static isIndexNumber(n) {
        if (Number.isNaN(n)) {
            return false;
        }
        if (!Number.isInteger(n)) {
            return false;
        }
        return n >= 0;
    }
}
module.exports = NumberUtils;


/***/ }),
/* 111 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Pet_1 = __importDefault(__webpack_require__(103));
class GoldenCagePage {
    get sortedPetList() {
        return Pet_1.default.sortPetList(this.petList);
    }
}
module.exports = GoldenCagePage;


/***/ }),
/* 112 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalPetManagement_credential, _PersonalPetManagement_townId;
const Pet_1 = __importDefault(__webpack_require__(103));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PersonalPetManagementPage_1 = __importDefault(__webpack_require__(113));
class PersonalPetManagement {
    constructor(credential, townId) {
        _PersonalPetManagement_credential.set(this, void 0);
        _PersonalPetManagement_townId.set(this, void 0);
        __classPrivateFieldSet(this, _PersonalPetManagement_credential, credential, "f");
        __classPrivateFieldSet(this, _PersonalPetManagement_townId, townId, "f");
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (() => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _PersonalPetManagement_credential, "f").asRequestMap();
                    if (__classPrivateFieldGet(this, _PersonalPetManagement_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _PersonalPetManagement_townId, "f"));
                    }
                    request.set("mode", "PETSTATUS");
                    NetworkUtils_1.default.post("mydata.cgi", request).then(html => {
                        const page = PersonalPetManagement.parsePage(html);
                        resolve(page);
                    });
                });
            })();
        });
    }
    static parsePage(html) {
        const petList = [];
        $(html).find("input:radio[name='select']").each(function (_idx, radio) {
            const index = $(radio).val();
            if (parseInt(index) >= 0) {
                // index为-1的意味着“无宠物”那个选项
                const table = $(radio).closest("table");
                // pet index & using
                const pet = new Pet_1.default();
                pet.index = parseInt(index);
                const usingText = radio.nextSibling.nodeValue;
                if (usingText === "未使用") {
                    pet.using = false;
                }
                if (usingText === "★使用") {
                    pet.using = true;
                }
                __parsePet(pet, table);
                petList.push(pet);
            }
        });
        const studyStatus = [];
        $(html).find("input:checkbox:checked").each(function (_idx, checkbox) {
            const name = $(checkbox).attr("name");
            if (name.startsWith("study")) {
                studyStatus.push(parseInt($(checkbox).val()));
            }
        });
        const page = new PersonalPetManagementPage_1.default();
        page.petList = petList;
        page.petStudyStatus = studyStatus;
        return page;
    }
}
_PersonalPetManagement_credential = new WeakMap(), _PersonalPetManagement_townId = new WeakMap();
function __parsePet(pet, table) {
    // pet name & gender
    const nameCell = table.find("td:first");
    let petNameText = nameCell.find("b").text();
    petNameText = petNameText.substring(1);
    pet.name = petNameText.substring(0, petNameText.length - 1);
    let fullNameText = nameCell.text();
    if (fullNameText.endsWith("(公)")) {
        pet.gender = "公";
    }
    else if (fullNameText.endsWith("(母)")) {
        pet.gender = "母";
    }
    else if (fullNameText.endsWith("(无性)")) {
        pet.gender = "无性";
    }
    // pet level
    let s = table.find("tr:eq(1) td:first").text();
    pet.level = parseInt(StringUtils_1.default.substringAfter(s, "Ｌｖ"));
    // pet picture & health
    s = table.find("tr:eq(2) td:eq(0) img").attr("src");
    pet.picture = s.substring(s.lastIndexOf("/") + 1);
    s = table.find("tr:eq(2) td:eq(2)").text();
    pet.health = parseInt(StringUtils_1.default.substringBeforeSlash(s));
    pet.maxHealth = parseInt(StringUtils_1.default.substringAfterSlash(s));
    // pet spells
    s = table.find("tr:eq(3) td:eq(1)").text();
    pet.spell1 = StringUtils_1.default.substringBefore(s, "(威力：");
    pet.usingSpell1 = s.includes("(使用中)");
    pet.spell1Description = s;
    pet.spell1Description += " " + table.find("tr:eq(4) td:eq(1)").text();
    s = table.find("tr:eq(5) td:eq(1)").text();
    pet.spell2 = StringUtils_1.default.substringBefore(s, "(威力：");
    pet.usingSpell2 = s.includes("(使用中)");
    pet.spell2Description = s;
    pet.spell2Description += " " + table.find("tr:eq(6) td:eq(1)").text();
    s = table.find("tr:eq(7) td:eq(1)").text();
    pet.spell3 = StringUtils_1.default.substringBefore(s, "(威力：");
    pet.usingSpell3 = s.includes("(使用中)");
    pet.spell3Description = s;
    pet.spell3Description += " " + table.find("tr:eq(8) td:eq(1)").text();
    s = table.find("tr:eq(9) td:eq(1)").text();
    pet.spell4 = StringUtils_1.default.substringBefore(s, "(威力：");
    pet.usingSpell4 = s.includes("(使用中)");
    pet.spell4Description = s;
    pet.spell4Description += " " + table.find("tr:eq(10) td:eq(1)").text();
    // pet attack & defense
    s = table.find("tr:eq(11) td:eq(1)").text();
    pet.attack = parseInt(s);
    s = table.find("tr:eq(11) td:eq(3)").text();
    pet.defense = parseInt(s);
    // pet specialAttack & specialDefense
    s = table.find("tr:eq(12) td:eq(1)").text();
    pet.specialAttack = parseInt(s);
    s = table.find("tr:eq(12) td:eq(3)").text();
    pet.specialDefense = parseInt(s);
    // pet speed & love
    s = table.find("tr:eq(13) td:eq(1)").text();
    pet.speed = parseInt(s);
    s = table.find("tr:eq(13) td:eq(3)").text();
    pet.love = parseFloat(s);
    // pet attributes
    pet.attribute1 = table.find("tr:eq(14) td:eq(1)").text();
    pet.attribute2 = table.find("tr:eq(14) td:eq(3)").text();
    // pet race & code
    s = table.find("tr:eq(16) td:eq(3)").text();
    pet.race = s;
    pet.code = StringUtils_1.default.substringBetween(s, "(", ")");
}
module.exports = PersonalPetManagement;


/***/ }),
/* 113 */
/***/ ((module) => {


class PersonalPetManagementPage {
}
module.exports = PersonalPetManagementPage;


/***/ }),
/* 114 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _AbstractPersonalPetManagementPageProcessor_instances, _AbstractPersonalPetManagementPageProcessor_renderImmutablePage;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const PersonalPetManagement_1 = __importDefault(__webpack_require__(112));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class AbstractPersonalPetManagementPageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _AbstractPersonalPetManagementPageProcessor_instances.add(this);
    }
    doProcess(credential, context) {
        const page = PersonalPetManagement_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        __classPrivateFieldGet(this, _AbstractPersonalPetManagementPageProcessor_instances, "m", _AbstractPersonalPetManagementPageProcessor_renderImmutablePage).call(this, credential, page, context);
    }
}
_AbstractPersonalPetManagementPageProcessor_instances = new WeakSet(), _AbstractPersonalPetManagementPageProcessor_renderImmutablePage = function _AbstractPersonalPetManagementPageProcessor_renderImmutablePage(credential, page, context) {
    $("input:submit[value='返回城市']").attr("id", "returnButton");
    // noinspection HtmlDeprecatedTag,XmlDeprecatedElement
    let html = "<center>";
    html += "<table style='background-color:#888888;width:100%;text-align:center'>";
    html += "<tbody style='background-color:#F8F0E0'>";
    html += "<tr>";
    html += "<td style='background-color:navy;color:yellowgreen;font-size:150%;font-weight:bold'>" +
        "＜＜  宠 物 管 理  ＞＞" +
        "</td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='eden'></td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='goldenCageIndex'>none</td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='goldenCageStatus'>off</td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='hasGoldenCage'>false</td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='roleLocation'></td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='ranchState'></td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td id='message_board_container'></td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td id='pet_management_container'></td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='ranchList'></td>";
    html += "</tr>";
    html += "</tody>";
    html += "</table>";
    // noinspection HtmlDeprecatedTag,XmlDeprecatedElement
    html += "<center>已登陆宠物联赛的宠物一览";
    // noinspection HtmlDeprecatedTag,XmlDeprecatedElement
    const leftHtml = StringUtils_1.default.substringAfter($("body:first").html(), "<center>已登陆宠物联赛的宠物一览");
    $("body:first").html(html + leftHtml);
    MessageBoard_1.default.createMessageBoard("message_board_container", NpcLoader_1.default.randomFemaleNpcImageHtml());
    $("#messageBoard")
        .css("background-color", "black")
        .css("color", "white")
        .css("height", "96");
    MessageBoard_1.default.resetMessageBoard("全新的宠物管理UI为您带来不一样的感受，试试把鼠标停留在宠物图片上有惊喜。<br>" +
        "手机用户请试试单击宠物名字那一栏。");
    this.doProcessWithPageParsed(credential, page, context);
};
module.exports = AbstractPersonalPetManagementPageProcessor;


/***/ }),
/* 115 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Pet_1 = __importDefault(__webpack_require__(103));
const PetProfileLoader_1 = __importDefault(__webpack_require__(104));
const CastleInformation_1 = __importDefault(__webpack_require__(63));
const CastleRanch_1 = __importDefault(__webpack_require__(107));
const GoldenCage_1 = __importDefault(__webpack_require__(109));
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const PersonalPetManagement_1 = __importDefault(__webpack_require__(112));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const TownBank_1 = __importDefault(__webpack_require__(51));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const AbstractPersonalPetManagementPageProcessor_1 = __importDefault(__webpack_require__(114));
class PersonalPetManagementPageProcessor_Town extends AbstractPersonalPetManagementPageProcessor_1.default {
    doProcessWithPageParsed(credential, page, context) {
        doProcess(credential, page.petList, page.petStudyStatus);
    }
}
function doProcess(credential, petList, studyStatus) {
    new PersonalStatus_1.default(credential).load().then(role => {
        if (role.masterCareerList.includes("贤者") || role.hasMirror) {
            $("#hasGoldenCage").text("true");
        }
        $("#roleLocation").text(role.location);
        doRender(credential, petList, studyStatus, role);
        new PersonalEquipmentManagement_1.default(credential).open().then(page => {
            const cage = page.findGoldenCage();
            if (cage !== null) {
                $("#goldenCageIndex").text(cage.index);
                $("#openCageButton").show();
                $("#closeCageButton").show();
            }
        });
    });
}
function doRender(credential, petList, studyStatus, role) {
    let html = "";
    html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%'>";
    html += "<tbody style='background-color:#F8F0E0'>";
    html += "<tr>";
    html += "<td style='background-color:#EFE0C0'></td>";
    html += "<td style='background-color:#EFE0C0'>使用</td>";
    html += "<td style='background-color:#E8E8D0'>宠物名</td>";
    html += "<td style='background-color:#E8E8D0'>性别</td>";
    html += "<td style='background-color:#E8E8D0'>Ｌｖ</td>";
    html += "<td style='background-color:#E8E8D0'>ＨＰ</td>";
    html += "<td style='background-color:#E8E8D0'>攻击力</td>";
    html += "<td style='background-color:#E8E8D0'>防御力</td>";
    html += "<td style='background-color:#E8E8D0'>智力</td>";
    html += "<td style='background-color:#E8E8D0'>精神力</td>";
    html += "<td style='background-color:#E8E8D0'>速度</td>";
    html += "<td style='background-color:#E8E8D0'>技1</td>";
    html += "<td style='background-color:#E8E8D0'>技2</td>";
    html += "<td style='background-color:#E8E8D0'>技3</td>";
    html += "<td style='background-color:#E8E8D0'>技4</td>";
    html += "<td style='background-color:#E8E8D0'>亲密度</td>";
    html += "<td style='background-color:#E8E8D0'>种类</td>";
    html += "<td style='background-color:#E8E8D0'>属性1</td>";
    html += "<td style='background-color:#E8E8D0'>属性2</td>";
    html += "<td style='background-color:#E8E8D0'>成长</td>";
    html += "</tr>";
    for (const pet of petList) {
        html += "<tr>";
        html += "<td style='background-color:#EFE0C0' rowspan='2' id='pet_picture_" + pet.code + "' class='pet_picture_class'>" +
            pet.imageHtml +
            "</td>";
        html += "<td style='background-color:#EFE0C0' rowspan='2'>" +
            (pet.using ? "★" : "") +
            "</td>";
        html += "<td style='background-color:#E8E8D0' id='pet_name_" + pet.code + "' class='PetUIButton'>" +
            "<b>" + pet.name + "</b>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.gender +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.level +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.health + "/" + pet.maxHealth +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.attack >= 375 ? "<b style='color:red'>" + pet.attack + "</b>" : pet.attack) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.defense >= 375 ? "<b style='color:red'>" + pet.defense + "</b>" : pet.defense) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.specialAttack >= 375 ? "<b style='color:red'>" + pet.specialAttack + "</b>" : pet.specialAttack) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.specialDefense >= 375 ? "<b style='color:red'>" + pet.specialDefense + "</b>" : pet.specialDefense) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.speed >= 375 ? "<b style='color:red'>" + pet.speed + "</b>" : pet.speed) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            "<input type='button' class='PetUIButton' id='pet_" + pet.index + "_spell_1' value='" + pet.spell1 + "' title='" + pet.spell1Description + "'>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            "<input type='button' class='PetUIButton' id='pet_" + pet.index + "_spell_2' value='" + pet.spell2 + "' title='" + pet.spell2Description + "'>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            "<input type='button' class='PetUIButton' id='pet_" + pet.index + "_spell_3' value='" + pet.spell3 + "' title='" + pet.spell3Description + "'>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            "<input type='button' class='PetUIButton' id='pet_" + pet.index + "_spell_4' value='" + pet.spell4 + "' title='" + pet.spell4Description + "'>" +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.love >= 100 ? "<b style='color:red'>" + pet.love + "</b>" : pet.love) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.race +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            pet.attribute1 +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>" +
            (pet.attribute2 === "无" ? "-" : pet.attribute2) +
            "</td>";
        html += "<td style='background-color:#E8E8D0'>";
        const petFuture = PetProfileLoader_1.default.load(pet.code);
        if (petFuture !== null) {
            html += petFuture.growExperience;
        }
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<td colspan='18' style='text-align: left'>"; // 当前宠物的操作位置
        html += "<input type='button' class='PetUIButton' value='卸下' id='pet_" + pet.index + "_uninstall'>";
        html += "<input type='button' class='PetUIButton' value='使用' id='pet_" + pet.index + "_install'>";
        html += "<input type='button' class='PetUIButton' value='入笼' id='pet_" + pet.index + "_cage'>";
        html += "<input type='button' class='PetUIButton' value='亲密' id='pet_" + pet.index + "_love'>";
        html += "<input type='button' class='PetUIButton' value='参赛' id='pet_" + pet.index + "_league'>";
        html += "<input type='button' class='PetUIButton' value='献祭' id='pet_" + pet.index + "_consecrate'>";
        html += "<input type='button' class='PetUIButton' value='发送' id='pet_" + pet.index + "_send'>";
        html += "<input type='button' class='PetUIButton' value='改名' id='pet_" + pet.index + "_rename'>&nbsp;";
        html += "<input type='text' id='pet_" + pet.index + "_name_text' size='15' maxlength='20'>";
        html += "</td>";
        html += "</tr>";
    }
    html += "<tr><td style='background-color:#EFE0C0;text-align:right' colspan='20'>";
    html += "<input type='text' id='receiverName' size='15' maxlength='20'>";
    html += "<input type='button' class='PetUIButton' id='searchReceiverButton' value='找人'>";
    html += "<select name='eid' id='receiverCandidates'><option value=''>选择发送对象</select>";
    html += "</td></tr>";
    html += "<tr><td style='background-color:#EFE0C0;text-align:center' colspan='20'>";
    html += "<b style='color:navy'>设置宠物升级时学习技能情况</b>";
    html += "</td></tr>";
    html += "<tr><td style='background-color:#E8E8D0;text-align:center' colspan='20'>";
    html += "<input type='button' class='PetUIButton' value='第１技能位' id='pet_spell_study_1'>";
    html += "<input type='button' class='PetUIButton' value='第２技能位' id='pet_spell_study_2'>";
    html += "<input type='button' class='PetUIButton' value='第３技能位' id='pet_spell_study_3'>";
    html += "<input type='button' class='PetUIButton' value='第４技能位' id='pet_spell_study_4'>";
    html += "</td></tr>";
    html += "<tr><td style='background-color:#E8E8D0;text-align:center' colspan='20'>";
    html += "<input type='button' class='PetUIButton' value='刷新宠物管理' id='refreshButton'>";
    html += "<input type='button' class='PetUIButton' value='打开黄金笼子' id='openCageButton'>";
    html += "<input type='button' class='PetUIButton' value='关闭黄金笼子' id='closeCageButton'>";
    html += "<input type='button' class='PetUIButton' value='从黄金笼子盲取' id='takeOutFirstFromCageButton' disabled style='display:none'>";
    html += "</td></tr>";
    html += "<tr id='ranchMenu' style='display:none'><td style='background-color:#E8E8D0;text-align:center' colspan='20'>";
    html += "<input type='button' class='PetUIButton' value='打开城堡牧场' id='openRanchButton'>";
    html += "<input type='button' class='PetUIButton' value='关闭城堡牧场' id='closeRanchButton'>";
    html += "</td></tr>";
    html += "<tr style='display:none'><td id='goldenCageContainer' style='background-color:#E8E8D0;text-align:center' colspan='20'>";
    html += "</td></tr>";
    html += "</tbody>";
    html += "</table>";
    $("#pet_management_container").html(html);
    if ($("#goldenCageIndex").text() === "none") {
        $("#openCageButton").hide();
        $("#closeCageButton").hide();
    }
    // 根据宠物状态修改按钮的样式
    for (let i = 0; i < petList.length; i++) {
        const pet = petList[i];
        // 设置卸下宠物按钮的状态
        if (!pet.using) {
            let buttonId = "pet_" + pet.index + "_uninstall";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置使用宠物按钮的状态
        if (pet.using) {
            let buttonId = "pet_" + pet.index + "_install";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
            buttonId = "pet_" + pet.index + "_cage";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        if ($("#hasGoldenCage").text() !== "true" && !pet.using) {
            // 没有黄金笼子的不应该有入笼选项
            let buttonId = "pet_" + pet.index + "_cage";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置宠物技能按钮的状态
        let spellButtonId = "pet_" + pet.index + "_spell_1";
        if (pet.usingSpell1) {
            $("#" + spellButtonId).css("color", "blue");
        }
        else {
            $("#" + spellButtonId).css("color", "grey");
        }
        spellButtonId = "pet_" + pet.index + "_spell_2";
        if (pet.usingSpell2) {
            $("#" + spellButtonId).css("color", "blue");
        }
        else {
            $("#" + spellButtonId).css("color", "grey");
        }
        spellButtonId = "pet_" + pet.index + "_spell_3";
        if (pet.usingSpell3) {
            $("#" + spellButtonId).css("color", "blue");
        }
        else {
            $("#" + spellButtonId).css("color", "grey");
        }
        spellButtonId = "pet_" + pet.index + "_spell_4";
        if (pet.usingSpell4) {
            $("#" + spellButtonId).css("color", "blue");
        }
        else {
            $("#" + spellButtonId).css("color", "grey");
        }
        // 设置宠物亲密度按钮的状态
        if (pet.love >= 100) {
            let buttonId = "pet_" + pet.index + "_love";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置宠物联赛按钮的状态
        if (pet.level < 100) {
            let buttonId = "pet_" + pet.index + "_league";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置宠物献祭按钮的状态
        if (pet.level !== 1) {
            let buttonId = "pet_" + pet.index + "_consecrate";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
        // 设置宠物发送按钮的状态
        if (pet.using) {
            let buttonId = "pet_" + pet.index + "_send";
            $("#" + buttonId).prop("disabled", true);
            $("#" + buttonId).css("color", "grey");
        }
    }
    // 设置技能学习位的按钮样式
    if (studyStatus.includes(1)) {
        $("#pet_spell_study_1").css("color", "blue");
    }
    else {
        $("#pet_spell_study_1").css("color", "grey");
    }
    if (studyStatus.includes(2)) {
        $("#pet_spell_study_2").css("color", "blue");
    }
    else {
        $("#pet_spell_study_2").css("color", "grey");
    }
    if (studyStatus.includes(3)) {
        $("#pet_spell_study_3").css("color", "blue");
    }
    else {
        $("#pet_spell_study_3").css("color", "grey");
    }
    if (studyStatus.includes(4)) {
        $("#pet_spell_study_4").css("color", "blue");
    }
    else {
        $("#pet_spell_study_4").css("color", "grey");
    }
    doBindPetFuture(petList);
    // 绑定按钮点击事件处理
    doBind(credential, petList);
    if (role !== undefined && SetupLoader_1.default.isCastleKeeperEnabled()) {
        new CastleInformation_1.default().load(role.name).then(() => {
            $("#ranchMenu").show();
            $("#openRanchButton").on("click", () => {
                if ($("#ranchState").text() === "on") {
                    return;
                }
                $("#ranchState").text("on");
                doRefresh(credential);
            });
            $("#closeRanchButton").on("click", () => {
                if ($("#ranchState").text() === "off") {
                    return;
                }
                $("#ranchState").text("off");
                doRefresh(credential);
            });
        });
    }
    if ($("#goldenCageStatus").text() === "on") {
        doRenderGoldenCage(credential);
    }
    else {
        // 由于某些bug造成某些号黄金笼子消失
        if ($("#hasGoldenCage").text() === "true") {
            // 身上没有发现黄金笼子，但是掌握了贤者或者开了分身
            // 应该有笼子的，能提供限制版笼子功能，取出第一个宠物
            $("#takeOutFirstFromCageButton")
                .prop("disabled", false)
                .show()
                .on("click", function () {
                const request = credential.asRequest();
                // @ts-ignore
                request["select"] = "0";
                // @ts-ignore
                request["mode"] = "GETOUTLONGZI";
                NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                    MessageBoard_1.default.processResponseMessage(html);
                    doRefresh(credential);
                });
            });
        }
    }
    if ($("#ranchState").text() === "on") {
        doRenderRanch(credential);
    }
}
function doBindPetFuture(petList) {
    for (const pet of petList) {
        const code = pet.code;
        if ($("#pet_name_" + code).length > 0) {
            $("#pet_name_" + code)
                .on("click", function () {
                const petFuture = PetProfileLoader_1.default.load(code);
                let html = "";
                html += "<table style='width:100%;border-width:0;background-color:wheat;margin:auto'>";
                html += "<tbody>";
                html += "<tr style='background-color:black;color:wheat'>";
                html += "<th>名字</th>";
                html += "<th>总族</th>";
                html += "<th>命族</th>";
                html += "<th>攻族</th>";
                html += "<th>防族</th>";
                html += "<th>智族</th>";
                html += "<th>精族</th>";
                html += "<th>速族</th>";
                html += "<th>命努</th>";
                html += "<th>攻努</th>";
                html += "<th>防努</th>";
                html += "<th>智努</th>";
                html += "<th>精努</th>";
                html += "<th>速努</th>";
                html += "<th>捕获</th>";
                html += "<th>成长</th>";
                html += "<td rowspan='2' style='text-align:center'>" + petFuture.imageHtml + "</td>";
                html += "</tr>";
                html += "<tr style='background-color:black;color:wheat;font-weight:bold;text-align:center'>";
                html += "<td>" + petFuture.name + "</td>";
                html += "<td>" + petFuture.totalBaseStats + "</td>";
                html += "<td>" + petFuture.healthBaseStats + "</td>";
                html += "<td>" + petFuture.attackBaseStats + "</td>";
                html += "<td>" + petFuture.defenseBaseStats + "</td>";
                html += "<td>" + petFuture.specialAttackBaseStats + "</td>";
                html += "<td>" + petFuture.specialDefenseBaseStats + "</td>";
                html += "<td>" + petFuture.speedBaseStats + "</td>";
                html += "<td>" + petFuture.healthEffort + "</td>";
                html += "<td>" + petFuture.attackEffort + "</td>";
                html += "<td>" + petFuture.defenseEffort + "</td>";
                html += "<td>" + petFuture.specialAttackEffort + "</td>";
                html += "<td>" + petFuture.specialDefenseEffort + "</td>";
                html += "<td>" + petFuture.speedEffort + "</td>";
                html += "<td>" + petFuture.catchRatio + "</td>";
                html += "<td>" + petFuture.growExperience + "</td>";
                html += "</tr>";
                html += "</tbody>";
                html += "</table>";
                $("#messageBoard").html(html);
            });
        }
        if ($("#pet_picture_" + code).length > 0) {
            $("#pet_picture_" + code)
                .on("mouseenter", function () {
                const petFuture = PetProfileLoader_1.default.load(code);
                let html = "";
                html += "<table style='width:100%;border-width:0;background-color:wheat;margin:auto'>";
                html += "<tbody>";
                html += "<tr style='background-color:black;color:wheat'>";
                html += "<th>名字</th>";
                html += "<th>总族</th>";
                html += "<th>命族</th>";
                html += "<th>攻族</th>";
                html += "<th>防族</th>";
                html += "<th>智族</th>";
                html += "<th>精族</th>";
                html += "<th>速族</th>";
                html += "<th>命努</th>";
                html += "<th>攻努</th>";
                html += "<th>防努</th>";
                html += "<th>智努</th>";
                html += "<th>精努</th>";
                html += "<th>速努</th>";
                html += "<th>捕获</th>";
                html += "<th>成长</th>";
                html += "<td rowspan='3' style='text-align:center'>" + petFuture.imageHtml + "</td>";
                html += "</tr>";
                html += "<tr style='background-color:black;color:wheat;font-weight:bold;text-align:center'>";
                html += "<td rowspan='2'>" + petFuture.name + "</td>";
                html += "<td rowspan='2'>" + petFuture.totalBaseStats + "</td>";
                html += "<td>" + petFuture.healthBaseStats + "</td>";
                html += "<td>" + petFuture.attackBaseStats + "</td>";
                html += "<td>" + petFuture.defenseBaseStats + "</td>";
                html += "<td>" + petFuture.specialAttackBaseStats + "</td>";
                html += "<td>" + petFuture.specialDefenseBaseStats + "</td>";
                html += "<td>" + petFuture.speedBaseStats + "</td>";
                html += "<td rowspan='2'>" + petFuture.healthEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.attackEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.defenseEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.specialAttackEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.specialDefenseEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.speedEffort + "</td>";
                html += "<td rowspan='2'>" + petFuture.catchRatio + "</td>";
                html += "<td rowspan='2'>" + petFuture.growExperience + "</td>";
                html += "</tr>";
                html += "<tr style='background-color:black;color:wheat;font-weight:bold;text-align:center'>";
                html += "<td>" + petFuture.perfectHealth + "</td>";
                html += "<td>" + petFuture.perfectAttack + "</td>";
                html += "<td>" + petFuture.perfectDefense + "</td>";
                html += "<td>" + petFuture.perfectSpecialAttack + "</td>";
                html += "<td>" + petFuture.perfectSpecialDefense + "</td>";
                html += "<td>" + petFuture.perfectSpeed + "</td>";
                html += "</tr>";
                html += "</tbody>";
                html += "</table>";
                $("#messageBoard").html(html);
            })
                .on("mouseleave", function () {
                MessageBoard_1.default.resetMessageBoard("全新的宠物管理UI为您带来不一样的感受，试试把鼠标停留在宠物图片上有惊喜。<br>" +
                    "手机用户请试试单击宠物名字那一栏。");
            });
        }
    }
}
function doRenderGoldenCage(credential) {
    const s = $("#goldenCageIndex").text();
    if (s === "none") {
        return;
    }
    const index = parseInt(s);
    new GoldenCage_1.default(credential).open(index).then(cagePage => {
        const cagePetList = cagePage.sortedPetList;
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;text-align:center;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0'>";
        html += "<tr>";
        html += "<td style='background-color:#E8E8D0'>宠物名</td>";
        html += "<td style='background-color:#E8E8D0'>Ｌｖ</td>";
        html += "<td style='background-color:#E8E8D0'>ＨＰ</td>";
        html += "<td style='background-color:#E8E8D0'>攻击力</td>";
        html += "<td style='background-color:#E8E8D0'>防御力</td>";
        html += "<td style='background-color:#E8E8D0'>智力</td>";
        html += "<td style='background-color:#E8E8D0'>精神力</td>";
        html += "<td style='background-color:#E8E8D0'>速度</td>";
        html += "<td style='background-color:#E8E8D0'>经验</td>";
        html += "<td style='background-color:#E8E8D0'>性别</td>";
        html += "<td style='background-color:#E8E8D0'>取出</td>";
        html += "</tr>";
        for (const pet of cagePetList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>" + pet.name + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.level + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.health + "/" + pet.maxHealth + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.attack + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.defense + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.specialAttack + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.specialDefense + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.speed + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.experience + "</td>";
            html += "<td style='background-color:#E8E8D0'>" + pet.gender + "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            html += "<input type='button' class='PetUIButton' id='takeOutButton_" + pet.index + "' value='取出'>";
            html += "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#goldenCageContainer")
            .html(html)
            .parent()
            .show();
        $("#goldenCageStatus").text("on");
        for (const pet of cagePetList) {
            doBindTakeOutButton(credential, pet.index);
        }
    });
}
function doBind(credential, petList) {
    for (let i = 0; i < petList.length; i++) {
        const pet = petList[i];
        let buttonId = "pet_" + pet.index + "_uninstall";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetUninstallButton(credential, buttonId);
        }
        buttonId = "pet_" + pet.index + "_install";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetInstallButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_cage";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetCageButton(credential, buttonId, pet);
        }
        doBindPetSpellButton(credential, pet);
        buttonId = "pet_" + pet.index + "_love";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetLoveButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_league";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetLeagueButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_rename";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetRenameButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_consecrate";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetConsecrateButton(credential, buttonId, pet);
        }
        buttonId = "pet_" + pet.index + "_send";
        if (!$("#" + buttonId).prop("disabled")) {
            doBindPetSendButton(credential, buttonId, pet);
        }
    }
    // 设置宠物技能学习位的按钮行为
    doBindPetStudyButton(credential);
    // 设置查找发送对象按钮行为
    doBindSearchButton(credential);
    // 设置更新按钮行为
    doBindRefreshButton(credential);
    // 设置黄金笼子按钮的行为
    doBindGoldenCageButton(credential);
}
function doRefresh(credential) {
    new PersonalPetManagement_1.default(credential).open().then(petPage => {
        // 从新的宠物界面中重新解析宠物状态
        const petList = petPage.petList;
        const petStudyStatus = petPage.petStudyStatus;
        $(".pet_picture_class").off("mouseenter").off("mouseleave");
        // 解除当前所有的按钮
        $(".PetUIButton").off("click");
        // 清除PetUI的内容
        $("#pet_management_container").html("");
        // 清除牧场
        $("#ranchList").html("").parent().hide();
        $("#ranchMenu").hide();
        new PersonalStatus_1.default(credential).open().then(page => {
            const role = page.role;
            // 使用新的宠物重新渲染PetUI
            doRender(credential, petList, petStudyStatus, role);
        });
    });
}
function doBindPetUninstallButton(credential, buttonId) {
    $("#" + buttonId).on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = "-1";
        // @ts-ignore
        request["mode"] = "CHOOSEPET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindPetInstallButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "CHOOSEPET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindPetCageButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PUTINLONGZI";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindPetSpellButton(credential, pet) {
    $("#" + "pet_" + pet.index + "_spell_1").on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETUSESKILL_SET";
        if (PageUtils_1.default.isColorGrey("pet_" + pet.index + "_spell_1")) {
            // 启用当前的技能
            // @ts-ignore
            request["use1"] = "1";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_2")) {
            // @ts-ignore
            request["use2"] = "2";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_3")) {
            // @ts-ignore
            request["use3"] = "3";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_4")) {
            // @ts-ignore
            request["use4"] = "4";
        }
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#" + "pet_" + pet.index + "_spell_2").on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETUSESKILL_SET";
        if (PageUtils_1.default.isColorGrey("pet_" + pet.index + "_spell_2")) {
            // 启用当前的技能
            // @ts-ignore
            request["use2"] = "2";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_1")) {
            // @ts-ignore
            request["use1"] = "1";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_3")) {
            // @ts-ignore
            request["use3"] = "3";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_4")) {
            // @ts-ignore
            request["use4"] = "4";
        }
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#" + "pet_" + pet.index + "_spell_3").on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETUSESKILL_SET";
        if (PageUtils_1.default.isColorGrey("pet_" + pet.index + "_spell_3")) {
            // 启用当前的技能
            // @ts-ignore
            request["use3"] = "3";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_1")) {
            // @ts-ignore
            request["use1"] = "1";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_2")) {
            // @ts-ignore
            request["use2"] = "2";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_4")) {
            // @ts-ignore
            request["use4"] = "4";
        }
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#" + "pet_" + pet.index + "_spell_4").on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETUSESKILL_SET";
        if (PageUtils_1.default.isColorGrey("pet_" + pet.index + "_spell_4")) {
            // 启用当前的技能
            // @ts-ignore
            request["use4"] = "4";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_1")) {
            // @ts-ignore
            request["use1"] = "1";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_2")) {
            // @ts-ignore
            request["use2"] = "2";
        }
        if (PageUtils_1.default.isColorBlue("pet_" + pet.index + "_spell_3")) {
            // @ts-ignore
            request["use3"] = "3";
        }
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindPetLoveButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const amount = Math.ceil(100 - pet.love);
        const bank = new TownBank_1.default(credential);
        bank.withdraw(amount).then(() => {
            const request = credential.asRequest();
            // @ts-ignore
            request["mode"] = "PETADDLOVE";
            // @ts-ignore
            request["select"] = pet.index;
            NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                MessageBoard_1.default.processResponseMessage(html);
                bank.deposit().then(() => {
                    doRefresh(credential);
                });
            });
        });
    });
}
function doBindPetLeagueButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = pet.index;
        // @ts-ignore
        request["mode"] = "PETGAME";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            if (html.includes("ERROR !")) {
                const result = $(html).find("font b").text();
                MessageBoard_1.default.publishWarning(result);
                doRefresh(credential);
            }
            else {
                // 由于目前登陆宠联的操作不会触发页面刷新，因此直接返回主页面
                $("#returnButton").trigger("click");
            }
        });
    });
}
function doBindPetRenameButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const textId = "pet_" + pet.index + "_name_text";
        let newName = $("#" + textId).val();
        if (newName !== "") {
            newName = escape(newName);
            const request = credential.asRequest();
            // @ts-ignore
            request["select"] = pet.index;
            // @ts-ignore
            request["name"] = newName;
            // @ts-ignore
            request["mode"] = "PETCHANGENAME";
            NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                MessageBoard_1.default.processResponseMessage(html);
                doRefresh(credential);
            });
        }
    });
}
function doBindPetConsecrateButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        if (!confirm("你确认要献祭宠物" + pet.name + "吗？")) {
            return;
        }
        const bank = new TownBank_1.default(credential);
        bank.withdraw(1000).then(() => {
            consecratePet(credential, pet.index).then(() => {
                bank.deposit().then(() => {
                    doRefresh(credential);
                });
            });
        });
    });
}
function doBindPetSendButton(credential, buttonId, pet) {
    $("#" + buttonId).on("click", function () {
        const receiver = $("#receiverCandidates").val();
        if (receiver === undefined || receiver === "") {
            MessageBoard_1.default.publishWarning("没有选择发送对象！");
            return;
        }
        const bank = new TownBank_1.default(credential);
        bank.withdraw(10).then(() => {
            const request = credential.asRequest();
            // @ts-ignore
            request["mode"] = "PET_SEND2";
            // @ts-ignore
            request["eid"] = receiver;
            // @ts-ignore
            request["select"] = pet.index;
            NetworkUtils_1.default.sendPostRequest("town.cgi", request, function (html) {
                MessageBoard_1.default.processResponseMessage(html);
                bank.deposit().then(() => {
                    doRefresh(credential);
                });
            });
        });
    });
}
function doBindPetStudyButton(credential) {
    $("#pet_spell_study_1").on("click", function () {
        const request = credential.asRequest();
        const color = $("#pet_spell_study_1").css("color");
        if (color.toString() === "rgb(128, 128, 128)") {
            // @ts-ignore
            request["study1"] = "1";
        }
        if (color.toString() === "rgb(0, 0, 255)") {
            // 当前是已经设置学习状态
        }
        // @ts-ignore
        request["mode"] = "STUDY_SET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#pet_spell_study_2").on("click", function () {
        const request = credential.asRequest();
        const color = $("#pet_spell_study_2").css("color");
        if (color.toString() === "rgb(128, 128, 128)") {
            // @ts-ignore
            request["study2"] = "2";
        }
        if (color.toString() === "rgb(0, 0, 255)") {
            // 当前是已经设置学习状态
        }
        // @ts-ignore
        request["mode"] = "STUDY_SET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#pet_spell_study_3").on("click", function () {
        const request = credential.asRequest();
        const color = $("#pet_spell_study_3").css("color");
        if (color.toString() === "rgb(128, 128, 128)") {
            // @ts-ignore
            request["study3"] = "3";
        }
        if (color.toString() === "rgb(0, 0, 255)") {
            // 当前是已经设置学习状态
        }
        // @ts-ignore
        request["mode"] = "STUDY_SET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
    $("#pet_spell_study_4").on("click", function () {
        const request = credential.asRequest();
        const color = $("#pet_spell_study_4").css("color");
        if (color.toString() === "rgb(128, 128, 128)") {
            // @ts-ignore
            request["study4"] = "4";
        }
        if (color.toString() === "rgb(0, 0, 255)") {
            // 当前是已经设置学习状态
        }
        // @ts-ignore
        request["mode"] = "STUDY_SET";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doBindSearchButton(credential) {
    $("#searchReceiverButton").on("click", function () {
        const search = $("#receiverName").val();
        if (search.trim() === "") {
            MessageBoard_1.default.publishWarning("接收人没有输入！");
            return;
        }
        const request = credential.asRequest();
        // @ts-ignore
        request["mode"] = "PET_SEND";
        // @ts-ignore
        request["serch"] = escape(search.trim());
        NetworkUtils_1.default.sendPostRequest("town.cgi", request, function (html) {
            const optionHTML = $(html).find("select[name='eid']").html();
            $("#receiverCandidates").html(optionHTML);
        });
    });
}
function doBindRefreshButton(credential) {
    $("#refreshButton").on("click", function () {
        MessageBoard_1.default.resetMessageBoard("");
        doRefresh(credential);
    });
}
function consecratePet(credential, petIndex) {
    return __awaiter(this, void 0, void 0, function* () {
        const action = function (credential, petIndex) {
            return new Promise((resolve) => {
                const request = credential.asRequest();
                // @ts-ignore
                request["select"] = petIndex;
                // @ts-ignore
                request["mode"] = "PETBORN6";
                NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
                    MessageBoard_1.default.processResponseMessage(html);
                    resolve();
                });
            });
        };
        return yield action(credential, petIndex);
    });
}
function doBindGoldenCageButton(credential) {
    $("#openCageButton").on("click", function () {
        if ($("#goldenCageStatus").text() === "on") {
            return;
        }
        doRenderGoldenCage(credential);
    });
    $("#closeCageButton").on("click", function () {
        if ($("#goldenCageStatus").text() === "off") {
            return;
        }
        $("#goldenCageContainer")
            .html("")
            .parent()
            .hide();
        $("#goldenCageStatus").text("off");
    });
}
function doBindTakeOutButton(credential, index) {
    $("#takeOutButton_" + index).on("click", function () {
        const select = StringUtils_1.default.substringAfter($(this).attr("id"), "_");
        const request = credential.asRequest();
        // @ts-ignore
        request["select"] = select;
        // @ts-ignore
        request["mode"] = "GETOUTLONGZI";
        NetworkUtils_1.default.sendPostRequest("mydata.cgi", request, function (html) {
            MessageBoard_1.default.processResponseMessage(html);
            doRefresh(credential);
        });
    });
}
function doRenderRanch(credential) {
    new CastleRanch_1.default(credential).enter().then(status => {
        const petList = Pet_1.default.sortPetList(status.ranchPetList);
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold' colspan='10'>";
        html += "＜ 城 堡 牧 场 ＞";
        html += "</td>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>等级</th>";
        html += "<th style='background-color:#E0D0B0'>生命</th>";
        html += "<th style='background-color:#E0D0B0'>攻击</th>";
        html += "<th style='background-color:#E0D0B0'>防御</th>";
        html += "<th style='background-color:#E0D0B0'>智力</th>";
        html += "<th style='background-color:#E0D0B0'>精神</th>";
        html += "<th style='background-color:#E0D0B0'>速度</th>";
        html += "<th style='background-color:#EFE0C0'>经验</th>";
        html += "<th style='background-color:#EFE0C0'>性别</th>";
        html += "</tr>";
        for (const pet of petList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>" + pet.name + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + pet.levelHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.healthHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.attackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.defenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.specialAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.specialDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + pet.speedHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + pet.experienceHtml + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + pet.gender + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#ranchList").html(html).parent().show();
    });
}
module.exports = PersonalPetManagementPageProcessor_Town;


/***/ }),
/* 116 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalSalaryPageInterceptor_inTownProcessor, _PersonalSalaryPageInterceptor_inCastleProcessor;
const PersonalSalaryPageProcessor_Town_1 = __importDefault(__webpack_require__(117));
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const PageProcessorContext_1 = __importDefault(__webpack_require__(30));
const PersonalSalaryPageProcessor_Castle_1 = __importDefault(__webpack_require__(119));
class PersonalSalaryPageInterceptor {
    constructor() {
        _PersonalSalaryPageInterceptor_inTownProcessor.set(this, new PersonalSalaryPageProcessor_Town_1.default());
        _PersonalSalaryPageInterceptor_inCastleProcessor.set(this, new PersonalSalaryPageProcessor_Castle_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "mydata.cgi") {
            return pageText.includes("领取了") || pageText.includes("下次领取俸禄还需要等待");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(townId => {
            const context = new PageProcessorContext_1.default();
            context.set("townId", townId);
            __classPrivateFieldGet(this, _PersonalSalaryPageInterceptor_inTownProcessor, "f").process(context);
        })
            .whenInCastle(castleName => {
            const context = new PageProcessorContext_1.default();
            context.set("castleName", castleName);
            __classPrivateFieldGet(this, _PersonalSalaryPageInterceptor_inCastleProcessor, "f").process(context);
        })
            .fork();
    }
}
_PersonalSalaryPageInterceptor_inTownProcessor = new WeakMap(), _PersonalSalaryPageInterceptor_inCastleProcessor = new WeakMap();
module.exports = PersonalSalaryPageInterceptor;


/***/ }),
/* 117 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
const TownBank_1 = __importDefault(__webpack_require__(51));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const AbstractPersonalSalaryPageProcessor_1 = __importDefault(__webpack_require__(118));
class PersonalSalaryPageProcessor_Town extends AbstractPersonalSalaryPageProcessor_1.default {
    doGenerateHiddenForm(containerId, credential) {
        const html = PageUtils_1.default.generateReturnTownForm(credential);
        $("#" + containerId).html(html);
    }
    doBindReturnButton(context) {
        if (context !== undefined) {
            const townId = context.get("townId");
            const town = TownLoader_1.default.getTownById(townId);
            $("#returnButton").val("返回" + town.name);
        }
        $("#returnButton").on("click", () => {
            $("#returnTown").trigger("click");
        });
    }
    doBindDepositButton(credential, context) {
        if (context !== undefined) {
            const townId = context.get("townId");
            const town = TownLoader_1.default.getTownById(townId);
            $("#returnButton").val("携款逃回" + town.name);
        }
        $("#returnButton").on("click", () => {
            new TownBank_1.default(credential, context === null || context === void 0 ? void 0 : context.get("townId")).deposit().then(() => {
                $("#returnTown").trigger("click");
            });
        });
    }
}
module.exports = PersonalSalaryPageProcessor_Town;


/***/ }),
/* 118 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const CommentBoard_1 = __importDefault(__webpack_require__(20));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class AbstractPersonalSalaryPageProcessor extends PageProcessorCredentialSupport_1.default {
    doProcess(credential, context) {
        const pageText = $("body:first").text();
        if (pageText.includes("下次领取俸禄还需要等待")) {
            // 没有到领取俸禄的时间
            $("form").remove();
            $("#ueqtweixin").remove();
            $("hr:last").after($("<div></div>"));
            const imageHtml = NpcLoader_1.default.getNpcImageHtml("花子");
            CommentBoard_1.default.createCommentBoard(imageHtml);
            $("#commentBoard")
                .css("background-color", "black")
                .css("color", "wheat")
                .css("font-size", "120%")
                .css("font-weight", "bold")
                .html("害我也白跑一趟，晦气！");
            let html = "";
            html += "<div id='hiddenFormContainer' style='display:none'></div>";
            html += "<div id='menuContainer'></div>";
            $("p:last").html(html);
            this.doGenerateHiddenForm("hiddenFormContainer", credential);
            $("#menuContainer").html("<input type='button' id='returnButton' value='返回'>");
            this.doBindReturnButton(context);
        }
        else {
            // 成功领取了俸禄
            const imageHtml = NpcLoader_1.default.getNpcImageHtml("花子");
            CommentBoard_1.default.createCommentBoard(imageHtml);
            $("#commentBoard")
                .css("background-color", "black")
                .css("color", "wheat")
                .css("font-size", "120%")
                .css("font-weight", "bold")
                .html("打、打、打劫。不许笑，我跟这儿打劫呢。IC、IP、IQ卡，通通告诉我密码！");
            $("form").remove();
            let html = "";
            html += "<div id='hiddenFormContainer' style='display:none'></div>";
            html += "<div id='menuContainer'></div>";
            $("p:last").html(html);
            this.doGenerateHiddenForm("hiddenFormContainer", credential);
            $("#menuContainer").html("<input type='button' id='returnButton' value='返回'>");
            this.doBindDepositButton(credential, context);
        }
    }
}
module.exports = AbstractPersonalSalaryPageProcessor;


/***/ }),
/* 119 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const CastleBank_1 = __importDefault(__webpack_require__(26));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const AbstractPersonalSalaryPageProcessor_1 = __importDefault(__webpack_require__(118));
class PersonalSalaryPageProcessor_Castle extends AbstractPersonalSalaryPageProcessor_1.default {
    doGenerateHiddenForm(containerId, credential) {
        const html = PageUtils_1.default.generateReturnCastleForm(credential);
        $("#" + containerId).html(html);
    }
    doBindReturnButton(context) {
        if (context !== undefined) {
            const castleName = context.get("castleName");
            $("#returnButton").val("返回" + castleName);
        }
        $("#returnButton").on("click", () => {
            $("#returnCastle").trigger("click");
        });
    }
    doBindDepositButton(credential, context) {
        if (context !== undefined) {
            const castleName = context.get("castleName");
            $("#returnButton").val("携款逃回" + castleName);
        }
        $("#returnButton").on("click", () => {
            new CastleBank_1.default(credential).deposit().then(() => {
                $("#returnCastle").trigger("click");
            });
        });
    }
}
module.exports = PersonalSalaryPageProcessor_Castle;


/***/ }),
/* 120 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalSetupPageInterceptor_inTownProcessor, _PersonalSetupPageInterceptor_inCastleProcessor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const PersonalSetupPageProcessor_Castle_1 = __importDefault(__webpack_require__(121));
const PersonalSetupPageProcessor_Town_1 = __importDefault(__webpack_require__(164));
class PersonalSetupPageInterceptor {
    constructor() {
        _PersonalSetupPageInterceptor_inTownProcessor.set(this, new PersonalSetupPageProcessor_Town_1.default());
        _PersonalSetupPageInterceptor_inCastleProcessor.set(this, new PersonalSetupPageProcessor_Castle_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "mydata.cgi") {
            return pageText.includes("给其他人发送消息");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _PersonalSetupPageInterceptor_inTownProcessor, "f").process();
        })
            .whenInCastle(() => {
            __classPrivateFieldGet(this, _PersonalSetupPageInterceptor_inCastleProcessor, "f").process();
        })
            .fork();
    }
}
_PersonalSetupPageInterceptor_inTownProcessor = new WeakMap(), _PersonalSetupPageInterceptor_inCastleProcessor = new WeakMap();
module.exports = PersonalSetupPageInterceptor;


/***/ }),
/* 121 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const AbstractPersonalSetupPageProcessor_1 = __importDefault(__webpack_require__(122));
const PageUtils_1 = __importDefault(__webpack_require__(21));
class PersonalSetupPageProcessor_Castle extends AbstractPersonalSetupPageProcessor_1.default {
    doGenerateHiddenForm(credential, containerId) {
        const html = PageUtils_1.default.generateReturnCastleForm(credential);
        $("#" + containerId).html(html);
    }
    doBindReturnButton(returnButtonId) {
        $("#" + returnButtonId).on("click", function () {
            $("#returnCastle").trigger("click");
        });
    }
}
module.exports = PersonalSetupPageProcessor_Castle;


/***/ }),
/* 122 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _AbstractPersonalSetupPageProcessor_instances, _AbstractPersonalSetupPageProcessor_setupItemManager, _AbstractPersonalSetupPageProcessor_render, _AbstractPersonalSetupPageProcessor_bindLoadButton, _AbstractPersonalSetupPageProcessor_bindRefreshButton, _AbstractPersonalSetupPageProcessor_loadEquipments;
const EquipmentLoader_1 = __importDefault(__webpack_require__(123));
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const TreasureBag_1 = __importDefault(__webpack_require__(85));
const SetupItemManager_1 = __importDefault(__webpack_require__(124));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class AbstractPersonalSetupPageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super();
        _AbstractPersonalSetupPageProcessor_instances.add(this);
        _AbstractPersonalSetupPageProcessor_setupItemManager.set(this, void 0);
        __classPrivateFieldSet(this, _AbstractPersonalSetupPageProcessor_setupItemManager, new SetupItemManager_1.default(), "f");
    }
    doProcess(credential) {
        // 整个页面是放在一个大form里面，删除重组
        const lastDivHtml = $("div:last").html();
        $("form:first").remove();
        $("body:first").prepend($("<div id='top_container'></div>" +
            "<hr style='height:0;width:100%'>" +
            "<div style='text-align:center'>" + lastDivHtml + "</div>"));
        // 绘制新的页面
        let html = "";
        html += "<div id='hiddenFormContainer' style='display:none'></div>";
        html += "<div id='weapon_list' style='display:none'></div>";
        html += "<div id='armor_list' style='display:none'></div>";
        html += "<div id='accessory_list' style='display:none'></div>";
        $("#top_container").append($(html));
        this.doGenerateHiddenForm(credential, "hiddenFormContainer");
        html = "";
        html += "<table style='background-color:#888888;width:100%;text-align:center'>";
        html += "<tbody style='background-color:#F8F0E0'>";
        html += "<tr>";
        html += "<td id='pageTitle' style='background-color:navy;color:yellowgreen;font-size:150%;font-weight:bold'>" +
            "＜＜  口 袋 助 手 设 置  ＞＞" +
            "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<td id='message_board_container'></td>";
        html += "</tr>";
        html += "<tr>";
        html += "<td id='setup_item_container'></td>";
        html += "</tr>";
        html += "<tr>";
        html += "<td style='text-align:center'>" +
            "<input type='button' id='loadButton' value='加载自己装备'>" +
            "<input type='button' id='refreshButton' value='刷新助手设置'>" +
            "<input type='button' id='returnButton' value='退出助手设置'>" +
            "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<td style='text-align:center;background-color:red;font-weight:bold;font-size:120%'>" +
            "以下操作包含有账号登陆敏感信息，请自己保护好数据安全！" +
            "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<td style='text-align:center'>" +
            "<input type='button' id='exportButton' value='导出所有设置'>" +
            "<input type='button' id='importButton' value='导入所有设置'>" +
            "<input type='button' id='purgeButton' value='清除所有设置'>" +
            "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<td style='text-align:center'>";
        // noinspection CssInvalidPropertyValue
        html += "<textarea id='allConfigs' " +
            "rows='15' " +
            "style=\"height:expression((this.scrollHeight>150)?'150px':(this.scrollHeight+5)+'px');overflow:auto;width:100%;word-break;break-all;\">" +
            "</textarea>";
        html += "</td>";
        html += "</tr>";
        html += "</tody>";
        html += "</table>";
        $("#top_container").append($(html));
        $("#weapon_list").text(EquipmentLoader_1.default.loadWeaponList().join(","));
        $("#armor_list").text(EquipmentLoader_1.default.loadArmorList().join(","));
        $("#accessory_list").text(EquipmentLoader_1.default.loadAccessoryList().join(","));
        __classPrivateFieldGet(this, _AbstractPersonalSetupPageProcessor_instances, "m", _AbstractPersonalSetupPageProcessor_bindLoadButton).call(this, credential);
        __classPrivateFieldGet(this, _AbstractPersonalSetupPageProcessor_instances, "m", _AbstractPersonalSetupPageProcessor_bindRefreshButton).call(this, credential);
        this.doBindReturnButton("returnButton");
        $("#exportButton").on("click", () => {
            const allConfigs = StorageUtils_1.default.dumpLocalStorage();
            $("#allConfigs").val(allConfigs);
        });
        $("#importButton").on("click", () => {
            if (!confirm("请确认要导入助手的所有设置？")) {
                return;
            }
            const json = $("#allConfigs").val();
            const allConfigs = JSON.parse(json);
            const keys = Object.keys(allConfigs);
            for (const key of keys) {
                // @ts-ignore
                const value = allConfigs[key];
                StorageUtils_1.default.set(key, value);
            }
            MessageBoard_1.default.publishMessage("助手设置信息已经导入！");
            PageUtils_1.default.scrollIntoView("pageTitle");
            $("#refreshButton").trigger("click");
        });
        $("#purgeButton").on("click", () => {
            if (!confirm("请再次确认要清除助手的所有设置？")) {
                return;
            }
            StorageUtils_1.default.purge();
            MessageBoard_1.default.publishMessage("所有助手设置信息已经清除！");
            PageUtils_1.default.scrollIntoView("pageTitle");
            $("#refreshButton").trigger("click");
        });
        new PersonalStatus_1.default(credential).load().then(role => {
            MessageBoard_1.default.createMessageBoard("message_board_container", role.imageHtml);
            $("#roleImage").on("dblclick", function () {
                // Get setup 001-005 status
                const s1 = $("#select_001").val();
                const s2 = $("#select_002").val();
                const s3 = $("#select_003").val();
                const s4 = $("#select_004").val();
                const s5 = $("#select_005").val();
                if (s1 === "1" &&
                    s2 === "0.2" &&
                    s3 === "20" &&
                    s4 === "20" &&
                    s5 === "2") {
                    if ($("#battle_field_setup").length > 0) {
                        $("#battle_field_setup").toggle();
                    }
                }
                $(".hidden_setup_item").toggle();
            });
        });
        __classPrivateFieldGet(this, _AbstractPersonalSetupPageProcessor_instances, "m", _AbstractPersonalSetupPageProcessor_render).call(this, credential);
    }
}
_AbstractPersonalSetupPageProcessor_setupItemManager = new WeakMap(), _AbstractPersonalSetupPageProcessor_instances = new WeakSet(), _AbstractPersonalSetupPageProcessor_render = function _AbstractPersonalSetupPageProcessor_render(credential) {
    let html = "";
    html += "<table style='background-color:#888888;width:100%;text-align:center'>";
    html += "<tbody style='background-color:#F8F0E0' id='setup_item_table'>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>名字</th>";
    html += "<th style='background-color:#E8E8D0'>专属</th>";
    html += "<th style='background-color:#EFE0C0'>设置</th>";
    html += "<th style='background-color:#E0D0B0'>选择</th>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#setup_item_container").html(html);
    for (const it of __classPrivateFieldGet(this, _AbstractPersonalSetupPageProcessor_setupItemManager, "f").getSetupItem()) {
        it.render(credential.id);
    }
}, _AbstractPersonalSetupPageProcessor_bindLoadButton = function _AbstractPersonalSetupPageProcessor_bindLoadButton(credential) {
    const instance = this;
    $("#loadButton").on("click", function () {
        new PersonalEquipmentManagement_1.default(credential).open().then(page => {
            const equipmentList = page.equipmentList;
            const treasureBag = page.findTreasureBag();
            if (treasureBag !== null) {
                new TreasureBag_1.default(credential).open(treasureBag.index)
                    .then(bagPage => {
                    const bagEquipmentList = bagPage.equipmentList;
                    __classPrivateFieldGet(instance, _AbstractPersonalSetupPageProcessor_instances, "m", _AbstractPersonalSetupPageProcessor_loadEquipments).call(instance, equipmentList, bagEquipmentList);
                    $("#refreshButton").trigger("click");
                });
            }
            else {
                __classPrivateFieldGet(instance, _AbstractPersonalSetupPageProcessor_instances, "m", _AbstractPersonalSetupPageProcessor_loadEquipments).call(instance, equipmentList, undefined);
                $("#refreshButton").trigger("click");
            }
        });
    });
}, _AbstractPersonalSetupPageProcessor_bindRefreshButton = function _AbstractPersonalSetupPageProcessor_bindRefreshButton(credential) {
    const instance = this;
    $("#refreshButton").on("click", function () {
        $("#setup_item_table").html("");
        $(".dynamic_button").off("click");
        __classPrivateFieldGet(instance, _AbstractPersonalSetupPageProcessor_instances, "m", _AbstractPersonalSetupPageProcessor_render).call(instance, credential);
    });
}, _AbstractPersonalSetupPageProcessor_loadEquipments = function _AbstractPersonalSetupPageProcessor_loadEquipments(itemList, bagItemList) {
    const weaponLib = [];
    const armorLib = [];
    const accessoryLib = [];
    for (const it of itemList) {
        if (it.isWeapon) {
            weaponLib.push(it.name);
        }
        if (it.isArmor) {
            armorLib.push(it.name);
        }
        if (it.isAccessory) {
            accessoryLib.push(it.name);
        }
    }
    if (bagItemList !== undefined) {
        for (const it of bagItemList) {
            if (it.isWeapon) {
                weaponLib.push(it.name);
            }
            if (it.isArmor) {
                armorLib.push(it.name);
            }
            if (it.isAccessory) {
                accessoryLib.push(it.name);
            }
        }
    }
    const weaponCandidates = [];
    const armorCandidates = [];
    const accessoryCandidates = [];
    for (const it of EquipmentLoader_1.default.loadWeaponList()) {
        if (weaponLib.includes(it)) {
            weaponCandidates.push(it);
        }
    }
    for (const it of EquipmentLoader_1.default.loadArmorList()) {
        if (armorLib.includes(it)) {
            armorCandidates.push(it);
        }
    }
    for (const it of EquipmentLoader_1.default.loadAccessoryList()) {
        if (accessoryLib.includes(it)) {
            accessoryCandidates.push(it);
        }
    }
    $("#weapon_list").text(weaponCandidates.join(","));
    $("#armor_list").text(armorCandidates.join(","));
    $("#accessory_list").text(accessoryCandidates.join(","));
};
module.exports = AbstractPersonalSetupPageProcessor;


/***/ }),
/* 123 */
/***/ ((module) => {


class EquipmentLoader {
    static loadWeaponList() {
        return WEAPON_LIST;
    }
    static loadArmorList() {
        return ARMOR_LIST;
    }
    static loadAccessoryList() {
        return ACCESSORY_LIST;
    }
}
const WEAPON_LIST = [
    "神枪 永恒",
    "霸邪斧 天煌",
    "魔刀 哭杀",
    "神器 苍穹",
    "魔神器 幻空",
    "真·圣剑 苍白的正义",
    "双经斩",
    "1.5倍界王拳套",
    "九齿钉耙",
    "降魔杖",
    "2015.02.14情人节巧克力",
    "2005.5.1-2006.5.1劳动升级版",
    "波斯弯刀",
    "女神之剑",
    "星夜之弓",
    "鲁恩之刀",
    "裂天矛",
    "沉默之剑",
    "破云弓",
    "光之剑",
    "巨魔弓 世界",
    "邪骇灵杖",
    "战魔刀",
    "闪刺枪",
    "妖枪 影",
    "传说之剑",
    "魔杖 霜雪",
    "生存之刀",
    "月牙型剑",
    "白金枪",
    "炙雷之斧",
    "圣纹剑",
    "铭刀长刀",
    "水晶刀",
    "龙鳞铠胄",
    "恶魔锁甲",
    "圣枪 隆基诺斯",
    "飞凤枪",
    "雨之村云",
    "影忍者刀",
    "鸣雷剑",
    "铳剑",
    "刺馈剑",
    "双刃",
    "秘剑 天下",
    "赎罪镇魂剑",
    "虚空之枪",
    "封魔弓",
    "霸枪 龙息",
    "光阴之剑",
    "大马士革钢刀",
    "秘银长剑",
    "流星闪爪",
    "奥利哈钢剑",
    "月牙法杖",
    "冰之拳套",
    "鬼灵之弓",
    "邪双华",
    "震雷匕首",
    "财富之军刀",
    "空斩短刃",
    "白银弓",
    "圣杖 天问",
    "绿玉投枪",
    "世界树之枝",
    "精灵之弓矢",
    "夺魂冰钩",
    "圣使之刺剑",
    "秘刀 走雪",
    "血之剑",
    "寡妇制造器",
    "瓦谕剑",
    "封神剑 天劫",
    "奥利哈钢匕首"
];
const ARMOR_LIST = [
    "千幻碧水猿洛克奇斯",
    "地纹玄甲龟斯特奥特斯",
    "幽冥黑鳞蟒罗尼科斯",
    "火睛混沌兽哈贝达",
    "羽翅圣光虎阿基勒斯",
    "金翅追日鹰庞塔雷斯",
    "风翼三足凤纳托利斯",
    "圣皇铠甲 天威",
    "薄翼甲",
    "2015.01.29十周年纪念",
    "背德魔铠",
    "月冰石之头巾",
    "斗神铠 狂狱",
    "风之法袍",
    "夜魔披风",
    "飞马头盔",
    "逆魔道袍",
    "星之甲",
    "犰狳铁皮甲",
    "英雄斗篷",
    "修罗轻衣",
    "雷之法袍",
    "锁子鳞甲",
    "纹章盾",
    "霜雪长袍",
    "古代头盔",
    "怨灵邪衣",
    "龙之盔甲",
    "冥铠 幽辉",
    "古代の铠甲",
    "龙鳞铠胄",
    "恶魔锁甲",
    "战士铠甲",
    "塔盾",
    "忍者头巾",
    "武者之铠",
    "镜盾",
    "守鹤之盾",
    "冥雷战甲",
    "金制头盔",
    "圣袍 光明",
    "金制锁甲",
    "软鳞甲",
    "护肩盾",
    "龙鳞长袍",
    "神之法袍",
    "幻衣 夕雾",
    "英雄王冠",
    "圣衣 苍羽",
    "火之法袍",
    "钢岩护甲",
    "火之锁甲",
    "吟游诗人双面上装",
    "勇者斗篷",
    "冰河兽革",
    "暗之法袍",
    "魔铠 血炙",
    "龙盾",
    "枭之甲",
    "螺旋盾",
    "霸铠 吞天",
    "鲁恩头盔",
    "龙铠 牙刃",
    "冰之法袍",
    "紫杉叶长袍",
    "女神之铠",
    "咒袍 孤星",
    "巨人之铠",
    "孔雀袍",
    "羽毛帽"
];
const ACCESSORY_LIST = [
    "魔盔 虚无",
    "神冠 灵通",
    "龙",
    "千与千寻",
    "勿忘我",
    "魔法使的闪光弹",
    "2015.02.14情人节玫瑰",
    "圣王玉坠",
    "月牙之戒",
    "龙结晶",
    "龙鳞冠",
    "黒影之项链",
    "人面鸟",
    "深红蔷薇",
    "魔金头环",
    "红色羽毛",
    "王者之靴 圣踏",
    "强运之耳饰",
    "头带",
    "陨石之光",
    "魔法头带",
    "雾之项链",
    "独角兽",
    "银制耳饰",
    "司祭头环",
    "战王之证",
    "极光护轮",
    "红月之角笛",
    "鬼面",
    "龙鳞护腕",
    "猫眼",
    "月之水滴",
    "雷鸣指环",
    "黑核晶",
    "铁制头盔",
    "钢制护手",
    "逆十字架",
    "黄金王冠",
    "龙牙冠",
    "鲁恩耳饰",
    "狮鹫兽",
    "沉睡之护符",
    "风之环",
    "冰鱼之勾玉",
    "魔炎战盔",
    "束缚之耳饰",
    "天马",
    "白金指环",
    "魔精玉",
    "蓝色羽毛",
    "圣心符",
    "银制指环",
    "陆行鸟",
    "绿色羽毛",
    "红头巾",
    "天使的羽毛",
    "烈岩头盔",
    "火神的指环",
    "速风之羽",
    "攻击之护符",
    "星盔 闪",
    "水女神的指环",
    "晶之冠",
    "金制胸针",
    "极光之翼",
    "雪的结晶"
];
module.exports = EquipmentLoader;


/***/ }),
/* 124 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _SetupItemManager_setupItemList;
const SetupItem001_1 = __importDefault(__webpack_require__(125));
const SetupItem002_1 = __importDefault(__webpack_require__(126));
const SetupItem003_1 = __importDefault(__webpack_require__(127));
const SetupItem004_1 = __importDefault(__webpack_require__(128));
const SetupItem005_1 = __importDefault(__webpack_require__(129));
const SetupItem006_1 = __importDefault(__webpack_require__(130));
const SetupItem007_1 = __importDefault(__webpack_require__(131));
const SetupItem008_1 = __importDefault(__webpack_require__(132));
const SetupItem009_1 = __importDefault(__webpack_require__(133));
const SetupItem010_1 = __importDefault(__webpack_require__(134));
const SetupItem011_1 = __importDefault(__webpack_require__(135));
const SetupItem012_1 = __importDefault(__webpack_require__(136));
const SetupItem013_1 = __importDefault(__webpack_require__(137));
const SetupItem014_1 = __importDefault(__webpack_require__(138));
const SetupItem015_1 = __importDefault(__webpack_require__(139));
const SetupItem016_1 = __importDefault(__webpack_require__(140));
const SetupItem017_1 = __importDefault(__webpack_require__(141));
const SetupItem018_1 = __importDefault(__webpack_require__(142));
const SetupItem019_1 = __importDefault(__webpack_require__(143));
const SetupItem020_1 = __importDefault(__webpack_require__(144));
const SetupItem021_1 = __importDefault(__webpack_require__(145));
const SetupItem022_1 = __importDefault(__webpack_require__(146));
const SetupItem023_1 = __importDefault(__webpack_require__(147));
const SetupItem024_1 = __importDefault(__webpack_require__(148));
const SetupItem025_1 = __importDefault(__webpack_require__(149));
const SetupItem026_1 = __importDefault(__webpack_require__(150));
const SetupItem027_1 = __importDefault(__webpack_require__(151));
const SetupItem028_1 = __importDefault(__webpack_require__(152));
const SetupItem029_1 = __importDefault(__webpack_require__(153));
const SetupItem030_1 = __importDefault(__webpack_require__(154));
const SetupItem031_1 = __importDefault(__webpack_require__(155));
const SetupItem032_1 = __importDefault(__webpack_require__(156));
const SetupItem033_1 = __importDefault(__webpack_require__(157));
const SetupItem034_1 = __importDefault(__webpack_require__(158));
const SetupItem035_1 = __importDefault(__webpack_require__(159));
const SetupItem036_1 = __importDefault(__webpack_require__(160));
const SetupItem037_1 = __importDefault(__webpack_require__(161));
const SetupItem038_1 = __importDefault(__webpack_require__(162));
const SetupItem039_1 = __importDefault(__webpack_require__(163));
class SetupItemManager {
    constructor() {
        _SetupItemManager_setupItemList.set(this, void 0);
        __classPrivateFieldSet(this, _SetupItemManager_setupItemList, [
            new SetupItem012_1.default(),
            new SetupItem029_1.default(),
            new SetupItem001_1.default(),
            new SetupItem002_1.default(),
            new SetupItem003_1.default(),
            new SetupItem004_1.default(),
            new SetupItem005_1.default(),
            new SetupItem006_1.default(),
            new SetupItem007_1.default(),
            new SetupItem008_1.default(),
            new SetupItem009_1.default(),
            new SetupItem010_1.default(),
            new SetupItem011_1.default(),
            new SetupItem013_1.default(),
            new SetupItem031_1.default(),
            new SetupItem033_1.default(),
            new SetupItem014_1.default(),
            new SetupItem015_1.default(),
            new SetupItem016_1.default(),
            new SetupItem017_1.default(),
            new SetupItem018_1.default(),
            new SetupItem019_1.default(),
            new SetupItem020_1.default(),
            new SetupItem021_1.default(),
            new SetupItem022_1.default(),
            new SetupItem023_1.default(),
            new SetupItem024_1.default(),
            new SetupItem025_1.default(),
            new SetupItem026_1.default(),
            new SetupItem027_1.default(),
            new SetupItem028_1.default(),
            new SetupItem030_1.default(),
            new SetupItem032_1.default(),
            new SetupItem034_1.default(),
            new SetupItem035_1.default(),
            new SetupItem036_1.default(),
            new SetupItem037_1.default(),
            new SetupItem038_1.default(),
            new SetupItem039_1.default(),
        ], "f");
    }
    getSetupItem() {
        return __classPrivateFieldGet(this, _SetupItemManager_setupItemList, "f");
    }
}
_SetupItemManager_setupItemList = new WeakMap();
module.exports = SetupItemManager;


/***/ }),
/* 125 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem001 {
    render(id) {
        doRender();
    }
}
const code = "001";
const name = "宝可梦百科超链";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isPokemonWikiEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem001;


/***/ }),
/* 126 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem002 {
    render(id) {
        doRender();
    }
}
const code = "002";
const name = "掉血后自动住宿";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getLodgeHealthLostRatio();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='-1'>禁用</option>";
    html += "<option class='option_class_" + code + "' value='0.1'>10%</option>";
    html += "<option class='option_class_" + code + "' value='0.2'>20%</option>";
    html += "<option class='option_class_" + code + "' value='0.3'>30%</option>";
    html += "<option class='option_class_" + code + "' value='0.4'>40%</option>";
    html += "<option class='option_class_" + code + "' value='0.5'>50%</option>";
    html += "<option class='option_class_" + code + "' value='0.6'>60%</option>";
    html += "<option class='option_class_" + code + "' value='0.7'>70%</option>";
    html += "<option class='option_class_" + code + "' value='0.8'>80%</option>";
    html += "<option class='option_class_" + code + "' value='1.1'>110%</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem002;


/***/ }),
/* 127 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem003 {
    render(id) {
        doRender();
    }
}
const code = "003";
const name = "掉魔后自动住宿";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getLodgeManaLostPoint();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='-1'>禁用</option>";
    html += "<option class='option_class_" + code + "' value='10'>10PP</option>";
    html += "<option class='option_class_" + code + "' value='20'>20PP</option>";
    html += "<option class='option_class_" + code + "' value='50'>50PP</option>";
    html += "<option class='option_class_" + code + "' value='100'>100PP</option>";
    html += "<option class='option_class_" + code + "' value='200'>200PP</option>";
    html += "<option class='option_class_" + code + "' value='500'>500PP</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem003;


/***/ }),
/* 128 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem004 {
    render(id) {
        doRender();
    }
}
const code = "004";
const name = "修理装备耐久限";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getRepairMinLimitation();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='10'>耐久10</option>";
    html += "<option class='option_class_" + code + "' value='20'>耐久20</option>";
    html += "<option class='option_class_" + code + "' value='50'>耐久50</option>";
    html += "<option class='option_class_" + code + "' value='100'>耐久100</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem004;


/***/ }),
/* 129 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem005 {
    render(id) {
        doRender();
    }
}
const code = "005";
const name = "触发存钱的战数";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getDepositBattleCount();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='-1'>不存</option>";
    html += "<option class='option_class_" + code + "' value='0'>每战存钱</option>";
    html += "<option class='option_class_" + code + "' value='2'>2战一存</option>";
    html += "<option class='option_class_" + code + "' value='5'>5战一存</option>";
    html += "<option class='option_class_" + code + "' value='10'>10战一存</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem005;


/***/ }),
/* 130 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem006 {
    render(id) {
        doRender();
    }
}
const code = "006";
const name = "战斗页自动触底";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isBattleResultAutoScrollEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem006;


/***/ }),
/* 131 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem007 {
    render(id) {
        doRender();
    }
}
const code = "007";
const name = "战斗后强制推荐";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isBattleForceRecommendationEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem007;


/***/ }),
/* 132 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem008 {
    render(id) {
        doRender();
    }
}
const code = "008";
const name = "十二宫极速战斗";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isZodiacFlashBattleEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem008;


/***/ }),
/* 133 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem009 {
    render(id) {
        doRender();
    }
}
const code = "009";
const name = "新宠物管理界面";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isPetManagementUIEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem009;


/***/ }),
/* 134 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem010 {
    render(id) {
        doRender();
    }
}
const code = "010";
const name = "新装备管理界面";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isEquipmentManagementUIEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem010;


/***/ }),
/* 135 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem011 {
    render(id) {
        doRender();
    }
}
const code = "011";
const name = "新职业管理界面";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isCareerManagementUIEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem011;


/***/ }),
/* 136 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem012 {
    render(id) {
        doRender(id);
    }
}
const code = "012";
const name = "战斗场偏好设置";
const key = "_pa_" + code;
function doRender(id) {
    let html = "";
    html += "<tr id='battle_field_setup' style='display:block'>";
    html += "<th style='background-color:red;color:wheat'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'>★</td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getBattlePlacePreference(id);
    // @ts-ignore
    $("#primary_battle").prop("checked", value["primary"]);
    // @ts-ignore
    $("#junior_battle").prop("checked", value["junior"]);
    // @ts-ignore
    $("#senior_battle").prop("checked", value["senior"]);
    // @ts-ignore
    $("#zodiac_battle").prop("checked", value["zodiac"]);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(id);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='checkbox' class='checkbox_class_" + code + "' id='primary_battle'>初级之森";
    html += "<input type='checkbox' class='checkbox_class_" + code + "' id='junior_battle'>中级之塔";
    html += "<input type='checkbox' class='checkbox_class_" + code + "' id='senior_battle'>上级之洞";
    html += "<input type='checkbox' class='checkbox_class_" + code + "' id='zodiac_battle'>十二神殿";
    return html;
}
function doSaveSetupItem(id) {
    const value = {};
    // @ts-ignore
    value["primary"] = $("#primary_battle").prop("checked");
    // @ts-ignore
    value["junior"] = $("#junior_battle").prop("checked");
    // @ts-ignore
    value["senior"] = $("#senior_battle").prop("checked");
    // @ts-ignore
    value["zodiac"] = $("#zodiac_battle").prop("checked");
    StorageUtils_1.default.set(key + "_" + id, JSON.stringify(value));
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem012;


/***/ }),
/* 137 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem013 {
    render(id) {
        doRender();
    }
}
const code = "013";
const name = "全新的商店界面";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isPocketSuperMarketEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem013;


/***/ }),
/* 138 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem014 {
    render(id) {
        doRender(id);
    }
}
const code = "014";
const name = "关闭转职的入口";
const key = "_pa_" + code;
function doRender(id) {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'>★</td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isCareerTransferEntranceDisabled(id);
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(id);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem(id) {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key + "_" + id, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem014;


/***/ }),
/* 139 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem015 {
    render(id) {
        doRender();
    }
}
const code = "015";
const name = "战斗的返回台词";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getBattleReturnButtonText();
    if (value !== "") {
        $("#text_" + code).attr("placeholder", value);
    }
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='text' id='text_" + code + "' class='text_class_" + code + "' size='40' maxlength='40'>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#text_" + code).val();
    if (value === "") {
        StorageUtils_1.default.remove(key);
        MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经重置。");
    }
    else {
        StorageUtils_1.default.set(key, value);
        MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    }
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem015;


/***/ }),
/* 140 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem016 {
    render(id) {
        doRender();
    }
}
const code = "016";
const name = "战斗的住宿台词";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getBattleLodgeButtonText();
    if (value !== "") {
        $("#text_" + code).attr("placeholder", value);
    }
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='text' id='text_" + code + "' class='text_class_" + code + "' size='40' maxlength='40'>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#text_" + code).val();
    if (value === "") {
        StorageUtils_1.default.remove(key);
        MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经重置。");
    }
    else {
        StorageUtils_1.default.set(key, value);
        MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    }
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem016;


/***/ }),
/* 141 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem017 {
    render(id) {
        doRender();
    }
}
const code = "017";
const name = "战斗的修理台词";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getBattleRepairButtonText();
    if (value !== "") {
        $("#text_" + code).attr("placeholder", value);
    }
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='text' id='text_" + code + "' class='text_class_" + code + "' size='40' maxlength='40'>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#text_" + code).val();
    if (value === "") {
        StorageUtils_1.default.remove(key);
        MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经重置。");
    }
    else {
        StorageUtils_1.default.set(key, value);
        MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    }
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem017;


/***/ }),
/* 142 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem018 {
    render(id) {
        doRender();
    }
}
const code = "018";
const name = "战斗的存钱台词";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getBattleDepositButtonText();
    if (value !== "") {
        $("#text_" + code).attr("placeholder", value);
    }
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='text' id='text_" + code + "' class='text_class_" + code + "' size='40' maxlength='40'>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#text_" + code).val();
    if (value === "") {
        StorageUtils_1.default.remove(key);
        MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经重置。");
    }
    else {
        StorageUtils_1.default.set(key, value);
        MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    }
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem018;


/***/ }),
/* 143 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem019 {
    render(id) {
        doRender(id);
    }
}
const code = "019";
const name = "自定义的套装Ａ";
const key = "_pa_" + code;
function doRender(id) {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'>★</td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.loadEquipmentSet_A(id);
    if (value["weaponStar"] !== undefined && value["weaponStar"]) {
        $(".checkbox_" + code + "[value='weaponStar']").prop("checked", true);
    }
    if (value["armorStar"] !== undefined && value["armorStar"]) {
        $(".checkbox_" + code + "[value='armorStar']").prop("checked", true);
    }
    if (value["accessoryStar"] !== undefined && value["accessoryStar"]) {
        $(".checkbox_" + code + "[value='accessoryStar']").prop("checked", true);
    }
    $(".weapon_option_" + code + "[value='" + value["weaponName"] + "']").prop("selected", true);
    $(".armor_option_" + code + "[value='" + value["armorName"] + "']").prop("selected", true);
    $(".accessory_option_" + code + "[value='" + value["accessoryName"] + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(id);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='weaponStar'>★";
    const weaponList = $("#weapon_list").text().split(",");
    html += "<select name='weapon_" + code + "'>";
    html += "<option class='weapon_option_" + code + "' value='NONE'>无</option>";
    for (const it of weaponList) {
        html += "<option class='weapon_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='armorStar'>★";
    const armorList = $("#armor_list").text().split(",");
    html += "<select name='armor_" + code + "'>";
    html += "<option class='armor_option_" + code + "' value='NONE'>无</option>";
    for (const it of armorList) {
        html += "<option class='armor_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='accessoryStar'>★";
    const accessoryList = $("#accessory_list").text().split(",");
    html += "<select name='accessory_" + code + "'>";
    html += "<option class='accessory_option_" + code + "' value='NONE'>无</option>";
    for (const it of accessoryList) {
        html += "<option class='accessory_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    return html;
}
function doSaveSetupItem(id) {
    const value = {};
    $("input:checkbox[name='star_" + code + "']:checked").each(function (_idx, checkbox) {
        // @ts-ignore
        value[$(checkbox).val()] = true;
    });
    // @ts-ignore
    value["weaponName"] = $("select[name='weapon_" + code + "']").val();
    // @ts-ignore
    value["armorName"] = $("select[name='armor_" + code + "']").val();
    // @ts-ignore
    value["accessoryName"] = $("select[name='accessory_" + code + "']").val();
    // @ts-ignore
    if (value["weaponName"] === "NONE") {
        // @ts-ignore
        value["weaponStar"] = false;
    }
    // @ts-ignore
    if (value["armorName"] === "NONE") {
        // @ts-ignore
        value["armorStar"] = false;
    }
    // @ts-ignore
    if (value["accessoryName"] === "NONE") {
        // @ts-ignore
        value["accessoryStar"] = false;
    }
    StorageUtils_1.default.set(key + "_" + id, JSON.stringify(value));
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem019;


/***/ }),
/* 144 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem020 {
    render(id) {
        doRender(id);
    }
}
const code = "020";
const name = "自定义的套装Ｂ";
const key = "_pa_" + code;
function doRender(id) {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'>★</td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.loadEquipmentSet_B(id);
    if (value["weaponStar"] !== undefined && value["weaponStar"]) {
        $(".checkbox_" + code + "[value='weaponStar']").prop("checked", true);
    }
    if (value["armorStar"] !== undefined && value["armorStar"]) {
        $(".checkbox_" + code + "[value='armorStar']").prop("checked", true);
    }
    if (value["accessoryStar"] !== undefined && value["accessoryStar"]) {
        $(".checkbox_" + code + "[value='accessoryStar']").prop("checked", true);
    }
    $(".weapon_option_" + code + "[value='" + value["weaponName"] + "']").prop("selected", true);
    $(".armor_option_" + code + "[value='" + value["armorName"] + "']").prop("selected", true);
    $(".accessory_option_" + code + "[value='" + value["accessoryName"] + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(id);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='weaponStar'>★";
    const weaponList = $("#weapon_list").text().split(",");
    html += "<select name='weapon_" + code + "'>";
    html += "<option class='weapon_option_" + code + "' value='NONE'>无</option>";
    for (const it of weaponList) {
        html += "<option class='weapon_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='armorStar'>★";
    const armorList = $("#armor_list").text().split(",");
    html += "<select name='armor_" + code + "'>";
    html += "<option class='armor_option_" + code + "' value='NONE'>无</option>";
    for (const it of armorList) {
        html += "<option class='armor_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='accessoryStar'>★";
    const accessoryList = $("#accessory_list").text().split(",");
    html += "<select name='accessory_" + code + "'>";
    html += "<option class='accessory_option_" + code + "' value='NONE'>无</option>";
    for (const it of accessoryList) {
        html += "<option class='accessory_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    return html;
}
function doSaveSetupItem(id) {
    const value = {};
    $("input:checkbox[name='star_" + code + "']:checked").each(function (_idx, checkbox) {
        // @ts-ignore
        value[$(checkbox).val()] = true;
    });
    // @ts-ignore
    value["weaponName"] = $("select[name='weapon_" + code + "']").val();
    // @ts-ignore
    value["armorName"] = $("select[name='armor_" + code + "']").val();
    // @ts-ignore
    value["accessoryName"] = $("select[name='accessory_" + code + "']").val();
    // @ts-ignore
    if (value["weaponName"] === "NONE") {
        // @ts-ignore
        value["weaponStar"] = false;
    }
    // @ts-ignore
    if (value["armorName"] === "NONE") {
        // @ts-ignore
        value["armorStar"] = false;
    }
    // @ts-ignore
    if (value["accessoryName"] === "NONE") {
        // @ts-ignore
        value["accessoryStar"] = false;
    }
    StorageUtils_1.default.set(key + "_" + id, JSON.stringify(value));
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem020;


/***/ }),
/* 145 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem021 {
    render(id) {
        doRender(id);
    }
}
const code = "021";
const name = "自定义的套装Ｃ";
const key = "_pa_" + code;
function doRender(id) {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'>★</td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.loadEquipmentSet_C(id);
    if (value["weaponStar"] !== undefined && value["weaponStar"]) {
        $(".checkbox_" + code + "[value='weaponStar']").prop("checked", true);
    }
    if (value["armorStar"] !== undefined && value["armorStar"]) {
        $(".checkbox_" + code + "[value='armorStar']").prop("checked", true);
    }
    if (value["accessoryStar"] !== undefined && value["accessoryStar"]) {
        $(".checkbox_" + code + "[value='accessoryStar']").prop("checked", true);
    }
    $(".weapon_option_" + code + "[value='" + value["weaponName"] + "']").prop("selected", true);
    $(".armor_option_" + code + "[value='" + value["armorName"] + "']").prop("selected", true);
    $(".accessory_option_" + code + "[value='" + value["accessoryName"] + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(id);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='weaponStar'>★";
    const weaponList = $("#weapon_list").text().split(",");
    html += "<select name='weapon_" + code + "'>";
    html += "<option class='weapon_option_" + code + "' value='NONE'>无</option>";
    for (const it of weaponList) {
        html += "<option class='weapon_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='armorStar'>★";
    const armorList = $("#armor_list").text().split(",");
    html += "<select name='armor_" + code + "'>";
    html += "<option class='armor_option_" + code + "' value='NONE'>无</option>";
    for (const it of armorList) {
        html += "<option class='armor_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='accessoryStar'>★";
    const accessoryList = $("#accessory_list").text().split(",");
    html += "<select name='accessory_" + code + "'>";
    html += "<option class='accessory_option_" + code + "' value='NONE'>无</option>";
    for (const it of accessoryList) {
        html += "<option class='accessory_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    return html;
}
function doSaveSetupItem(id) {
    const value = {};
    $("input:checkbox[name='star_" + code + "']:checked").each(function (_idx, checkbox) {
        // @ts-ignore
        value[$(checkbox).val()] = true;
    });
    // @ts-ignore
    value["weaponName"] = $("select[name='weapon_" + code + "']").val();
    // @ts-ignore
    value["armorName"] = $("select[name='armor_" + code + "']").val();
    // @ts-ignore
    value["accessoryName"] = $("select[name='accessory_" + code + "']").val();
    // @ts-ignore
    if (value["weaponName"] === "NONE") {
        // @ts-ignore
        value["weaponStar"] = false;
    }
    // @ts-ignore
    if (value["armorName"] === "NONE") {
        // @ts-ignore
        value["armorStar"] = false;
    }
    // @ts-ignore
    if (value["accessoryName"] === "NONE") {
        // @ts-ignore
        value["accessoryStar"] = false;
    }
    StorageUtils_1.default.set(key + "_" + id, JSON.stringify(value));
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem021;


/***/ }),
/* 146 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem022 {
    render(id) {
        doRender(id);
    }
}
const code = "022";
const name = "自定义的套装Ｄ";
const key = "_pa_" + code;
function doRender(id) {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'>★</td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.loadEquipmentSet_D(id);
    if (value["weaponStar"] !== undefined && value["weaponStar"]) {
        $(".checkbox_" + code + "[value='weaponStar']").prop("checked", true);
    }
    if (value["armorStar"] !== undefined && value["armorStar"]) {
        $(".checkbox_" + code + "[value='armorStar']").prop("checked", true);
    }
    if (value["accessoryStar"] !== undefined && value["accessoryStar"]) {
        $(".checkbox_" + code + "[value='accessoryStar']").prop("checked", true);
    }
    $(".weapon_option_" + code + "[value='" + value["weaponName"] + "']").prop("selected", true);
    $(".armor_option_" + code + "[value='" + value["armorName"] + "']").prop("selected", true);
    $(".accessory_option_" + code + "[value='" + value["accessoryName"] + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(id);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='weaponStar'>★";
    const weaponList = $("#weapon_list").text().split(",");
    html += "<select name='weapon_" + code + "'>";
    html += "<option class='weapon_option_" + code + "' value='NONE'>无</option>";
    for (const it of weaponList) {
        html += "<option class='weapon_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='armorStar'>★";
    const armorList = $("#armor_list").text().split(",");
    html += "<select name='armor_" + code + "'>";
    html += "<option class='armor_option_" + code + "' value='NONE'>无</option>";
    for (const it of armorList) {
        html += "<option class='armor_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='accessoryStar'>★";
    const accessoryList = $("#accessory_list").text().split(",");
    html += "<select name='accessory_" + code + "'>";
    html += "<option class='accessory_option_" + code + "' value='NONE'>无</option>";
    for (const it of accessoryList) {
        html += "<option class='accessory_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    return html;
}
function doSaveSetupItem(id) {
    const value = {};
    $("input:checkbox[name='star_" + code + "']:checked").each(function (_idx, checkbox) {
        // @ts-ignore
        value[$(checkbox).val()] = true;
    });
    // @ts-ignore
    value["weaponName"] = $("select[name='weapon_" + code + "']").val();
    // @ts-ignore
    value["armorName"] = $("select[name='armor_" + code + "']").val();
    // @ts-ignore
    value["accessoryName"] = $("select[name='accessory_" + code + "']").val();
    // @ts-ignore
    if (value["weaponName"] === "NONE") {
        // @ts-ignore
        value["weaponStar"] = false;
    }
    // @ts-ignore
    if (value["armorName"] === "NONE") {
        // @ts-ignore
        value["armorStar"] = false;
    }
    // @ts-ignore
    if (value["accessoryName"] === "NONE") {
        // @ts-ignore
        value["accessoryStar"] = false;
    }
    StorageUtils_1.default.set(key + "_" + id, JSON.stringify(value));
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem022;


/***/ }),
/* 147 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem023 {
    render(id) {
        doRender(id);
    }
}
const code = "023";
const name = "自定义的套装Ｅ";
const key = "_pa_" + code;
function doRender(id) {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'>★</td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.loadEquipmentSet_E(id);
    if (value["weaponStar"] !== undefined && value["weaponStar"]) {
        $(".checkbox_" + code + "[value='weaponStar']").prop("checked", true);
    }
    if (value["armorStar"] !== undefined && value["armorStar"]) {
        $(".checkbox_" + code + "[value='armorStar']").prop("checked", true);
    }
    if (value["accessoryStar"] !== undefined && value["accessoryStar"]) {
        $(".checkbox_" + code + "[value='accessoryStar']").prop("checked", true);
    }
    $(".weapon_option_" + code + "[value='" + value["weaponName"] + "']").prop("selected", true);
    $(".armor_option_" + code + "[value='" + value["armorName"] + "']").prop("selected", true);
    $(".accessory_option_" + code + "[value='" + value["accessoryName"] + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(id);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='weaponStar'>★";
    const weaponList = $("#weapon_list").text().split(",");
    html += "<select name='weapon_" + code + "'>";
    html += "<option class='weapon_option_" + code + "' value='NONE'>无</option>";
    for (const it of weaponList) {
        html += "<option class='weapon_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='armorStar'>★";
    const armorList = $("#armor_list").text().split(",");
    html += "<select name='armor_" + code + "'>";
    html += "<option class='armor_option_" + code + "' value='NONE'>无</option>";
    for (const it of armorList) {
        html += "<option class='armor_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    html += "<input type='checkbox' name='star_" + code + "' class='checkbox_" + code + "' value='accessoryStar'>★";
    const accessoryList = $("#accessory_list").text().split(",");
    html += "<select name='accessory_" + code + "'>";
    html += "<option class='accessory_option_" + code + "' value='NONE'>无</option>";
    for (const it of accessoryList) {
        html += "<option class='accessory_option_" + code + "' value='" + it + "'>" + it + "</option>";
    }
    html += "</select>";
    return html;
}
function doSaveSetupItem(id) {
    const value = {};
    $("input:checkbox[name='star_" + code + "']:checked").each(function (_idx, checkbox) {
        // @ts-ignore
        value[$(checkbox).val()] = true;
    });
    // @ts-ignore
    value["weaponName"] = $("select[name='weapon_" + code + "']").val();
    // @ts-ignore
    value["armorName"] = $("select[name='armor_" + code + "']").val();
    // @ts-ignore
    value["accessoryName"] = $("select[name='accessory_" + code + "']").val();
    // @ts-ignore
    if (value["weaponName"] === "NONE") {
        // @ts-ignore
        value["weaponStar"] = false;
    }
    // @ts-ignore
    if (value["armorName"] === "NONE") {
        // @ts-ignore
        value["armorStar"] = false;
    }
    // @ts-ignore
    if (value["accessoryName"] === "NONE") {
        // @ts-ignore
        value["accessoryStar"] = false;
    }
    StorageUtils_1.default.set(key + "_" + id, JSON.stringify(value));
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem023;


/***/ }),
/* 148 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem024 {
    render(id) {
        doRender();
    }
}
const code = "024";
const name = "战斗入手的提示";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getBattleHarvestPrompt();
    $(".option_class_" + code + "[value='" + value["person"] + "']").prop("selected", true);
    $("#text_" + code).attr("placeholder", value["text"]);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(value["text"]);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='NONE'>禁用</option>";
    html += "<option class='option_class_" + code + "' value='SELF'>自己</option>";
    html += "<option class='option_class_" + code + "' value='RANDOM'>随机</option>";
    for (const name of NpcLoader_1.default.playerNpcNames()) {
        html += "<option class='option_class_" + code + "' value='" + name + "'>" + name + "</option>";
    }
    html += "</select>";
    html += "<input type='text' id='text_" + code + "' size='60' maxlength='60' placeholder='自定义台词'>";
    return html;
}
function doSaveSetupItem(beforeText) {
    let person = $("#select_" + code).val();
    let text = $("#text_" + code).val();
    if (text === undefined || text === null || text.trim() === "") {
        text = beforeText;
    }
    if (person === "NONE") {
        text = "";
    }
    const value = {};
    // @ts-ignore
    value["person"] = person;
    // @ts-ignore
    value["text"] = text;
    StorageUtils_1.default.set(key, JSON.stringify(value));
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem024;


/***/ }),
/* 149 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem025 {
    render(id) {
        doRender();
    }
}
const code = "025";
const name = "正常战斗的提示";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getNormalBattlePrompt();
    $(".option_class_" + code + "[value='" + value["person"] + "']").prop("selected", true);
    $("#text_" + code).attr("placeholder", value["text"]);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(value["text"]);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='NONE'>禁用</option>";
    html += "<option class='option_class_" + code + "' value='SELF'>自己</option>";
    html += "<option class='option_class_" + code + "' value='RANDOM'>随机</option>";
    for (const name of NpcLoader_1.default.playerNpcNames()) {
        html += "<option class='option_class_" + code + "' value='" + name + "'>" + name + "</option>";
    }
    html += "</select>";
    html += "<input type='text' id='text_" + code + "' size='60' maxlength='60' placeholder='自定义台词'>";
    return html;
}
function doSaveSetupItem(beforeText) {
    let person = $("#select_" + code).val();
    let text = $("#text_" + code).val();
    if (text === undefined || text === null || text.trim() === "") {
        text = beforeText;
    }
    if (person === "NONE") {
        text = "";
    }
    const value = {};
    // @ts-ignore
    value["person"] = person;
    // @ts-ignore
    value["text"] = text;
    StorageUtils_1.default.set(key, JSON.stringify(value));
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem025;


/***/ }),
/* 150 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem026 {
    render(id) {
        doRender();
    }
}
const code = "026";
const name = "经验进度条显示";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isExperienceProgressBarEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem026;


/***/ }),
/* 151 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem027 {
    render(id) {
        doRender();
    }
}
const code = "027";
const name = "入口处快速登陆";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isFastLoginEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem027;


/***/ }),
/* 152 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem028 {
    render(id) {
        doRender();
    }
}
const code = "028";
const name = "隐藏出城和退出";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isHiddenLeaveAndExitEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem028;


/***/ }),
/* 153 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem029 {
    render(id) {
        doRender();
    }
}
const code = "029";
const name = "普通的极速战斗";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr class='hidden_setup_item' style='display:block'>";
    html += "<th style='background-color:red;color:wheat'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isNormalFlashBattleEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem029;


/***/ }),
/* 154 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem030 {
    render(id) {
        doRender();
    }
}
const code = "030";
const name = "关闭收益的入口";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isCollectTownTaxDisabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem030;


/***/ }),
/* 155 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem031 {
    render(id) {
        doRender();
    }
}
const code = "031";
const name = "全新宝石屋界面";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isGemHouseUIEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem031;


/***/ }),
/* 156 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem032 {
    render(id) {
        doRender();
    }
}
const code = "032";
const name = "城堡管家查库存";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isCastleKeeperEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem032;


/***/ }),
/* 157 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem033 {
    render(id) {
        doRender();
    }
}
const code = "033";
const name = "全新的银行界面";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isPocketBankEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem033;


/***/ }),
/* 158 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem034 {
    render(id) {
        doRender();
    }
}
const code = "034";
const name = "战斗页面大按钮";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isBattleLargeButtonEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem034;


/***/ }),
/* 159 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem035 {
    render(id) {
        doRender();
    }
}
const code = "035";
const name = "城市面板快捷钮";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isTownDashboardShortcutButtonEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem035;


/***/ }),
/* 160 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem036 {
    render(id) {
        doRender();
    }
}
const code = "036";
const name = "老年版战斗辅助";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getEnlargeBattleRatio();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='-1'>禁用</option>";
    html += "<option class='option_class_" + code + "' value='1.2'>120%</option>";
    html += "<option class='option_class_" + code + "' value='1.5'>150%</option>";
    html += "<option class='option_class_" + code + "' value='1.8'>180%</option>";
    html += "<option class='option_class_" + code + "' value='2'>200%</option>";
    html += "<option class='option_class_" + code + "' value='2.5'>250%</option>";
    html += "<option class='option_class_" + code + "' value='3'>300%</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem036;


/***/ }),
/* 161 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem037 {
    render(id) {
        doRender(id);
    }
}
const code = "037";
const name = "识别祭奠的状态";
const key = "_pa_" + code;
function doRender(id) {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'>★</td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isConsecrateStateRecognizeEnabled(id);
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem(id);
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem(id) {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key + "_" + id, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem037;


/***/ }),
/* 162 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem038 {
    render(id) {
        doRender();
    }
}
const code = "038";
const name = "装备和宠物排序";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.isEquipmentPetSortEnabled();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "";
    html += "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='1'>启用</option>";
    html += "<option class='option_class_" + code + "' value='0'>禁用</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem038;


/***/ }),
/* 163 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class SetupItem039 {
    render(id) {
        doRender();
    }
}
const code = "039";
const name = "保存图鉴的战数";
const key = "_pa_" + code;
function doRender() {
    let html = "";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>" + name + "</th>";
    html += "<td style='background-color:#E8E8D0'></td>";
    html += "<td style='background-color:#EFE0C0'><input type='button' class='dynamic_button' id='setup_" + code + "' value='设置'></td>";
    html += "<td style='background-color:#E0D0B0;text-align:left'>" + doGenerateSetupItem() + "</td>";
    html += "</tr>";
    $("#setup_item_table").append($(html));
    const value = SetupLoader_1.default.getSavePetMapBattleCount();
    $(".option_class_" + code + "[value='" + Number(value) + "']").prop("selected", true);
    $("#setup_" + code).on("click", function () {
        doSaveSetupItem();
    });
}
function doGenerateSetupItem() {
    let html = "<select id='select_" + code + "'>";
    html += "<option class='option_class_" + code + "' value='-1'>禁用</option>";
    html += "<option class='option_class_" + code + "' value='10'>10战更新</option>";
    html += "<option class='option_class_" + code + "' value='20'>20战更新</option>";
    html += "<option class='option_class_" + code + "' value='50'>50战更新</option>";
    html += "<option class='option_class_" + code + "' value='100'>100战更新</option>";
    html += "</select>";
    return html;
}
function doSaveSetupItem() {
    const value = $("#select_" + code).val();
    StorageUtils_1.default.set(key, value.toString());
    MessageBoard_1.default.publishMessage("<b style='color:red'>" + name + "</b>已经设置。");
    $("#refreshButton").trigger("click");
}
module.exports = SetupItem039;


/***/ }),
/* 164 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const AbstractPersonalSetupPageProcessor_1 = __importDefault(__webpack_require__(122));
const PageUtils_1 = __importDefault(__webpack_require__(21));
class PersonalSetupPageProcessor_Town extends AbstractPersonalSetupPageProcessor_1.default {
    doGenerateHiddenForm(credential, containerId) {
        const html = PageUtils_1.default.generateReturnTownForm(credential);
        $("#" + containerId).html(html);
    }
    doBindReturnButton(returnButtonId) {
        $("#" + returnButtonId).on("click", function () {
            $("#returnTown").trigger("click");
        });
    }
}
module.exports = PersonalSetupPageProcessor_Town;


/***/ }),
/* 165 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _PersonalStatusPageInterceptor_inTownProcessor, _PersonalStatusPageInterceptor_inCastleProcessor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const PersonalStatusPageProcessor_Town_1 = __importDefault(__webpack_require__(166));
const PersonalStatusPageProcessor_Castle_1 = __importDefault(__webpack_require__(168));
class PersonalStatusPageInterceptor {
    constructor() {
        _PersonalStatusPageInterceptor_inTownProcessor.set(this, new PersonalStatusPageProcessor_Town_1.default());
        _PersonalStatusPageInterceptor_inCastleProcessor.set(this, new PersonalStatusPageProcessor_Castle_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "mydata.cgi") {
            return pageText.includes("仙人的宝物");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _PersonalStatusPageInterceptor_inTownProcessor, "f").process();
        })
            .whenInCastle(() => {
            __classPrivateFieldGet(this, _PersonalStatusPageInterceptor_inCastleProcessor, "f").process();
        })
            .fork();
    }
}
_PersonalStatusPageInterceptor_inTownProcessor = new WeakMap(), _PersonalStatusPageInterceptor_inCastleProcessor = new WeakMap();
module.exports = PersonalStatusPageInterceptor;


/***/ }),
/* 166 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const PageUtils_1 = __importDefault(__webpack_require__(21));
const AbstractPersonalStatusPageProcessor_1 = __importDefault(__webpack_require__(167));
class PersonalStatusPageProcessor_Town extends AbstractPersonalStatusPageProcessor_1.default {
    constructor() {
        super();
    }
    doBindReturnButton() {
        $("#returnButton").on("click", () => {
            $("#returnTown").trigger("click");
        });
    }
    doGenerateHiddenForm(credential, containerId) {
        const html = PageUtils_1.default.generateReturnTownForm(credential);
        $("#" + containerId).html(html);
        $("#returnTown").attr("tabIndex", 1);
    }
    doGenerateReturnButton(role, containerId) {
        let title = "返回";
        if (role.town !== undefined) {
            title = title + role.town.name;
        }
        const html = "<input type='button' id='returnButton' value='" + title + "'>";
        $("#" + containerId).html(html);
    }
}
module.exports = PersonalStatusPageProcessor_Town;


/***/ }),
/* 167 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _AbstractPersonalStatusPageProcessor_instances, _AbstractPersonalStatusPageProcessor_renderPage;
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class AbstractPersonalStatusPageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super();
        _AbstractPersonalStatusPageProcessor_instances.add(this);
    }
    doProcess(credential, context) {
        const page = PersonalStatus_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        __classPrivateFieldGet(this, _AbstractPersonalStatusPageProcessor_instances, "m", _AbstractPersonalStatusPageProcessor_renderPage).call(this, page.role);
        // 页面渲染完成，现在可以添加内容
        let html = "";
        html += "<tr style='display:none'>";
        html += "<td id='hiddenFormContainer'></td>";
        html += "</tr>";
        $("#t0")
            .find("tr:first")
            .before($(html));
        this.doGenerateHiddenForm(credential, "hiddenFormContainer");
        // 删除旧的表单并且新建全新的智能返回按钮
        $("form:last").remove();
        $("p:last").attr("id", "returnButtonContainer");
        this.doGenerateReturnButton(page.role, "returnButtonContainer");
        this.doBindReturnButton();
    }
}
_AbstractPersonalStatusPageProcessor_instances = new WeakSet(), _AbstractPersonalStatusPageProcessor_renderPage = function _AbstractPersonalStatusPageProcessor_renderPage(role) {
    // 调整表格的宽度
    $("table:first")
        .attr("id", "t0")
        .css("width", "100%");
    // Render experience
    if (SetupLoader_1.default.isExperienceProgressBarEnabled()) {
        const t1 = $("table:eq(1)");
        let tr = $(t1).find("tr:eq(16)");
        let td = $(tr).find("td:eq(2)");
        if (role.level === 150) {
            $(td).attr("style", "color: blue").text("MAX");
        }
        else {
            const ratio = role.level / 150;
            const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
            const exp = $(td).text() + " EX";
            $(td).html("<span title='" + exp + "'>" + progressBar + "</span>");
        }
        $("th:contains('分身类别')")
            .filter(function () {
            return $(this).text() === "分身类别";
        })
            .closest("table")
            .find("tr")
            .each(function (_idx, tr) {
            if (_idx > 0) {
                const td = $(tr).find("td:last");
                const exp = parseInt($(td).text());
                const level = Math.floor(exp / 100) + 1;
                if (level === 150) {
                    $(td).attr("style", "color: blue").text("MAX");
                }
                else {
                    const ratio = level / 150;
                    const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
                    $(td).html("<span title='" + (exp + " EX") + "'>" + progressBar + "</span>");
                }
            }
        });
        $("td:contains('宠物名 ：')")
            .filter(function () {
            return $(this).text().startsWith("宠物名 ：");
        })
            .closest("table")
            .each(function (_idx, table) {
            let s = $(table).find("tr:eq(1) td:first").text();
            const level = parseInt(StringUtils_1.default.substringAfter(s, "Ｌｖ"));
            const td = $(table).find("tr:last td:eq(1)");
            if (level === 100) {
                $(td).attr("style", "color: blue").text("MAX");
            }
            else {
                s = $(td).text();
                const a = parseInt(StringUtils_1.default.substringBeforeSlash(s));
                const b = parseInt(StringUtils_1.default.substringAfterSlash(s));
                const ratio = a / b;
                const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
                $(td).html("<span title='" + s + "'>" + progressBar + "</span>");
            }
        });
    }
    // Render honor
    let td = $("table:eq(1) tr:eq(24) td:first");
    let html = $(td).html();
    html = html.replace(/<br>/g, '');
    $(td).attr("style", "word-break:break-all");
    $(td).html(html);
};
module.exports = AbstractPersonalStatusPageProcessor;


/***/ }),
/* 168 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const PageUtils_1 = __importDefault(__webpack_require__(21));
const AbstractPersonalStatusPageProcessor_1 = __importDefault(__webpack_require__(167));
class PersonalStatusPageProcessor_Castle extends AbstractPersonalStatusPageProcessor_1.default {
    constructor() {
        super();
    }
    doBindReturnButton() {
        $("#returnButton").on("click", () => {
            $("#returnCastle").trigger("click");
        });
    }
    doGenerateHiddenForm(credential, containerId) {
        const html = PageUtils_1.default.generateReturnCastleForm(credential);
        $("#" + containerId).html(html);
        $("#returnCastle").attr("tabIndex", 1);
    }
    doGenerateReturnButton(role, containerId) {
        let title = "返回";
        if (role.castle !== undefined) {
            title = title + role.castle.name;
        }
        const html = "<input type='button' id='returnButton' value='" + title + "'>";
        $("#" + containerId).html(html);
    }
}
module.exports = PersonalStatusPageProcessor_Castle;


/***/ }),
/* 169 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownAccessoryHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownAccessoryHousePageProcessor_1 = __importDefault(__webpack_require__(170));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class TownAccessoryHousePageInterceptor {
    constructor() {
        _TownAccessoryHousePageInterceptor_processor.set(this, new TownAccessoryHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("＜＜　□　饰品屋　□　＞＞");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isPocketSuperMarketEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _TownAccessoryHousePageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_TownAccessoryHousePageInterceptor_processor = new WeakMap();
module.exports = TownAccessoryHousePageInterceptor;


/***/ }),
/* 170 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownAccessoryHousePageProcessor_instances, _TownAccessoryHousePageProcessor_renderImmutablePage, _TownAccessoryHousePageProcessor_bindImmutableButtons, _TownAccessoryHousePageProcessor_renderMutablePage, _TownAccessoryHousePageProcessor_bindMutableButtons, _TownAccessoryHousePageProcessor_refreshMutablePage;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const TownAccessoryHouse_1 = __importDefault(__webpack_require__(171));
const TownBank_1 = __importDefault(__webpack_require__(51));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownAccessoryHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _TownAccessoryHousePageProcessor_instances.add(this);
    }
    doLoadButtonStyles() {
        return [35, 89];
    }
    doProcess(credential, context) {
        const page = TownAccessoryHouse_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        __classPrivateFieldGet(this, _TownAccessoryHousePageProcessor_instances, "m", _TownAccessoryHousePageProcessor_renderImmutablePage).call(this, credential, page);
        __classPrivateFieldGet(this, _TownAccessoryHousePageProcessor_instances, "m", _TownAccessoryHousePageProcessor_renderMutablePage).call(this, credential, page);
    }
}
_TownAccessoryHousePageProcessor_instances = new WeakSet(), _TownAccessoryHousePageProcessor_renderImmutablePage = function _TownAccessoryHousePageProcessor_renderImmutablePage(credential, page) {
    $("table:eq(1)")
        .attr("id", "t1")
        .find("td:first")
        .attr("id", "pageTitle")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("bgcolor")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  " + page.town.nameTitle + " 饰 品 屋  ＞＞")
        .parent()
        .next()
        .find("table:first")
        .find("td:eq(1)")
        .find("table:first")
        .find("td:last")
        .attr("id", "roleCash");
    $("form").remove();
    $("#t1")
        .find("tr:first")
        .next()
        .next()
        .find("table:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .css("color", "white")
        .next()
        .attr("id", "messageBoardManager");
    $("#t1")
        .find("tr:first")
        .next()
        .next()
        .next()
        .html("<td id='storeUI' style='width:100%;background-color:#F8F0E0'></td>");
    let html = "";
    html += "<table style='width:100%;border-width:0;background-color:#888888;margin:auto'>";
    html += "<tbody>";
    // ------------------------------------------------------------------------
    // 隐藏的表单
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='hidden_form_cell'>";
    html += PageUtils_1.default.generateReturnTownForm(credential);
    // noinspection HtmlUnknownTarget
    html += "<form action='mydata.cgi' method='post'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='town' value='" + page.town.id + "'>";
    html += "<input type='hidden' name='mode' value='USE_ITEM'>";
    html += "<input type='submit' id='equipmentManagement'>";
    html += "</form>";
    html += "</td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 主菜单
    // ------------------------------------------------------------------------
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' id='refreshButton' value='刷新" + page.town.name + "饰品屋' class='button-35'>&nbsp;";
    html += "<input type='button' id='returnButton' value='离开" + page.town.name + "饰品屋' class='button-35'>&nbsp;";
    html += "<input type='button' id='equipmentButton' value='转到装备管理' class='button-35'>";
    html += "</td>";
    // ------------------------------------------------------------------------
    // 个人物品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='equipmentList' style='text-align:center'></td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 饰品屋商品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='merchandiseList' style='text-align:center'></td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#storeUI").html(html);
    __classPrivateFieldGet(this, _TownAccessoryHousePageProcessor_instances, "m", _TownAccessoryHousePageProcessor_bindImmutableButtons).call(this, credential, page.town.id);
}, _TownAccessoryHousePageProcessor_bindImmutableButtons = function _TownAccessoryHousePageProcessor_bindImmutableButtons(credential, townId) {
    $("#refreshButton").on("click", () => {
        $("#messageBoardManager").html(NpcLoader_1.default.randomNpcImageHtml());
        MessageBoard_1.default.resetMessageBoard("欢迎、欢迎。");
        __classPrivateFieldGet(this, _TownAccessoryHousePageProcessor_instances, "m", _TownAccessoryHousePageProcessor_refreshMutablePage).call(this, credential, townId);
    });
    $("#returnButton").on("click", () => {
        $("#returnTown").trigger("click");
    });
    $("#equipmentButton").on("click", () => {
        $("#equipmentManagement").trigger("click");
    });
}, _TownAccessoryHousePageProcessor_renderMutablePage = function _TownAccessoryHousePageProcessor_renderMutablePage(credential, page) {
    // ------------------------------------------------------------------------
    // 渲染随身装备
    // ------------------------------------------------------------------------
    const equipmentList = page.equipmentList;
    if (equipmentList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkred;color:wheat;font-weight:bold' colspan='12'>";
        html += "＜ 随 身 装 备 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>出售</th>";
        html += "<th style='background-color:#EFE0C0'>装备</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>价值</th>";
        html += "</tr>";
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (equipment.isSellable) {
                html += "<input type='button' value='出售' " +
                    "id='sell_" + equipment.index + "' class='mutableButton button-89'>";
            }
            else {
                html += PageUtils_1.default.generateInvisibleButton("#E8E8D0");
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.usingHTML + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0;text-align:right'>" + equipment.priceHTML + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#equipmentList")
            .html(html)
            .parent()
            .show();
    }
    // ------------------------------------------------------------------------
    // 渲染饰品店商品
    // ------------------------------------------------------------------------
    const merchandiseList = page.merchandiseList;
    if (merchandiseList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold' colspan='15'>";
        html += "＜ 商 品 列 表 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>数量</th>";
        html += "<th style='background-color:#E8E8D0'>购买</th>";
        html += "<th style='background-color:#EFE0C0'>特产</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>价格</th>";
        html += "<th style='background-color:#E0D0B0'>威力</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>职业</th>";
        html += "<th style='background-color:#E0D0B0'>攻击</th>";
        html += "<th style='background-color:#E0D0B0'>防御</th>";
        html += "<th style='background-color:#E0D0B0'>智力</th>";
        html += "<th style='background-color:#E0D0B0'>精神</th>";
        html += "<th style='background-color:#E0D0B0'>速度</th>";
        html += "<th style='background-color:#E0D0B0'>宝石</th>";
        html += "</tr>";
        for (const merchandise of merchandiseList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            const spaceCount = 19 - page.equipmentList.length;
            if (spaceCount > 0) {
                html += "<select id='count_" + merchandise.index + "'>";
                for (let i = 1; i <= spaceCount; i++) {
                    html += "<option value='" + i + "'>" + i + "</option>";
                }
                html += "</select>";
            }
            html += "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (spaceCount > 0) {
                html += "<input type='button' value='购买' " +
                    "id='buy_" + merchandise.index + "' class='dynamic_button_class button-89'>";
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.specialityHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.nameHtml + "</td>";
            html += "<td style='background-color:#EFE0C0;text-align:right'>" + merchandise.priceHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredCareerHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpecialAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpecialDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpeedHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.gemCountHtml + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#merchandiseList")
            .html(html)
            .parent()
            .show();
    }
    __classPrivateFieldGet(this, _TownAccessoryHousePageProcessor_instances, "m", _TownAccessoryHousePageProcessor_bindMutableButtons).call(this, credential, page);
}, _TownAccessoryHousePageProcessor_bindMutableButtons = function _TownAccessoryHousePageProcessor_bindMutableButtons(credential, page) {
    $("input:button[value='出售']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(buttonId.split("_")[1]);
        const equipment = page.findEquipment(index);
        if (!confirm("确认要出售“" + equipment.fullName + "”？")) {
            return;
        }
        new TownAccessoryHouse_1.default(credential, page.townId)
            .sell(index, page.discount)
            .then(() => {
            new TownBank_1.default(credential, page.townId).deposit().then(() => {
                __classPrivateFieldGet(this, _TownAccessoryHousePageProcessor_instances, "m", _TownAccessoryHousePageProcessor_refreshMutablePage).call(this, credential, page.townId);
            });
        });
    });
    $("input:button[value='购买']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(buttonId.split("_")[1]);
        const count = parseInt($("#count_" + index).val());
        const merchandise = page.findMerchandise(index);
        const totalPrice = merchandise.price * count;
        const amount = BankUtils_1.default.calculateCashDifferenceAmount(page.role.cash, totalPrice);
        if (!confirm("确认要购买" + count + "件“" + merchandise.name + "”？大约需要再支取" + amount + "万GOLD。")) {
            return;
        }
        const bank = new TownBank_1.default(credential, page.townId);
        bank.withdraw(amount)
            .then(() => {
            new TownAccessoryHouse_1.default(credential, page.townId)
                .buy(index, count, page.discount)
                .then(() => {
                bank.deposit()
                    .then(() => {
                    __classPrivateFieldGet(this, _TownAccessoryHousePageProcessor_instances, "m", _TownAccessoryHousePageProcessor_refreshMutablePage).call(this, credential, page.townId);
                });
            });
        });
    });
}, _TownAccessoryHousePageProcessor_refreshMutablePage = function _TownAccessoryHousePageProcessor_refreshMutablePage(credential, townId) {
    PageUtils_1.default.scrollIntoView("pageTitle");
    $("#equipmentList").parent().hide();
    $("#merchandiseList").parent().hide();
    $(".mutableButton").off("click");
    new TownAccessoryHouse_1.default(credential, townId).open().then(page => {
        $("#roleCash").text(page.role.cash + " GOLD");
        __classPrivateFieldGet(this, _TownAccessoryHousePageProcessor_instances, "m", _TownAccessoryHousePageProcessor_renderMutablePage).call(this, credential, page);
    });
};
module.exports = TownAccessoryHousePageProcessor;


/***/ }),
/* 171 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownAccessoryHouse_credential, _TownAccessoryHouse_townId;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Merchandise_1 = __importDefault(__webpack_require__(172));
const Role_1 = __importDefault(__webpack_require__(14));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownAccessoryHousePage_1 = __importDefault(__webpack_require__(173));
class TownAccessoryHouse {
    constructor(credential, townId) {
        _TownAccessoryHouse_credential.set(this, void 0);
        _TownAccessoryHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownAccessoryHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownAccessoryHouse_townId, townId, "f");
    }
    static parsePage(pageHtml) {
        return __parsePage(pageHtml);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownAccessoryHouse_credential, "f").asRequestMap();
                    request.set("town", __classPrivateFieldGet(this, _TownAccessoryHouse_townId, "f"));
                    request.set("con_str", "50");
                    request.set("mode", "ACC_SHOP");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const page = TownAccessoryHouse.parsePage(html);
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    sell(equipmentIndex, discount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownAccessoryHouse_credential, "f").asRequestMap();
                    request.set("select", equipmentIndex.toString());
                    request.set("val_off", discount.toString());
                    request.set("mode", "SELL");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
    buy(merchandiseIndex, count, discount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    const request = __classPrivateFieldGet(this, _TownAccessoryHouse_credential, "f").asRequestMap();
                    request.set("select", merchandiseIndex.toString());
                    request.set("townid", __classPrivateFieldGet(this, _TownAccessoryHouse_townId, "f"));
                    request.set("val_off", discount.toString());
                    request.set("mark", "2");
                    request.set("mode", "BUY");
                    request.set("num", count.toString());
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        if (html.includes("所持金不足")) {
                            reject();
                        }
                        else {
                            resolve();
                        }
                    });
                });
            };
            return yield action();
        });
    }
}
_TownAccessoryHouse_credential = new WeakMap(), _TownAccessoryHouse_townId = new WeakMap();
function __parsePage(pageHtml) {
    const townId = $(pageHtml).find("input:hidden[name='townid']:first").val();
    let discount = 1;
    const input = $(pageHtml).find("input:hidden[name='val_off']:first");
    if (input.length > 0) {
        discount = parseFloat(input.val());
    }
    const role = new Role_1.default();
    $(pageHtml).find("td:contains('姓名')")
        .filter((idx, td) => $(td).text() === "姓名")
        .closest("table")
        .find("tr:first")
        .next()
        .find("td:first")
        .each((idx, td) => {
        role.name = $(td).text();
    })
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        role.level = parseInt(s);
    })
        .next()
        .each((idx, td) => {
        role.attribute = $(td).text();
    })
        .next()
        .each((idx, td) => {
        role.career = $(td).text();
    })
        .parent()
        .next()
        .find("td:first")
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        s = StringUtils_1.default.substringBefore(s, " GOLD");
        role.cash = parseInt(s);
    });
    const page = new TownAccessoryHousePage_1.default();
    page.townId = townId;
    page.discount = discount;
    page.role = role;
    page.equipmentList = __parseEquipmentList(pageHtml);
    page.merchandiseList = __parseMerchandiseList(pageHtml);
    return page;
}
function __parseEquipmentList(pageHtml) {
    const equipmentList = [];
    $(pageHtml)
        .find("input:submit[value='物品卖出']")
        .closest("table")
        .find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const c2 = c1.next();
        const c3 = c2.next();
        const c4 = c3.next();
        const c5 = c4.next();
        const c6 = c5.next();
        const c7 = c6.next();
        const equipment = new Equipment_1.default();
        equipment.index = parseInt($(radio).val());
        equipment.selectable = !$(radio).prop("disabled");
        equipment.using = c1.text() === "★";
        equipment.parseName(c2.html());
        equipment.category = c3.text();
        equipment.power = parseInt(c4.text());
        equipment.weight = parseInt(c5.text());
        equipment.parseEndure(c6.text());
        equipment.parsePrice(c7.html());
        equipmentList.push(equipment);
    });
    return equipmentList;
}
function __parseMerchandiseList(pageHtml) {
    const merchandiseList = [];
    const table = $(pageHtml).find("input:radio:last")
        .closest("table");
    let specialityMatch = false;
    table.find("tr").each(function (_idx, tr) {
        const c1 = $(tr).find(":first-child");
        const radio = c1.find("input:radio:first");
        if (radio.length > 0) {
            const merchandise = new Merchandise_1.default();
            merchandise.id = "ACC_" + $(radio).val();
            merchandise.category = "饰品";
            const c2 = c1.next();
            const c3 = c2.next();
            const c4 = c3.next();
            const c5 = c4.next();
            const c6 = c5.next();
            const c7 = c6.next();
            const c8 = c7.next();
            const c9 = c8.next();
            const c10 = c9.next();
            const c11 = c10.next();
            const c12 = c11.next();
            const c13 = c12.next();
            const c14 = c13.next();
            merchandise.name = c2.text();
            merchandise.nameHtml = c2.html();
            let s = c3.text();
            s = StringUtils_1.default.substringBefore(s, " Gold");
            merchandise.price = parseInt(s);
            merchandise.power = parseInt(c4.text());
            merchandise.weight = parseInt(c5.text());
            merchandise.endure = parseInt(c6.text());
            merchandise.attribute = c7.text();
            merchandise.requiredCareer = c8.text();
            merchandise.requiredAttack = parseInt(c9.text());
            merchandise.requiredDefense = parseInt(c10.text());
            merchandise.requiredSpecialAttack = parseInt(c11.text());
            merchandise.requiredSpecialDefense = parseInt(c12.text());
            merchandise.requiredSpeed = parseInt(c13.text());
            merchandise.gemCount = parseInt(c14.text());
            merchandise.speciality = specialityMatch;
            merchandiseList.push(merchandise);
        }
        else if (c1.text() === "== 特产饰品 ==") {
            specialityMatch = true;
        }
    });
    return merchandiseList;
}
module.exports = TownAccessoryHouse;


/***/ }),
/* 172 */
/***/ ((module) => {


/**
 * 商店售卖商品的数据结构描述
 */
class Merchandise {
    get index() {
        return parseInt(this.id.split("_")[1]);
    }
    get categoryHtml() {
        if (this.category === "武器") {
            return "<span style='color:blue'>" + this.category + "</span>";
        }
        else if (this.category === "防具") {
            return "<span style='color:red'>" + this.category + "</span>";
        }
        else if (this.category === "饰品") {
            return "<span style='color:green'>" + this.category + "</span>";
        }
        else {
            return this.category;
        }
    }
    get priceHtml() {
        if (this.price === undefined) {
            return "-";
        }
        if (this.price >= 10000000) {
            return "<span style='color:gold;background-color:darkblue'>" + this.price + "</span> GOLD";
        }
        else {
            return this.price + " GOLD";
        }
    }
    get endureHtml() {
        if (this.endure === undefined || this.endure === 1) {
            return "-";
        }
        else {
            return this.endure.toString();
        }
    }
    get requiredCareerHtml() {
        if (this.requiredCareer === undefined || this.requiredCareer === "所有职业") {
            return "-";
        }
        else {
            return this.requiredCareer;
        }
    }
    get requiredAttackHtml() {
        if (this.requiredAttack === undefined || this.requiredAttack === 0) {
            return "-";
        }
        else {
            if (this.requiredAttack >= 375) {
                return "<span title='倚天' style='color:red'>" + this.requiredAttack + "</span>";
            }
            else {
                return this.requiredAttack.toString();
            }
        }
    }
    get requiredDefenseHtml() {
        if (this.requiredDefense === undefined || this.requiredDefense === 0) {
            return "-";
        }
        else {
            if (this.requiredDefense >= 375) {
                return "<span title='磐石' style='color:red'>" + this.requiredDefense + "</span>";
            }
            else {
                return this.requiredDefense.toString();
            }
        }
    }
    get requiredSpecialAttackHtml() {
        if (this.requiredSpecialAttack === undefined || this.requiredSpecialAttack === 0) {
            return "-";
        }
        else {
            if (this.requiredSpecialAttack >= 375) {
                return "<span title='仙人' style='color:red'>" + this.requiredSpecialAttack + "</span>";
            }
            else {
                return this.requiredSpecialAttack.toString();
            }
        }
    }
    get requiredSpecialDefenseHtml() {
        if (this.requiredSpecialDefense === undefined || this.requiredSpecialDefense === 0) {
            return "-";
        }
        else {
            if (this.requiredSpecialDefense >= 375) {
                return "<span title='军神' style='color:red'>" + this.requiredSpecialDefense + "</span>";
            }
            else {
                return this.requiredSpecialDefense.toString();
            }
        }
    }
    get requiredSpeedHtml() {
        if (this.requiredSpecialDefense === undefined || this.requiredSpeed === 0) {
            return "-";
        }
        else {
            if (this.requiredSpecialDefense >= 375) {
                return "<span title='疾风' style='color:red'>" + this.requiredSpecialDefense + "</span>";
            }
            else {
                return this.requiredSpecialDefense.toString();
            }
        }
    }
    get gemCountHtml() {
        if (this.gemCount === undefined || this.gemCount === 0) {
            return "-";
        }
        else {
            return this.gemCount.toString();
        }
    }
    get specialityHtml() {
        if (this.speciality === undefined || !this.speciality) {
            return "";
        }
        else {
            return "★";
        }
    }
}
module.exports = Merchandise;


/***/ }),
/* 173 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
class TownAccessoryHousePage {
    get town() {
        return TownLoader_1.default.getTownById(this.townId);
    }
    findEquipment(index) {
        for (const equipment of this.equipmentList) {
            if (equipment.index === index) {
                return equipment;
            }
        }
        return null;
    }
    findMerchandise(index) {
        for (const merchandise of this.merchandiseList) {
            if (merchandise.index === index) {
                return merchandise;
            }
        }
        return null;
    }
}
module.exports = TownAccessoryHousePage;


/***/ }),
/* 174 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownAdventureGuildPageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownAdventureGuildPageProcessor_1 = __importDefault(__webpack_require__(175));
class TownAdventureGuildPageInterceptor {
    constructor() {
        _TownAdventureGuildPageInterceptor_processor.set(this, new TownAdventureGuildPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("*  藏宝图以旧换新业务 *");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _TownAdventureGuildPageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_TownAdventureGuildPageInterceptor_processor = new WeakMap();
module.exports = TownAdventureGuildPageInterceptor;


/***/ }),
/* 175 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TravelPlan_1 = __importDefault(__webpack_require__(40));
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const MapBuilder_1 = __importDefault(__webpack_require__(41));
const MapExplorer_1 = __importDefault(__webpack_require__(176));
const TownEntrance_1 = __importDefault(__webpack_require__(45));
const TravelPlanExecutor_1 = __importDefault(__webpack_require__(47));
const TreasureHintParser_1 = __importDefault(__webpack_require__(177));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const TownBank_1 = __importDefault(__webpack_require__(51));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownAdventureGuildPageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super();
    }
    doProcess(credential, context) {
        const pageHtml = document.documentElement.outerHTML;
        const treasureHintList = TreasureHintParser_1.default.parseTreasureHintList(pageHtml);
        doProcess(credential, treasureHintList);
    }
}
function doProcess(credential, treasureHintList) {
    const t1 = $("table:eq(1)");
    const t3 = $("table:eq(3)");
    const t4 = $("table:eq(4)");
    $(t1).find("td:first")
        .removeAttr("bgcolor")
        .removeAttr("width")
        .removeAttr("height")
        .css("width", "100%")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .attr("id", "title")
        .text("＜＜  冒 险 家 公 会  ＞＞");
    $(t3).find("tr:last td:eq(1)")
        .attr("id", "roleCash")
        .text("-");
    $(t3).find("tr:last")
        .after($("" +
        "<tr>" +
        "<td style='background-color:#E0D0B0'>坐标点</td>" +
        "<td id='roleLocation' style='background-color:#E8E8D0;color:red;font-weight:bold;text-align:right' colspan='3'>-</td>" +
        "</tr>" +
        "<tr>" +
        "<td style='background-color:#E0D0B0'>计时器</td>" +
        "<td id='countDownTimer' style='background-color:#E8E8D0;color:red;font-weight:bold;text-align:right' colspan='3'>-</td>" +
        "</tr>"));
    $(t4).find("td:first")
        .removeAttr("width")
        .removeAttr("bgcolor")
        .css("width", "100%")
        .css("background-color", "black")
        .css("color", "white")
        .attr("id", "messageBoard")
        .next()
        .html(NpcLoader_1.default.getNpcImageHtml("花子"));
    MessageBoard_1.default.resetMessageBoard("S、S、SHIT，隔壁驿站推出了新的业务，抢、抢走了我的生意，幸亏挖宝的还得来我这儿！");
    $("form:first").parent()
        .attr("id", "menu")
        .parent()
        .after($("" +
        "<tr style='display:none'>" +
        "<td id='eden' style='width:100%'></td>" +
        "</tr>" +
        "<tr style='display:none'>" +
        "<td id='treasureHint' style='width:100%;background-color:#E8E8D0;text-align:center'></td>" +
        "</tr>"));
    // 清空之前的藏宝图交换的表单
    $("#menu").html("");
    doRenderEden(credential);
    doRenderMenu();
    doRenderTreasureHint(credential, treasureHintList);
}
function doRenderEden(credential) {
    let html = "";
    // noinspection HtmlUnknownTarget
    html += "<form action='status.cgi' method='post' id='returnForm'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='mode' value='STATUS'>";
    html += "<input type='submit' id='returnSubmit'>";
    html += "</form>";
    $("#eden").html(html);
}
function doRenderMenu() {
    let html = "";
    html += "<input type='button' value='重置消息面板' id='resetButton'>";
    html += "<input type='button' value='离开冒险家公会' id='returnButton'>";
    $("#menu").html(html);
    $("#resetButton").on("click", function () {
        MessageBoard_1.default.resetMessageBoard("");
    });
    $("#returnButton").on("click", function () {
        $("#returnSubmit").trigger("click");
    });
}
function doRenderTreasureHint(credential, treasureHintList) {
    var _a, _b;
    if (treasureHintList.length === 0) {
        return;
    }
    let html = "";
    html += "<table style='border-width:0;text-align:center'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<td style='width:100%'>";
    html += "<table style='background-color:#888888;margin:auto;border-width:0;text-align:center'>";
    html += "<tbody style='background-color:#F8F0E0'>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>选择</th>";
    html += "<th style='background-color:#F8F0E0'>物品</th>";
    html += "<th style='background-color:#EFE0C0'>X坐标</th>";
    html += "<th style='background-color:#E0D0B0'>Y坐标</th>";
    html += "<th style='background-color:#EFE0C0'>备注</th>";
    html += "</tr>";
    let rowIndex = 0;
    for (const treasureHint of treasureHintList) {
        html += "<tr class='treasure_hint_class' id='row_" + (rowIndex++) + "'>";
        html += "<td style='background-color:#E8E8D0'><input type='checkbox' name='item" + treasureHint.index + "' value='" + treasureHint.index + "'></td>";
        html += "<td style='background-color:#F8F0E0'>" + treasureHint.name + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + ((_a = treasureHint.coordinate) === null || _a === void 0 ? void 0 : _a.x) + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + ((_b = treasureHint.coordinate) === null || _b === void 0 ? void 0 : _b.y) + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + treasureHint.commentHtml + "</td>";
        html += "</tr>";
    }
    html += "<tr>";
    html += "<td colspan='5'>";
    html += "<input type='button' value='更换藏宝图' id='exchangeButton'>";
    html += "<input type='button' value='藏宝图探险' id='treasureButton'>";
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    html += "</td>";
    html += "<td>";
    html += MapBuilder_1.default.buildMapTable();
    html += "</td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#treasureHint")
        .html(html)
        .parent()
        .show();
    MapBuilder_1.default.updateTownBackgroundColor();
    $(".treasure_hint_class")
        .on("mouseenter", function () {
        const x = parseInt($(this).find("td:eq(2)").text());
        const y = parseInt($(this).find("td:eq(3)").text());
        const mapId = "location_" + x + "_" + y;
        $("#" + mapId).css("background-color", "blue");
    })
        .on("mouseleave", function () {
        const x = parseInt($(this).find("td:eq(2)").text());
        const y = parseInt($(this).find("td:eq(3)").text());
        const mapId = "location_" + x + "_" + y;
        const s = $("#" + mapId).parent().attr("class");
        const c = StringUtils_1.default.substringAfter(s, "_");
        if (c !== "none") {
            $("#" + mapId).css("background-color", c);
        }
        else {
            $("#" + mapId).removeAttr("style");
        }
    });
    doBindExchangeButton(credential);
    doBindTreasureButton(credential);
}
function doBindExchangeButton(credential) {
    $("#exchangeButton").on("click", function () {
        const request = credential.asRequest();
        let checkedCount = 0;
        $("input:checkbox:checked").each(function (_idx, checkbox) {
            const name = $(checkbox).attr("name");
            const value = $(checkbox).val();
            checkedCount++;
            // @ts-ignore
            request[name] = value;
        });
        if (checkedCount === 0) {
            MessageBoard_1.default.publishWarning("没有选择藏宝图！");
            return;
        }
        // @ts-ignore
        request["mode"] = "CHANGEMAP2";
        const bank = new TownBank_1.default(credential);
        bank.withdraw(10).then(() => {
            NetworkUtils_1.default.sendPostRequest("town.cgi", request, function () {
                MessageBoard_1.default.publishMessage("交换藏宝图成功。");
                bank.deposit().then(() => {
                    doRefresh(credential);
                });
            });
        });
    });
}
function doBindTreasureButton(credential) {
    $("#treasureButton").on("click", function () {
        var _a;
        const candidates = [];
        $("input:checkbox:checked").each(function (_idx, checkbox) {
            const c0 = $(checkbox).parent();
            const c1 = $(c0).next();
            const c2 = $(c1).next();
            const c3 = $(c2).next();
            const c4 = $(c3).next();
            if ($(c4).text() === "-") {
                const x = parseInt($(c2).text());
                const y = parseInt($(c3).text());
                candidates.push(new Coordinate_1.default(x, y));
            }
        });
        if (candidates.length === 0) {
            MessageBoard_1.default.publishWarning("没有选择有效的藏宝图！");
            return;
        }
        // 开始进入探险模式
        (_a = document.getElementById("title")) === null || _a === void 0 ? void 0 : _a.scrollIntoView();
        MessageBoard_1.default.resetMessageBoard("藏宝图探险动态实时播报：<br>");
        $("#resetButton").prop("disabled", true).hide();
        $("#returnButton").prop("disabled", true).val("藏宝图探险中......");
        $("input:checkbox").prop("disabled", true);
        $(".location_button_class").prop("disabled", true);
        $(".treasure_hint_class")
            .off("mouseenter")
            .off("mouseleave");
        // 页面渲染完毕，开始探险
        new TownBank_1.default(credential).withdraw(110).then(() => {
            new PersonalStatus_1.default(credential).load().then(role => {
                const town = role.town;
                doStartTreasureSeeking(credential, candidates, town);
            });
        });
    });
}
function doStartTreasureSeeking(credential, candidates, town) {
    for (const it of candidates) {
        const mapId = "location_" + it.x + "_" + it.y;
        $("#" + mapId)
            .css("background-color", "blue")
            .css("color", "yellow")
            .attr("value", "宝")
            .parent()
            .attr("class", "color_blue");
    }
    candidates.sort((a, b) => {
        let ret = a.x - b.x;
        if (ret === 0) {
            ret = a.y - b.y;
        }
        return ret;
    });
    MessageBoard_1.default.publishMessage("藏宝图整理完毕。");
    // 这个是要探索的完整路线，从本城开始，回到本城。
    const locationList = [];
    locationList.push(town.coordinate);
    locationList.push(...candidates);
    locationList.push(town.coordinate);
    if (locationList.length !== 0) {
        let msg = "探险顺序：";
        for (let i = 0; i < locationList.length; i++) {
            const it = locationList[i];
            msg += it.asText();
            if (i !== locationList.length - 1) {
                msg += "=>";
            }
        }
        MessageBoard_1.default.publishMessage(msg);
    }
    const foundList = [];
    new TownEntrance_1.default(credential).leave()
        .then(plan => {
        doSeekTreasure(credential, town, plan.scope, plan.mode, locationList, 0, foundList);
    });
}
function doSeekTreasure(credential, town, scope, mode, locationList, locationIndex, foundList) {
    const from = locationList[locationIndex];
    const to = locationList[locationIndex + 1];
    if (locationIndex !== locationList.length - 2) {
        if (from.x === to.x && from.y === to.y) {
            // 下一张图在原地
            MessageBoard_1.default.publishMessage("运气真好，原地可以继续探险。");
            new MapExplorer_1.default(credential).explore()
                .then(found => {
                foundList.push(found);
                doSeekTreasure(credential, town, scope, mode, locationList, locationIndex + 1, foundList);
            });
        }
        else {
            const plan = new TravelPlan_1.default();
            plan.credential = credential;
            plan.source = from;
            plan.destination = to;
            plan.scope = scope;
            plan.mode = mode;
            new TravelPlanExecutor_1.default(plan).execute()
                .then(() => {
                new MapExplorer_1.default(credential).explore()
                    .then(found => {
                    foundList.push(found);
                    doSeekTreasure(credential, town, scope, mode, locationList, locationIndex + 1, foundList);
                });
            });
        }
    }
    else {
        // 最后一个坐标已经完成了探险。现在可以回城了
        MessageBoard_1.default.publishMessage("藏宝图已经用完，准备回城。");
        const plan = new TravelPlan_1.default();
        plan.credential = credential;
        plan.source = from;
        plan.destination = to;
        plan.scope = scope;
        plan.mode = mode;
        new TravelPlanExecutor_1.default(plan).execute()
            .then(() => {
            new TownEntrance_1.default(credential).enter(town.id)
                .then(() => {
                new TownBank_1.default(credential).deposit().then(() => {
                    MessageBoard_1.default.publishMessage("探险完成。");
                    if (foundList.length > 0) {
                        MessageBoard_1.default.publishMessage("在无人处，悄悄检视了下探险的收入：");
                        for (let i = 0; i < foundList.length; i++) {
                            MessageBoard_1.default.publishMessage("<b style='color: yellow'>" + foundList[i] + "</b>");
                        }
                    }
                    $("#returnButton")
                        .prop("disabled", false)
                        .attr("value", town.name + "欢迎您的归来");
                });
            });
        });
    }
}
function doRefresh(credential) {
    $("#treasureHint").parent().hide();
    $("#exchangeButton").off("click");
    $("#treasureButton").off("click");
    $(".treasure_hint_class")
        .off("mouseenter")
        .off("mouseleave");
    const request = credential.asRequest();
    // @ts-ignore
    request["con_str"] = "50";
    // @ts-ignore
    request["mode"] = "CHANGEMAP";
    NetworkUtils_1.default.sendPostRequest("town.cgi", request, function (html) {
        const hints = TreasureHintParser_1.default.parseTreasureHintList(html);
        doRenderTreasureHint(credential, hints);
    });
}
module.exports = TownAdventureGuildPageProcessor;


/***/ }),
/* 176 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _MapExplorer_credential;
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const TimeoutUtils_1 = __importDefault(__webpack_require__(46));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
class MapExplorer {
    constructor(credential) {
        _MapExplorer_credential.set(this, void 0);
        __classPrivateFieldSet(this, _MapExplorer_credential, credential, "f");
    }
    explore() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential) => {
                return new Promise((resolve) => {
                    MessageBoard_1.default.publishMessage("等待探险冷却中......(约55秒)");
                    TimeoutUtils_1.default.execute(55000, function () {
                        const request = credential.asRequest();
                        // @ts-ignore
                        request["mode"] = "MAP_SEARCH";
                        NetworkUtils_1.default.sendPostRequest("map.cgi", request, function (html) {
                            if (html.includes("所持金超过1000000。请先存入银行。")) {
                                MessageBoard_1.default.publishMessage("在探险过程中，突然跳出<b style='color:chartreuse'>3个BT</b>对你进行了殴打！");
                                resolve("被3BT殴打！");
                            }
                            else {
                                const found = $(html).find("h2:first").text();
                                MessageBoard_1.default.publishMessage("<b style='color:red'>" + found + "</b>");
                                resolve(found);
                            }
                        });
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _MapExplorer_credential, "f"));
        });
    }
}
_MapExplorer_credential = new WeakMap();
module.exports = MapExplorer;


/***/ }),
/* 177 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TreasureHint_1 = __importDefault(__webpack_require__(178));
const Coordinate_1 = __importDefault(__webpack_require__(7));
class TreasureHintParser {
    static parseTreasureHintList(pageHtml) {
        const treasureHintList = [];
        $(pageHtml)
            .find("input:checkbox")
            .each(function (_idx, checkbox) {
            const t0 = $(checkbox).parent();
            const t1 = $(t0).next();
            const t2 = $(t1).next();
            const t3 = $(t2).next();
            const t4 = $(t3).next();
            const t5 = $(t4).next();
            const treasureHint = new TreasureHint_1.default();
            treasureHint.index = parseInt($(checkbox).val());
            treasureHint.name = $(t2).text();
            const x = parseInt($(t4).text());
            const y = parseInt($(t5).text());
            treasureHint.coordinate = new Coordinate_1.default(x, y);
            treasureHintList.push(treasureHint);
        });
        return treasureHintList;
    }
}
module.exports = TreasureHintParser;


/***/ }),
/* 178 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
class TreasureHint {
    get commentHtml() {
        if (!this.coordinate.isAvailable) {
            return "<span style='color:red'>活动图</span>";
        }
        const town = TownLoader_1.default.getTownByCoordinate(this.coordinate);
        if (town === null) {
            return "-";
        }
        else {
            return "<span style='color:red'>" + town.name + " " + this.coordinate.asText() + "</span>";
        }
    }
}
module.exports = TreasureHint;


/***/ }),
/* 179 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownArmorHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownArmorHousePageProcessor_1 = __importDefault(__webpack_require__(180));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class TownArmorHousePageInterceptor {
    constructor() {
        _TownArmorHousePageInterceptor_processor.set(this, new TownArmorHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("＜＜　□　防具屋　□　＞＞");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isPocketSuperMarketEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _TownArmorHousePageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_TownArmorHousePageInterceptor_processor = new WeakMap();
module.exports = TownArmorHousePageInterceptor;


/***/ }),
/* 180 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownArmorHousePageProcessor_instances, _TownArmorHousePageProcessor_renderImmutablePage, _TownArmorHousePageProcessor_bindImmutableButtons, _TownArmorHousePageProcessor_renderMutablePage, _TownArmorHousePageProcessor_bindMutableButtons, _TownArmorHousePageProcessor_refreshMutablePage;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const TownArmorHouse_1 = __importDefault(__webpack_require__(181));
const TownBank_1 = __importDefault(__webpack_require__(51));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownArmorHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _TownArmorHousePageProcessor_instances.add(this);
    }
    doProcess(credential, context) {
        PageUtils_1.default.loadButtonStyle(7);
        PageUtils_1.default.loadButtonStyle(8);
        PageUtils_1.default.loadButtonStyle(35);
        const page = TownArmorHouse_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        __classPrivateFieldGet(this, _TownArmorHousePageProcessor_instances, "m", _TownArmorHousePageProcessor_renderImmutablePage).call(this, credential, page);
        __classPrivateFieldGet(this, _TownArmorHousePageProcessor_instances, "m", _TownArmorHousePageProcessor_renderMutablePage).call(this, credential, page);
    }
}
_TownArmorHousePageProcessor_instances = new WeakSet(), _TownArmorHousePageProcessor_renderImmutablePage = function _TownArmorHousePageProcessor_renderImmutablePage(credential, page) {
    // 重新绘制页面框架
    $("table:eq(1)")
        .attr("id", "t1")
        .find("td:first")
        .attr("id", "pageTitle")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("bgcolor")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  " + page.town.nameTitle + " 防 具 屋  ＞＞")
        .parent()
        .next()
        .find("table:first")
        .find("td:eq(1)")
        .find("table:first")
        .find("td:last")
        .attr("id", "roleCash");
    // 删除原有页面所有的表单
    $("form").remove();
    // 消息面板
    $("#t1")
        .find("tr:first")
        .next()
        .next()
        .find("table:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .css("color", "white")
        .next()
        .attr("id", "messageBoardManager");
    // 清空原来的商品栏，保留行作为新的UI的位置
    $("#t1")
        .find("tr:first")
        .next()
        .next()
        .next()
        .html("<td id='armor_store_UI' style='width:100%;background-color:#F8F0E0'></td>");
    // 绘制新的内容
    let html = "";
    html += "<table style='width:100%;border-width:0;background-color:#888888;margin:auto'>";
    html += "<tbody>";
    // ------------------------------------------------------------------------
    // 隐藏的表单
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='hidden_form_cell'>";
    html += PageUtils_1.default.generateReturnTownForm(credential);
    // noinspection HtmlUnknownTarget
    html += "<form action='mydata.cgi' method='post'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='town' value='" + page.town.id + "'>";
    html += "<input type='hidden' name='mode' value='USE_ITEM'>";
    html += "<input type='submit' id='equipmentManagement'>";
    html += "</form>";
    html += "</td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 主菜单
    // ------------------------------------------------------------------------
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' id='refresh_button' value='刷新" + page.town.name + "防具屋' class='button-35'>&nbsp;";
    html += "<input type='button' id='return_button' value='离开" + page.town.name + "防具屋' class='button-35'>&nbsp;";
    html += "<input type='button' id='equipment_button' value='转到装备管理' class='button-35'>";
    html += "</td>";
    // ------------------------------------------------------------------------
    // 个人物品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='personal_equipment_list_cell'></td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 防具屋商品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='armor_merchandise_list_cell'></td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#armor_store_UI").html(html);
    __classPrivateFieldGet(this, _TownArmorHousePageProcessor_instances, "m", _TownArmorHousePageProcessor_bindImmutableButtons).call(this, credential, page.town.id);
}, _TownArmorHousePageProcessor_bindImmutableButtons = function _TownArmorHousePageProcessor_bindImmutableButtons(credential, townId) {
    $("#refresh_button").on("click", () => {
        $("#messageBoardManager").html(NpcLoader_1.default.randomNpcImageHtml());
        MessageBoard_1.default.resetMessageBoard("欢迎、欢迎。");
        __classPrivateFieldGet(this, _TownArmorHousePageProcessor_instances, "m", _TownArmorHousePageProcessor_refreshMutablePage).call(this, credential, townId);
    });
    $("#return_button").on("click", () => {
        $("#returnTown").trigger("click");
    });
    $("#equipment_button").on("click", () => {
        $("#equipmentManagement").trigger("click");
    });
}, _TownArmorHousePageProcessor_renderMutablePage = function _TownArmorHousePageProcessor_renderMutablePage(credential, page) {
    // ------------------------------------------------------------------------
    // 渲染随身装备
    // ------------------------------------------------------------------------
    const equipmentList = page.equipmentList;
    if (equipmentList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;width:100%;background-color:#888888'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkred;color:wheat;font-weight:bold' colspan='12'>";
        html += "＜ 随 身 装 备 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>出售</th>";
        html += "<th style='background-color:#EFE0C0'>装备</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>价值</th>";
        html += "</tr>";
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (equipment.isSellable) {
                html += "<input type='button' value='出售' " +
                    "id='sell_" + equipment.index + "' class='dynamic_button_class button-7'>";
            }
            else {
                html += PageUtils_1.default.generateInvisibleButton("#E8E8D0");
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.usingHTML + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0;text-align:right'>" + equipment.priceHTML + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#personal_equipment_list_cell")
            .html(html)
            .parent()
            .show();
    }
    // ------------------------------------------------------------------------
    // 渲染防具店商品
    // ------------------------------------------------------------------------
    const merchandiseList = page.merchandiseList;
    if (merchandiseList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;width:100%;background-color:#888888'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold' colspan='15'>";
        html += "＜ 商 品 列 表 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>数量</th>";
        html += "<th style='background-color:#E8E8D0'>购买</th>";
        html += "<th style='background-color:#EFE0C0'>特产</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>价格</th>";
        html += "<th style='background-color:#E0D0B0'>威力</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>职业</th>";
        html += "<th style='background-color:#E0D0B0'>攻击</th>";
        html += "<th style='background-color:#E0D0B0'>防御</th>";
        html += "<th style='background-color:#E0D0B0'>智力</th>";
        html += "<th style='background-color:#E0D0B0'>精神</th>";
        html += "<th style='background-color:#E0D0B0'>速度</th>";
        html += "<th style='background-color:#E0D0B0'>宝石</th>";
        html += "</tr>";
        for (const merchandise of merchandiseList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            const spaceCount = 19 - page.equipmentList.length;
            if (spaceCount > 0) {
                html += "<select id='count_" + merchandise.index + "'>";
                for (let i = 1; i <= spaceCount; i++) {
                    html += "<option value='" + i + "'>" + i + "</option>";
                }
                html += "</select>";
            }
            html += "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (spaceCount > 0) {
                html += "<input type='button' value='购买' " +
                    "id='buy_" + merchandise.index + "' class='dynamic_button_class button-8'>";
            }
            else {
                html += PageUtils_1.default.generateInvisibleButton("#E8E8D0");
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.specialityHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.nameHtml + "</td>";
            html += "<td style='background-color:#EFE0C0;text-align:right'>" + merchandise.priceHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredCareerHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpecialAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpecialDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpeedHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.gemCountHtml + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#armor_merchandise_list_cell")
            .html(html)
            .parent()
            .show();
    }
    __classPrivateFieldGet(this, _TownArmorHousePageProcessor_instances, "m", _TownArmorHousePageProcessor_bindMutableButtons).call(this, credential, page);
}, _TownArmorHousePageProcessor_bindMutableButtons = function _TownArmorHousePageProcessor_bindMutableButtons(credential, page) {
    $("input:button[value='出售']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(buttonId.split("_")[1]);
        const equipment = page.findEquipment(index);
        if (!confirm("确认要出售“" + equipment.fullName + "”？")) {
            return;
        }
        new TownArmorHouse_1.default(credential, page.townId)
            .sell(index, page.discount)
            .then(() => {
            new TownBank_1.default(credential, page.townId).deposit().then(() => {
                __classPrivateFieldGet(this, _TownArmorHousePageProcessor_instances, "m", _TownArmorHousePageProcessor_refreshMutablePage).call(this, credential, page.townId);
            });
        });
    });
    $("input:button[value='购买']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(buttonId.split("_")[1]);
        const count = parseInt($("#count_" + index).val());
        const merchandise = page.findMerchandise(index);
        const totalPrice = merchandise.price * count;
        const amount = BankUtils_1.default.calculateCashDifferenceAmount(page.role.cash, totalPrice);
        if (!confirm("确认要购买" + count + "件“" + merchandise.name + "”？大约需要再支取" + amount + "万GOLD。")) {
            return;
        }
        const bank = new TownBank_1.default(credential, page.townId);
        bank.withdraw(amount)
            .then(() => {
            new TownArmorHouse_1.default(credential, page.townId)
                .buy(index, count, page.discount)
                .then(() => {
                bank.deposit()
                    .then(() => {
                    __classPrivateFieldGet(this, _TownArmorHousePageProcessor_instances, "m", _TownArmorHousePageProcessor_refreshMutablePage).call(this, credential, page.townId);
                });
            });
        });
    });
}, _TownArmorHousePageProcessor_refreshMutablePage = function _TownArmorHousePageProcessor_refreshMutablePage(credential, townId) {
    PageUtils_1.default.scrollIntoView("pageTitle");
    $("#personal_equipment_list_cell").parent().hide();
    $("#armor_merchandise_list_cell").parent().hide();
    $(".dynamic_button_class").off("click");
    new TownArmorHouse_1.default(credential, townId).open().then(page => {
        $("#roleCash").text(page.role.cash + " GOLD");
        __classPrivateFieldGet(this, _TownArmorHousePageProcessor_instances, "m", _TownArmorHousePageProcessor_renderMutablePage).call(this, credential, page);
    });
};
module.exports = TownArmorHousePageProcessor;


/***/ }),
/* 181 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownArmorHouse_credential, _TownArmorHouse_townId;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Merchandise_1 = __importDefault(__webpack_require__(172));
const Role_1 = __importDefault(__webpack_require__(14));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownArmorHousePage_1 = __importDefault(__webpack_require__(182));
class TownArmorHouse {
    constructor(credential, townId) {
        _TownArmorHouse_credential.set(this, void 0);
        _TownArmorHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownArmorHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownArmorHouse_townId, townId, "f");
    }
    static parsePage(pageHtml) {
        return doParsePage(pageHtml);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownArmorHouse_credential, "f").asRequestMap();
                    request.set("town", __classPrivateFieldGet(this, _TownArmorHouse_townId, "f"));
                    request.set("con_str", "50");
                    request.set("mode", "PRO_SHOP");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const page = TownArmorHouse.parsePage(html);
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    sell(equipmentIndex, discount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownArmorHouse_credential, "f").asRequestMap();
                    request.set("select", equipmentIndex.toString());
                    request.set("val_off", discount.toString());
                    request.set("mode", "SELL");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
    buy(merchandiseIndex, count, discount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    const request = __classPrivateFieldGet(this, _TownArmorHouse_credential, "f").asRequestMap();
                    request.set("select", merchandiseIndex.toString());
                    request.set("townid", __classPrivateFieldGet(this, _TownArmorHouse_townId, "f"));
                    request.set("val_off", discount.toString());
                    request.set("mark", "1");
                    request.set("mode", "BUY");
                    request.set("num", count.toString());
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        if (html.includes("所持金不足")) {
                            reject();
                        }
                        else {
                            resolve();
                        }
                    });
                });
            };
            return yield action();
        });
    }
}
_TownArmorHouse_credential = new WeakMap(), _TownArmorHouse_townId = new WeakMap();
function doParsePage(pageHtml) {
    const townId = $(pageHtml).find("input:hidden[name='townid']:first").val();
    let discount = 1;
    const input = $(pageHtml).find("input:hidden[name='val_off']:first");
    if (input.length > 0) {
        discount = parseFloat(input.val());
    }
    const role = new Role_1.default();
    $(pageHtml).find("td:contains('姓名')")
        .filter((idx, td) => $(td).text() === "姓名")
        .closest("table")
        .find("tr:first")
        .next()
        .find("td:first")
        .each((idx, td) => {
        role.name = $(td).text();
    })
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        role.level = parseInt(s);
    })
        .next()
        .each((idx, td) => {
        role.attribute = $(td).text();
    })
        .next()
        .each((idx, td) => {
        role.career = $(td).text();
    })
        .parent()
        .next()
        .find("td:first")
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        s = StringUtils_1.default.substringBefore(s, " GOLD");
        role.cash = parseInt(s);
    });
    const page = new TownArmorHousePage_1.default();
    page.townId = townId;
    page.discount = discount;
    page.role = role;
    page.equipmentList = doParsePersonalEquipmentList(pageHtml);
    page.merchandiseList = doParseArmorMerchandiseList(pageHtml);
    return page;
}
function doParsePersonalEquipmentList(pageHtml) {
    const personalEquipmentList = [];
    $(pageHtml)
        .find("input:submit[value='物品卖出']")
        .closest("table")
        .find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const c2 = c1.next();
        const c3 = c2.next();
        const c4 = c3.next();
        const c5 = c4.next();
        const c6 = c5.next();
        const c7 = c6.next();
        const equipment = new Equipment_1.default();
        equipment.index = parseInt($(radio).val());
        equipment.selectable = !$(radio).prop("disabled");
        equipment.using = c1.text() === "★";
        equipment.parseName(c2.html());
        equipment.category = c3.text();
        equipment.power = parseInt(c4.text());
        equipment.weight = parseInt(c5.text());
        equipment.parseEndure(c6.text());
        equipment.parsePrice(c7.html());
        personalEquipmentList.push(equipment);
    });
    return personalEquipmentList;
}
function doParseArmorMerchandiseList(pageHtml) {
    const armorMerchandiseList = [];
    const table = $(pageHtml).find("input:radio:last")
        .closest("table");
    let specialityMatch = false;
    table.find("tr").each(function (_idx, tr) {
        const c1 = $(tr).find(":first-child");
        const radio = c1.find("input:radio:first");
        if (radio.length > 0) {
            const merchandise = new Merchandise_1.default();
            merchandise.id = "ARM_" + $(radio).val();
            merchandise.category = "防具";
            const c2 = c1.next();
            const c3 = c2.next();
            const c4 = c3.next();
            const c5 = c4.next();
            const c6 = c5.next();
            const c7 = c6.next();
            const c8 = c7.next();
            const c9 = c8.next();
            const c10 = c9.next();
            const c11 = c10.next();
            const c12 = c11.next();
            const c13 = c12.next();
            const c14 = c13.next();
            merchandise.name = c2.text();
            merchandise.nameHtml = c2.html();
            let s = c3.text();
            s = StringUtils_1.default.substringBefore(s, " Gold");
            merchandise.price = parseInt(s);
            merchandise.power = parseInt(c4.text());
            merchandise.weight = parseInt(c5.text());
            merchandise.endure = parseInt(c6.text());
            merchandise.attribute = c7.text();
            merchandise.requiredCareer = c8.text();
            merchandise.requiredAttack = parseInt(c9.text());
            merchandise.requiredDefense = parseInt(c10.text());
            merchandise.requiredSpecialAttack = parseInt(c11.text());
            merchandise.requiredSpecialDefense = parseInt(c12.text());
            merchandise.requiredSpeed = parseInt(c13.text());
            merchandise.gemCount = parseInt(c14.text());
            merchandise.speciality = specialityMatch;
            armorMerchandiseList.push(merchandise);
        }
        else if (c1.text() === "== 特产防具 ==") {
            specialityMatch = true;
        }
    });
    return armorMerchandiseList;
}
module.exports = TownArmorHouse;


/***/ }),
/* 182 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
class TownArmorHousePage {
    get town() {
        return TownLoader_1.default.getTownById(this.townId);
    }
    findEquipment(index) {
        for (const equipment of this.equipmentList) {
            if (equipment.index === index) {
                return equipment;
            }
        }
        return null;
    }
    findMerchandise(index) {
        for (const merchandise of this.merchandiseList) {
            if (merchandise.index === index) {
                return merchandise;
            }
        }
        return null;
    }
}
module.exports = TownArmorHousePage;


/***/ }),
/* 183 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownBankPageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownBankPageProcessor_1 = __importDefault(__webpack_require__(184));
const PageProcessorContext_1 = __importDefault(__webpack_require__(30));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class TownBankPageInterceptor {
    constructor() {
        _TownBankPageInterceptor_processor.set(this, new TownBankPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("存入或取出请输入数额后按下确认键");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isPocketBankEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(townId => {
            const context = new PageProcessorContext_1.default();
            context.set("townId", townId);
            __classPrivateFieldGet(this, _TownBankPageInterceptor_processor, "f").process(context);
        })
            .fork();
    }
}
_TownBankPageInterceptor_processor = new WeakMap();
module.exports = TownBankPageInterceptor;


/***/ }),
/* 184 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownBankPageProcessor_instances, _TownBankPageProcessor_renderImmutablePage, _TownBankPageProcessor_bindImmutableButtons, _TownBankPageProcessor_renderMutablePage, _TownBankPageProcessor_bindMutableButtons, _TownBankPageProcessor_refreshMutablePage;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const TownBank_1 = __importDefault(__webpack_require__(51));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownBankPageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _TownBankPageProcessor_instances.add(this);
    }
    doProcess(credential, context) {
        const page = TownBank_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        const town = TownLoader_1.default.getTownById(context.get("townId"));
        __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_renderImmutablePage).call(this, credential, town);
        __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_renderMutablePage).call(this, credential, page, town);
    }
}
_TownBankPageProcessor_instances = new WeakSet(), _TownBankPageProcessor_renderImmutablePage = function _TownBankPageProcessor_renderImmutablePage(credential, town) {
    $("form").remove();
    $("table:eq(1)")
        .attr("id", "t1")
        .find("td:first")
        .attr("id", "pageTitle")
        .removeAttr("bgcolor")
        .removeAttr("width")
        .removeAttr("height")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  口 袋 银 行 " + town.nameTitle + " 分 行  ＞＞");
    $("#pageTitle")
        .parent()
        .attr("id", "tr0")
        .next()
        .attr("id", "tr1")
        .find("td:first")
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .next()
        .next()
        .next()
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .find("table:first")
        .find("tr:first")
        .next()
        .next()
        .find("td:last")
        .attr("id", "roleCash");
    $("#tr1")
        .next()
        .attr("id", "tr2")
        .find("td:first")
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .removeAttr("width")
        .removeAttr("bgcolor")
        .css("width", "100%")
        .css("background-color", "black")
        .css("color", "wheat")
        .next()
        .attr("id", "messageBoardManager");
    let html = "";
    html += "<tr id='tr3' style='display:none'>";
    html += "<td id='hiddenFormContainer'></td>";
    html += "</tr>";
    html += "<tr id='tr4'>";
    html += "<td style='background-color:#F8F0E0;text-align:center;width:100%'>";
    html += "<input type='button' id='refreshButton' value='刷新" + town.name + "银行'>";
    html += "<input type='button' id='returnButton' value='离开" + town.name + "银行'>";
    html += "</td>";
    html += "</tr>";
    $("#tr2").after($(html));
    $("#hiddenFormContainer").html(PageUtils_1.default.generateReturnTownForm(credential));
    html = "";
    html += "<p id='p1'>";
    html += "<input type='button' id='depositAllButton' value='全部存入' class='dynamicButton'>";
    html += "</p>";
    html += "<p id='p2'>";
    html += "<input type='text' id='depositAmount' value='' size='3' style='text-align:right'>0000 Gold&nbsp;&nbsp;&nbsp;";
    html += "<input type='button' id='depositButton' value='金存入' class='dynamicButton'>";
    html += "</p>";
    html += "<p id='p3'>";
    html += "<input type='text' id='withdrawAmount' value='' size='3' style='text-align:right'>0000 Gold&nbsp;&nbsp;&nbsp;";
    html += "<input type='button' id='withdrawButton' value='金取出' class='dynamicButton'>";
    html += "</p>";
    html += "<p id='p4'>";
    html += "&nbsp;&nbsp;&nbsp;";
    html += "</p>";
    $("#tr4")
        .next()
        .attr("id", "tr5")
        .find("td:first")
        .find("p:first")
        .attr("id", "p0")
        .after($(html));
    $("#p0")
        .prev()
        .find("font:first")
        .attr("id", "accountCash")
        .next()
        .attr("id", "accountSaving");
    html = "";
    html += "<tr id='tr6'>";
    html += "<td style='background-color:darkred;width:100%;text-align:center;font-weight:bold;color:aliceblue'>";
    html += "＜ 转 账 通 道 ＞";
    html += "</td>";
    html += "</tr>";
    html += "<tr id='tr7'>";
    html += "<td style='background-color:#F8F0E0;width:100%;text-align:center'>";
    html += "<input type='text' id='searchName' size='15' maxlength='20'>";
    html += "<input type='button' id='searchButton' value='找人'>";
    html += "<select id='peopleSelect'><option value=''>选择发送对象</select>";
    html += "<input type='text' id='transferAmount' value='' size='3' style='text-align:right'>0000 Gold&nbsp;&nbsp;&nbsp;";
    html += "<input type='button' id='transferButton' value='转账' class='dynamicButton'>";
    html += "</td>";
    html += "</tr>";
    $("#tr5").after($(html));
    __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_bindImmutableButtons).call(this, credential, town);
}, _TownBankPageProcessor_bindImmutableButtons = function _TownBankPageProcessor_bindImmutableButtons(credential, town) {
    $("#refreshButton").on("click", () => {
        PageUtils_1.default.scrollIntoView("pageTitle");
        MessageBoard_1.default.resetMessageBoard("请管理您的账户吧！");
        $("#messageBoardManager").html(NpcLoader_1.default.randomNpcImageHtml());
        __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_refreshMutablePage).call(this, credential, town);
    });
    $("#returnButton").on("click", () => {
        $("#returnTown").trigger("click");
    });
    $("#searchButton").on("click", () => {
        const s = $("#searchName").val();
        if (s === undefined || s.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("请正确输入人名！");
            return;
        }
        const searchName = s.trim();
        const request = credential.asRequestMap();
        request.set("mode", "MONEY_SEND");
        // noinspection JSDeprecatedSymbols
        request.set("serch", escape(searchName));
        NetworkUtils_1.default.post("town.cgi", request).then(html => {
            const options = $(html).find("select[name='eid']").html();
            $("#peopleSelect").html(options);
        });
    });
}, _TownBankPageProcessor_renderMutablePage = function _TownBankPageProcessor_renderMutablePage(credential, page, town) {
    __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_bindMutableButtons).call(this, credential, page, town);
}, _TownBankPageProcessor_bindMutableButtons = function _TownBankPageProcessor_bindMutableButtons(credential, page, town) {
    $("#depositAllButton").on("click", () => {
        if (page.account.cash < 10000) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没觉得你身上有啥值得存入的现金！");
            return;
        }
        new TownBank_1.default(credential, town === null || town === void 0 ? void 0 : town.id).deposit()
            .then(() => __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_refreshMutablePage).call(this, credential, town))
            .catch(() => PageUtils_1.default.scrollIntoView("pageTitle"));
    });
    $("#depositButton").on("click", () => {
        const text = $("#depositAmount").val();
        if (text === undefined || text.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有输入存入的金额！");
            return;
        }
        const amount = parseInt(text.trim());
        if (isNaN(amount) || !Number.isInteger(amount) || amount <= 0) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("非法输入金额！");
            return;
        }
        if (amount * 10000 > page.account.cash) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning(amount + "万！真逗，搞得你好像有这么多现金似得！");
            return;
        }
        new TownBank_1.default(credential, town === null || town === void 0 ? void 0 : town.id).deposit(amount)
            .then(() => __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_refreshMutablePage).call(this, credential, town));
    });
    $("#withdrawButton").on("click", () => {
        const text = $("#withdrawAmount").val();
        if (text === undefined || text.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有输入取出的金额！");
            return;
        }
        const amount = parseInt(text.trim());
        if (isNaN(amount) || !Number.isInteger(amount) || amount <= 0) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("非法输入金额！");
            return;
        }
        if (amount * 10000 > page.account.saving) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning(amount + "万！真逗，搞得你好像有这么多存款似得！");
            return;
        }
        new TownBank_1.default(credential, town === null || town === void 0 ? void 0 : town.id).withdraw(amount)
            .then(() => __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_refreshMutablePage).call(this, credential, town));
    });
    $("#transferButton").on("click", () => {
        const s = $("#peopleSelect").val();
        if (s === undefined || s.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有选择转账对象！");
            return;
        }
        const text = $("#transferAmount").val();
        if (text === undefined || text.trim() === "") {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有输入取出的金额！");
            return;
        }
        const amount = parseInt(text.trim());
        if (isNaN(amount) || !Number.isInteger(amount) || amount <= 0) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("非法输入金额！");
            return;
        }
        if ((amount + 10) * 10000 > page.account.total) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("很遗憾，你压根就没有这么多钱！");
            return;
        }
        const target = $("#peopleSelect").find("option:selected").text();
        if (!confirm("请您确认向" + target + "转账" + amount + "万GOLD？")) {
            return;
        }
        const delta = BankUtils_1.default.calculateCashDifferenceAmount(page.account.cash, (amount + 10) * 10000);
        const bank = new TownBank_1.default(credential, town === null || town === void 0 ? void 0 : town.id);
        bank.withdraw(delta).then(() => {
            const request = credential.asRequestMap();
            request.set("gold", (amount * 10).toString()); // 送钱的接口单位是K
            request.set("eid", s.trim());
            request.set("mode", "MONEY_SEND2");
            NetworkUtils_1.default.post("town.cgi", request).then(html => {
                MessageBoard_1.default.processResponseMessage(html);
                bank.deposit()
                    .then(() => __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_refreshMutablePage).call(this, credential, town));
            });
        });
    });
}, _TownBankPageProcessor_refreshMutablePage = function _TownBankPageProcessor_refreshMutablePage(credential, town) {
    new TownBank_1.default(credential, town === null || town === void 0 ? void 0 : town.id).open().then(page => {
        $("#roleCash").text(page.role.cash + " GOLD");
        $("#accountCash").text(page.account.cash.toString());
        $("#accountSaving").text(page.account.saving.toString());
        $("#depositAmount").val("");
        $("#withdrawAmount").val("");
        $("#transferAmount").val("");
        $(".dynamicButton").off("click");
        __classPrivateFieldGet(this, _TownBankPageProcessor_instances, "m", _TownBankPageProcessor_renderMutablePage).call(this, credential, page, town);
    });
};
module.exports = TownBankPageProcessor;


/***/ }),
/* 185 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownDashboardPageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownDashboardPageProcessor_1 = __importDefault(__webpack_require__(186));
class TownDashboardPageInterceptor {
    constructor() {
        _TownDashboardPageInterceptor_processor.set(this, new TownDashboardPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "status.cgi" || cgi === "town.cgi") {
            return pageText.includes("城市支配率");
        }
        return false;
    }
    intercept() {
        // Set current location state to TOWN.
        LocationStateMachine_1.default.create().inTown();
        __classPrivateFieldGet(this, _TownDashboardPageInterceptor_processor, "f").process();
    }
}
_TownDashboardPageInterceptor_processor = new WeakMap();
module.exports = TownDashboardPageInterceptor;


/***/ }),
/* 186 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
const EventHandler_1 = __importDefault(__webpack_require__(33));
const RoleStatusParser_1 = __importDefault(__webpack_require__(93));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownDashboardPageProcessor extends PageProcessorCredentialSupport_1.default {
    doLoadButtonStyles() {
        return [7, 8, 16, 24];
    }
    doProcess(credential, context) {
        doProcess(credential);
    }
}
function doProcess(credential) {
    $("input:text:last").attr("id", "messageInputText");
    $("input:submit[value='更新']")
        .attr("id", "refreshButton");
    let buttonChanged = false;
    if (SetupLoader_1.default.isConsecrateStateRecognizeEnabled(credential.id)) {
        buttonChanged = true;
        if (PageUtils_1.default.currentPageHtml().includes("可以进行下次祭奠了")) {
            $("#refreshButton").addClass("button-7");
            $("input:submit[value='行动']").addClass("button-7");
        }
        else {
            $("#refreshButton").addClass("button-8");
            $("input:submit[value='行动']").addClass("button-8");
        }
    }
    $("#refreshButton").attr("height", "100%");
    $("input:submit[value='行动']").attr("height", "100%");
    const enlargeRatio = SetupLoader_1.default.getEnlargeBattleRatio();
    if (enlargeRatio > 0) {
        if (!buttonChanged) {
            $("#refreshButton").addClass("button-16");
            $("input:submit[value='行动']").addClass("button-16");
        }
        let fontSize = 100 * enlargeRatio;
        let picWidth = 80 * enlargeRatio;
        let picHeight = 40 * enlargeRatio;
        $("th:contains('训练·战斗')")
            .filter((idx, th) => {
            return $(th).text() === "训练·战斗";
        })
            .next()
            .attr("id", "battleCell")
            .removeAttr("height")
            .find("select:first")
            .css("font-size", fontSize + "%")
            .parent()
            .find("img:first")
            .attr("width", picWidth)
            .attr("height", picHeight)
            .before($("<br>"));
        $("#battleCell")
            .next()
            .find("input:submit:first")
            .css("height", "100%");
    }
    doRenderBattleMenu(credential);
    doRenderPostHouseMenu();
    doRenderSetupMenu();
    doRenderEquipmentManagementMenu();
    doRenderPetManagementMenu();
    doRenderCareerManagementMenu();
    doRenderAdventureGuildMenu();
    doRenderSuperMarketMenu();
    doRenderGemHouseMenu();
    doRenderPetRankMenu();
    doRenderFastLoginMenu();
    doRenderBankMenu();
    const roleStatus = RoleStatusParser_1.default.parseRoleStatus(document.documentElement.outerHTML);
    doRenderBattleCount(roleStatus);
    doRenderCareerTransferWarning(credential, roleStatus);
    doRenderRoleStatus(roleStatus);
    doRenderTownTax(credential, roleStatus);
    doRenderLeaveTown();
    doRenderEventBoard();
    if (SetupLoader_1.default.isTownDashboardShortcutButtonEnabled()) {
        $("th:contains('训练·战斗')")
            .filter((idx, th) => {
            return $(th).text() === "训练·战斗";
        })
            .closest("table")
            .attr("id", "mainMenu")
            .find("tr:first")
            .find("td:first")
            .attr("colspan", 5)
            .parent()
            .next()
            .find("th:first")
            .attr("colspan", 4)
            .parent()
            .next()
            .find("th:first")
            .attr("colspan", 3)
            .css("text-align", "right")
            .text("训练战斗")
            .parent()
            .next()
            .find("th:first")
            .css("text-align", "right")
            .text("城市设施")
            .before($("<td><button role='button' class='button-24' id='shortcut1'>鉴</button></td>"))
            .parent()
            .next()
            .find("th:first")
            .css("text-align", "right")
            .before($("<td><button role='button' class='button-24' id='shortcut2'>装</button></td>"))
            .parent()
            .next()
            .find("th:first")
            .css("text-align", "right")
            .before($("<td><button role='button' class='button-24' id='shortcut3'>宠</button></td>"))
            .parent()
            .next()
            .find("th:first")
            .css("text-align", "right")
            .before($("<td><button role='button' class='button-24' id='shortcut4'>职</button></td>"))
            .parent()
            .next()
            .find("th:first")
            .attr("colspan", 3)
            .parent()
            .next()
            .find("th:first")
            .attr("colspan", 4)
            .parent()
            .next()
            .find("th:first")
            .attr("colspan", 5);
        $("#shortcut1").on("click", () => {
            $("option[value='PETMAP']")
                .prop("selected", true)
                .closest("td")
                .next()
                .find("input:submit:first")
                .trigger("click");
        });
        $("#shortcut2").on("click", () => {
            $("option[value='USE_ITEM']")
                .prop("selected", true)
                .closest("td")
                .next()
                .find("input:submit:first")
                .trigger("click");
        });
        $("#shortcut3").on("click", () => {
            $("option[value='PETSTATUS']")
                .prop("selected", true)
                .closest("td")
                .next()
                .find("input:submit:first")
                .trigger("click");
        });
        $("#shortcut4").on("click", () => {
            $("option[value='CHANGE_OCCUPATION']")
                .prop("selected", true)
                .closest("td")
                .next()
                .find("input:submit:first")
                .trigger("click");
        });
    }
}
function doRenderBattleMenu(credential) {
    const preference = SetupLoader_1.default.getBattlePlacePreference(credential.id);
    let count = 0;
    // @ts-ignore
    if (preference["primary"]) {
        count++;
    }
    // @ts-ignore
    if (preference["junior"]) {
        count++;
    }
    // @ts-ignore
    if (preference["senior"]) {
        count++;
    }
    // @ts-ignore
    if (preference["zodiac"]) {
        count++;
    }
    if (count === 0) {
        // 没有设置战斗场所偏好，忽略
        return;
    }
    // 设置了战斗场所偏好
    $("select[name='level']").find("option").each(function (_idx, option) {
        const text = $(option).text();
        if (text.startsWith("秘宝之岛")) {
            // do nothing, keep
        }
        else if (text.startsWith("初级之森")) {
            // do nothing, keep
        }
        else if (text.startsWith("中级之塔")) {
            // do nothing, keep
        }
        else if (text.startsWith("上级之洞")) {
            // do nothing, keep
        }
        else if (text.startsWith("十二神殿")) {
            // do nothing, keep
        }
        else if (text.startsWith("------")) {
            // do nothing, keep
        }
        else {
            $(option).remove();
        }
    });
    $("select[name='level']").find("option").each(function (_idx, option) {
        const text = $(option).text();
        if (text.startsWith("初级之森")) {
            // @ts-ignore
            if (!preference["primary"]) {
                $(option).remove();
            }
        }
        else if (text.startsWith("中级之塔")) {
            // @ts-ignore
            if (!preference["junior"]) {
                $(option).remove();
            }
        }
        else if (text.startsWith("上级之洞")) {
            // @ts-ignore
            if (!preference["senior"]) {
                $(option).remove();
            }
        }
        else if (text.startsWith("十二神殿")) {
            // @ts-ignore
            if (!preference["zodiac"]) {
                $(option).remove();
            }
        }
    });
    // 删除连续的分隔线
    let delimMatch = false;
    $("select[name='level']").find("option").each(function (_idx, option) {
        const text = $(option).text();
        if (text.startsWith("------")) {
            if (!delimMatch) {
                delimMatch = true;
            }
            else {
                $(option).remove();
            }
        }
        else {
            delimMatch = false;
        }
    });
    // 删除头尾的分隔线
    if ($("select[name='level']").find("option:last").text().startsWith("------")) {
        $("select[name='level']").find("option:last").remove();
    }
    if ($("select[name='level']").find("option:first").text().startsWith("------")) {
        $("select[name='level']").find("option:first").remove();
    }
    if (count === 1) {
        // 只设置了一处战斗场所偏好
        let formBattle = $("form[action='battle.cgi']");
        let selectBattle = formBattle.find('select[name="level"]');
        let btnBattle = formBattle.parent().next().find('input');
        let inputDigits = '';
        $(document).off('keydown.city').on('keydown.city', function (e) {
            if ($("#messageInputText:focus").length > 0) {
                // 当前的焦点在消息框，禁用按键辅助
                return;
            }
            const key = e.key;
            if (key !== undefined && !isNaN(parseInt(key))) {
                inputDigits += key;
            }
            if (inputDigits.length === 2) {
                switch (inputDigits) {
                    case '11':
                        selectBattle.find('option').eq(0).prop('selected', true);
                        break;
                    case '22':
                        selectBattle.find('option').eq(1).prop('selected', true);
                        break;
                    default:
                        inputDigits = '';
                        break;
                }
                btnBattle.trigger("focus");
                // 重置 inputDigits
                inputDigits = '';
            }
        });
    }
}
function doRenderPostHouseMenu() {
    $("option[value='INN']")
        .css("background-color", "yellow")
        .text("客栈·驿站");
}
function doRenderSetupMenu() {
    $("option[value='LETTER']")
        .css("background-color", "yellow")
        .text("口袋助手设置");
}
function doRenderEquipmentManagementMenu() {
    if (SetupLoader_1.default.isEquipmentManagementUIEnabled()) {
        $("option[value='USE_ITEM']")
            .css("background-color", "yellow")
            .text("装备管理");
        $("option[value='ITEM_SEND']").remove();
    }
}
function doRenderPetManagementMenu() {
    if (SetupLoader_1.default.isPetManagementUIEnabled()) {
        $("option[value='PETSTATUS']")
            .css("background-color", "yellow")
            .text("宠物管理");
        $("option[value='PET_SEND']").remove();
    }
}
function doRenderCareerManagementMenu() {
    if (SetupLoader_1.default.isCareerManagementUIEnabled()) {
        $("option[value='CHANGE_OCCUPATION']")
            .css("background-color", "yellow")
            .text("职业管理");
        $("option[value='MAGIC']").remove();
    }
}
function doRenderSuperMarketMenu() {
    if (SetupLoader_1.default.isPocketSuperMarketEnabled()) {
        $("option[value='ARM_SHOP']")
            .css("background-color", "yellow");
        $("option[value='PRO_SHOP']")
            .css("background-color", "yellow");
        $("option[value='ACC_SHOP']")
            .css("background-color", "yellow");
        $("option[value='ITEM_SHOP']")
            .css("background-color", "yellow");
    }
}
function doRenderGemHouseMenu() {
    if (SetupLoader_1.default.isGemHouseUIEnabled()) {
        $("option[value='BAOSHI_SHOP']")
            .css("background-color", "yellow")
            .text("宝石屋");
        $("option[value='BAOSHI_DELSHOP']")
            .remove();
    }
}
function doRenderPetRankMenu() {
    $("option[value='PETPROFILE']")
        .css("background-color", "yellow")
        .text("宠物排行榜");
}
function doRenderAdventureGuildMenu() {
    $("option[value='CHANGEMAP']")
        .css("background-color", "yellow")
        .text("冒险家公会");
}
function doRenderFastLoginMenu() {
    if (SetupLoader_1.default.isFastLoginEnabled()) {
        $("option[value='CHUJIA']")
            .css("background-color", "yellow")
            .text("快速登陆设置");
    }
}
function doRenderBankMenu() {
    if (SetupLoader_1.default.isPocketBankEnabled()) {
        $("option[value='BANK']")
            .css("background-color", "yellow")
            .text("口袋银行");
        $("option[value='MONEY_SEND']").remove();
    }
}
function doRenderBattleCount(roleStatus) {
    $("td:contains('贡献度')")
        .filter(function () {
        return $(this).text() === "贡献度";
    })
        .closest("table")
        .find("th:first")
        .find("font:first")
        .html(function (_idx, text) {
        const name = StringUtils_1.default.substringBefore(text, "(");
        const unit = StringUtils_1.default.substringBetween(text, "(", "军)");
        if (unit.includes("无所属")) {
            return name + "&nbsp;&nbsp;&nbsp;" + roleStatus.battleCount + "战";
        }
        else {
            return name + "(" + unit + ")" + "&nbsp;&nbsp;&nbsp;" + roleStatus.battleCount + "战";
        }
    });
}
function doRenderCareerTransferWarning(credential, roleStatus) {
    // 如果满级并且没有关闭转职入口，则战斗前标签用红色显示
    if (roleStatus.level === 150) {
        if (!SetupLoader_1.default.isCareerTransferEntranceDisabled(credential.id)) {
            $("#refreshButton")
                .closest("td")
                .prev()
                .css("color", "red");
        }
    }
}
function doRenderRoleStatus(roleStatus) {
    $("td:parent").each(function (_idx, td) {
        const text = $(td).text();
        if (text === "经验值") {
            if (SetupLoader_1.default.isExperienceProgressBarEnabled()) {
                if (roleStatus.level === 150) {
                    $(td).next()
                        .attr("style", "color: blue")
                        .text("MAX");
                }
                else {
                    const ratio = roleStatus.level / 150;
                    const progressBar = PageUtils_1.default.generateProgressBarHTML(ratio);
                    const exp = $(td).next().text();
                    $(td).next()
                        .html("<span title='" + exp + "'>" + progressBar + "</span>");
                }
            }
        }
        if (text === "身份") {
            if (roleStatus.level !== 150 && (roleStatus.attack === 375 || roleStatus.defense === 375
                || roleStatus.specialAttack === 375 || roleStatus.specialDefense === 375 || roleStatus.speed === 375)) {
                $(td).next().css("color", "red");
            }
        }
        if (text === "资金") {
            const cashText = $(td).next().text();
            const cash = cashText.substring(0, cashText.indexOf(" Gold"));
            if (parseInt(cash) >= 1000000) {
                $(td).next().css("color", "red");
            }
        }
    });
}
function doRenderTownTax(credential, roleStatus) {
    let td = null;
    const town = TownLoader_1.default.getTownById(roleStatus.townId);
    if (town !== null && town.name === "枫丹") {
        td = $("th:contains('收益')")
            .filter(function () {
            return $(this).text() === "收益";
        })
            .next()
            .removeAttr("align")
            .css("text-align", "right")
            .html("<span style='color:red' title='枫丹的收益不需要关心'>PRIVACY</span>");
    }
    if (SetupLoader_1.default.isCollectTownTaxDisabled()) {
        $("option[value='MAKE_TOWN']").remove();
        return;
    }
    if (roleStatus.country !== "在野" && roleStatus.country === roleStatus.townCountry) {
        if (td === null) {
            td = $("th:contains('收益')")
                .filter(function () {
                return $(this).text() === "收益";
            })
                .next();
        }
        const tax = parseInt(td.text());
        if (tax >= 50000) {
            if (tax - Math.floor(tax / 50000) * 50000 <= 10000) {
                td.css("color", "white")
                    .css("background-color", "green")
                    .css("font-weight", "bold")
                    .attr("id", "tax_" + roleStatus.townId);
                doBindTownTaxButton(credential, "tax_" + roleStatus.townId);
            }
        }
    }
}
function doRenderLeaveTown() {
    if (!SetupLoader_1.default.isHiddenLeaveAndExitEnabled()) {
        return;
    }
    $("th:contains('出城')")
        .filter(function () {
        return $(this).text() === "出城";
    })
        .parent()
        .attr("id", "leaveTownRow")
        .hide()
        .next()
        .attr("id", "safeExitRow")
        .hide();
    $("img:first").attr("id", "townImage");
    $("#townImage").on("click", function () {
        $("#leaveTownRow").toggle();
        $("#safeExitRow").toggle();
    });
}
function doRenderEventBoard() {
    $("td:contains('最近发生的事件')")
        .filter(function () {
        return $(this).text() === "最近发生的事件";
    })
        .parent()
        .next()
        .find("td:first")
        .attr("id", "eventBoard");
    const eventHtmlList = [];
    $("#eventBoard").html()
        .split("<br>")
        .filter(it => it.endsWith(")"))
        .map(function (it) {
        // noinspection HtmlDeprecatedTag,XmlDeprecatedElement,HtmlDeprecatedAttribute
        const header = "<font color=\"navy\">●</font>";
        return StringUtils_1.default.substringAfter(it, header);
    })
        .map(function (it) {
        return EventHandler_1.default.handleWithEventHtml(it);
    })
        .forEach(it => eventHtmlList.push(it));
    let html = "";
    html += "<table style='border-width:0;width:100%;height:100%;margin:auto'>";
    html += "<tbody>";
    eventHtmlList.forEach(it => {
        html += "<tr>";
        html += "<th style='color:navy;vertical-align:top'>●</th>";
        html += "<td style='width:100%'>";
        html += it;
        html += "</td>";
        html += "</tr>";
    });
    html += "</tbody>";
    html += "</table>";
    $("#eventBoard").html(html);
}
function doBindTownTaxButton(credential, cellId) {
    $("#" + cellId).on("dblclick", function () {
        const townId = StringUtils_1.default.substringAfterLast($(this).attr("id"), "_");
        const request = credential.asRequest();
        // @ts-ignore
        request.town = townId;
        // @ts-ignore
        request.mode = "MAKE_TOWN";
        NetworkUtils_1.default.sendPostRequest("country.cgi", request, function () {
            $("#refreshButton").trigger("click");
        });
    });
}
module.exports = TownDashboardPageProcessor;


/***/ }),
/* 187 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownGemHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownGemHousePageProcessor_1 = __importDefault(__webpack_require__(188));
const PageProcessorContext_1 = __importDefault(__webpack_require__(30));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class TownGemHousePageInterceptor {
    constructor() {
        _TownGemHousePageInterceptor_processor.set(this, new TownGemHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("＜＜ * 合 成 屋 *＞＞");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isGemHouseUIEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(townId => {
            const context = new PageProcessorContext_1.default();
            context.set("townId", townId);
            __classPrivateFieldGet(this, _TownGemHousePageInterceptor_processor, "f").process(context);
        })
            .fork();
    }
}
_TownGemHousePageInterceptor_processor = new WeakMap();
module.exports = TownGemHousePageInterceptor;


/***/ }),
/* 188 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownGemHousePageProcessor_instances, _TownGemHousePageProcessor_renderImmutablePage, _TownGemHousePageProcessor_bindImmutableButtons, _TownGemHousePageProcessor_renderMutablePage, _TownGemHousePageProcessor_bindMutableButtons, _TownGemHousePageProcessor_refreshMutablePage, _TownGemHousePageProcessor__fuseAllGems;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const PersonalEquipmentManagement_1 = __importDefault(__webpack_require__(83));
const TownBank_1 = __importDefault(__webpack_require__(51));
const TownGemHouse_1 = __importDefault(__webpack_require__(189));
const TownGemMeltHouse_1 = __importDefault(__webpack_require__(191));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const CommentBoard_1 = __importDefault(__webpack_require__(20));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownGemHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _TownGemHousePageProcessor_instances.add(this);
    }
    doProcess(credential, context) {
        const townId = context.get("townId");
        const town = TownLoader_1.default.getTownById(townId);
        new TownGemHouse_1.default(credential, town.id).parsePage(PageUtils_1.default.currentPageHtml())
            .then(page => {
            __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_renderImmutablePage).call(this, credential, town);
            __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_renderMutablePage).call(this, credential, page, town);
        });
    }
}
_TownGemHousePageProcessor_instances = new WeakSet(), _TownGemHousePageProcessor_renderImmutablePage = function _TownGemHousePageProcessor_renderImmutablePage(credential, town) {
    $("table:eq(1)")
        .attr("id", "t1")
        .find("td:first")
        .attr("id", "pageTitle")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("bgcolor")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  " + town.nameTitle + " 宝 石 屋  ＞＞")
        .parent()
        .next()
        .find("table:first")
        .find("td:eq(1)")
        .find("table:first")
        .find("td:first")
        .find("table:first")
        .find("td:last")
        .attr("id", "roleCash");
    $("#t1")
        .find("tr:first")
        .next()
        .next()
        .find("table:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .removeAttr("width")
        .removeAttr("bgcolor")
        .css("width", "100%")
        .css("background-color", "black")
        .css("color", "white")
        .html(WELCOME_MESSAGE)
        .next()
        .attr("id", "messageBoardManager");
    // 清空原来的页面内容，准备重新绘制
    $("#t1")
        .find("tr:first")
        .next()
        .next()
        .next()
        .html("<td id='gem_house_UI' style='width:100%;text-align:center'></td>")
        .next()
        .remove();
    // 绘制新的内容
    let html = "";
    html += "<table style='width:100%;border-width:0;background-color:#888888;margin:auto'>";
    html += "<tbody>";
    // ------------------------------------------------------------------------
    // 隐藏的表单
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='hidden_form_cell'>";
    html += PageUtils_1.default.generateReturnTownForm(credential);
    html += "</td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 记录最后一次合成装备的信息
    // 不能用下标来记录，因为宝石的消耗可能造成下标的变化
    // 因此需要记录的是装备的全名及其在物品栏出现的序号。
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='last_fuse_cell'>none</td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 主菜单
    // ------------------------------------------------------------------------
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' id='refresh_button' value='刷新" + town.name + "宝石屋'>";
    html += "<input type='button' id='return_button' value='离开" + town.name + "宝石屋'>";
    html += "</td>";
    // ------------------------------------------------------------------------
    // 个人物品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='equipment_list_cell' style='background-color:#F8F0E0;text-align:center'></td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 宝石栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='gem_list_cell' style='background-color:#F8F0E0;text-align:center'></td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#gem_house_UI").html(html);
    CommentBoard_1.default.createCommentBoard(NpcLoader_1.default.getNpcImageHtml("末末"));
    CommentBoard_1.default.writeMessage("<b style='font-size:120%;color:navy'>砸石头这种事儿，确实是有手就行。</b>");
    CommentBoard_1.default.writeMessage("<p id='fuseAllContainer' style='display:none'>" +
        "<input type='button' id='fuseAll_1' value='砸完所有威力' class='dynamic_button_class all_gem_class' disabled>" +
        "<input type='button' id='fuseAll_2' value='砸完所有重量' class='dynamic_button_class all_gem_class' disabled>" +
        "<input type='button' id='fuseAll_3' value='砸完所有幸运' class='dynamic_button_class all_gem_class' disabled>" +
        "</p>");
    __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_bindImmutableButtons).call(this, credential, town);
}, _TownGemHousePageProcessor_bindImmutableButtons = function _TownGemHousePageProcessor_bindImmutableButtons(credential, town) {
    $("#return_button").on("click", () => {
        $("#returnTown").trigger("click");
    });
    $("#refresh_button").on("click", () => {
        PageUtils_1.default.scrollIntoView("pageTitle");
        $("#messageBoardManager").html(NpcLoader_1.default.randomNpcImageHtml());
        MessageBoard_1.default.resetMessageBoard("钻石恒久远，一颗永流传。");
        $("#last_fuse_cell").text("none");
        __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_refreshMutablePage).call(this, credential, town);
    });
    $("#p_8173").on("dblclick", () => {
        $("#fuseAllContainer").toggle();
    });
}, _TownGemHousePageProcessor_renderMutablePage = function _TownGemHousePageProcessor_renderMutablePage(credential, page, town) {
    if (page.equipmentList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkred;color:wheat;font-weight:bold' colspan='9'>";
        html += "＜ 随 身 装 备 ＞";
        html += "</td>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>选择</th>";
        html += "<th style='background-color:#EFE0C0'>装备</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>威力</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>宝石</th>";
        html += "<th style='background-color:#E0D0B0'>销毁</th>";
        html += "</tr>";
        for (const equipment of page.equipmentList) {
            const canFuse = equipment.selectable && (!equipment.using || (equipment.using && equipment.name === "宠物蛋"));
            const canMelt = !equipment.using && page.townGemMeltHousePage.canMelt(equipment.index);
            if (!canFuse && !canMelt) {
                continue;
            }
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (canFuse) {
                html += "<input type='button' value='选择' " +
                    "class='dynamic_button_class' " +
                    "id='select_" + equipment.index + "' " +
                    "style='color:grey'>";
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.usingHTML + "</td>";
            html += "<td style='background-color:#E0D0B0' id='name_" + equipment.index + "' class='equipment_detail_class'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.gemCountHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>";
            if (canMelt) {
                html += "<input type='button' value='销毁' " +
                    "class='dynamic_button_class' " +
                    "id='melt_" + equipment.index + "' " +
                    "style='color:red'>";
            }
            html += "</td>";
            html += "</tr>";
        }
        html += "</tr>";
        html += "<tr>";
        html += "<td id='equipment_detail' style='background-color:navy;color:greenyellow;font-weight:bold' colspan='9'>　</td>";
        html += "</tr>";
        html += "</tbody>";
        html += "</table>";
        $("#equipment_list_cell")
            .html(html)
            .parent()
            .show();
        const lastFuse = $("#last_fuse_cell").text();
        if (lastFuse !== "none" && lastFuse.includes("/")) {
            const equipmentName = StringUtils_1.default.substringBefore(lastFuse, "/");
            const equipmentSequence = parseInt(StringUtils_1.default.substringAfter(lastFuse, "/"));
            // 查找装备
            let equipmentIndex = -1;
            let sequence = 0;
            for (const equipment of page.equipmentList) {
                if (equipment.fullName === equipmentName) {
                    sequence++;
                    if (sequence === equipmentSequence) {
                        equipmentIndex = equipment.index;
                        break;
                    }
                }
            }
            if (equipmentIndex >= 0) {
                // 找到对应的装备，修改对应按钮的状态
                const buttonId = "select_" + equipmentIndex;
                if ($("#" + buttonId).length > 0) {
                    $("#" + buttonId).css("color", "blue");
                }
            }
        }
    }
    if (page.gemList.length > 0) {
        let powerGemFound = false;
        let weightGemFound = false;
        let luckGemFound = false;
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold' colspan='2'>";
        html += "＜ 可 用 宝 石 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>宝石</th>";
        html += "<th style='background-color:#EFE0C0'>镶嵌</th>";
        html += "</tr>";
        for (const gem of page.gemList) {
            if (gem.name === "威力宝石") {
                powerGemFound = true;
            }
            if (gem.name === "重量宝石") {
                weightGemFound = true;
            }
            if (gem.name === "幸运宝石") {
                luckGemFound = true;
            }
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>" + gem.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>";
            html += "<input type='button' value='镶嵌' " +
                "class='dynamic_button_class' " +
                "id='fuse_" + gem.index + "'>";
            html += "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#gem_list_cell")
            .html(html)
            .parent()
            .show();
        if (powerGemFound) {
            $("#fuseAll_1").prop("disabled", false);
        }
        if (weightGemFound) {
            $("#fuseAll_2").prop("disabled", false);
        }
        if (luckGemFound) {
            $("#fuseAll_3").prop("disabled", false);
        }
    }
    __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_bindMutableButtons).call(this, credential, page, town);
}, _TownGemHousePageProcessor_bindMutableButtons = function _TownGemHousePageProcessor_bindMutableButtons(credential, page, town) {
    $(".equipment_detail_class")
        .on("mouseenter", function () {
        const index = parseInt($(this).attr("id").split("_")[1]);
        new PersonalEquipmentManagement_1.default(credential).open().then(page => {
            const equipment = page.findEquipment(index);
            if (equipment !== null) {
                let s = "";
                s += equipment.fullName;
                s += " ";
                s += "附加威力:" + equipment.additionalPower;
                s += " ";
                s += "附加重量:" + equipment.additionalWeight;
                s += " ";
                s += "附加幸运:" + equipment.additionalLuck;
                $("#equipment_detail").text(s);
            }
        });
    })
        .on("mouseleave", function () {
        $("#equipment_detail").text("　");
    });
    $("input:button[value='选择']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        if (PageUtils_1.default.isColorBlue(buttonId)) {
            // 当前按钮是蓝色，是已经选中状态。将其变为灰色即可
            $("#" + buttonId).css("color", "grey");
        }
        else if (PageUtils_1.default.isColorGrey(buttonId)) {
            // 当前按钮是灰色，将其变成选中状态，并且取消其他所有的按钮
            $("#" + buttonId).css("color", "blue");
            $("input:button[value='选择']")
                .each((_idx, button) => {
                const otherButtonId = $(button).attr("id");
                if (otherButtonId !== buttonId) {
                    $("#" + otherButtonId).css("color", "grey");
                }
            });
        }
    });
    $("input:button[value='销毁']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(buttonId.split("_")[1]);
        const equipment = page.findEquipment(index);
        if (!confirm("确认销毁“" + (equipment === null || equipment === void 0 ? void 0 : equipment.nameHTML) + "”的宝石？")) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            return;
        }
        const amount = BankUtils_1.default.calculateCashDifferenceAmount(page.role.cash, 5000000);
        const bank = new TownBank_1.default(credential, town.id);
        bank.withdraw(amount).then(() => {
            new TownGemMeltHouse_1.default(credential, town.id).melt(index).then(() => {
                bank.deposit().then(() => {
                    __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_refreshMutablePage).call(this, credential, town);
                });
            });
        });
    });
    $("input:button[value='镶嵌']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(buttonId.split("_")[1]);
        let checkedIndex = undefined;
        $("input:button[value='选择']")
            .filter(function () {
            const buttonId = $(this).attr("id");
            return PageUtils_1.default.isColorBlue(buttonId);
        })
            .each(function (_idx, button) {
            if (checkedIndex === undefined) {
                const buttonId = $(button).attr("id");
                checkedIndex = parseInt(StringUtils_1.default.substringAfter(buttonId, "_"));
            }
        });
        if (checkedIndex === undefined) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            MessageBoard_1.default.publishWarning("没有选择要镶嵌的装备！");
            return;
        }
        const equipment = page.findEquipment(checkedIndex);
        const gem = page.findGem(index);
        if (!confirm("确认为“" + (equipment === null || equipment === void 0 ? void 0 : equipment.nameHTML) + "”镶嵌“" + (gem === null || gem === void 0 ? void 0 : gem.name) + "”？")) {
            PageUtils_1.default.scrollIntoView("pageTitle");
            return;
        }
        // 找这件装备的序号是多少
        let lastFuse = "none";
        let sequence = 0;
        for (const it of page.equipmentList) {
            if (it.fullName === equipment.fullName) {
                sequence++;
            }
            if (it.index === equipment.index) {
                lastFuse = equipment.fullName + "/" + sequence;
                break;
            }
        }
        new TownGemHouse_1.default(credential, town.id).fuse(checkedIndex, index).then(() => {
            // 合成装备之后，设置最后一次合成的信息
            $("#last_fuse_cell").text(lastFuse);
            __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_refreshMutablePage).call(this, credential, town);
        });
    });
    $(".all_gem_class").on("click", event => {
        PageUtils_1.default.scrollIntoView("pageTitle");
        const buttonId = $(event.target).attr("id");
        const gemCode = parseInt(buttonId.split("_")[1]);
        let gemName = "";
        if (gemCode === 1) {
            gemName = "威力宝石";
        }
        else if (gemCode === 2) {
            gemName = "重量宝石";
        }
        else if (gemCode === 3) {
            gemName = "幸运宝石";
        }
        let checkedIndex = undefined;
        $("input:button[value='选择']")
            .filter(function () {
            const buttonId = $(this).attr("id");
            return PageUtils_1.default.isColorBlue(buttonId);
        })
            .each(function (_idx, button) {
            if (checkedIndex === undefined) {
                const buttonId = $(button).attr("id");
                checkedIndex = parseInt(StringUtils_1.default.substringAfter(buttonId, "_"));
            }
        });
        if (checkedIndex === undefined) {
            MessageBoard_1.default.publishWarning("没有选择要镶嵌的装备！");
            return;
        }
        const equipment = page.findEquipment(checkedIndex);
        if (!confirm("确认为“" + (equipment === null || equipment === void 0 ? void 0 : equipment.nameHTML) + "”尽可能镶嵌所有的“" + gemName + "”？")) {
            return;
        }
        // 找这件装备的序号是多少
        let lastFuse = "none";
        let sequence = 0;
        for (const it of page.equipmentList) {
            if (it.fullName === equipment.fullName) {
                sequence++;
            }
            if (it.index === equipment.index) {
                lastFuse = equipment.fullName + "/" + sequence;
                break;
            }
        }
        __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor__fuseAllGems).call(this, credential, page, town, lastFuse, gemCode);
    });
}, _TownGemHousePageProcessor_refreshMutablePage = function _TownGemHousePageProcessor_refreshMutablePage(credential, town) {
    $("#equipment_list_cell").html("").parent().hide();
    $("#gem_list_cell").html("").parent().hide();
    $(".dynamic_button_class").off("click");
    $(".equipment_detail_class").off("mouseenter").off("mouseleave");
    $(".all_gem_class").prop("disabled", true);
    new TownGemHouse_1.default(credential, town.id).open().then(page => {
        const cash = page.role.cash;
        $("#roleCash").html(cash + " GOLD");
        __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_renderMutablePage).call(this, credential, page, town);
    });
}, _TownGemHousePageProcessor__fuseAllGems = function _TownGemHousePageProcessor__fuseAllGems(credential, page, town, target, gemCode) {
    // 找待砸石头的装备
    const equipmentName = StringUtils_1.default.substringBefore(target, "/");
    const equipmentSequence = parseInt(StringUtils_1.default.substringAfter(target, "/"));
    // 查找装备
    let equipmentIndex = -1;
    let sequence = 0;
    for (const equipment of page.equipmentList) {
        if (equipment.fullName === equipmentName) {
            sequence++;
            if (sequence === equipmentSequence) {
                equipmentIndex = equipment.index;
                break;
            }
        }
    }
    if (equipmentIndex < 0) {
        // Not found? Should not reach here.
        __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_refreshMutablePage).call(this, credential, town);
        return;
    }
    const equipment = page.findEquipment(equipmentIndex);
    const canFuse = equipment.selectable && (!equipment.using || (equipment.using && equipment.name === "宠物蛋"));
    if (!canFuse) {
        // 已经不能再继续镶嵌了，返回
        MessageBoard_1.default.publishMessage("所选装备已经没有剩余孔位，结束。");
        __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_refreshMutablePage).call(this, credential, town);
        return;
    }
    let gem = undefined;
    for (const it of page.gemList) {
        if (gemCode === 1 && it.name === "威力宝石") {
            gem = it;
            break;
        }
        if (gemCode === 2 && it.name === "重量宝石") {
            gem = it;
            break;
        }
        if (gemCode === 3 && it.name === "幸运宝石") {
            gem = it;
            break;
        }
    }
    if (gem === undefined) {
        // 已经没有剩余的宝石，返回
        MessageBoard_1.default.publishMessage("已经没有剩余的宝石，结束。");
        __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_refreshMutablePage).call(this, credential, town);
        return;
    }
    if (gemCode === 1) {
        new PersonalEquipmentManagement_1.default(credential).open().then(p => {
            const e = p.findEquipment(equipmentIndex);
            if (e !== null && e.additionalPower < 0) {
                MessageBoard_1.default.publishMessage("当前装备镶嵌威力宝石时出现负数，中断转手工处理。");
                __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor_refreshMutablePage).call(this, credential, town);
            }
            else {
                const house = new TownGemHouse_1.default(credential, town.id);
                house.fuse(equipmentIndex, gem.index).then(() => {
                    house.open().then(page => {
                        __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor__fuseAllGems).call(this, credential, page, town, target, gemCode);
                    });
                });
            }
        });
    }
    else {
        const house = new TownGemHouse_1.default(credential, town.id);
        house.fuse(equipmentIndex, gem.index).then(() => {
            house.open().then(page => {
                __classPrivateFieldGet(this, _TownGemHousePageProcessor_instances, "m", _TownGemHousePageProcessor__fuseAllGems).call(this, credential, page, town, target, gemCode);
            });
        });
    }
};
const WELCOME_MESSAGE = "<b style='color:yellow'>宝石屋改造的一些说明：</b><br>" +
    "正在使用中的装备除了宠物蛋之外不允许镶嵌；<br>" +
    "鼠标停留在装备名字上可以显示当前装备的宝石附加状态。<br>" +
    "（鼠标停留功能请慎用，会对服务器发出额外的请求）";
module.exports = TownGemHousePageProcessor;


/***/ }),
/* 189 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownGemHouse_credential, _TownGemHouse_townId;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Role_1 = __importDefault(__webpack_require__(14));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownGemHousePage_1 = __importDefault(__webpack_require__(190));
const TownGemMeltHouse_1 = __importDefault(__webpack_require__(191));
class TownGemHouse {
    constructor(credential, townId) {
        _TownGemHouse_credential.set(this, void 0);
        _TownGemHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownGemHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownGemHouse_townId, townId, "f");
    }
    parsePage(html) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const page = doParsePage(html);
                    new TownGemMeltHouse_1.default(__classPrivateFieldGet(this, _TownGemHouse_credential, "f"), __classPrivateFieldGet(this, _TownGemHouse_townId, "f")).open()
                        .then(townGemMeltHousePage => {
                        page.townGemMeltHousePage = townGemMeltHousePage;
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownGemHouse_credential, "f").asRequestMap();
                    request.set("con_str", "50");
                    request.set("mode", "BAOSHI_SHOP");
                    if (__classPrivateFieldGet(this, _TownGemHouse_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _TownGemHouse_townId, "f"));
                    }
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        this.parsePage(html).then(page => {
                            resolve(page);
                        });
                    });
                });
            };
            return yield action();
        });
    }
    fuse(equipmentIndex, gemIndex) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownGemHouse_credential, "f").asRequestMap();
                    request.set("select", equipmentIndex.toString());
                    request.set("baoshi", gemIndex.toString());
                    request.set("azukeru", "0");
                    request.set("mode", "BAOSHI_MAKE");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
}
_TownGemHouse_credential = new WeakMap(), _TownGemHouse_townId = new WeakMap();
function doParsePage(html) {
    const role = new Role_1.default();
    $(html)
        .find("td:contains('姓名')")
        .filter((_idx, td) => $(td).text() === "姓名")
        .closest("table")
        .find("tr:first")
        .next()
        .find("td:first")
        .each((_idx, td) => {
        role.name = $(td).text();
    })
        .next()
        .each((_idx, td) => {
        let s = $(td).text();
        role.level = parseInt(s);
    })
        .next()
        .each((_idx, td) => {
        let s = $(td).text();
        role.attribute = StringUtils_1.default.substringBefore(s, "属");
    })
        .next()
        .each((_idx, td) => {
        role.career = $(td).text();
    })
        .parent()
        .next()
        .find("td:first")
        .next()
        .each((_idx, td) => {
        let s = $(td).text();
        s = StringUtils_1.default.substringBefore(s, " GOLD");
        role.cash = parseInt(s);
    });
    const equipmentList = [];
    $(html).find("td:contains('选择要合成的装备')")
        .filter(function () {
        return $(this).text().startsWith("选择要合成的装备");
    })
        .find("table:first")
        .find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const c2 = c1.next();
        const c3 = c2.next();
        const c4 = c3.next();
        const c5 = c4.next();
        const c6 = c5.next();
        const c7 = c6.next();
        const equipment = new Equipment_1.default();
        equipment.index = parseInt($(radio).val());
        equipment.selectable = !$(radio).prop("disabled");
        equipment.using = c1.text() === "★";
        equipment.parseName(c2.html());
        equipment.category = c3.text();
        equipment.power = parseInt(c4.text());
        equipment.weight = parseInt(c5.text());
        equipment.parseEndure(c6.text());
        equipment.parseGemCount(c7.text());
        equipmentList.push(equipment);
    });
    const gemList = [];
    $(html).find("td:contains('选择要使用的宝石')")
        .filter(function () {
        return $(this).text().startsWith("\n选择要使用的宝石");
    })
        .find("table:first")
        .find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const gem = new Equipment_1.default();
        gem.index = parseInt($(radio).val());
        gem.selectable = true;
        gem.parseName(c1.html());
        gemList.push(gem);
    });
    const page = new TownGemHousePage_1.default();
    page.role = role;
    page.equipmentList = equipmentList;
    page.gemList = gemList;
    return page;
}
module.exports = TownGemHouse;


/***/ }),
/* 190 */
/***/ ((module) => {


class TownGemHousePage {
    findEquipment(index) {
        for (const equipment of this.equipmentList) {
            if (equipment.index === index) {
                return equipment;
            }
        }
        return null;
    }
    findGem(index) {
        for (const gem of this.gemList) {
            if (gem.index === index) {
                return gem;
            }
        }
        return null;
    }
}
module.exports = TownGemHousePage;


/***/ }),
/* 191 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownGemMeltHouse_credential, _TownGemMeltHouse_townId;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Role_1 = __importDefault(__webpack_require__(14));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownGemMeltHousePage_1 = __importDefault(__webpack_require__(192));
class TownGemMeltHouse {
    constructor(credential, townId) {
        _TownGemMeltHouse_credential.set(this, void 0);
        _TownGemMeltHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownGemMeltHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownGemMeltHouse_townId, townId, "f");
    }
    static parsePage(html) {
        return doParsePage(html);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownGemMeltHouse_credential, "f").asRequestMap();
                    request.set("con_str", "50");
                    request.set("mode", "BAOSHI_DELSHOP");
                    if (__classPrivateFieldGet(this, _TownGemMeltHouse_townId, "f") !== undefined) {
                        request.set("town", __classPrivateFieldGet(this, _TownGemMeltHouse_townId, "f"));
                    }
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const page = TownGemMeltHouse.parsePage(html);
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    melt(index) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownGemMeltHouse_credential, "f").asRequestMap();
                    request.set("select", index.toString());
                    request.set("azukeru", "0");
                    request.set("mode", "BAOSHI_DELETE");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
}
_TownGemMeltHouse_credential = new WeakMap(), _TownGemMeltHouse_townId = new WeakMap();
function doParsePage(html) {
    const role = new Role_1.default();
    $(html)
        .find("td:contains('姓名')")
        .filter((_idx, td) => $(td).text() === "姓名")
        .closest("table")
        .find("tr:first")
        .next()
        .find("td:first")
        .each((_idx, td) => {
        role.name = $(td).text();
    })
        .next()
        .each((_idx, td) => {
        let s = $(td).text();
        role.level = parseInt(s);
    })
        .next()
        .each((_idx, td) => {
        let s = $(td).text();
        role.attribute = StringUtils_1.default.substringBefore(s, "属");
    })
        .next()
        .each((_idx, td) => {
        role.career = $(td).text();
    })
        .parent()
        .next()
        .find("td:first")
        .next()
        .each((_idx, td) => {
        let s = $(td).text();
        s = StringUtils_1.default.substringBefore(s, " GOLD");
        role.cash = parseInt(s);
    });
    const equipmentList = [];
    $(html).find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const c2 = c1.next();
        const c3 = c2.next();
        const c4 = c3.next();
        const c5 = c4.next();
        const c6 = c5.next();
        const c7 = c6.next();
        const equipment = new Equipment_1.default();
        equipment.index = parseInt($(radio).val());
        equipment.selectable = !$(radio).prop("disabled");
        equipment.using = c1.text() === "★";
        equipment.parseName(c2.html());
        equipment.category = c3.text();
        equipment.additionalPower = parseInt(c4.text());
        equipment.additionalWeight = parseInt(c5.text());
        equipment.additionalLuck = parseInt(c6.text());
        equipment.parseGemCount(c7.text());
        equipmentList.push(equipment);
    });
    const page = new TownGemMeltHousePage_1.default();
    page.role = role;
    page.equipmentList = equipmentList;
    return page;
}
module.exports = TownGemMeltHouse;


/***/ }),
/* 192 */
/***/ ((module) => {


class TownGemMeltHousePage {
    canMelt(index) {
        for (const equipment of this.equipmentList) {
            if (equipment.index === index) {
                return equipment.selectable;
            }
        }
        return false;
    }
}
module.exports = TownGemMeltHousePage;


/***/ }),
/* 193 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownInformationPageInterceptor_processor;
const TownInformationPageProcessor_1 = __importDefault(__webpack_require__(194));
class TownInformationPageInterceptor {
    constructor() {
        _TownInformationPageInterceptor_processor.set(this, new TownInformationPageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town_print.cgi") {
            return pageText.includes("收益金");
        }
        return false;
    }
    intercept() {
        __classPrivateFieldGet(this, _TownInformationPageInterceptor_processor, "f").process();
    }
}
_TownInformationPageInterceptor_processor = new WeakMap();
module.exports = TownInformationPageInterceptor;


/***/ }),
/* 194 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const PageUtils_1 = __importDefault(__webpack_require__(21));
class TownInformationPageProcessor {
    process() {
        PageUtils_1.default.fixCurrentPageBrokenImages();
        PageUtils_1.default.removeUnusedHyperLinks();
        PageUtils_1.default.removeGoogleAnalyticsScript();
        doProcess();
    }
}
function doProcess() {
    $("td:contains('枫丹')")
        .filter(function () {
        return $(this).text() === "枫丹";
    })
        .next()
        .next()
        .find("font:first")
        .text("- GOLD");
}
module.exports = TownInformationPageProcessor;


/***/ }),
/* 195 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownItemHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownItemHousePageProcessor_1 = __importDefault(__webpack_require__(196));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class TownItemHousePageInterceptor {
    constructor() {
        _TownItemHousePageInterceptor_processor.set(this, new TownItemHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("＜＜　□　物品屋　□　＞＞");
        }
        return false;
    }
    intercept() {
        if (!SetupLoader_1.default.isPocketSuperMarketEnabled()) {
            return;
        }
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _TownItemHousePageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_TownItemHousePageInterceptor_processor = new WeakMap();
module.exports = TownItemHousePageInterceptor;


/***/ }),
/* 196 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownItemHousePageProcessor_instances, _TownItemHousePageProcessor_renderImmutablePage, _TownItemHousePageProcessor_bindImmutableButtons, _TownItemHousePageProcessor_renderMutablePage, _TownItemHousePageProcessor_bindMutableButtons, _TownItemHousePageProcessor_refreshMutablePage;
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const TownAccessoryHouse_1 = __importDefault(__webpack_require__(171));
const TownBank_1 = __importDefault(__webpack_require__(51));
const TownItemHouse_1 = __importDefault(__webpack_require__(197));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownItemHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _TownItemHousePageProcessor_instances.add(this);
    }
    doLoadButtonStyles() {
        return [7, 8, 35];
    }
    doProcess(credential, context) {
        const page = TownItemHouse_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        __classPrivateFieldGet(this, _TownItemHousePageProcessor_instances, "m", _TownItemHousePageProcessor_renderImmutablePage).call(this, credential, page);
        __classPrivateFieldGet(this, _TownItemHousePageProcessor_instances, "m", _TownItemHousePageProcessor_renderMutablePage).call(this, credential, page);
    }
}
_TownItemHousePageProcessor_instances = new WeakSet(), _TownItemHousePageProcessor_renderImmutablePage = function _TownItemHousePageProcessor_renderImmutablePage(credential, page) {
    $("table[height='100%']").removeAttr("height");
    $("table:first")
        .attr("id", "t0")
        .find("td:first")
        .attr("id", "pageTitle")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("bgcolor")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  " + page.town.nameTitle + " 物 品 屋  ＞＞")
        .parent()
        .next()
        .find("table:first")
        .find("td:eq(1)")
        .find("table:first")
        .find("td:last")
        .attr("id", "roleCash");
    $("form").remove();
    $("#t0")
        .find("tr:first")
        .next()
        .next()
        .find("table:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .css("color", "white")
        .next()
        .attr("id", "messageBoardManager");
    $("#t0")
        .find("tr:first")
        .next()
        .next()
        .next()
        .html("<td id='storeUI' style='width:100%;background-color:#F8F0E0'></td>");
    let html = "";
    html += "<table style='width:100%;border-width:0;background-color:#888888;margin:auto'>";
    html += "<tbody>";
    // ------------------------------------------------------------------------
    // 隐藏的表单
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='hidden_form_cell'>";
    html += PageUtils_1.default.generateReturnTownForm(credential);
    // noinspection HtmlUnknownTarget
    html += "<form action='mydata.cgi' method='post'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='town' value='" + page.town.id + "'>";
    html += "<input type='hidden' name='mode' value='USE_ITEM'>";
    html += "<input type='submit' id='equipmentManagement'>";
    html += "</form>";
    html += "</td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 主菜单
    // ------------------------------------------------------------------------
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' id='refreshButton' value='刷新" + page.town.name + "物品屋' class='button-35'>&nbsp;";
    html += "<input type='button' id='returnButton' value='离开" + page.town.name + "物品屋' class='button-35'>&nbsp;";
    html += "<input type='button' id='equipmentButton' value='转到装备管理' class='button-35'>";
    html += "</td>";
    // ------------------------------------------------------------------------
    // 个人物品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='equipmentList' style='text-align:center'></td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 商品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='merchandiseList' style='text-align:center'></td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#storeUI").html(html);
    __classPrivateFieldGet(this, _TownItemHousePageProcessor_instances, "m", _TownItemHousePageProcessor_bindImmutableButtons).call(this, credential, page.townId);
}, _TownItemHousePageProcessor_bindImmutableButtons = function _TownItemHousePageProcessor_bindImmutableButtons(credential, townId) {
    $("#refreshButton").on("click", () => {
        $("#messageBoardManager").html(NpcLoader_1.default.randomNpcImageHtml());
        MessageBoard_1.default.resetMessageBoard("欢迎、欢迎。");
        __classPrivateFieldGet(this, _TownItemHousePageProcessor_instances, "m", _TownItemHousePageProcessor_refreshMutablePage).call(this, credential, townId);
    });
    $("#returnButton").on("click", () => {
        $("#returnTown").trigger("click");
    });
    $("#equipmentButton").on("click", () => {
        $("#equipmentManagement").trigger("click");
    });
}, _TownItemHousePageProcessor_renderMutablePage = function _TownItemHousePageProcessor_renderMutablePage(credential, page) {
    // ------------------------------------------------------------------------
    // 渲染随身装备
    // ------------------------------------------------------------------------
    const equipmentList = page.equipmentList;
    if (equipmentList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkred;color:wheat;font-weight:bold' colspan='12'>";
        html += "＜ 随 身 装 备 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>出售</th>";
        html += "<th style='background-color:#EFE0C0'>装备</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>价值</th>";
        html += "</tr>";
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (equipment.isSellable) {
                html += "<input type='button' value='出售' " +
                    "id='sell_" + equipment.index + "' class='mutableButton button-7'>";
            }
            else {
                html += PageUtils_1.default.generateInvisibleButton("#E8E8D0");
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.usingHTML + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0;text-align:right'>" + equipment.priceHTML + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#equipmentList")
            .html(html)
            .parent()
            .show();
    }
    // ------------------------------------------------------------------------
    // 渲染饰品店商品
    // ------------------------------------------------------------------------
    const merchandiseList = page.merchandiseList;
    if (merchandiseList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold' colspan='8'>";
        html += "＜ 商 品 列 表 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>数量</th>";
        html += "<th style='background-color:#E8E8D0'>购买</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>价格</th>";
        html += "<th style='background-color:#E0D0B0'>威力</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>属性</th>";
        html += "</tr>";
        for (const merchandise of merchandiseList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            const spaceCount = 19 - page.equipmentList.length;
            if (spaceCount > 0) {
                html += "<select id='count_" + merchandise.index + "'>";
                for (let i = 1; i <= spaceCount; i++) {
                    html += "<option value='" + i + "'>" + i + "</option>";
                }
                html += "</select>";
            }
            html += "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (spaceCount > 0) {
                html += "<input type='button' value='购买' " +
                    "id='buy_" + merchandise.index + "' class='dynamic_button_class button-8'>";
            }
            html += "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.nameHtml + "</td>";
            html += "<td style='background-color:#EFE0C0;text-align:right'>" + merchandise.priceHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.attribute + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#merchandiseList")
            .html(html)
            .parent()
            .show();
    }
    __classPrivateFieldGet(this, _TownItemHousePageProcessor_instances, "m", _TownItemHousePageProcessor_bindMutableButtons).call(this, credential, page);
}, _TownItemHousePageProcessor_bindMutableButtons = function _TownItemHousePageProcessor_bindMutableButtons(credential, page) {
    $("input:button[value='出售']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(buttonId.split("_")[1]);
        const equipment = page.findEquipment(index);
        if (!confirm("确认要出售“" + equipment.fullName + "”？")) {
            return;
        }
        new TownAccessoryHouse_1.default(credential, page.townId)
            .sell(index, page.discount)
            .then(() => {
            new TownBank_1.default(credential, page.townId).deposit().then(() => {
                __classPrivateFieldGet(this, _TownItemHousePageProcessor_instances, "m", _TownItemHousePageProcessor_refreshMutablePage).call(this, credential, page.townId);
            });
        });
    });
    $("input:button[value='购买']").on("click", event => {
        const buttonId = $(event.target).attr("id");
        const index = parseInt(buttonId.split("_")[1]);
        const count = parseInt($("#count_" + index).val());
        const merchandise = page.findMerchandise(index);
        const totalPrice = merchandise.price * count;
        const amount = BankUtils_1.default.calculateCashDifferenceAmount(page.role.cash, totalPrice);
        if (!confirm("确认要购买" + count + "件“" + merchandise.name + "”？大约需要再支取" + amount + "万GOLD。")) {
            return;
        }
        const bank = new TownBank_1.default(credential, page.townId);
        bank.withdraw(amount)
            .then(() => {
            new TownItemHouse_1.default(credential, page.townId)
                .buy(index, count, page.discount)
                .then(() => {
                bank.deposit()
                    .then(() => {
                    __classPrivateFieldGet(this, _TownItemHousePageProcessor_instances, "m", _TownItemHousePageProcessor_refreshMutablePage).call(this, credential, page.townId);
                });
            });
        });
    });
}, _TownItemHousePageProcessor_refreshMutablePage = function _TownItemHousePageProcessor_refreshMutablePage(credential, townId) {
    PageUtils_1.default.scrollIntoView("pageTitle");
    $("#equipmentList").parent().hide();
    $("#merchandiseList").parent().hide();
    $(".mutableButton").off("click");
    new TownItemHouse_1.default(credential, townId).open().then(page => {
        $("#roleCash").text(page.role.cash + " GOLD");
        __classPrivateFieldGet(this, _TownItemHousePageProcessor_instances, "m", _TownItemHousePageProcessor_renderMutablePage).call(this, credential, page);
    });
};
module.exports = TownItemHousePageProcessor;


/***/ }),
/* 197 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownItemHouse_credential, _TownItemHouse_townId;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Merchandise_1 = __importDefault(__webpack_require__(172));
const Role_1 = __importDefault(__webpack_require__(14));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownItemHousePage_1 = __importDefault(__webpack_require__(198));
class TownItemHouse {
    constructor(credential, townId) {
        _TownItemHouse_credential.set(this, void 0);
        _TownItemHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownItemHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownItemHouse_townId, townId, "f");
    }
    static parsePage(html) {
        return __parsePage(html);
    }
    open() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownItemHouse_credential, "f").asRequestMap();
                    request.set("town", __classPrivateFieldGet(this, _TownItemHouse_townId, "f"));
                    request.set("con_str", "50");
                    request.set("mode", "ITEM_SHOP");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        const page = TownItemHouse.parsePage(html);
                        resolve(page);
                    });
                });
            };
            return yield action();
        });
    }
    sell(equipmentIndex, discount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise(resolve => {
                    const request = __classPrivateFieldGet(this, _TownItemHouse_credential, "f").asRequestMap();
                    request.set("select", equipmentIndex.toString());
                    request.set("val_off", discount.toString());
                    request.set("mode", "SELL");
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        resolve();
                    });
                });
            };
            return yield action();
        });
    }
    buy(merchandiseIndex, count, discount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = () => {
                return new Promise((resolve, reject) => {
                    const request = __classPrivateFieldGet(this, _TownItemHouse_credential, "f").asRequestMap();
                    request.set("select", merchandiseIndex.toString());
                    request.set("townid", __classPrivateFieldGet(this, _TownItemHouse_townId, "f"));
                    request.set("val_off", discount.toString());
                    request.set("mark", "3");
                    request.set("mode", "BUY");
                    request.set("num", count.toString());
                    NetworkUtils_1.default.post("town.cgi", request).then(html => {
                        MessageBoard_1.default.processResponseMessage(html);
                        if (html.includes("所持金不足")) {
                            reject();
                        }
                        else {
                            resolve();
                        }
                    });
                });
            };
            return yield action();
        });
    }
}
_TownItemHouse_credential = new WeakMap(), _TownItemHouse_townId = new WeakMap();
function __parsePage(html) {
    const townId = $(html).find("input:hidden[name='townid']:first").val();
    let discount = 1;
    const input = $(html).find("input:hidden[name='val_off']:first");
    if (input.length > 0) {
        discount = parseFloat(input.val());
    }
    const role = new Role_1.default();
    $(html).find("td:contains('姓名')")
        .filter((idx, td) => $(td).text() === "姓名")
        .closest("table")
        .find("tr:first")
        .next()
        .find("td:first")
        .each((idx, td) => {
        role.name = $(td).text();
    })
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        role.level = parseInt(s);
    })
        .next()
        .each((idx, td) => {
        role.attribute = $(td).text();
    })
        .next()
        .each((idx, td) => {
        role.career = $(td).text();
    })
        .parent()
        .next()
        .find("td:first")
        .next()
        .each((idx, td) => {
        let s = $(td).text();
        s = StringUtils_1.default.substringBefore(s, " GOLD");
        role.cash = parseInt(s);
    });
    const equipmentList = [];
    $(html)
        .find("input:submit[value='物品卖出']")
        .closest("table")
        .find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const c2 = c1.next();
        const c3 = c2.next();
        const c4 = c3.next();
        const c5 = c4.next();
        const c6 = c5.next();
        const c7 = c6.next();
        const equipment = new Equipment_1.default();
        equipment.index = parseInt($(radio).val());
        equipment.selectable = !$(radio).prop("disabled");
        equipment.using = c1.text() === "★";
        equipment.parseName(c2.html());
        equipment.category = c3.text();
        equipment.power = parseInt(c4.text());
        equipment.weight = parseInt(c5.text());
        equipment.parseEndure(c6.text());
        equipment.parsePrice(c7.html());
        equipmentList.push(equipment);
    });
    const merchandiseList = [];
    const table = $(html).find("input:radio:last")
        .closest("table");
    table.find("tr").each(function (_idx, tr) {
        const c1 = $(tr).find(":first-child");
        const radio = c1.find("input:radio:first");
        if (radio.length > 0) {
            const merchandise = new Merchandise_1.default();
            merchandise.id = "ITE_" + $(radio).val();
            merchandise.category = "物品";
            const c2 = c1.next();
            const c3 = c2.next();
            const c4 = c3.next();
            const c5 = c4.next();
            const c6 = c5.next();
            const c7 = c6.next();
            merchandise.name = c2.text();
            merchandise.nameHtml = c2.html();
            let s = c3.text();
            s = StringUtils_1.default.substringBefore(s, " Gold");
            merchandise.price = parseInt(s);
            merchandise.power = parseInt(c4.text());
            merchandise.weight = parseInt(c5.text());
            merchandise.endure = parseInt(c6.text());
            merchandise.attribute = c7.text();
            merchandise.speciality = false;
            merchandiseList.push(merchandise);
        }
    });
    const page = new TownItemHousePage_1.default();
    page.townId = townId;
    page.discount = discount;
    page.role = role;
    page.equipmentList = equipmentList;
    page.merchandiseList = merchandiseList;
    return page;
}
module.exports = TownItemHouse;


/***/ }),
/* 198 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const TownLoader_1 = __importDefault(__webpack_require__(34));
class TownItemHousePage {
    get town() {
        return TownLoader_1.default.getTownById(this.townId);
    }
    findEquipment(index) {
        for (const equipment of this.equipmentList) {
            if (equipment.index === index) {
                return equipment;
            }
        }
        return null;
    }
    findMerchandise(index) {
        for (const merchandise of this.merchandiseList) {
            if (merchandise.index === index) {
                return merchandise;
            }
        }
        return null;
    }
}
module.exports = TownItemHousePage;


/***/ }),
/* 199 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownPetMapHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownPetMapHousePageProcessor_1 = __importDefault(__webpack_require__(200));
const PageProcessorContext_1 = __importDefault(__webpack_require__(30));
class TownPetMapHousePageInterceptor {
    constructor() {
        _TownPetMapHousePageInterceptor_processor.set(this, new TownPetMapHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("* 宠物图鉴 *");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(townId => {
            const context = new PageProcessorContext_1.default();
            context.set("townId", townId);
            __classPrivateFieldGet(this, _TownPetMapHousePageInterceptor_processor, "f").process(context);
        })
            .fork();
    }
}
_TownPetMapHousePageInterceptor_processor = new WeakMap();
module.exports = TownPetMapHousePageInterceptor;


/***/ }),
/* 200 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownPetMapHousePageProcessor_instances, _TownPetMapHousePageProcessor_renderImmutablePage, _TownPetMapHousePageProcessor_bindSearchButton, _TownPetMapHousePageProcessor_searchPetMap;
const FastLogin_1 = __importDefault(__webpack_require__(56));
const PetMap_1 = __importDefault(__webpack_require__(13));
const FastLoginLoader_1 = __importDefault(__webpack_require__(55));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const TownPetMapHouse_1 = __importDefault(__webpack_require__(12));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StorageUtils_1 = __importDefault(__webpack_require__(5));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownPetMapHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super(...arguments);
        _TownPetMapHousePageProcessor_instances.add(this);
    }
    doProcess(credential, context) {
        const page = TownPetMapHouse_1.default.parsePage(PageUtils_1.default.currentPageHtml());
        __classPrivateFieldGet(this, _TownPetMapHousePageProcessor_instances, "m", _TownPetMapHousePageProcessor_renderImmutablePage).call(this, credential, page, context);
    }
}
_TownPetMapHousePageProcessor_instances = new WeakSet(), _TownPetMapHousePageProcessor_renderImmutablePage = function _TownPetMapHousePageProcessor_renderImmutablePage(credential, page, context) {
    let html = $("body:first").html();
    html = html.replace("\n\n\n收集图鉴一览：\n", "");
    $("body:first").html(html);
    // 删除所有的表单
    $("form").remove();
    $("input:hidden").remove();
    $("td:first")
        .attr("id", "pageTitle")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("bgcolor")
        .css("text-align", "center")
        .css("font-size", "180%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  宠 物 图 鉴  ＞＞")
        .parent()
        .attr("id", "tr0")
        .next()
        .attr("id", "tr1")
        .find("td:first")
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .css("color", "white")
        .next()
        .attr("id", "messageBoardManager");
    $("#tr1")
        .next()
        .attr("id", "tr2")
        .css("display", "none")
        .html("<td id='returnFormContainer'></td>");
    $("#returnFormContainer").html(PageUtils_1.default.generateReturnTownForm(credential));
    $("#tr2")
        .after("<tr id='tr3'><td id='pageMenuContainer' style='text-align:center'></td></tr>");
    let returnTitle = "返回城市";
    const townId = context === null || context === void 0 ? void 0 : context.get("townId");
    if (townId !== undefined) {
        const town = TownLoader_1.default.getTownById(townId);
        returnTitle = "返回" + town.name;
    }
    html = "";
    html += "<input type='text' id='petCode' size='10' maxlength='10'>";
    html += "<button role='button' id='searchButton'>查找图鉴</button>";
    html += "<button role='button' id='returnButton'>" + returnTitle + "</button>";
    $("#pageMenuContainer").html(html);
    __classPrivateFieldGet(this, _TownPetMapHousePageProcessor_instances, "m", _TownPetMapHousePageProcessor_bindSearchButton).call(this, credential);
    $("#returnButton").on("click", () => {
        $("#returnTown").trigger("click");
    });
    const petMapText = page.asText();
    if (petMapText !== "") {
        let html = $("#messageBoard").html();
        html += "<br>" + petMapText;
        $("#messageBoard").html(html);
    }
    StorageUtils_1.default.set("_pm_" + credential.id, petMapText);
    MessageBoard_1.default.publishMessage("宠物图鉴信息已存储。");
    $("table:eq(2)")
        .attr("id", "t1")
        .css("width", "100%");
}, _TownPetMapHousePageProcessor_bindSearchButton = function _TownPetMapHousePageProcessor_bindSearchButton(credential) {
    $("#searchButton").on("click", () => {
        const petCode = $("#petCode").val();
        if (petCode === undefined || petCode.trim() === "") {
            MessageBoard_1.default.publishWarning("请输入正确的宠物图鉴编号！");
            PageUtils_1.default.scrollIntoView("pageTitle");
            return;
        }
        const configList = [];
        for (let i = 0; i < 10; i++) {
            const config = FastLoginLoader_1.default.loadFastLogin(i);
            if (config === null) {
                continue;
            }
            configList.push(config);
        }
        let foundSelf = false;
        for (const config of configList) {
            if (config.id === credential.id) {
                foundSelf = true;
                break;
            }
        }
        if (foundSelf) {
            __classPrivateFieldGet(this, _TownPetMapHousePageProcessor_instances, "m", _TownPetMapHousePageProcessor_searchPetMap).call(this, petCode.trim(), configList);
        }
        else {
            new PersonalStatus_1.default(credential).load().then(role => {
                const config = new FastLogin_1.default();
                config.name = role.name;
                config.id = credential.id;
                configList.push(config);
                __classPrivateFieldGet(this, _TownPetMapHousePageProcessor_instances, "m", _TownPetMapHousePageProcessor_searchPetMap).call(this, petCode.trim(), configList);
            });
        }
    });
}, _TownPetMapHousePageProcessor_searchPetMap = function _TownPetMapHousePageProcessor_searchPetMap(petCode, configList) {
    const foundList = [];
    for (const config of configList) {
        const key = "_pm_" + config.id;
        const petMapText = StorageUtils_1.default.getString(key);
        if (petMapText !== "") {
            for (const it of petMapText.split(" ")) {
                const code = StringUtils_1.default.substringBeforeSlash(it);
                if (code === petCode) {
                    const count = parseInt(StringUtils_1.default.substringAfterSlash(it));
                    foundList.push(config.name + "/" + code + "/" + count);
                    break;
                }
            }
        }
    }
    if (foundList.length === 0) {
        MessageBoard_1.default.publishWarning("没有找到图鉴" + petCode + "的信息！");
        PageUtils_1.default.scrollIntoView("pageTitle");
        $("#t1").find("tbody:first").html("");
        return;
    }
    const petMap = new PetMap_1.default();
    petMap.code = petCode;
    petMap.picture = petCode + ".png";
    let html = "";
    html += "<tr>";
    html += "<td>";
    html += petMap.imageHtml;
    html += "</td>";
    html += "<td style='width:100%;text-align:center'>";
    html += "<table style='margin:auto;border-width:0;text-align:center;background-color:#888888'>";
    html += "<tbody>";
    html += "<tr>";
    html += "<th style='background-color:#F8F0E0'>持有人</th>";
    html += "<th style='background-color:#F8F0E0'>数量</th>";
    html += "</tr>";
    for (const found of foundList) {
        const ss = found.split("/");
        html += "<tr>";
        html += "<td style='background-color:#E8E8D0'>" + ss[0] + "</td>";
        html += "<td style='background-color:#E8E8B0'>" + ss[2] + "</td>";
        html += "</tr>";
    }
    html += "</tbody>";
    html += "</table>";
    html += "</td>";
    html += "</tr>";
    $("#t1").find("tbody:first").html(html);
};
module.exports = TownPetMapHousePageProcessor;


/***/ }),
/* 201 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownPetRankHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownPetRankHousePageProcessor_1 = __importDefault(__webpack_require__(202));
class TownPetRankHousePageInterceptor {
    constructor() {
        _TownPetRankHousePageInterceptor_processor.set(this, new TownPetRankHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("＜＜ * 宠物资料馆 *＞＞");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _TownPetRankHousePageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_TownPetRankHousePageInterceptor_processor = new WeakMap();
module.exports = TownPetRankHousePageInterceptor;


/***/ }),
/* 202 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const PetProfileLoader_1 = __importDefault(__webpack_require__(104));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownPetRankHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    doLoadButtonStyles() {
        return [89];
    }
    doProcess(credential, context) {
        doProcess(credential);
    }
}
function doProcess(credential) {
    const t0 = $("table:first");
    const t1 = $("table:eq(1)");
    t1.find("td:first")
        .attr("id", "title_cell")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("bgcolor")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  宠 物 排 行 榜  ＞＞");
    t0.find("tr:first")
        .next()
        .find("table:first")
        .find("tr:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .removeAttr("width")
        .removeAttr("bgcolor")
        .css("width", "100%")
        .css("background-color", "black")
        .css("color", "white")
        .html("全新宠物排行榜，帮助您更好了解口袋的宠物。<br>" +
        "目前宠物初始值和族值的关系是我们推测的，不一定准确。等白猫如果有反馈再修正。")
        .next()
        .attr("id", "messageBoardManager");
    // 删除老页面的内容
    t0.next().remove();
    $("form").remove();
    // 绘制新的页面架构
    let html = "";
    html += "<tr style='display:none'>";
    html += "<td id='hidden_form_cell'></td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' id='return_button' value='离开宠物排行榜'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' class='button-89' id='total_base_stats_rank' value='族值ＴＯＰ３０'>";
    html += "<input type='button' class='button-89' id='health_rank' value='生命ＴＯＰ３０'>";
    html += "<input type='button' class='button-89' id='attack_rank' value='攻击ＴＯＰ３０'>";
    html += "<input type='button' class='button-89' id='defense_rank' value='防御ＴＯＰ３０'>";
    html += "<input type='button' class='button-89' id='special_attack_rank' value='智力ＴＯＰ３０'>";
    html += "<input type='button' class='button-89' id='special_defense_rank' value='精神ＴＯＰ３０'>";
    html += "<input type='button' class='button-89' id='speed_rank' value='速度ＴＯＰ３０'>";
    html += "<input type='button' class='button-89' id='capacity_rank' value='能力ＴＯＰ３０'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' class='button-89' id='r_total_base_stats_rank' value='族值垫底的３０'>";
    html += "<input type='button' class='button-89' id='r_health_rank' value='生命垫底的３０'>";
    html += "<input type='button' class='button-89' id='r_attack_rank' value='攻击垫底的３０'>";
    html += "<input type='button' class='button-89' id='r_defense_rank' value='防御垫底的３０'>";
    html += "<input type='button' class='button-89' id='r_special_attack_rank' value='智力垫底的３０'>";
    html += "<input type='button' class='button-89' id='r_special_defense_rank' value='精神垫底的３０'>";
    html += "<input type='button' class='button-89' id='r_speed_rank' value='速度垫底的３０'>";
    html += "<input type='button' class='button-89' id='r_capacity_rank' value='能力垫底的３０'>";
    html += "</td>";
    html += "</tr>";
    html += "<tr style='display:none'>";
    html += "<td id='pet_rank_cell'></td>";
    html += "</tr>";
    t0.find("tr:first").next().after($(html));
    doGenerateHiddenForm(credential);
    doBindReturnButton();
    doBindRankButton();
}
function doGenerateHiddenForm(credential) {
    let html = "";
    // noinspection HtmlUnknownTarget
    html += "<form action='status.cgi' method='post' id='return_form'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='mode' value='STATUS'>";
    html += "<input type='submit' id='return_submit'>";
    html += "</form>";
    $("#hidden_form_cell").html(html);
}
function doBindReturnButton() {
    $("#return_button").on("click", function () {
        $("#return_submit").trigger("click");
    });
}
function doBindRankButton() {
    $("#total_base_stats_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByTotalBaseStats(petList);
        doRender("族 值 排 行 榜", petList);
    });
    $("#r_total_base_stats_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByTotalBaseStats(petList, true);
        doRender("族 值 （垫 底） 排 行 榜", petList);
    });
    $("#health_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByHealth(petList);
        doRender("生 命 排 行 榜", petList);
    });
    $("#r_health_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByHealth(petList, true);
        doRender("生 命 （垫 底） 排 行 榜", petList);
    });
    $("#attack_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByAttack(petList);
        doRender("攻 击 排 行 榜", petList);
    });
    $("#r_attack_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByAttack(petList, true);
        doRender("攻 击 （垫 底） 排 行 榜", petList);
    });
    $("#defense_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByDefense(petList);
        doRender("防 御 排 行 榜", petList);
    });
    $("#r_defense_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByDefense(petList, true);
        doRender("防 御 （垫 底） 排 行 榜", petList);
    });
    $("#special_attack_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortBySpecialAttack(petList);
        doRender("智 力 排 行 榜", petList);
    });
    $("#r_special_attack_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortBySpecialAttack(petList, true);
        doRender("智 力 （垫 底） 排 行 榜", petList);
    });
    $("#special_defense_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortBySpecialDefense(petList);
        doRender("精 神 排 行 榜", petList);
    });
    $("#r_special_defense_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortBySpecialDefense(petList, true);
        doRender("精 神 （垫 底） 排 行 榜", petList);
    });
    $("#speed_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortBySpeed(petList);
        doRender("速 度 排 行 榜", petList);
    });
    $("#r_speed_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortBySpeed(petList, true);
        doRender("速 度 （垫 底） 排 行 榜", petList);
    });
    $("#capacity_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByCapacity(petList);
        doRender("能 力 排 行 榜", petList);
    });
    $("#r_capacity_rank").on("click", function () {
        let petList = PetProfileLoader_1.default.loadAll();
        petList = sortByCapacity(petList, true);
        doRender("能 力 （垫 底） 排 行 榜", petList);
    });
}
function doRender(title, petList) {
    let html = "";
    html += "<table style='border-width:0;background-color:#888888;margin:auto;width:100%'>";
    html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
    html += "<tr>";
    html += "<td style='background-color:darkred;color:wheat;font-weight:bold' colspan='20'>";
    html += "＜ " + title + " ＞";
    html += "</td>";
    html += "<tr>";
    html += "<th style='background-color:#E8E8D0'>排名</th>";
    html += "<th style='background-color:#E8E8D0'>形象</th>";
    html += "<th style='background-color:#EFE0C0'>名字</th>";
    html += "<th style='background-color:#E0D0B0'>总族值</th>";
    html += "<th style='background-color:#EFE0C0'>生命族值</th>";
    html += "<th style='background-color:#E0D0B0'>攻击族值</th>";
    html += "<th style='background-color:#E0D0B0'>防御族值</th>";
    html += "<th style='background-color:#EFE0C0'>智力族值</th>";
    html += "<th style='background-color:#EFE0C0'>精神族值</th>";
    html += "<th style='background-color:#E0D0B0'>速度族值</th>";
    html += "<th style='background-color:#E0D0B0'>总努力</th>";
    html += "<th style='background-color:#EFE0C0'>生命努力</th>";
    html += "<th style='background-color:#E0D0B0'>攻击努力</th>";
    html += "<th style='background-color:#E0D0B0'>防御努力</th>";
    html += "<th style='background-color:#EFE0C0'>智力努力</th>";
    html += "<th style='background-color:#EFE0C0'>精神努力</th>";
    html += "<th style='background-color:#E0D0B0'>速度努力</th>";
    html += "<th style='background-color:#EFE0C0'>捕获率</th>";
    html += "<th style='background-color:#EFE0C0'>成长经验</th>";
    html += "<th style='background-color:#E8E8D0'>最大能力</th>";
    html += "</tr>";
    for (let i = 0; i < 30; i++) {
        const pet = petList[i];
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>" + (i + 1) + "</th>";
        html += "<td style='background-color:#E8E8D0'>";
        html += pet.imageHtml;
        html += "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.name + "</td>";
        html += "<td style='background-color:#E0D0B0;font-weight:bold;color:blue'>" + pet.totalBaseStats + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.healthBaseStats + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + pet.attackBaseStats + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + pet.defenseBaseStats + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.specialAttackBaseStats + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.specialDefenseBaseStats + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + pet.speedBaseStats + "</td>";
        html += "<td style='background-color:#E0D0B0;font-weight:bold;color:green'>" + pet.totalEffort + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.healthEffort + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + pet.attackEffort + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + pet.defenseEffort + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.specialAttackEffort + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.specialDefenseEffort + "</td>";
        html += "<td style='background-color:#E0D0B0'>" + pet.speedEffort + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.catchRatio + "</td>";
        html += "<td style='background-color:#EFE0C0'>" + pet.growExperience + "</td>";
        html += "<td style='background-color:#E8E8D0'>" + pet.perfectCapacity + "</td>";
        html += "</tr>";
    }
    html += "</tbody>";
    html += "</table>";
    $("#pet_rank_cell").html(html).parent().show();
}
function sortByTotalBaseStats(petList, reverse) {
    const result = [];
    result.push(...petList);
    if (reverse) {
        result.sort((a, b) => {
            let ret = a.totalBaseStats - b.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            ret = a.totalEffort - b.totalEffort;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    else {
        result.sort((a, b) => {
            let ret = b.totalBaseStats - a.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            ret = b.totalEffort - a.totalEffort;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    return result;
}
function sortByHealth(petList, reverse) {
    const result = [];
    result.push(...petList);
    if (reverse) {
        result.sort((a, b) => {
            let ret = a.perfectHealth - b.perfectHealth;
            if (ret !== 0) {
                return ret;
            }
            ret = a.totalBaseStats - b.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    else {
        result.sort((a, b) => {
            let ret = b.perfectHealth - a.perfectHealth;
            if (ret !== 0) {
                return ret;
            }
            ret = b.totalBaseStats - a.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    return result;
}
function sortByAttack(petList, reverse) {
    const result = [];
    result.push(...petList);
    if (reverse) {
        result.sort((a, b) => {
            let ret = a.perfectAttack - b.perfectAttack;
            if (ret !== 0) {
                return ret;
            }
            ret = a.totalBaseStats - b.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    else {
        result.sort((a, b) => {
            let ret = b.perfectAttack - a.perfectAttack;
            if (ret !== 0) {
                return ret;
            }
            ret = b.totalBaseStats - a.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    return result;
}
function sortByDefense(petList, reverse) {
    const result = [];
    result.push(...petList);
    if (reverse) {
        result.sort((a, b) => {
            let ret = a.perfectDefense - b.perfectDefense;
            if (ret !== 0) {
                return ret;
            }
            ret = a.totalBaseStats - b.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    else {
        result.sort((a, b) => {
            let ret = b.perfectDefense - a.perfectDefense;
            if (ret !== 0) {
                return ret;
            }
            ret = b.totalBaseStats - a.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    return result;
}
function sortBySpecialAttack(petList, reverse) {
    const result = [];
    result.push(...petList);
    if (reverse) {
        result.sort((a, b) => {
            let ret = a.perfectSpecialAttack - b.perfectSpecialAttack;
            if (ret !== 0) {
                return ret;
            }
            ret = a.totalBaseStats - b.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    else {
        result.sort((a, b) => {
            let ret = b.perfectSpecialAttack - a.perfectSpecialAttack;
            if (ret !== 0) {
                return ret;
            }
            ret = b.totalBaseStats - a.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    return result;
}
function sortBySpecialDefense(petList, reverse) {
    const result = [];
    result.push(...petList);
    if (reverse) {
        result.sort((a, b) => {
            let ret = a.perfectSpecialDefense - b.perfectSpecialDefense;
            if (ret !== 0) {
                return ret;
            }
            ret = a.totalBaseStats - b.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    else {
        result.sort((a, b) => {
            let ret = b.perfectSpecialDefense - a.perfectSpecialDefense;
            if (ret !== 0) {
                return ret;
            }
            ret = b.totalBaseStats - a.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    return result;
}
function sortBySpeed(petList, reverse) {
    const result = [];
    result.push(...petList);
    if (reverse) {
        result.sort((a, b) => {
            let ret = a.perfectSpeed - b.perfectSpeed;
            if (ret !== 0) {
                return ret;
            }
            ret = a.totalBaseStats - b.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    else {
        result.sort((a, b) => {
            let ret = b.perfectSpeed - a.perfectSpeed;
            if (ret !== 0) {
                return ret;
            }
            ret = b.totalBaseStats - a.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    return result;
}
function sortByCapacity(petList, reverse) {
    const result = [];
    result.push(...petList);
    if (reverse) {
        result.sort((a, b) => {
            let ret = a.perfectCapacity - b.perfectCapacity;
            if (ret !== 0) {
                return ret;
            }
            ret = a.totalBaseStats - b.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    else {
        result.sort((a, b) => {
            let ret = b.perfectCapacity - a.perfectCapacity;
            if (ret !== 0) {
                return ret;
            }
            ret = b.totalBaseStats - a.totalBaseStats;
            if (ret !== 0) {
                return ret;
            }
            return a.code.localeCompare(b.code);
        });
    }
    return result;
}
module.exports = TownPetRankHousePageProcessor;


/***/ }),
/* 203 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownPostHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownPostHousePageProcessor_1 = __importDefault(__webpack_require__(204));
class TownPostHousePageInterceptor {
    constructor() {
        _TownPostHousePageInterceptor_processor.set(this, new TownPostHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("* 宿 屋 *");
        }
        return false;
    }
    intercept() {
        LocationStateMachine_1.default.create()
            .load()
            .whenInTown(() => {
            __classPrivateFieldGet(this, _TownPostHousePageInterceptor_processor, "f").process();
        })
            .fork();
    }
}
_TownPostHousePageInterceptor_processor = new WeakMap();
module.exports = TownPostHousePageInterceptor;


/***/ }),
/* 204 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const Castle_1 = __importDefault(__webpack_require__(49));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const CastleEntrance_1 = __importDefault(__webpack_require__(38));
const MapBuilder_1 = __importDefault(__webpack_require__(41));
const TownEntrance_1 = __importDefault(__webpack_require__(45));
const TravelPlanExecutor_1 = __importDefault(__webpack_require__(47));
const CastleInformation_1 = __importDefault(__webpack_require__(63));
const PersonalStatus_1 = __importDefault(__webpack_require__(48));
const TownBank_1 = __importDefault(__webpack_require__(51));
const Coordinate_1 = __importDefault(__webpack_require__(7));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
class TownPostHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super();
    }
    doProcess(credential, context) {
        doProcess(credential);
    }
}
function doProcess(credential) {
    // 记录原有表单上的住宿费用
    const lodgeExpense = $("input:hidden[name='inn_gold']").val();
    const t1 = $("table:eq(1)");
    const t4 = $("table:eq(4)");
    const t5 = $("table:eq(5)");
    // 修改标题
    let td = $(t1).find("tr:first td:first");
    $(td).removeAttr("bgcolor");
    $(td).removeAttr("width");
    $(td).removeAttr("height");
    $(td).css("text-align", "center");
    $(td).css("font-size", "150%");
    $(td).css("font-weight", "bold");
    $(td).css("background-color", "navy");
    $(td).css("color", "yellowgreen");
    $(td).attr("id", "title");
    $(td).text("＜＜  宿 屋 & 驿 站  ＞＞");
    // 标记现金栏、增加坐标栏和计时器
    const player = $(t4).find("tr:eq(1) td:first").text();
    let tr = $(t4).find("tr:last");
    td = $(tr).find("td:last");
    $(td).attr("id", "roleCash");
    $(tr).after($("<tr>" +
        "<td style='background-color:#E0D0B0'>坐标点</td>" +
        "<td style='background-color:#E8E8D0;text-align:right' id='roleLocation' colspan='3'>-</td>" +
        "</tr>" +
        "<tr>" +
        "<td style='background-color:#E0D0B0'>计时器</td>" +
        "<td style='background-color:#E8E8D0;color:red;font-weight:bold;text-align:right' id='countDownTimer' colspan='3'>-</td>" +
        "</tr>"));
    // 创建消息面板
    td = $(t5).find("tr:first td:first");
    $(td).attr("id", "messageBoard");
    $(td).css("color", "white");
    // 增加扩展驿站面板
    tr = $(t1).find("tr:last");
    $(tr).find("td:first")
        .removeAttr("bgcolor")
        .removeAttr("align")
        .css("background-color", "#F8F0E0")
        .css("text-align", "center")
        .attr("id", "menu");
    $(tr).after($("" +
        "<tr style='display:none'>" +
        "<td id='eden'>" +
        "</td>" +
        "</tr>" +
        "<tr style='display:none'>" +
        "<td id='map' style='background-color:#F8F0E0;text-align:center'>" +
        "</td>" +
        "</tr>"));
    doRenderEden(credential, parseInt(lodgeExpense));
    doRenderMenu();
    doRenderMap(credential, player);
}
function doRenderEden(credential, lodgeExpense) {
    let html = "";
    // noinspection HtmlUnknownTarget
    html += "<form action='town.cgi' method='post' id='lodgeForm'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='inn_gold' value='" + lodgeExpense + "'>";
    html += "<input type='hidden' name='mode' value='RECOVERY'>";
    html += "<input type='submit' id='lodgeSubmit'>";
    html += "</form>";
    // noinspection HtmlUnknownTarget
    html += "<form action='status.cgi' method='post' id='returnForm'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='mode' value='STATUS'>";
    html += "<input type='submit' id='returnSubmit'>";
    html += "</form>";
    $("#eden").html(html);
}
function doRenderMenu() {
    $("#menu").html("" +
        "<input type='button' id='lodgeButton' value='宿泊'>" +
        "<input type='button' id='returnButton' value='返回城市'>");
    $("#lodgeButton").on("click", function () {
        $("#lodgeSubmit").trigger("click");
    });
    $("#returnButton").on("click", function () {
        $("#returnSubmit").trigger("click");
    });
}
function doRenderMap(credential, player) {
    const html = MapBuilder_1.default.buildMapTable();
    $("#map").html(html);
    MapBuilder_1.default.updateTownBackgroundColor();
    new PersonalStatus_1.default(credential).load().then((role) => {
        const town = role.town;
        const buttonId = "location_" + town.coordinate.x + "_" + town.coordinate.y;
        $("#" + buttonId)
            .closest("td")
            .css("background-color", "black")
            .css("color", "yellow")
            .css("text-align", "center")
            .html($("#" + buttonId).val());
        $(".location_button_class")
            .on("mouseenter", function () {
            $(this).css("background-color", "red");
        })
            .on("mouseleave", function () {
            const s = $(this).parent().attr("class");
            const c = StringUtils_1.default.substringAfter(s, "_");
            if (c !== "none") {
                $(this).css("background-color", c);
            }
            else {
                $(this).removeAttr("style");
            }
        });
        // 显示地图
        $("#map").parent().show();
        // 如果有必要的话绘制城堡
        new CastleInformation_1.default().load(player).then(castle => {
            const coordinate = castle.coordinate;
            const buttonId = "location_" + coordinate.x + "_" + coordinate.y;
            $("#" + buttonId)
                .attr("value", "堡")
                .css("background-color", "fuchsia")
                .parent()
                .attr("title", "城堡" + coordinate.asText() + " " + castle.name)
                .attr("class", "color_fuchsia");
        });
        // 绑定地图按钮事件
        doBindMapButton(credential);
    });
}
function doBindMapButton(credential) {
    $(".location_button_class").on("click", function () {
        var _a;
        const title = $(this).parent().attr("title");
        const ss = $(this).attr("id").split("_");
        const x = parseInt(ss[1]);
        const y = parseInt(ss[2]);
        const coordinate = new Coordinate_1.default(x, y);
        let townName = "";
        let castleName = "";
        let confirmation;
        if (title.startsWith("城市")) {
            townName = StringUtils_1.default.substringAfterLast(title, " ");
            confirmation = confirm("确认移动到" + townName + "？");
        }
        else if (title.startsWith("城堡")) {
            castleName = StringUtils_1.default.substringAfterLast(title, " ");
            confirmation = confirm("确认回到" + castleName + "？");
        }
        else {
            confirmation = confirm("确认移动到坐标" + coordinate.asText() + "？");
        }
        if (!confirmation) {
            return;
        }
        // 准备切换到移动模式
        (_a = document.getElementById("title")) === null || _a === void 0 ? void 0 : _a.scrollIntoView();
        MessageBoard_1.default.resetMessageBoard("我们将实时为你播报旅途的动态：<br>");
        $("#lodgeButton")
            .prop("disabled", true)
            .hide();
        $("#returnButton")
            .prop("disabled", true)
            .val("旅途中请耐心等候......");
        $(".location_button_class")
            .prop("disabled", true)
            .off("mouseenter")
            .off("mouseleave");
        if (townName !== "") {
            const town = TownLoader_1.default.getTownByCoordinate(coordinate);
            doTravelToTown(credential, town);
        }
        else if (castleName !== "") {
            const castle = new Castle_1.default();
            castle.name = castleName;
            castle.coordinate = coordinate;
            doTravelToCastle(credential, castle);
        }
        else {
            doTravelToLocation(credential, coordinate);
        }
    });
}
function doTravelToTown(credential, town) {
    MessageBoard_1.default.publishMessage("目的地城市：<span style='color:greenyellow'>" + town.name + "</span>");
    MessageBoard_1.default.publishMessage("目的地坐标：<span style='color:greenyellow'>" + town.coordinate.asText() + "</span>");
    const bank = new TownBank_1.default(credential);
    // 支取10万城门税
    bank.withdraw(10).then(() => {
        // 更新现金栏
        bank.load().then(account => {
            $("#roleCash").text(account.cash + " GOLD");
        });
        const entrance = new TownEntrance_1.default(credential);
        // 离开当前城市
        entrance.leave()
            .then(plan => {
            plan.destination = town.coordinate;
            const executor = new TravelPlanExecutor_1.default(plan);
            // 执行旅途计划
            executor.execute()
                .then(() => {
                // 进入目标城市
                entrance.enter(town.id)
                    .then(() => {
                    // 把身上现金全部存入
                    bank.deposit().then(() => {
                        // 更新现金栏
                        bank.load().then(account => {
                            $("#roleCash").text(account.cash + " GOLD");
                        });
                        MessageBoard_1.default.publishMessage("旅途愉快，下次再见。");
                        $("#returnButton").val(town.name + "欢迎您");
                        $("#returnButton").prop("disabled", false);
                    });
                });
            });
        });
    });
}
function doTravelToCastle(credential, castle) {
    MessageBoard_1.default.publishMessage("目的地城堡：<span style='color:greenyellow'>" + castle.name + "</span>");
    MessageBoard_1.default.publishMessage("目的地坐标：<span style='color:greenyellow'>" + castle.coordinate.asText() + "</span>");
    const entrance = new TownEntrance_1.default(credential);
    entrance.leave()
        .then(plan => {
        plan.destination = castle.coordinate;
        const executor = new TravelPlanExecutor_1.default(plan);
        executor.execute()
            .then(() => {
            const entrance = new CastleEntrance_1.default(credential);
            entrance.enter()
                .then(() => {
                $("#returnForm")
                    .attr("action", "castlestatus.cgi")
                    .find("input:hidden[value='STATUS']")
                    .val("CASTLESTATUS");
                MessageBoard_1.default.publishMessage("旅途愉快，下次再见。");
                $("#returnButton")
                    .prop("disabled", false)
                    .val("欢迎您回到" + castle.name);
            });
        });
    });
}
function doTravelToLocation(credential, location) {
    MessageBoard_1.default.publishMessage("目的地坐标：<span style='color:greenyellow'>" + location.asText() + "</span>");
    new TownEntrance_1.default(credential).leave()
        .then(plan => {
        plan.destination = location;
        const executor = new TravelPlanExecutor_1.default(plan);
        executor.execute()
            .then(() => {
            MessageBoard_1.default.publishMessage("旅途愉快，下次再见。");
            $("#returnButton")
                .prop("disabled", false)
                .val("到达了目的地" + location.asText());
        });
    });
}
module.exports = TownPostHousePageProcessor;


/***/ }),
/* 205 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownWeaponHousePageInterceptor_processor;
const LocationStateMachine_1 = __importDefault(__webpack_require__(4));
const TownWeaponHousePageProcessor_1 = __importDefault(__webpack_require__(206));
const PageProcessorContext_1 = __importDefault(__webpack_require__(30));
const SetupLoader_1 = __importDefault(__webpack_require__(19));
class TownWeaponHousePageInterceptor {
    constructor() {
        _TownWeaponHousePageInterceptor_processor.set(this, new TownWeaponHousePageProcessor_1.default());
    }
    accept(cgi, pageText) {
        if (cgi === "town.cgi") {
            return pageText.includes("＜＜　□　武器屋　□　＞＞");
        }
        return false;
    }
    intercept() {
        if (SetupLoader_1.default.isPocketSuperMarketEnabled()) {
            LocationStateMachine_1.default.create()
                .load()
                .whenInTown(townId => {
                const context = new PageProcessorContext_1.default();
                context.set("townId", townId);
                __classPrivateFieldGet(this, _TownWeaponHousePageInterceptor_processor, "f").process(context);
            })
                .fork();
        }
    }
}
_TownWeaponHousePageInterceptor_processor = new WeakMap();
module.exports = TownWeaponHousePageInterceptor;


/***/ }),
/* 206 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const NpcLoader_1 = __importDefault(__webpack_require__(9));
const TownLoader_1 = __importDefault(__webpack_require__(34));
const TownBank_1 = __importDefault(__webpack_require__(51));
const TownWeaponHouse_1 = __importDefault(__webpack_require__(207));
const BankUtils_1 = __importDefault(__webpack_require__(28));
const Constants_1 = __importDefault(__webpack_require__(10));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const PageProcessorCredentialSupport_1 = __importDefault(__webpack_require__(23));
/**
 * @deprecated
 */
class TownWeaponHousePageProcessor extends PageProcessorCredentialSupport_1.default {
    constructor() {
        super();
    }
    doProcess(credential, context) {
        processPage(context.get("townId"));
    }
}
function processPage(townId) {
    const page = TownWeaponHouse_1.default.parsePage(PageUtils_1.default.currentPageHtml());
    const town = TownLoader_1.default.getTownById(townId);
    // 重新绘制页面框架
    const t1 = $("table:eq(1)");
    t1.find("td:first")
        .attr("id", "title_cell")
        .removeAttr("width")
        .removeAttr("height")
        .removeAttr("bgcolor")
        .css("text-align", "center")
        .css("font-size", "150%")
        .css("font-weight", "bold")
        .css("background-color", "navy")
        .css("color", "yellowgreen")
        .text("＜＜  " + town.nameTitle + " 武 器 屋  ＞＞")
        .parent()
        .next()
        .find("table:first")
        .find("td:eq(1)")
        .find("table:first")
        .find("td:last")
        .attr("id", "roleCash");
    // 删除原有页面所有的表单
    $("form").remove();
    // 消息面板
    t1.find("tr:first")
        .next()
        .next()
        .find("table:first")
        .find("td:first")
        .attr("id", "messageBoard")
        .css("color", "white")
        .html("倍“锋”来袭,特“利”独行。")
        .next()
        .attr("id", "messageBoardManager");
    // 清空原来的商品栏，保留行作为新的UI的位置
    t1.find("tr:first")
        .next()
        .next()
        .next()
        .html("<td id='weapon_store_UI' style='width:100%;background-color:#F8F0E0'></td>");
    // 绘制新的内容
    let html = "";
    html += "<table style='width:100%;border-width:0;background-color:#888888;margin:auto'>";
    html += "<tbody>";
    // ------------------------------------------------------------------------
    // 隐藏的表单
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='hidden_form_cell'></td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 主菜单
    // ------------------------------------------------------------------------
    html += "<tr>";
    html += "<td style='background-color:#F8F0E0;text-align:center'>";
    html += "<input type='button' id='refresh_button' value='刷新武器屋'>";
    html += "<input type='button' id='return_button' value='离开武器屋'>";
    html += "</td>";
    // ------------------------------------------------------------------------
    // 个人物品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='personal_equipment_list_cell'></td>";
    html += "</tr>";
    // ------------------------------------------------------------------------
    // 武器屋商品栏
    // ------------------------------------------------------------------------
    html += "<tr style='display:none'>";
    html += "<td id='weapon_merchandise_list_cell'></td>";
    html += "</tr>";
    html += "</tbody>";
    html += "</table>";
    $("#weapon_store_UI").html(html);
    doGenerateHiddenForm(page.credential);
    doBindReturnButton();
    doBindRefreshButton(page);
    doRender(page);
}
function doGenerateHiddenForm(credential) {
    let html = "";
    // noinspection HtmlUnknownTarget
    html += "<form action='status.cgi' method='post' id='return_form'>";
    html += "<input type='hidden' name='id' value='" + credential.id + "'>";
    html += "<input type='hidden' name='pass' value='" + credential.pass + "'>";
    html += "<input type='hidden' name='mode' value='STATUS'>";
    html += "<input type='submit' id='return_submit'>";
    html += "</form>";
    $("#hidden_form_cell").html(html);
}
function doBindReturnButton() {
    $("#return_button").on("click", function () {
        $("#return_submit").trigger("click");
    });
}
function doRefresh(page) {
    var _a;
    (_a = document.getElementById("title_cell")) === null || _a === void 0 ? void 0 : _a.scrollIntoView();
    $("#personal_equipment_list_cell").parent().hide();
    $("#weapon_merchandise_list_cell").parent().hide();
    $(".dynamic_button_class").off("click");
    new TownWeaponHouse_1.default(page.credential, page.townId).enter()
        .then(page => {
        const roleCash = page.roleCash;
        $("#roleCash").text(roleCash + " GOLD");
        doRender(page);
    });
}
function doBindRefreshButton(page) {
    $("#refresh_button").on("click", function () {
        $("#messageBoardManager").html(NpcLoader_1.default.randomNpcImageHtml());
        MessageBoard_1.default.resetMessageBoard("倍“锋”来袭,特“利”独行。");
        doRefresh(page);
    });
}
function doRender(page) {
    // ------------------------------------------------------------------------
    // 渲染随身装备
    // ------------------------------------------------------------------------
    const equipmentList = page.personalEquipmentList;
    if (equipmentList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;width:100%;background-color:#888888'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkred;color:wheat;font-weight:bold' colspan='12'>";
        html += "＜ 随 身 装 备 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>出售</th>";
        html += "<th style='background-color:#EFE0C0'>装备</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>种类</th>";
        html += "<th style='background-color:#E0D0B0'>效果</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>价值</th>";
        html += "</tr>";
        const indexList = [];
        for (const equipment of equipmentList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (equipment.isSellable) {
                html += "<img alt='出售' id='sell_" + equipment.index + "' " +
                    "class='dynamic_button_class' title='出售' " +
                    "src='" + (Constants_1.default.POCKET_DOMAIN + "/image/country/7.gif") + "'>";
                indexList.push(equipment.index);
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.usingHTML + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.nameHTML + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.category + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + equipment.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + equipment.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0;text-align:right'>" + equipment.priceHTML + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#personal_equipment_list_cell")
            .html(html)
            .parent()
            .show();
        doBindSellButton(page, indexList);
    }
    // ------------------------------------------------------------------------
    // 渲染武器店商品
    // ------------------------------------------------------------------------
    const merchandiseList = page.weaponMerchandiseList;
    if (merchandiseList.length > 0) {
        let html = "";
        html += "<table style='border-width:0;width:100%;background-color:#888888'>";
        html += "<tbody style='background-color:#F8F0E0;text-align:center'>";
        html += "<tr>";
        html += "<td style='background-color:darkgreen;color:wheat;font-weight:bold' colspan='16'>";
        html += "＜ 商 品 列 表 ＞";
        html += "</td>";
        html += "</tr>";
        html += "<tr>";
        html += "<th style='background-color:#E8E8D0'>数量</th>";
        html += "<th style='background-color:#E8E8D0'>购买</th>";
        html += "<th style='background-color:#EFE0C0'>特产</th>";
        html += "<th style='background-color:#E0D0B0'>名字</th>";
        html += "<th style='background-color:#EFE0C0'>价格</th>";
        html += "<th style='background-color:#E0D0B0'>威力</th>";
        html += "<th style='background-color:#EFE0C0'>重量</th>";
        html += "<th style='background-color:#EFE0C0'>耐久</th>";
        html += "<th style='background-color:#E0D0B0'>职业</th>";
        html += "<th style='background-color:#E0D0B0'>攻击</th>";
        html += "<th style='background-color:#E0D0B0'>防御</th>";
        html += "<th style='background-color:#E0D0B0'>智力</th>";
        html += "<th style='background-color:#E0D0B0'>精神</th>";
        html += "<th style='background-color:#E0D0B0'>速度</th>";
        html += "<th style='background-color:#E0D0B0'>类型</th>";
        html += "<th style='background-color:#E0D0B0'>宝石</th>";
        html += "</tr>";
        const indexList = [];
        for (const merchandise of merchandiseList) {
            html += "<tr>";
            html += "<td style='background-color:#E8E8D0'>";
            if (page.spaceCount > 0) {
                html += "<select id='count_" + merchandise.index + "'>";
                for (let i = 1; i <= page.spaceCount; i++) {
                    html += "<option value='" + i + "'>" + i + "</option>";
                }
                html += "</select>";
            }
            html += "</td>";
            html += "<td style='background-color:#E8E8D0'>";
            if (page.spaceCount > 0) {
                html += "<img alt='购买' id='buy_" + merchandise.index + "' " +
                    "class='dynamic_button_class' title='购买' " +
                    "src='" + (Constants_1.default.POCKET_DOMAIN + "/image/country/6.gif") + "'>";
                indexList.push(merchandise.index);
            }
            html += "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.specialityHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.nameHtml + "</td>";
            html += "<td style='background-color:#EFE0C0;text-align:right'>" + merchandise.priceHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.power + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.weight + "</td>";
            html += "<td style='background-color:#EFE0C0'>" + merchandise.endureHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredCareerHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpecialAttackHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpecialDefenseHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.requiredSpeedHtml + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.weaponCategory + "</td>";
            html += "<td style='background-color:#E0D0B0'>" + merchandise.gemCountHtml + "</td>";
            html += "</tr>";
        }
        html += "</tbody>";
        html += "</table>";
        $("#weapon_merchandise_list_cell")
            .html(html)
            .parent()
            .show();
        doBindBuyButton(page, indexList);
    }
}
function doBindSellButton(page, indexList) {
    for (const index of indexList) {
        const buttonId = "sell_" + index;
        $("#" + buttonId).on("click", function () {
            const equipment = page.findEquipment(index);
            if (!confirm("确认要出售“" + equipment.fullName + "”？")) {
                return;
            }
            new TownWeaponHouse_1.default(page.credential, page.townId)
                .sell(index, page.discount)
                .then(() => {
                new TownBank_1.default(page.credential).deposit().then(() => {
                    doRefresh(page);
                });
            });
        });
    }
}
function doBindBuyButton(page, indexList) {
    for (const index of indexList) {
        const buttonId = "buy_" + index;
        $("#" + buttonId).on("click", function () {
            const count = parseInt($("#count_" + index).val());
            const merchandise = page.findMerchandise(index);
            const totalPrice = merchandise.price * count;
            const amount = BankUtils_1.default.calculateCashDifferenceAmount(page.roleCash, totalPrice);
            if (!confirm("确认要购买" + count + "把“" + merchandise.name + "”？大约需要再支取" + amount + "万GOLD。")) {
                return;
            }
            const bank = new TownBank_1.default(page.credential);
            bank.withdraw(amount).then(() => {
                new TownWeaponHouse_1.default(page.credential, page.townId)
                    .buy(index, count, page.discount)
                    .then(() => {
                    bank.deposit().then(() => {
                        doRefresh(page);
                    });
                });
            })
                .catch(() => {
                // Nothing changed, ignore.
            });
        });
    }
}
module.exports = TownWeaponHousePageProcessor;


/***/ }),
/* 207 */
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {


var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {
    if (kind === "m") throw new TypeError("Private method is not writable");
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
    return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
};
var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _TownWeaponHouse_credential, _TownWeaponHouse_townId;
const Equipment_1 = __importDefault(__webpack_require__(78));
const Merchandise_1 = __importDefault(__webpack_require__(172));
const MessageBoard_1 = __importDefault(__webpack_require__(16));
const NetworkUtils_1 = __importDefault(__webpack_require__(15));
const PageUtils_1 = __importDefault(__webpack_require__(21));
const StringUtils_1 = __importDefault(__webpack_require__(1));
const TownWeaponHousePage_1 = __importDefault(__webpack_require__(208));
class TownWeaponHouse {
    constructor(credential, townId) {
        _TownWeaponHouse_credential.set(this, void 0);
        _TownWeaponHouse_townId.set(this, void 0);
        __classPrivateFieldSet(this, _TownWeaponHouse_credential, credential, "f");
        __classPrivateFieldSet(this, _TownWeaponHouse_townId, townId, "f");
    }
    static parsePage(pageHtml) {
        // Parse credential and townId
        const credential = PageUtils_1.default.parseCredential(pageHtml);
        const townId = $(pageHtml).find("input:hidden[name='townid']").val();
        const page = new TownWeaponHousePage_1.default(credential, townId);
        // Parse discount
        let discount = 1;
        const input = $(pageHtml).find("input:hidden[name='val_off']");
        if (input.length > 0) {
            discount = parseFloat(input.val());
        }
        page.discount = discount;
        // Parse role cash
        const s = $(pageHtml).find("td:contains('所持金')")
            .filter(function () {
            return $(this).text() === "所持金";
        })
            .next()
            .text();
        page.roleCash = parseInt(StringUtils_1.default.substringBefore(s, " GOLD"));
        // Parse space count
        const option = $(pageHtml)
            .find("select[name='num']")
            .find("option:last");
        if (option.length === 0) {
            page.spaceCount = 0;
        }
        else {
            page.spaceCount = parseInt($(option).val());
        }
        // Parse personal equipment list
        page.personalEquipmentList = doParsePersonalEquipmentList(pageHtml);
        // Parse weapon merchandise list
        page.weaponMerchandiseList = doParseWeaponMerchandiseList(pageHtml);
        return page;
    }
    enter() {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential, townId) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request.town = townId;
                    // @ts-ignore
                    request.con_str = "50";
                    // @ts-ignore
                    request.mode = "ARM_SHOP";
                    NetworkUtils_1.default.sendPostRequest("town.cgi", request, function (pageHtml) {
                        const page = TownWeaponHouse.parsePage(pageHtml);
                        resolve(page);
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _TownWeaponHouse_credential, "f"), __classPrivateFieldGet(this, _TownWeaponHouse_townId, "f"));
        });
    }
    buy(index, count, discount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential, townId, index, count, discount) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request.select = index;
                    // @ts-ignore
                    request.townid = townId;
                    // @ts-ignore
                    request.val_off = discount;
                    // @ts-ignore
                    request.mark = 0;
                    // @ts-ignore
                    request.mode = "BUY";
                    // @ts-ignore
                    request.num = count;
                    NetworkUtils_1.default.sendPostRequest("town.cgi", request, function (pageHtml) {
                        MessageBoard_1.default.processResponseMessage(pageHtml);
                        resolve();
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _TownWeaponHouse_credential, "f"), __classPrivateFieldGet(this, _TownWeaponHouse_townId, "f"), index, count, discount);
        });
    }
    sell(index, discount) {
        return __awaiter(this, void 0, void 0, function* () {
            const action = (credential, index, discount) => {
                return new Promise(resolve => {
                    const request = credential.asRequest();
                    // @ts-ignore
                    request.select = index;
                    // @ts-ignore
                    request.val_off = discount;
                    // @ts-ignore
                    request.mode = "SELL";
                    NetworkUtils_1.default.sendPostRequest("town.cgi", request, function (pageHtml) {
                        MessageBoard_1.default.processResponseMessage(pageHtml);
                        resolve();
                    });
                });
            };
            return yield action(__classPrivateFieldGet(this, _TownWeaponHouse_credential, "f"), index, discount);
        });
    }
}
_TownWeaponHouse_credential = new WeakMap(), _TownWeaponHouse_townId = new WeakMap();
function doParsePersonalEquipmentList(pageHtml) {
    const personalEquipmentList = [];
    $(pageHtml)
        .find("input:submit[value='物品卖出']")
        .closest("table")
        .find("input:radio")
        .each(function (_idx, radio) {
        const c0 = $(radio).parent();
        const c1 = c0.next();
        const c2 = c1.next();
        const c3 = c2.next();
        const c4 = c3.next();
        const c5 = c4.next();
        const c6 = c5.next();
        const c7 = c6.next();
        const equipment = new Equipment_1.default();
        equipment.index = parseInt($(radio).val());
        equipment.selectable = !$(radio).prop("disabled");
        equipment.using = c1.text() === "★";
        equipment.parseName(c2.html());
        equipment.category = c3.text();
        equipment.power = parseInt(c4.text());
        equipment.weight = parseInt(c5.text());
        equipment.parseEndure(c6.text());
        equipment.parsePrice(c7.html());
        personalEquipmentList.push(equipment);
    });
    return personalEquipmentList;
}
function doParseWeaponMerchandiseList(pageHtml) {
    const weaponMerchandiseList = [];
    const table = $(pageHtml).find("input:radio:last")
        .closest("table");
    let specialityMatch = false;
    table.find("tr").each(function (_idx, tr) {
        const c1 = $(tr).find(":first-child");
        const radio = c1.find("input:radio:first");
        if (radio.length > 0) {
            const merchandise = new Merchandise_1.default();
            merchandise.id = "WEA_" + $(radio).val();
            merchandise.category = "武器";
            const c2 = c1.next();
            const c3 = c2.next();
            const c4 = c3.next();
            const c5 = c4.next();
            const c6 = c5.next();
            const c7 = c6.next();
            const c8 = c7.next();
            const c9 = c8.next();
            const c10 = c9.next();
            const c11 = c10.next();
            const c12 = c11.next();
            const c13 = c12.next();
            const c14 = c13.next();
            const c15 = c14.next();
            merchandise.name = c2.text();
            merchandise.nameHtml = c2.html();
            let s = c3.text();
            s = StringUtils_1.default.substringBefore(s, " Gold");
            merchandise.price = parseInt(s);
            merchandise.power = parseInt(c4.text());
            merchandise.weight = parseInt(c5.text());
            merchandise.endure = parseInt(c6.text());
            merchandise.attribute = c7.text();
            merchandise.requiredCareer = c8.text();
            merchandise.requiredAttack = parseInt(c9.text());
            merchandise.requiredDefense = parseInt(c10.text());
            merchandise.requiredSpecialAttack = parseInt(c11.text());
            merchandise.requiredSpecialDefense = parseInt(c12.text());
            merchandise.requiredSpeed = parseInt(c13.text());
            merchandise.weaponCategory = c14.text();
            merchandise.gemCount = parseInt(c15.text());
            merchandise.speciality = specialityMatch;
            weaponMerchandiseList.push(merchandise);
        }
        else if (c1.text() === "== 特产武器 ==") {
            specialityMatch = true;
        }
    });
    return weaponMerchandiseList;
}
module.exports = TownWeaponHouse;


/***/ }),
/* 208 */
/***/ ((module) => {


/**
 * 城市武器屋页面数据结构的描述
 */
class TownWeaponHousePage {
    constructor(credential, townId) {
        this.credential = credential;
        this.townId = townId;
    }
    findEquipment(index) {
        for (const equipment of this.personalEquipmentList) {
            if (equipment.index === index) {
                return equipment;
            }
        }
        return null;
    }
    findMerchandise(index) {
        for (const merchandise of this.weaponMerchandiseList) {
            if (merchandise.index === index) {
                return merchandise;
            }
        }
        return null;
    }
}
module.exports = TownWeaponHousePage;


/***/ })
/******/ 	]);
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/************************************************************************/
/******/
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__(0);
/******/
/******/ })()
;
